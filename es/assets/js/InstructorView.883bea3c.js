(self.webpackChunk=self.webpackChunk||[]).push([[111,8671],{36673:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Qt}});var n=s(202784),i=s(690299),a=s.n(i),r=s(579553),l=s.n(r),o=s(198),c=s(223444),h=s(360626),m=s(594010),d=s(623102),u=s.n(d),p=s(557106),f=s.n(p),g=s(539365),b=s(213980),y=s.n(b),v=s(619034),E=s.n(v),k=s(596823),w=s.n(k),j=s(790817),S=s(770561),C=s(423184),x=s(482228),z=s(380408),Z=s(156562),N=s(224008),F=s.n(N),I=s(287013),T=s.n(I),O=s(700601),D=s.n(O),A=s(217431);s(185229);var P=(0,A.Z)((()=>Promise.all([s.e(532),s.e(8115),s.e(9212)]).then(s.bind(s,936242)))),$=s(55257),L=s(422132),R=s(123103),H=s(302108),U=s(438802),M=s.n(U),V=s(93961),_=s.n(V);var B=(0,A.Z)((()=>s.e(2493).then(s.bind(s,777473)))),G=s(912860),q=s(779572);const W=e=>{let t=e.value;(0,q.isPrimitive)(t)&&(t=t?"true":"false");const s=new Date(e.absoluteTime);let i,a;return e.anonymized?(i=e.userHash.name[e.name]||e.name,a=e.userHash.email[e.email]||e.email):(i=e.name,a=e.email),n.createElement(G.Z,{style:{background:e.backgroundColor,color:e.color,fontSize:15,fontFamily:"Open Sans",padding:"2px 1px 2px 1px",lineHeight:1}},n.createElement("div",{className:"actionNote"},n.createElement("label",{htmlFor:"action-email-button"},e.t("name"),":\xa0"),n.createElement("button",{id:"action-name-button",className:"empty-button",onClick:e.clickFactory("name",e.name)},i)," | ",n.createElement("label",{htmlFor:"action-email-button"},e.t("email"),":\xa0"),n.createElement("button",{id:"action-email-button",className:"empty-button",onClick:e.clickFactory("email",e.email)},a)),n.createElement("div",{className:"actionNote"},n.createElement("span",{className:"title"},e.t("time"),":\xa0"),s.toLocaleTimeString()," - ",s.toLocaleDateString()),n.createElement("div",{className:"actionNote"},n.createElement("label",{htmlFor:"action-id-button"},e.t("id"),":\xa0"),n.createElement("button",{id:"action-id-button",className:"empty-button",onClick:e.clickFactory("id",e.id)},e.id)," |",n.createElement("label",{htmlFor:"action-type-button"},e.t("type"),":\xa0"),n.createElement("button",{id:"action-type-button",className:"empty-button",onClick:e.clickFactory("type",e.type)},e.type)),n.createElement("div",{className:"actionNote"},n.createElement("span",{className:"title"},e.t("value"),":\xa0"),n.createElement("span",{style:{userSelect:"text"}},t)),n.createElement(S.Z,{variant:"outline-danger",size:"sm",onClick:()=>{e.onDelete(e.sessiondataID)},"aria-label":e.t("delete"),style:{position:"absolute",top:6,right:6}},n.createElement("span",{className:"fa fa-trash"})))};W.propTypes={absoluteTime:y().number.isRequired,backgroundColor:y().string.isRequired,color:y().string.isRequired,clickFactory:y().func.isRequired,email:y().string.isRequired,type:y().string.isRequired,value:y().oneOfType([y().object,y().string]).isRequired,anonymized:y().bool.isRequired,userHash:y().object.isRequired};var J=(0,o.Z)("internal/statusbar")(W),K=s(922730),Q=s(883992),Y=s.n(Q);var X=function(e,t,s){return n=>{n.stopPropagation();let i=F()(t);delete i[e],u()(i)&&(i=null);const a=ee(i,s);s(i,a)}};var ee=function(e,t){let s=e?Y()(e):[];return n.createElement(n.Fragment,null,n.createElement("span",{className:"title"},K.a.t("internal/statusbar:filters")),n.createElement("span",{style:{position:"relative",width:"auto",fontSize:"12px",fontFamily:"Open Sans"}},s.map(((s,i)=>n.createElement("button",{className:"action-filter-button",onClick:X(s[0],e,t),key:i},s[0],": ",s[1])))))},te=Object.defineProperty,se=(e,t,s)=>(((e,t,s)=>{t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const ne=a()("isle:statusbar:action-log"),ie=/\r?\n/g;class ae extends n.Component{constructor(e){super(e),se(this,"clickFactory",((e,t)=>()=>{const s=this.props.filter?F()(this.props.filter):{};s[e]=t,ne("The filter was successfully changed: "+JSON.stringify(s));const n=ee(s,this.props.onFilterChange);this.props.onFilterChange(s,n)})),se(this,"itemSizeGetter",(e=>{let t=40;const s=this.state.actions[e];if(!s)return 0;return t+=16*((String(s.value).match(ie)||"").length+1),t+=20,t})),se(this,"openDeleteModal",(e=>{ne("Open delete modal for action with id "+e),this.setState({showDeleteModal:!this.state.showDeleteModal,deleteModelActionID:e})})),se(this,"closeDeleteModal",(()=>{ne("Close delete modal..."),this.setState({showDeleteModal:!1})})),se(this,"deleteAction",(()=>{const e=this.state.deleteModelActionID;ne("Should delete action with id: "+e);this.props.session.removeSessionElementFromDB(e,(e=>{e&&ne("Encountered an error: "+e.message),this.closeDeleteModal()}))})),se(this,"renderItem",((e,t)=>{ne(`Render ${e}th item`);const s=this.state.actions[e];let i,a=e%2?"white":"lightgrey";return i=s.owner?"#3c763d":"black",n.createElement(J,{key:t,backgroundColor:a,color:i,clickFactory:this.clickFactory,onDelete:this.openDeleteModal,value:s.value,email:s.email,type:s.type,name:s.name,owner:s.owner,absoluteTime:s.absoluteTime,time:s.time,id:s.id,sessiondataID:s.sessiondataID,anonymized:this.props.anonymized,userHash:this.props.userHash})})),this.state={actions:e.actions,showDeleteModal:!1,deleteModelActionID:null}}static getDerivedStateFromProps(e,t){if(e.actions.length!==t.actions.length){const t=new Array(e.actions.length);for(let s=0;s<e.actions.length;s++){t[s]=e.actions[s];const n=t[s].value;_()(n)&&(t[s].value=JSON.stringify(n,null,2))}return{actions:e.actions}}return null}render(){const{height:e}=this.props,{actions:t}=this.state;ne("Rendering list of actions...");let s=null;return t.length>0&&(ne("Received more than one action: "+t.length),s=n.createElement(M(),{itemRenderer:this.renderItem,length:t.length,type:"variable",pageSize:50,itemSizeGetter:this.itemSizeGetter})),n.createElement("div",{style:{overflowY:"scroll",height:e}},s,n.createElement(B,{show:this.state.showDeleteModal,onDelete:this.deleteAction,onClose:this.closeDeleteModal}))}}ae.defaultProps={actions:[],anonymized:!1,filter:{},height:null,userHash:null,onFilterChange(){}},ae.propTypes={actions:y().array,anonymized:y().bool,filter:y().object,height:y().number,userHash:y().object,onFilterChange:y().func,period:y().shape({from:y().object,to:y().object}).isRequired,session:y().object.isRequired};var re=(0,o.Z)("internal/statusbar")(ae),le=s(931776),oe=s(23836),ce=s(293367),he=s.n(ce),me=Object.defineProperty,de=Object.defineProperties,ue=Object.getOwnPropertyDescriptors,pe=Object.getOwnPropertySymbols,fe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,be=(e,t,s)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ye=(e,t)=>{for(var s in t||(t={}))fe.call(t,s)&&be(e,s,t[s]);if(pe)for(var s of pe(t))ge.call(t,s)&&be(e,s,t[s]);return e};class ve extends n.Component{constructor(e){var t;super(e),be(this,"symbol"!=typeof(t="handleSubmit")?t+"":t,(()=>{const e=this.state.type.value;let t=this.state.value;"type"===e&&(t=he()(t)),this.props.onSubmit(e,t),this.setState({type:null,value:""})})),this.options=[{value:"email",label:this.props.t("email")},{value:"name",label:this.props.t("name")},{value:"type",label:this.props.t("type")},{value:"id",label:this.props.t("id")},{value:"value",label:this.props.t("value")}],this.state={type:null,value:""}}render(){const{style:e,t:t}=this.props;return n.createElement(oe.Z.Group,{controlId:"custom-filter-form-group",style:(s=ye({},e),i={width:280},de(s,ue(i)))},n.createElement("div",{style:{width:100,float:"left"}},n.createElement(le.ZP,{options:this.options,placeholder:t("filter"),value:this.state.type,onChange:e=>{this.setState({type:e})}})),n.createElement(oe.Z.Control,{type:"text",value:this.state.value,placeholder:t("contains"),style:{width:100,float:"left"},onChange:e=>{this.setState({value:e.target.value})}}),n.createElement(S.Z,{size:"small",variant:"light",style:{float:"left"},onClick:this.handleSubmit,disabled:!this.state.type||!this.state.value},n.createElement("i",{className:"fas fa-plus"})));var s,i}}ve.propTypes={onSubmit:y().func.isRequired,style:y().object},ve.defaultProps={style:{}};var Ee=ve,ke=Object.defineProperty,we=(e,t,s)=>(((e,t,s)=>{t in e?ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const je=a()("isle:statusbar:action-log");E().locale("us");class Se extends n.Component{constructor(e){super(e),we(this,"resizeHandler",(()=>{this.setState({listHeight:f()(.85*window.innerHeight-320,0)})})),we(this,"handleEmailFilterClick",(e=>{e.stopPropagation();let t=F()(this.state.filter);delete t.email,u()(t)&&(t=null);const s=ee(t,((e,t)=>{this.setState({filter:e,filters:t})}));this.setState({filter:t,filters:s})})),we(this,"handleIDFilterClick",(e=>{e.stopPropagation();let t=F()(this.state.filter);delete t.id,u()(t)&&(t=null);const s=ee(t,((e,t)=>{this.setState({filter:e,filters:t})}));this.setState({filter:t,filters:s})})),we(this,"handleRadioChange",(()=>{return e=this,t=null,s=function*(){const e=this.context;this.userHash||(this.userHash=yield e.getFakeUsers()),this.setState({anonymized:!this.state.anonymized})},new Promise(((n,i)=>{var a=e=>{try{l(s.next(e))}catch(t){i(t)}},r=e=>{try{l(s.throw(e))}catch(t){i(t)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,r);l((s=s.apply(e,t)).next())}));var e,t,s})),we(this,"prepareActionsForExport",(()=>{const e=this.state.actions.length;let t;if(je("Exporting "+e+" actions for export..."),this.state.anonymized){t=new Array(e);for(let s=0;s<e;s++){const e=F()(this.state.actions[s]);e.name=this.userHash.name[e.name]||e.name,e.email=this.userHash.email[e.email]||e.email,t[s]=e}}else t=this.state.actions;return t})),we(this,"saveJSON",(()=>{const e=this.context,t=this.prepareActionsForExport(),s=new Blob([JSON.stringify(t)],{type:"application/json"}),n=`actions_${e.namespaceName}_${e.lessonName}.json`;(0,$.Z)(s,n)})),we(this,"saveCSV",(()=>{const e=this.context,t=this.prepareActionsForExport();w()(t,{header:!0},((t,s)=>{if(t)return e.addNotification({title:this.props.t("error-encountered"),message:this.props.t("error-csv")+t.message,level:"error",position:"tl"});const n=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=`actions_${e.namespaceName}_${e.lessonName}.csv`;(0,$.Z)(n,i)}))})),this.state={anonymized:!1,includes:["guests","owners","students"],filters:n.createElement("span",{className:"title"},this.props.t("filters")),period:{from:E()(0).startOf("day"),to:E()().endOf("day")},actions:[],listHeight:f()(.85*window.innerHeight-320,0)}}componentDidMount(){const e=this.context;e.socketActions&&e.socketActions.length>0&&(je("Initial construction of actions array..."),this.setState({actions:this.buildActionsArray()})),this.unsubscribe=e.subscribe(((t,s)=>{t===H.E7?(je("Should reset the filters after user logout:"),this.setState({filters:n.createElement("span",{className:"title"},this.props.t("filters"))})):t!==H.c_&&t!==H.Wh&&t!==H.Hl||this.setState({actions:this.buildActionsArray()}),0===e.socketActions.length&&null!==this.state.filter&&this.setState({filter:{},filters:n.createElement("span",{className:"title"},this.props.t("filters"))})})),window.addEventListener("resize",this.resizeHandler)}componentDidUpdate(e,t){this.props.selectedEmail!==e.selectedEmail?this.setState({filter:{email:this.props.selectedEmail},filters:n.createElement(n.Fragment,null,n.createElement("span",{className:"title"},this.props.t("filters")),n.createElement("span",{style:{position:"relative",width:"auto",fontSize:"12px",fontFamily:"Open Sans"}},n.createElement("span",{role:"button",tabIndex:0,onClick:this.handleEmailFilterClick,onKeyPress:this.handleEmailFilterClick,style:{marginLeft:10,background:"lightcoral",cursor:"pointer"}},"email",": ",this.props.selectedEmail)))}):this.props.selectedID!==e.selectedID?this.setState({filter:{id:this.props.selectedID},filters:n.createElement(n.Fragment,null,n.createElement("span",{className:"title"},this.props.t("filters")),n.createElement("span",{style:{position:"relative",width:"auto",fontSize:"12px",fontFamily:"Open Sans"}},n.createElement("span",{role:"button",tabIndex:0,onClick:this.handleIDFilterClick,onKeyPress:this.handleIDFilterClick,style:{marginLeft:10,background:"lightcoral",cursor:"pointer"}},"id",": ",this.props.selectedID)))}):this.state.filter!==t.filter?(je("Should filter out actions..."),this.setState({actions:this.buildActionsArray()})):this.state.period.from===t.period.from&&this.state.period.to===t.period.to||this.setState({actions:this.buildActionsArray()})}componentWillUnmount(){this.unsubscribe&&this.unsubscribe(),window.removeEventListener("resize",this.resizeHandler)}buildActionsArray(){let{from:e,to:t}=this.state.period;const s=T()(this.state.includes,"owners"),n=T()(this.state.includes,"students"),i=T()(this.state.includes,"guests");if(je("Building action array..."),e&&t){e=e.toDate(),t=t.toDate();const a=this.context;let r=[];for(let l=0;l<a.socketActions.length;l++){let o=a.socketActions[l];a.selectedCohort&&!(0,L.Z)(a.selectedCohort,o.email)||o.absoluteTime>e&&o.absoluteTime<t&&(o.owner?s&&r.push(o):o.email===o.name?i&&r.push(o):n&&r.push(o))}return this.state.filter&&(je("Should filter actions: "+r.length),this.removeMarkedActions(r)),r}return[]}removeMarkedActions(e){for(let t=e.length-1;t>=0;t--){let s=e[t],n=!1;for(let e in this.state.filter)if(D()(this.state.filter,e)){let t=this.state.filter[e];String(s[e]).includes(t)||(n=!0)}n&&e.splice(t,1)}}render(){const e=this.context,t=e.socketActions,s=t.length;let i;return i=s>0?t[s-1].absoluteTime:0,n.createElement(j.Z.Body,null,n.createElement(P,{size:"sm",origin:i,onChange:e=>{this.setState({period:e})},style:{float:"left"}}),n.createElement(Ee,{style:{float:"left"},t:this.props.t,onSubmit:(e,t)=>{const s=this.state.filter?F()(this.state.filter):{};s[e]=t;const n=ee(s,((e,t)=>{this.setState({filter:e,filters:t})}));this.setState({filter:s,filters:n})}}),n.createElement("br",{style:{clear:"both"}}),n.createElement(re,{session:e,actions:this.state.actions,period:this.state.period,filter:this.state.filter,height:this.state.listHeight,userHash:this.userHash,anonymized:this.state.anonymized,onFilterChange:(e,t)=>{this.setState({filter:e,filters:t})}}),this.state.filters,n.createElement(x.Z,null,n.createElement(C.Z,null,n.createElement("span",{style:{fontSize:"14px",marginRight:20,paddingTop:5,fontWeight:600}},this.props.t("num-actions",{n:this.state.actions.length}))),n.createElement(z.Z,{name:"options",onChange:this.handleRadioChange,type:"radio",size:"small",value:this.state.anonymized,style:{marginRight:"5px"}},n.createElement(Z.Z,{id:"toggle-original-actions",size:"sm",variant:"light",value:!1,style:{fontSize:"12px",color:this.state.anonymized?"#A9A9A9":"black"}},this.props.t("original")),n.createElement(Z.Z,{id:"toggle-anonymized-actions",size:"sm",variant:"light",value:!0,style:{fontSize:"12px",color:this.state.anonymized?"black":"#A9A9A9"}},this.props.t("anonymized"))),n.createElement(z.Z,{type:"checkbox",onChange:e=>{this.setState({includes:e})},value:this.state.includes,style:{marginRight:"5px"}},n.createElement(Z.Z,{id:"toggle-instructor-actions",size:"sm",variant:"light",value:"owners",style:{fontSize:"12px",color:T()(this.state.includes,"owners")?"black":"#A9A9A9"}},this.props.t("instructors")),n.createElement(Z.Z,{id:"toggle-student-actions",size:"sm",variant:"light",value:"students",style:{fontSize:"12px",color:T()(this.state.includes,"students")?"black":"#A9A9A9"}},this.props.t("students")),n.createElement(Z.Z,{id:"toggle-guest-actions",size:"sm",variant:"light",value:"guests",style:{fontSize:"12px",color:T()(this.state.includes,"guests")?"black":"#A9A9A9"}},this.props.t("guests"))),n.createElement(C.Z,{size:"sm"},n.createElement(S.Z,{variant:"primary",onClick:this.saveJSON},this.props.t("save-json")),n.createElement(S.Z,{variant:"primary",onClick:this.saveCSV},this.props.t("save-csv")))))}}Se.contextType=R.Z,Se.propTypes={selectedEmail:y().string,selectedID:y().string},Se.defaultProps={selectedEmail:null,selectedID:null};var Ce=Se,xe=s(165666);const ze=a()("isle:instructor-notes-editor"),Ze=["bold","italic","underline","heading","|","open_markdown","save","preview"];var Ne=()=>(ze("Rendering instructor notes..."),n.createElement(xe.Z,{id:"instructor-notes-editor",className:"instructor-notes-editor",mode:"collaborative",allowSubmissions:!1,toolbarConfig:Ze})),Fe=s(975813),Ie=s(112114),Te=s(113545),Oe=s(188304),De=s(998856),Ae=s(552770),Pe=s.n(Ae),$e=s(294565),Le=s(437069),Re=s.n(Le),He=s(370420),Ue=s(727187),Me=s(257513),Ve=s(763489),_e=Object.defineProperty,Be=(e,t,s)=>(((e,t,s)=>{t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const Ge=a()("isle:statusbar:instructor-view"),qe=[];function We(){const e=document.getElementsByClassName("focus-glow");for(;e.length;)e[0].classList.remove("focus-glow");const t=document.getElementById("duplicated-container");t&&t.parentNode.removeChild(t)}class Je extends n.Component{constructor(e){super(e),Be(this,"highlightElement",(e=>{const t=this.props.session.userFocuses[e];Ge("ID of element to be focused is: "+t),We();const s=document.getElementById(t);if(s)if(Ge("Found element, should add glow effect..."),(0,Me.Z)(s)){const e=s.cloneNode(!0),t=document.createElement("div");t.id="duplicated-container",e.id="duplicated-elem",e.classList.add("focus-glow"),t.append(e),document.body.appendChild(t)}else s.classList.add("focus-glow"),s.scrollIntoView()})),Be(this,"handleClickFactory",(e=>()=>{if(this.state.selected===e)return We(),this.setState({selected:null});this.highlightElement(e),this.setState({selected:e})})),Be(this,"thumbnailClickFactory",(e=>t=>{t.stopPropagation(),this.props.onThumbnailClick(e)})),Be(this,"filter",(e=>{Ge("Clicked on progressbar...");const t=e.target.innerText;let s;s=this.state.filter===t?null:t,this.setState({filter:s})})),Be(this,"chatInviteFactory",((e,t)=>{const s=this.props.session;return(n,i)=>{Ge("Invite "+t+" to personal chat..."),i?s.inviteToChat({name:e,canLeave:!1},t):s.closeChatForAll(e)}})),Be(this,"videoChatInviteFactory",((e,t)=>{const s=this.props.session;return(n,i)=>{Ge("Invite "+t+" to video chat..."),i&&s.inviteToVideo(e,t)}})),this.state={filter:null,selected:null}}componentDidMount(){const e=this.props.session;this.unsubscribe=e.subscribe(((e,t)=>{e===H.lf||e===H.At||e===H.vu||e===H.p0||e===H.c_||e===H.Ny?(Ge("Should render the user list..."),this.forceUpdate()):e!==H.Wh||t.type!==H.gz&&t.type!==H.sS||(t.email===this.state.selected&&this.highlightElement(t.email),this.forceUpdate())}))}componentWillUnmount(){Ge("Unmount user list..."),this.unsubscribe&&this.unsubscribe(),We()}render(){const e=this.props.session,t=e.userFocuses,s=e.userProgress,i={};let a=0;const r=n.createElement(Oe.Z,{className:"user-list-group",style:{height:"calc(85vh - 110px)"}},e.userList.filter((s=>{if(e.selectedCohort&&!(0,L.Z)(e.selectedCohort,s.email))return!1;const n=t[s.email];if(n){let e=Pe()(qe,n);-1===e&&(e=qe.length,qe.push(n)),i[n]=(i[n]||0)+1,a+=1}return!this.state.filter||n===this.state.filter})).map(((i,a)=>{let r=null;const l=t[i.email];if(l){let e=Pe()(qe,l);r=n.createElement("span",{style:{float:"right",color:Ve.D[e%Ve.D.length]}},l)}let o,c;o=i.owner?"#3c763d":i.inactive?"lightgray":"black",c=this.state.selected===i.email?"#e0a800":"transparent";const h=e.server+"/thumbnail/"+i.picture,m=this.thumbnailClickFactory(i.email),d=e.user.email!==i.email&&!i.inactive,u=(0,$e.isPrimitive)(i.joinTime)?i.joinTime:new Date(i.joinTime).toLocaleTimeString();let p;p=null===i.exitTime?"":(0,$e.isPrimitive)(i.exitTime)?i.exitTime:new Date(i.exitTime).toLocaleTimeString();const f=`${i.name} (${i.email}) | ${u} - ${p}`;return n.createElement(G.Z,{className:"user-list-item",key:a},n.createElement("div",{style:{width:"100%"}},n.createElement(Ie.Z,{placement:"right",tooltip:this.props.t("open-user-actions")},n.createElement("span",{role:"button",tabIndex:0,onClick:m,onKeyPress:m},n.createElement("img",{className:"user-thumbnail",alt:"User thumbnail",src:h}))),n.createElement(Ie.Z,{placement:"bottom",tooltip:this.props.t("lesson-progress")},n.createElement(De.Z,{"aria-label":`${this.props.t("lesson-progress")}: ${i.email}}`,className:"user-list-progress",now:100*s[i.email]})),d?n.createElement(He.Z,{showTooltip:!1,for:this.props.t("chat-with",{name:i.name}),onClick:this.chatInviteFactory(this.props.t("chat-with",{name:i.name}),i.email)}):null,d?n.createElement(Ue.Z,{showTooltip:!1,for:`${e.user.name}-${i.name}`,subject:this.props.t("video-chat-with",{name:i.name}),style:{marginLeft:5},onClick:this.videoChatInviteFactory({name:`${e.user.name}-${i.name}`,subject:this.props.t("video-chat-with",{name:i.name})},i.email)}):null),n.createElement("div",{style:{width:"100%",color:o}},f,r?n.createElement(Ie.Z,{placement:"left",tooltip:this.props.t("element-interacting-with")},n.createElement(S.Z,{className:"user-list-active-button",variant:"outline-secondary",size:"sm",onClick:this.handleClickFactory(i.email),style:{background:c}},r)):null))}))),l=Re()(i);return n.createElement(n.Fragment,null,n.createElement(Ie.Z,{placement:"left",tooltip:this.props.t("users-interacting-with")},n.createElement(De.Z,{"aria-label":this.props.t("users-interacting-with"),style:{cursor:"pointer"},onClick:this.filter},l.map(((e,t)=>{const s=Pe()(qe,e),r=Ve.D[s%Ve.D.length];return n.createElement(De.Z,{style:{background:this.state.filter!==e?r:"gold"},key:t,now:i[e]/a*100,label:e})})))),r)}}Je.propTypes={onThumbnailClick:y().func.isRequired,session:y().object.isRequired};var Ke=Je,Qe=s(686605),Ye=s.n(Qe),Xe=s(841908),et=s.n(Xe),tt=s(295943),st=s.n(tt);var nt=e=>{e/=1e3;const t=st()(e/3600);e%=3600;let s=st()(e/60);return s<10&&(s="0"+s),t+":"+s},it=Object.defineProperty,at=(e,t,s)=>(((e,t,s)=>{t in e?it(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const rt=a()("isle:statusbar:instructor-view");function lt(){const e=document.getElementsByClassName("focus-glow");for(;e.length;)e[0].classList.remove("focus-glow");const t=document.getElementById("duplicated-container");t&&t.parentNode.removeChild(t)}class ot extends n.Component{constructor(e){super(e),at(this,"thumbnailClickFactory",(e=>t=>{t.stopPropagation(),this.props.onThumbnailClick(e)})),at(this,"highlightFactory",(e=>()=>{if(lt(),this.state.selected===e)return this.setState({selected:null});const t=document.getElementById(e);if(t)if(rt("Found element, should add glow effect..."),(0,Me.Z)(t)){const e=t.cloneNode(!0);e.addEventListener("click",(e=>{rt(`Clicked on element with ID ${e.target.id}`);document.getElementById(e.target.id).click()}));const s=document.createElement("div");s.id="duplicated-container",e.id="duplicated-elem",e.classList.add("focus-glow"),s.append(e),document.body.appendChild(s)}else t.classList.add("focus-glow"),t.scrollIntoView();this.setState({selected:e})})),rt("Initializing state in constructor..."),this.state={selected:null,means:{}}}componentDidMount(){const e=this.props.session,t=e.responseVisualizers,s=e.responseVisualizerIds,n={};for(let i=0;i<s.length;i++){const e=t[s[i]],a=et()();e.ref.state.actions.forEach((e=>{a(e.time)})),n[s[i]]=a}this.setState({means:n}),this.unsubscribe=e.subscribe(((e,t)=>{if(e===H.Wh&&T()(s,t.id)){const e=F()(this.state.means);e[t.id](t.time),this.setState({means:e})}else e!==H.VC&&e!==H.c_||this.forceUpdate()}))}componentWillUnmount(){lt(),this.unsubscribe&&this.unsubscribe()}render(){rt("Render response visualizer statistics...");const{t:e}=this.props;let t,s;const i=this.props.session;i.selectedCohort?(s=i.activeCohortMembers.length,t=e("completion-rate-cohort",{cohort:i.selectedCohort.title})):(s=i.userList.length,t=e("completion-rate-all"));const a=i.responseVisualizers,{means:r}=this.state,l=i.responseVisualizerIds,o=new Array(l.length),h=new Date-this.props.session.startTime;let m=0;for(let d=0;d<l.length;d++){const u=a[l[d]],p=u.ref.state.nInfo,f=u.ref.state.nActions,g=Re()(u.ref.emailHash).length,b=p/s*100;m+=b;const y=l[d],v=`${e("time")}: ${r[y]?nt(r[y]()):""}`;let E,k;E=p>0&&r[y]&&h>r[y]()?b<10?"danger":b>75?"success":"info":"secondary",k=i.selectedCohort?`${p} / ${s} (${e("of")} ${i.selectedCohort.members.length})`:`${p} / ${s}`,o[d]=n.createElement(G.Z,{key:d,style:{background:this.state.selected===y?"gold":"lightgrey",padding:"0.4rem 1rem",cursor:"pointer"},onClick:this.highlightFactory(y)},n.createElement(Ie.Z,{placement:"right",tooltip:e("question-id-tooltip")},n.createElement("label",{style:{margin:0}},y)),n.createElement(Ie.Z,{placement:"left",tooltip:e("open-actions")},n.createElement(c.Z,{bg:"secondary",style:{float:"right",margin:"2px"},onClick:this.thumbnailClickFactory(y)},e("open"))),n.createElement(Ie.Z,{placement:"left",tooltip:e("num-cohort-actions",{cohort:i.selectedCohort?i.selectedCohort.title:"all cohorts"})},n.createElement(c.Z,{bg:"secondary",style:{float:"right",margin:"2px"}},`n: ${f}`)),n.createElement(Ie.Z,{placement:"left",tooltip:e("num-students-answered",{cohort:i.selectedCohort?i.selectedCohort.title:"all cohorts"})},n.createElement(c.Z,{bg:"secondary",style:{float:"right",margin:"2px"}},`s: ${g}`)),n.createElement(Ie.Z,{placement:"left",tooltip:e("elapsed-time")},n.createElement(c.Z,{bg:E,style:{float:"right",margin:"2px"}},v)),n.createElement(Ie.Z,{placement:"left",tooltip:t},n.createElement(De.Z,{variant:"info",now:b,max:100,min:0,label:k,style:{width:"180px",float:"right",height:"1.25rem"}})))}return m/=l.length,n.createElement("div",null,n.createElement(De.Z,{striped:!0,variant:"success",label:e("class-progress",{progress:Ye()(m)}),now:m}),n.createElement(Oe.Z,{style:{height:"calc(85vh - 110px)",overflowY:"scroll"}},o))}}ot.propTypes={onThumbnailClick:y().func.isRequired,session:y().object.isRequired};var ct=ot,ht=s(903472),mt=s(318967),dt=s.n(mt),ut=s(471275),pt=s(26266),ft=s(458264),gt=s(312594),bt=s(875084),yt=s(588703),vt=s.n(yt),Et=s(309765),kt=s(871199),wt=s.n(kt),jt=s(228713),St=s(684800),Ct=s(870781),xt=Object.defineProperty,zt=Object.defineProperties,Zt=Object.getOwnPropertyDescriptors,Nt=Object.getOwnPropertySymbols,Ft=Object.prototype.hasOwnProperty,It=Object.prototype.propertyIsEnumerable,Tt=(e,t,s)=>t in e?xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ot=(e,t)=>{for(var s in t||(t={}))Ft.call(t,s)&&Tt(e,s,t[s]);if(Nt)for(var s of Nt(t))It.call(t,s)&&Tt(e,s,t[s]);return e},Dt=(e,t,s)=>(Tt(e,"symbol"!=typeof t?t+"":t,s),s);const At=a()("isle:statusbar:student-responses"),Pt=e=>(0,$e.isPrimitive)(e)&&e.startsWith("[")&&e.endsWith("]");function $t(e,t){const s=new Set;for(const n of e)t.has(n)&&s.add(n);return s}function Lt(){const e=document.getElementsByClassName("focus-glow");for(;e.length;)e[0].classList.remove("focus-glow");const t=document.getElementById("duplicated-container");t&&t.parentNode.removeChild(t)}function Rt(e,t){const s=t.ref.props.data.type;let n;if(wt()(e))return"";switch(s){case"factor":{const s=t.ref.props.data.levels;Pt(e)&&(e=JSON.parse(e)),n=vt()(e)?(0,Et.isPrimitive)(e[0])?e.map((e=>(0,Et.isPrimitive)(e)?s[e]:e)).join(", "):e.map(((e,t)=>!0===e?s[t]:"")).filter((e=>""!==e)).join(", "):s[e]}break;case"range":Pt(e)&&(e=JSON.parse(e)),n=`lower: ${e[0]}, upper: ${e[1]}`;break;case"number":default:n=String(e);break;case"image":break;case"matrix":case"tensor":case"matches":n=JSON.stringify(e,null,2)}return n}function Ht(e){const t=new Date(e);return`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`}function Ut(e,t){if(!e)return 0;const s=t.ref.props.data.solution,n=t.ref.props.data.type,i=t.ref.props.points;if(wt()(s))return i;let a=e.value;switch(n){case"factor":if(vt()(s)){Pt(a)&&(a=JSON.parse(a));const e=new Set(s),n=new Set,r=t.ref.props.data.levels;for(let t=0;t<r.length;t++)e.has(t)||n.add(t);const l=new Set;for(let t=0;t<a.length;t++)!0===a[t]&&l.add(t);const o=$t(l,e),c=$t(l,n),h=o.size-c.size+n.size;return Ye()(h/(e.size+n.size)*i)}return a===s?i:0;case"range":return Pt(a)&&(a=JSON.parse(a)),a[0]===s[0]&&a[1]===s[1]?i:a[0]===s[0]||a[1]===s[1]?Ye()(i/2):0;case"number":return a===s?i:0;default:return i}}class Mt extends n.Component{constructor(e){super(e),Dt(this,"highlightFactory",(e=>()=>{if(Lt(),this.state.selected===e)return this.setState({selected:null});const t=document.getElementById(e);if(t)if(At("Found element, should add glow effect..."),(0,Me.Z)(t)){const e=t.cloneNode(!0);e.addEventListener("click",(e=>{At(`Clicked on element with ID ${e.target.id}`);document.getElementById(e.target.id).click()}));const s=document.createElement("div");s.id="duplicated-container",e.id="duplicated-elem",e.classList.add("focus-glow"),s.append(e),document.body.appendChild(s)}else t.classList.add("focus-glow"),t.scrollIntoView();this.setState({selected:e})})),Dt(this,"handleRadioChange",(()=>{return e=this,t=null,s=function*(){const e=this.props.session;this.userHash||(this.userHash=yield e.getFakeUsers()),this.setState({anonymized:!this.state.anonymized})},new Promise(((n,i)=>{var a=e=>{try{l(s.next(e))}catch(t){i(t)}},r=e=>{try{l(s.throw(e))}catch(t){i(t)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,r);l((s=s.apply(e,t)).next())}));var e,t,s})),Dt(this,"prepareQuestionsForExport",(()=>{let e=[];const t=this.props.session,s=t.responseVisualizerIds,i=t.responseVisualizers;for(let a=0;a<s.length;a++){const r=i[s[a]],l=r.ref.props.data.question,o=r.ref.props.data.solution;let c=r.ref.state.actions;const h=[];for(let e=0;e<c.length;e++){const s=c[e];h.push({id:s.id,type:s.type,value:s.value,absoluteTime:Ht(s.absoluteTime),time:s.time,email:this.state.anonymized?this.userHash.email[s.email]:s.email,name:this.state.anonymized?this.userHash.name[s.name]:s.name,question:n.isValidElement(l)?dt()(l):String(l),solution:n.isValidElement(o)?dt()(o):o,maximumPoints:r.ref.props.points,awardedPoints:t.lessonGrades[s.email]?t.lessonGrades[s.email][s.id]:null})}e=e.concat(h)}return e})),Dt(this,"saveJSON",(()=>{const e=this.props.session,t=this.prepareQuestionsForExport(),s=new Blob([JSON.stringify(t)],{type:"application/json"}),n=`questions_${e.namespaceName}_${e.lessonName}.json`;(0,$.Z)(s,n)})),Dt(this,"saveCSV",(()=>{const e=this.props.session,t=this.prepareQuestionsForExport();w()(t,{header:!0},((t,s)=>{if(t)return e.addNotification({title:this.props.t("error-encountered"),message:this.props.t("error-csv")+t.message,level:"error",position:"tl"});const n=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=`questions_${e.namespaceName}_${e.lessonName}.csv`;(0,$.Z)(n,i)}))})),Dt(this,"assembleUserList",(()=>{const e=this.props.session,t=[];if(this.state.anonymized){const s=this.userHash,n=e=>s.name[e.name]||e.name,i=e=>s.email[e.email]||e.email;if(e.cohorts)if(e.selectedCohort){const s=e.selectedCohort;for(let e=0;e<s.members.length;e++){const a=s.members[e];t.push({value:s.members[e],label:`${n(a)} (${i(a)})`})}}else for(let a=0;a<e.cohorts.length;a++){const s=e.cohorts[a];for(let e=0;e<s.members.length;e++){const a=s.members[e];t.push({value:s.members[e],label:`${n(a)} (${i(a)})`})}}return t}if(e.cohorts)if(e.selectedCohort){const s=e.selectedCohort;for(let e=0;e<s.members.length;e++){const n=s.members[e];t.push({value:s.members[e],label:`${n.name} (${n.email})`})}}else for(let s=0;s<e.cohorts.length;s++){const n=e.cohorts[s];for(let e=0;e<n.members.length;e++){const s=n.members[e];t.push({value:n.members[e],label:`${s.name} (${s.email})`})}}return t})),Dt(this,"assembleGrades",(e=>{const t=this.props.session,s=t.lessonGrades[e.value.email]||{},n=t.responseVisualizers,i=t.responseVisualizerIds;for(let a=0;a<i.length;a++){const t=i[a],r=n[t],l=r.ref.state.actions.filter((t=>t.email===e.value.email));let o;o=s&&(0,Et.isPrimitive)(s[t])?s[t]:Ut(l[0],r),s[t]=o}return s})),Dt(this,"handleFeedbackFactory",(e=>()=>{let t;t=e!==this.state.feedbackID||!this.state.showFeedbackEditor,this.setState({showFeedbackEditor:t,feedbackID:e,feedbackText:""})})),Dt(this,"handleFeedbackSubmission",(()=>{this.props.session.appendGradeMessage(this.state.leftUser.email,this.state.feedbackID,this.state.feedbackText),this.setState({feedbackText:""})})),Dt(this,"renderFeedbackMessages",(()=>{const e=this.props.session,t=e.lessonGradeMessages;if(t[this.state.leftUser.email]&&t[this.state.leftUser.email][this.state.feedbackID]){const s=t[this.state.leftUser.email][this.state.feedbackID];return n.createElement("div",{className:"student-responses-feedback-messages"},s.map(((t,s)=>n.createElement("div",{className:"feedback-message",key:s},n.createElement("img",{className:"feedback-picture unselectable",src:e.server+"/thumbnail/"+t.picture,alt:this.props.t("profile-pic")}),n.createElement("div",{className:"feedback-message-right"},n.createElement("span",{className:"feedback-user"},t.user)," - ",n.createElement("span",{className:"feedback-time"},(0,Ct.Z)(t.time)),n.createElement("br",null),n.createElement("span",{className:"feedback-message-content"},t.content))))))}return n.createElement("p",null,this.props.t("no-feedback-yet"))})),At("Initializing state in constructor..."),this.state={selected:null,leftUser:null,rightUser:null,anonymized:!1,grades:{},showFeedbackEditor:!1,feedbackID:null,feedbackText:""}}componentDidMount(){const e=this.props.session;e.getLessonGrades(),e.getLessonGradeMessages(),this.unsubscribe=e.subscribe(((e,t)=>{e!==H.VC&&e!==H.c_||this.forceUpdate()}))}componentWillUnmount(){Lt(),this.unsubscribe&&this.unsubscribe()}renderOverlay(){return this.state.showFeedbackEditor&&this.state.leftUser?n.createElement(bt.Z,{target:this.firstCol,show:this.state.showFeedbackEditor,placement:"left"},(e=>{var t,s,i=e,{placement:a,arrowProps:r,show:l,popper:o}=i,c=((e,t)=>{var s={};for(var n in e)Ft.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&Nt)for(var n of Nt(e))t.indexOf(n)<0&&It.call(e,n)&&(s[n]=e[n]);return s})(i,["placement","arrowProps","show","popper"]);return n.createElement("div",(t=Ot({},c),s={style:Ot({backgroundColor:"rgb(232, 232, 232)",padding:"2px 10px",color:"darkslategrey",borderRadius:6,border:"1px solid darkslategrey",width:"32%",marginTop:"80px",boxShadow:"0px 0px 4px darkslategrey",zIndex:1006},c.style)},zt(t,Zt(s))),n.createElement("div",{style:{marginTop:6,marginBottom:6}},this.state.feedbackID,n.createElement(S.Z,{variant:"secondary",size:"sm",onClick:()=>{this.setState({showFeedbackEditor:!1,feedbackID:null,feedbackText:""})},style:{float:"right",marginBottom:4}},n.createElement("i",{className:"fas fa-times"}))),n.createElement("hr",null),this.renderFeedbackMessages(),n.createElement("hr",null),n.createElement(pt.Z,{key:`${this.state.feedbackID}-textarea`,as:"textarea",rows:5,placeholder:this.props.t("enter-feedback",{name:this.state.leftUser.name}),style:{marginBottom:6,resize:"none",height:"20vh"},onChange:e=>{this.setState({feedbackText:e.target.value})}}),n.createElement(S.Z,{variant:"primary",size:"sm",style:{marginBottom:6},onClick:this.handleFeedbackSubmission,disabled:0===this.state.feedbackText.length},this.props.t("submit")))})):null}render(){if(At("Render student responses..."),"student_responses"!==this.props.activeTab)return null;const e=this.props.session,t=e.lessonGradeMessages,s=e.responseVisualizers,i=e.responseVisualizerIds,a=this.assembleUserList(),r=new Array(i.length),{leftUser:l,rightUser:o}=this.state;let h=!1;for(let u=0;u<i.length;u++){const a=s[i[u]],m=a.ref.props.data.question,d=a.ref.state.actions,p=a.ref.props.data.solution;let f,g;f=l?d.filter((e=>e.email===l.email)):[],g=o?d.filter((e=>e.email===o.email)):[];const b=i[u];this.state.grades&&isNaN(this.state.grades[b])&&(h=!0),r[u]=n.createElement(ft.Z,{key:u,className:"student-responses-row"},n.createElement(Ie.Z,{tooltip:m,placement:"left"},n.createElement(gt.Z,{onClick:this.highlightFactory(b),style:{cursor:"pointer",background:this.state.selected===b?"gold":"lightgrey"}},n.createElement("div",{style:{width:"80%"}},b),l?n.createElement("button",{className:"student-responses-note-button",onClick:this.handleFeedbackFactory(b)},n.createElement("i",{className:"student-responses-note-icon far fa-sticky-note"}),n.createElement(c.Z,{className:"student-responses-note-badge",pill:!0,bg:"secondary"},t[l.email]?(t[l.email][b]||[]).length:0)):null)),n.createElement(gt.Z,{className:"student-responses-first-col"},n.createElement(jt.Z,{active:f.length>1,style:{width:"100%",paddingTop:14},tooltip:this.props.t("cycle-through-answers")},f.map(((e,t)=>n.createElement("span",{key:t},n.createElement("span",{className:"student-responses-time"},Ht(e.absoluteTime)),Rt(e.value,a)))))),n.createElement(gt.Z,{style:{background:o?"rgba(173, 216, 230, 0.4)":"#fff2e5"}},o?n.createElement(jt.Z,{active:g.length>1,style:{width:"100%",paddingTop:14},tooltip:this.props.t("cycle-through-answers")},g.map(((e,t)=>n.createElement("span",{key:t},n.createElement("span",{className:"student-responses-time"},Ht(e.absoluteTime)),Rt(e.value,a))))):n.createElement("span",null,Rt(p,a))),n.createElement(gt.Z,{className:"student-responses-first-col"},l&&!o&&a.ref.props.points?n.createElement(n.Fragment,null,n.createElement(pt.Z,{key:`${l.email}-points`,className:"student-responses-points-input",type:"text",defaultValue:this.state.grades[b],onChange:e=>{const t=Ot({},this.state.grades);t[b]=Number(e.target.value),this.setState({grades:t})}}),this.props.t("out-of"),n.createElement(pt.Z,{key:`${l.email}-max-points`,className:"student-responses-points-input",type:"text",disabled:!0,defaultValue:a.ref.props.points})):null,l&&o&&a.ref.props.points?n.createElement(n.Fragment,null,this.props.t("left"),":",n.createElement(pt.Z,{key:`${l.email}-points`,className:"student-responses-points-input",type:"text",defaultValue:this.state.grades[b],onChange:e=>{const t=Ot({},this.state.grades);t[b]=Number(e.target.value),this.setState({grades:t})}}),this.props.t("right"),":",n.createElement(pt.Z,{key:`${o.email}-points`,className:"student-responses-points-input",type:"text",disabled:!0,defaultValue:e.lessonGrades[o.email]?e.lessonGrades[this.state.rightUser.email][b]:""})):null))}const m=t=>{const s=t.data.value;let i,a,r;return this.state.anonymized?(r=e.server+"/thumbnail/anonymous.jpg",i=this.userHash.email[s.email]||s.email,a=this.userHash.name[s.name]||s.name):(r=e.server+"/thumbnail/"+s.picture,i=s.email,a=s.name),n.createElement(ht.c.Option,Ot({},t),n.createElement("img",{alt:this.props.t("profile-pic"),src:r,width:"32px",height:"32px"}),n.createElement(Ie.Z,{tooltip:i,placement:"top"},n.createElement("span",{style:{paddingLeft:6}},a)),e.lessonGrades&&e.lessonGrades[i]?n.createElement(c.Z,{bg:"secondary",style:{float:"right"}},e.lessonGrades[i]._sumPoints," / ",e.metadata.grades.maxPoints):null)},d=t=>{const s=t.data.value;let i,a,r;return this.state.anonymized?(r=e.server+"/thumbnail/anonymous.jpg",i=this.userHash.email[s.email]||s.email,a=this.userHash.name[s.name]||s.name):(r=e.server+"/thumbnail/"+s.picture,i=s.email,a=s.name),n.createElement(ht.c.SingleValue,Ot({},t),n.createElement("img",{alt:this.props.t("profile-pic"),src:r,width:"32px",height:"32px"}),n.createElement(Ie.Z,{tooltip:i,placement:"top"},n.createElement("span",{style:{paddingLeft:6}},a)),e.lessonGrades&&e.lessonGrades[i]?n.createElement(c.Z,{bg:"secondary",style:{marginLeft:6}},e.lessonGrades[i]._sumPoints," / ",e.metadata.grades.maxPoints):null)};return n.createElement("div",{style:{marginLeft:"6px"}},n.createElement(ft.Z,{style:{paddingTop:"3px",paddingBottom:"3px",paddingRight:"16px"}},n.createElement(gt.Z,{ref:e=>{this.firstCol=e}}),n.createElement(gt.Z,null,n.createElement(le.ZP,{components:{Option:m,SingleValue:d},placeholder:this.props.t("select-enrolled-student"),options:a,styles:St.Z,onChange:e=>{this.setState({leftUser:e?e.value:null,grades:e?this.assembleGrades(e):null,feedbackText:"",feedbackID:null,showFeedbackEditor:!1})},isClearable:!0})),n.createElement(gt.Z,null,n.createElement(le.ZP,{components:{Option:m,SingleValue:d},placeholder:this.props.t("solutions-or-student"),options:a,styles:St.Z,onChange:e=>{this.setState({rightUser:e?e.value:null})},isClearable:!0})),n.createElement(gt.Z,null,this.state.leftUser?n.createElement(n.Fragment,null,n.createElement(c.Z,{bg:"secondary",style:{verticalAlign:"sub"}},this.props.t("maximum-points"),": ",e.metadata.grades.maxPoints),n.createElement(S.Z,{variant:"warning",style:{float:"right",fontVariant:"small-caps",margin:3},onClick:()=>{e.adjustGrades(this.state.leftUser.email,this.state.grades)},disabled:h},this.props.t("save-grades"))):null)),n.createElement(ut.Z,{style:{height:"calc(85vh - 175px)",overflowY:"scroll"}},r),n.createElement(z.Z,{name:"options",onChange:this.handleRadioChange,type:"radio",size:"small",value:this.state.anonymized,style:{marginRight:"5px"}},n.createElement(Z.Z,{id:"toggle-responses-original",size:"sm",variant:"light",value:!1,style:{fontSize:"12px",color:this.state.anonymized?"#A9A9A9":"black"}},this.props.t("original")),n.createElement(Z.Z,{id:"toggle-responses-anonymized",size:"sm",variant:"light",value:!0,style:{fontSize:"12px",color:this.state.anonymized?"black":"#A9A9A9"}},this.props.t("anonymized"))),n.createElement(C.Z,{size:"sm"},n.createElement(S.Z,{variant:"primary",onClick:this.saveJSON},this.props.t("save-json")),n.createElement(S.Z,{variant:"primary",onClick:this.saveCSV},this.props.t("save-csv"))),this.renderOverlay())}}Mt.propTypes={session:y().object.isRequired};var Vt=Mt,_t=s(164876),Bt=Object.defineProperty,Gt=(e,t,s)=>(((e,t,s)=>{t in e?Bt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const qt=g.Z?15:0,Wt=a()("isle:statusbar-instructor-view"),Jt={clickOutsideDeactivates:!0};class Kt extends n.Component{constructor(e,t){super(e),Gt(this,"toggleHidden",(()=>{this.setState({hidden:!this.state.hidden})})),Gt(this,"toggleBar",(()=>{this.state.hidden?(this.toggleHidden(),(0,Fe.Z)(this.instructorView,"right",qt,400),this.handler.style.opacity=.7):((0,Fe.Z)(this.instructorView,"right",this.state.rightPos,400,this.toggleHidden),setTimeout(this.toggleHidden,400),this.handler.style.opacity=.7)})),Gt(this,"onMouseOver",(()=>{this.state.hidden&&(this.handler.style.opacity=1)})),Gt(this,"onMouseOut",(()=>{this.state.hidden&&(this.handler.style.opacity=.7)})),Gt(this,"renderTabs",(()=>{const{t:e}=this.props,t=this.context;if(this.state.hidden)return null;const s=!u()(t.responseVisualizers);return n.createElement(l(),{focusTrapOptions:Jt},n.createElement("div",null,n.createElement(h.Z,{activeKey:this.state.activeTab,id:"instructor-view-tabs",onSelect:e=>{this.setState({activeTab:e})}},s?n.createElement(m.Z,{eventKey:"response_visualizers",title:e("activity")},n.createElement(ct,{selectedCohort:t.selectedCohort,session:t,onThumbnailClick:e=>{Wt("Go to actions with id "+e+"..."),this.setState({activeTab:"action_log",selectedID:e})},t:e})):null,s?n.createElement(m.Z,{eventKey:"student_responses",title:e("responses")},n.createElement(Vt,{selectedCohort:t.selectedCohort,session:t,t:e,activeTab:this.state.activeTab})):null,n.createElement(m.Z,{eventKey:"active_users",title:n.createElement("span",null,e("active-users"),n.createElement(c.Z,{bg:"secondary",style:{marginLeft:6}},t.userList.length))},n.createElement(Ke,{session:t,onThumbnailClick:e=>{Wt("Go to actions from user "+e+"..."),this.setState({activeTab:"action_log",selectedEmail:e})},t:e})),n.createElement(m.Z,{eventKey:"action_log",title:e("action-log")},n.createElement(Ce,{selectedEmail:this.state.selectedEmail,selectedID:this.state.selectedID,t:e})),n.createElement(m.Z,{eventKey:"instructor_notes",title:e("instructor-notes")},"instructor_notes"===this.state.activeTab?n.createElement(Ne,null):null)),this.renderHandler()))}));const s=!u()(t.responseVisualizers);this.state={activeTab:s?"response_visualizers":"active_users",hidden:!0,rightPos:-f()(.45*window.innerWidth,400),selectedEmail:null,selectedID:null}}componentDidMount(){const e=this.context;this.unsubscribe=e.subscribe(((e,t)=>{e!==H.lf&&e!==H.At&&e!==H.vu&&e!==H.p0&&e!==H.c_||this.forceUpdate()}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}renderHandler(){const{t:e}=this.props;return n.createElement(Ie.Z,{tooltip:`${this.state.hidden?e("instructor-panel-open"):e("instructor-panel-close")} (I)`,placement:"left"},n.createElement("div",{className:"instructor-view-handler",role:"button",tabIndex:0,"aria-label":this.state.hidden?e("instructor-panel-open"):e("instructor-panel-close"),onClick:this.toggleBar,onKeyPress:this.toggleBar,onMouseOver:this.onMouseOver,onFocus:this.onMouseOver,onMouseOut:this.onMouseOut,onBlur:this.onMouseOut,ref:e=>{this.handler=e},style:{right:qt+12,borderWidth:this.state.hidden?"15px 26px 15px 0":"15px 0 15px 26px",borderColor:this.state.hidden?"transparent #c95d0a transparent transparent":"transparent transparent transparent #c95d0a"}}))}render(){const{t:e}=this.props;return n.createElement(n.Fragment,null,n.createElement("div",{className:"instructor-view unselectable",ref:e=>{this.instructorView=e},style:{right:this.state.rightPos,display:this.state.hidden?"none":"inherit",width:"student_responses"===this.state.activeTab?"65%":"45%"},tabIndex:"-1"},n.createElement("div",{className:"instructor-view-top"},n.createElement("h3",{style:{marginTop:"20px"}},e("instructor-panel")),n.createElement("hr",{style:{background:"#333",backgroundImage:"linear-gradient(to right, #ccc, #333, #ccc)",height:"1px",border:0}})),n.createElement("div",{className:"instructor-view-middle"},this.renderTabs(),n.createElement(_t.Z,{id:"instructor-view-cohort-select",label:e("only-show-users-from"),session:this.context,t:e})),n.createElement("div",{className:"instructor-view-bottom"})),this.state.hidden?this.renderHandler():null,n.createElement(Te.Z,{actions:{i:this.toggleBar}}))}}Kt.contextType=R.Z;var Qt=(0,o.Z)("internal/statusbar")(Kt)},55257:function(e,t){"use strict";const s=/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i;function n(e){setImmediate((function(){throw e}),0)}function i(e){return s.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}const a=function(e){if(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))return;const t=e.document;function s(){return e.URL||e.webkitURL||e}function a(e){setTimeout((function(){"string"==typeof e?s().revokeObjectURL(e):e.remove()}),4e4)}let r,l=!1;t&&t.createElementNS&&(r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),l="download"in r);const o=/constructor/i.test(e.HTMLElement)||e.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent),h=e.setImmediate||e.setTimeout;function m(t,m,d){d||(t=i(t));const u=this,p="application/octet-stream"===t.type;let f;function g(){!function(e,t,s){let i=(t=[].concat(t)).length;for(;i--;){const r=e["on"+t[i]];if("function"==typeof r)try{r.call(e,s||e)}catch(a){n(a)}}}(u,"writestart progress write writeend".split(" "))}if(u.readyState=u.INIT,l)return f=s().createObjectURL(t),void h((function(){r.href=f,r.download=m,function(e){const t=new MouseEvent("click");e.dispatchEvent(t)}(r),g(),a(f),u.readyState=u.DONE}),0);!function(){if((c||p&&o)&&e.FileReader){const s=new FileReader;return s.onloadend=function(){let t=c?s.result:s.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,u.readyState=u.DONE,g()},s.readAsDataURL(t),void(u.readyState=u.INIT)}if(f||(f=s().createObjectURL(t)),p)e.location.href=f;else{e.open(f,"_blank")||(e.location.href=f)}u.readyState=u.DONE,g(),a(f)}()}const d=m.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,s){return t=t||e.name||"download",s||(e=i(e)),navigator.msSaveOrOpenBlob(e,t)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=null,d.onwritestart=null,d.onprogress=null,d.onwrite=null,d.onabort=null,d.onerror=null,d.onwriteend=null,function(e,t,s){return new m(e,t||e.name||"download",s)})}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);t.Z=a},96616:function(e,t,s){var n={"./af":195191,"./af.js":195191,"./ar":854358,"./ar-dz":571727,"./ar-dz.js":571727,"./ar-kw":98279,"./ar-kw.js":98279,"./ar-ly":787895,"./ar-ly.js":787895,"./ar-ma":611987,"./ar-ma.js":611987,"./ar-sa":852796,"./ar-sa.js":852796,"./ar-tn":312386,"./ar-tn.js":312386,"./ar.js":854358,"./az":457452,"./az.js":457452,"./be":579053,"./be.js":579053,"./bg":765428,"./bg.js":765428,"./bm":521569,"./bm.js":521569,"./bn":356212,"./bn-bd":224635,"./bn-bd.js":224635,"./bn.js":356212,"./bo":713667,"./bo.js":713667,"./br":100192,"./br.js":100192,"./bs":51802,"./bs.js":51802,"./ca":219118,"./ca.js":219118,"./cs":739990,"./cs.js":739990,"./cv":130557,"./cv.js":130557,"./cy":404227,"./cy.js":404227,"./da":395406,"./da.js":395406,"./de":887994,"./de-at":444139,"./de-at.js":444139,"./de-ch":786591,"./de-ch.js":786591,"./de.js":887994,"./dv":294649,"./dv.js":294649,"./el":914453,"./el.js":914453,"./en-au":148428,"./en-au.js":148428,"./en-ca":336972,"./en-ca.js":336972,"./en-gb":213224,"./en-gb.js":213224,"./en-ie":418843,"./en-ie.js":418843,"./en-il":632732,"./en-il.js":632732,"./en-in":176579,"./en-in.js":176579,"./en-nz":329851,"./en-nz.js":329851,"./en-sg":870442,"./en-sg.js":870442,"./eo":410654,"./eo.js":410654,"./es":463621,"./es-do":568791,"./es-do.js":568791,"./es-mx":167278,"./es-mx.js":167278,"./es-us":860717,"./es-us.js":860717,"./es.js":463621,"./et":772404,"./et.js":772404,"./eu":962944,"./eu.js":962944,"./fa":730496,"./fa.js":730496,"./fi":498137,"./fi.js":498137,"./fil":132872,"./fil.js":132872,"./fo":806545,"./fo.js":806545,"./fr":949090,"./fr-ca":213049,"./fr-ca.js":213049,"./fr-ch":12338,"./fr-ch.js":12338,"./fr.js":949090,"./fy":295088,"./fy.js":295088,"./ga":77812,"./ga.js":77812,"./gd":608374,"./gd.js":608374,"./gl":63649,"./gl.js":63649,"./gom-deva":452674,"./gom-deva.js":452674,"./gom-latn":844948,"./gom-latn.js":844948,"./gu":24033,"./gu.js":24033,"./he":710175,"./he.js":710175,"./hi":858055,"./hi.js":858055,"./hr":41678,"./hr.js":41678,"./hu":985111,"./hu.js":985111,"./hy-am":926530,"./hy-am.js":926530,"./id":119126,"./id.js":119126,"./is":811696,"./is.js":811696,"./it":198710,"./it-ch":838821,"./it-ch.js":838821,"./it.js":198710,"./ja":993974,"./ja.js":993974,"./jv":770648,"./jv.js":770648,"./ka":454731,"./ka.js":454731,"./kk":943501,"./kk.js":943501,"./km":484398,"./km.js":484398,"./kn":391825,"./kn.js":391825,"./ko":913729,"./ko.js":913729,"./ku":419670,"./ku.js":419670,"./ky":878797,"./ky.js":878797,"./lb":650627,"./lb.js":650627,"./lo":65859,"./lo.js":65859,"./lt":880355,"./lt.js":880355,"./lv":116594,"./lv.js":116594,"./me":245324,"./me.js":245324,"./mi":11689,"./mi.js":11689,"./mk":461308,"./mk.js":461308,"./ml":385241,"./ml.js":385241,"./mn":176320,"./mn.js":176320,"./mr":996771,"./mr.js":996771,"./ms":820503,"./ms-my":477748,"./ms-my.js":477748,"./ms.js":820503,"./mt":155534,"./mt.js":155534,"./my":62727,"./my.js":62727,"./nb":807550,"./nb.js":807550,"./ne":249899,"./ne.js":249899,"./nl":241228,"./nl-be":431225,"./nl-be.js":431225,"./nl.js":241228,"./nn":697130,"./nn.js":697130,"./oc-lnc":293130,"./oc-lnc.js":293130,"./pa-in":591282,"./pa-in.js":591282,"./pl":28190,"./pl.js":28190,"./pt":341549,"./pt-br":178135,"./pt-br.js":178135,"./pt.js":341549,"./ro":900307,"./ro.js":900307,"./ru":989272,"./ru.js":989272,"./sd":179248,"./sd.js":179248,"./se":674969,"./se.js":674969,"./si":365522,"./si.js":365522,"./sk":661581,"./sk.js":661581,"./sl":556428,"./sl.js":556428,"./sq":534611,"./sq.js":534611,"./sr":719821,"./sr-cyrl":262615,"./sr-cyrl.js":262615,"./sr.js":719821,"./ss":435029,"./ss.js":435029,"./sv":980939,"./sv.js":980939,"./sw":373107,"./sw.js":373107,"./ta":272304,"./ta.js":272304,"./te":872550,"./te.js":872550,"./tet":699717,"./tet.js":699717,"./tg":687669,"./tg.js":687669,"./th":594959,"./th.js":594959,"./tk":892661,"./tk.js":892661,"./tl-ph":552234,"./tl-ph.js":552234,"./tlh":394120,"./tlh.js":394120,"./tr":981111,"./tr.js":981111,"./tzl":453080,"./tzl.js":453080,"./tzm":188246,"./tzm-latn":125385,"./tzm-latn.js":125385,"./tzm.js":188246,"./ug-cn":548777,"./ug-cn.js":548777,"./uk":302014,"./uk.js":302014,"./ur":145953,"./ur.js":145953,"./uz":89716,"./uz-latn":487791,"./uz-latn.js":487791,"./uz.js":89716,"./vi":699816,"./vi.js":699816,"./x-pseudo":494450,"./x-pseudo.js":494450,"./yo":522556,"./yo.js":522556,"./zh-cn":407414,"./zh-cn.js":407414,"./zh-hk":750824,"./zh-hk.js":750824,"./zh-mo":688589,"./zh-mo.js":688589,"./zh-tw":163285,"./zh-tw.js":163285};function i(e){var t=a(e);return s(t)}function a(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=96616},753260:function(){},357267:function(){},759255:function(){}}]);