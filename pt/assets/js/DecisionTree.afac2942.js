"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[60061],{303428:function(e,t,n){n.d(t,{$F:function(){return i},PB:function(){return r}});function r(e){return`data-rr-ui-${e}`}function i(e){return`rrUi${e}`}},658092:function(e,t,n){n.d(t,{Z:function(){return i}});var r=Function.prototype.bind.call(Function.prototype.call,[].slice);function i(e,t){return r(e.querySelectorAll(t))}},18559:function(e,t,n){n.r(t);var r=n(202784),i=n(213980),o=n.n(i),s=n(198),a=n(822736),c=n(770561),l=n(588703),u=n.n(l),h=n(112114),p=n(609207),m=n(741082),d=n(848285),f=Object.defineProperty,g=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,T=(e,t,n)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t)=>{for(var n in t||(t={}))y.call(t,n)&&T(e,n,t[n]);if(g)for(var n of g(t))v.call(t,n)&&T(e,n,t[n]);return e};let C=0;const x=({x:e,y:t,data:n,type:r,quantitative:i,impurityMeasure:o,scoreThreshold:s,maxTreeDepth:a,minItemsCount:c})=>{let l;l=u()(e)?e:[e];try{let e;return e="Classification"===r?new p.DV({response:t,predictors:l,data:n,quantitative:i,criterion:o,scoreThreshold:s,maxTreeDepth:a,minItemsCount:c}):new p.tC({response:t,predictors:l,data:n,quantitative:i,scoreThreshold:s,maxTreeDepth:a,minItemsCount:c}),e}catch(h){return null}};class E extends r.Component{constructor(e){var t;super(e),T(this,"symbol"!=typeof(t="handlePredict")?t+"":t,(()=>{this.props.onPredict(this.state.tree,C)})),C+=1;const{x:n,y:r,data:i,type:o,quantitative:s,impurityMeasure:a,scoreThreshold:c,maxTreeDepth:l,minItemsCount:u}=this.props;this.state=b({tree:x({x:n,y:r,data:i,type:o,quantitative:s,impurityMeasure:a,scoreThreshold:c,maxTreeDepth:l,minItemsCount:u})},e)}static getDerivedStateFromProps(e,t){if(e.y!==t.y||e.x!==t.x||e.type!==t.type||e.impurityMeasure!==t.impurityMeasure||e.data!==t.data||e.quantitative!==t.quantitative||e.scoreThreshold!==t.scoreThreshold||e.maxTreeDepth!==t.maxTreeDepth||e.minItemsCount!==t.minItemsCount){const{x:t,y:n,data:r,type:i,quantitative:o,impurityMeasure:s,scoreThreshold:a,maxTreeDepth:c,minItemsCount:l}=e;return b({tree:x({x:t,y:n,data:r,type:i,quantitative:o,impurityMeasure:s,scoreThreshold:a,maxTreeDepth:c,minItemsCount:l})},e)}return null}render(){const{tree:e}=this.state,{t:t}=this.props;return e?r.createElement("div",{style:{overflowX:"auto",width:"100%"}},r.createElement("span",{className:"title"},t("decision-tree-for",{y:this.props.y,counter:C})),r.createElement(p.fA,{tree:e.root}),this.props.onPredict?r.createElement(h.Z,{tooltip:t("predictions-attached")},r.createElement(c.Z,{variant:"secondary",size:"sm",style:{marginTop:10},onClick:this.handlePredict},this.props.t("use-model-to-predict"))):null):r.createElement(a.Z,{variant:"danger"},t("missing-attributes"))}}E.defaultProps={impurityMeasure:"gini",scoreThreshold:.0075,maxTreeDepth:5,minItemsCount:50,onPredict:null},E.propTypes={data:o().object.isRequired,y:o().oneOfType([o().string,o().instanceOf(d.E)]).isRequired,x:o().oneOfType([o().arrayOf(o().oneOfType([o().string,o().instanceOf(d.E)])),o().string,o().instanceOf(d.E)]).isRequired,type:o().oneOf(["Classification","Regression"]).isRequired,quantitative:o().arrayOf(o().string).isRequired,impurityMeasure:o().oneOf(["gini","entropy"]),scoreThreshold:o().number,maxTreeDepth:o().number,minItemsCount:o().number,onPredict:o().func},t.default=(0,s.Z)("models")((0,m.W)(E))},609207:function(e,t,n){n.d(t,{DV:function(){return U},OI:function(){return J},tC:function(){return X},fA:function(){return Q}});var r=n(240054),i=n.n(r),o=n(287013),s=n.n(o),a=n(700601),c=n.n(a),l=n(798030),u=n.n(l),h=n(686605),p=n.n(h),m=n(605977),d=n.n(m),f=n(202784),g=n(198),y=n(457447),v=n(309765),T=n(844096),b=n.n(T),C=n(711768),x=n(394362),E=n(213980),M=n.n(E),w=n(770561),D=n(715318),q=n(112114),I=Object.defineProperty,N=(e,t,n)=>(((e,t,n)=>{t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class O extends f.Component{constructor(){super(),N(this,"toggleFullscreen",(()=>{this.setState({fullscreen:!this.state.fullscreen})})),this.state={fullscreen:!1}}render(){const{t:e}=this.props;return f.createElement(f.Fragment,null,f.createElement(q.Z,{id:"fullscreen_tooltip",placement:"bottom",tooltip:e("toggle-fullscreen")},f.createElement(w.Z,{variant:"outline-danger",size:"sm",onClick:this.toggleFullscreen,style:{position:"absolute",top:"10px",right:"32px"}},f.createElement("div",{className:"fa fa-window-maximize"}))),f.createElement(D.Z,{show:this.state.fullscreen,onHide:this.toggleFullscreen,dialogClassName:"modal-100w"},f.createElement(D.Z.Header,{closeButton:!0},f.createElement(D.Z.Title,{as:"h1"},e("decision-tree"))),f.createElement(D.Z.Body,{style:{height:.75*window.innerHeight,width:"100%",fontSize:32,overflow:"scroll"}},f.createElement("div",{className:"decision-tree decision-tree-fullscreen"},this.props.tree)),f.createElement(D.Z.Footer,null,f.createElement(w.Z,{onClick:this.toggleFullscreen},e("close")))))}}O.propTypes={tree:M().node.isRequired};var Z=(0,g.Z)("models")(O);const k=/^[+-]?[\d.]+e?[+-]?\d*$/;function P(e,t){if(!e)return null;if(e.category){let n=e.category;return((0,v.isPrimitive)(n)||k.test(n))&&(n=Number(n),b()(n)||(n=n.toFixed(6))),f.createElement("ul",null,f.createElement("li",null,f.createElement("span",{className:"decision-tree-leaf"},t("predict"),": ",n," ")))}return f.createElement("ul",null,f.createElement("li",null,f.createElement("span",null,f.createElement("b",null," ",e.attribute," ",e.predicateName," ",e.pivot," ?")),f.createElement("ul",null,f.createElement("li",null,f.createElement("span",null,t("no")," ( ",e.notMatchedCount," ",t("obs"),") "),P(e.notMatch,t)),f.createElement("li",null,f.createElement("span",null,t("yes")," ( ",e.matchedCount," ",t("obs"),") "),P(e.match,t)))))}class F extends f.Component{constructor(e){super(e),this.state={plotValue:null,plotKey:null,fullscreen:!1}}componentDidMount(){this.tree&&(this.treeWrapper.scrollLeft=.4*this.tree.clientWidth,(0,y.hi)(this.tree,{backgroundColor:"white",style:{fontSize:22}}).then((e=>{const t=`<img src="${e}" style="display: block; margin: 0 auto; max-width: 100%; max-height: 100%" />`;this.setState({plotKey:`\x3c!--IMAGE_LOG:${(0,C.Z)(6)}_${(0,C.Z)(6)}--\x3e`,plotValue:t})})))}render(){const{t:e}=this.props,t=P(this.props.tree,e);return f.createElement("div",{className:"decision-tree-wrapper",ref:e=>{this.treeWrapper=e}},f.createElement("button",{className:"decision-tree-draggable-bar",draggable:"true",onDragStart:e=>{e.dataTransfer.setData("text/html",this.state.plotValue),e.dataTransfer.setData("text/plain",this.state.plotKey)},onClick:()=>{(0,x.Z)(this.state.plotValue)},style:{float:"left"}},e("drag-plot")),f.createElement(Z,{variant:"outline-danger",size:"sm",onClick:()=>{this.setState({fullscreen:!this.state.fullscreen})},tree:t},f.createElement("div",{className:"fa fa-times"})),f.createElement("div",{className:"decision-tree",ref:e=>{this.tree=e}},t))}}var S=(0,g.Z)("models")(F);var R=function(e,t,n,r,i){const o=[],s=[],a=e[n];for(let c=t.length-1;c>=0;c--){const e=t[c];r(a[e],i)?o.push(e):s.push(e)}return{match:o,notMatch:s}};function B(e,t){const n={};for(let r=t.length-1;r>=0;r--){n[e[t[r]]]=0}for(let r=t.length-1;r>=0;r--){n[e[t[r]]]+=1}return n}function z(e,t){const n=B(e,t);let r,i=0;for(let o in n)n[o]>i&&(i=n[o],r=o);return r}function A(e,t){const n=B(e,t);let r=0;for(let i in n)if(c()(n,i)){const e=n[i]/t.length;r+=e*(1-e)}return r}function $(e,t){const n=B(e,t);let r=0;for(let i in n)if(c()(n,i)){const e=n[i]/t.length;r+=-e*u()(e)}return r}function j(e,t){const n=t.length;let r=0,i=0,o=0,s=0;if(!n)return null;if(n<2)return 0;for(let a=0;a<n;a++){const n=e[t[a]];s+=1,r=n-i,i+=r/s,o+=r*(n-i)}return o/(s-1)}function V(e,t){const n=t.length;if(!n)return null;let r=0;for(let i=0;i<n;i++){r+=(e[t[i]]-r)/(i+1)}return r}const H={"==":(e,t)=>e==t,">=":(e,t)=>e>=t};function W(e){const t=e.data[e.response].length;this.importances={};for(let n=0;n<e.predictors.length;n++)this.importances[e.predictors[n]]=0;this.root=K({data:e.data,response:e.response,predictors:e.predictors,indices:e.indices?e.indices:d()(0,t,1),minItemsCount:e.minItemsCount||50,minBucket:e.minBucket||p()((e.minItemsCount||50)/3),scoreThreshold:e.scoreThreshold||.01,maxTreeDepth:e.maxTreeDepth||20,quantitative:e.quantitative,criterion:"gini"===e.criterion?A:$},this.importances),this.predict=(t,n)=>{if(void 0===n){const n=t[e.predictors[0]].length,r=new Array(n);for(let e=0;e<n;e++)r[e]=_(this.root,t,e);return r}return _(this.root,t,n)},this.type="classification",this.response=e.response}function K(e,t){const{data:n,predictors:r,indices:o,response:a,minItemsCount:c,scoreThreshold:l,maxTreeDepth:u,quantitative:h,criterion:p,minBucket:m,nTry:d}=e,f=o.length;if(0===u||f<=c)return{category:z(n[a],o)};const g=p(n[a],o),y={};let v={gain:0};d&&(r=i()(r,{size:d}));for(let i=f-1;i>=0;i--){const e=o[i];for(let t=0;t<r.length;t++){const i=r[t],c=n[i][e];let l;l=s()(h,i)?">=":"==";const u=i+l+c;if(y[u])continue;y[u]=!0;const d=H[l],T=R(n,o,i,d,c),b=p(n[a],T.match),C=p(n[a],T.notMatch);let x=0;x+=b*T.match.length,x+=C*T.notMatch.length,x/=f;const E=g-x;E>v.gain&&T.match.length>m&&T.notMatch.length>m&&(v=T,v.predicateName=l,v.predicate=d,v.attribute=i,v.pivot=c,v.gain=E)}}if(!v.gain||v.gain/g<l)return{category:z(n[a],o)};e.maxTreeDepth=u-1,t[v.attribute]+=v.gain,e.indices=v.match;const T=K(e,t);e.indices=v.notMatch;const b=K(e,t);return{attribute:v.attribute,predicate:v.predicate,predicateName:v.predicateName,pivot:v.pivot,match:T,notMatch:b,matchedCount:v.match.length,notMatchedCount:v.notMatch.length}}function L(e){const{data:t,predictors:n,indices:r,response:o,minItemsCount:a,scoreThreshold:c,maxTreeDepth:l,quantitative:u,minBucket:h,nTry:p}=e,m=r.length;if(0===l||m<=a)return{category:V(t[o],r)};const d=j(t[o],r),f={};let g={gain:0};p&&(n=i()(n,{size:p}));for(let i=m-1;i>=0;i--){const e=r[i];for(let i=0;i<n.length;i++){const a=n[i],c=t[a][e];let l;l=s()(u,a)?">=":"==";const p=a+l+c;if(f[p])continue;f[p]=!0;const y=H[l],v=R(t,r,a,y,c),T=j(t[o],v.match),b=j(t[o],v.notMatch);let C=0;C+=T*v.match.length,C+=b*v.notMatch.length,C/=m;const x=d-C;x>g.gain&&v.match.length>h&&v.notMatch.length>h&&(g=v,g.predicateName=l,g.predicate=y,g.attribute=a,g.pivot=c,g.gain=x)}}if(!g.gain||g.gain/d<c)return{category:V(t[o],r)};e.maxTreeDepth=l-1,e.indices=g.match;const y=L(e);e.indices=g.notMatch;const v=L(e);return{attribute:g.attribute,predicate:g.predicate,predicateName:g.predicateName,pivot:g.pivot,match:y,notMatch:v,matchedCount:g.match.length,notMatchedCount:g.notMatch.length}}function _(e,t,n){for(;;){if(e.category)return e.category;const r=t[e.attribute][n];e=(0,e.predicate)(r,e.pivot)?e.match:e.notMatch}}function G(e,t,n){const r={};for(let s=0;s<e.length;s++){const i=e[s].predict(t,n);r[i]=r[i]?r[i]+1:1}let i,o=-1;for(let s in r)c()(r,s)&&r[s]>o&&(o=r[s],i=s);return i}const U=W,X=function(e){const t=e.data[e.response].length;this.root=L({data:e.data,response:e.response,predictors:e.predictors,indices:e.indices?e.indices:d()(0,t,1),minItemsCount:e.minItemsCount||50,minBucket:e.minBucket||p()((e.minItemsCount||50)/3),scoreThreshold:e.scoreThreshold||.01,maxTreeDepth:e.maxTreeDepth||20,quantitative:e.quantitative}),this.predict=(t,n)=>{if(void 0===n){const n=t[e.predictors[0]].length,r=new Array(n);for(let e=0;e<n;e++)r[e]=Number(_(this.root,t,e));return r}return Number(_(this.root,t,n))},this.type="regression",this.response=e.response},J=function(e){this.trees=function(e){const t=[],n=e.data[e.response].length,r=d()(0,n,1);for(let s=0;s<e.nTrees;s++)t[s]=i()(r);const o=[];for(let i=0;i<e.nTrees;i++){e.indices=t[i];const n=new W(e);o.push(n)}return o}(e),this.importances={};for(let t=0;t<e.predictors.length;t++){const n=e.predictors[t];this.importances[n]=0;for(let e=0;e<this.trees.length;e++)this.importances[n]+=this.trees[e].importances[n];this.importances[n]/=this.trees.length}this.predict=(t,n)=>{if(void 0===n){const n=t[e.predictors[0]].length,r=new Array(n);for(let e=0;e<n;e++)r[e]=G(this.trees,t,e);return r}return G(this.trees,t,n)},this.type="classification",this.response=e.response},Q=S},394362:function(e,t){t.Z=function(e){const t=document.createElement("div");t.innerHTML=e,t.style.position="fixed",t.style.opacity=0,t.style.pointerEvents="none",document.body.appendChild(t),window.getSelection().removeAllRanges();const n=document.createRange();n.selectNode(t),window.getSelection().addRange(n),document.execCommand("copy"),document.body.removeChild(t)}}}]);