"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4438],{282199:function(e,t,n){n.r(t);var s=n(497326),a=n(894578),o=n(202784),r=n(928316),l=n(789644),i=n.n(l),p=n(213980),h=n.n(p),u=n(690299),c=n.n(u),m=n(198),d=n(770561),w=n(26266),f=n(10863),g=n(830650),y=n(23836),v=n(875084),Z=n(431882),S=n(435376),E=n(992500),I=n(862816),C=n(267682),P=Object.defineProperty,b=function(e,t,n){return function(e,t,n){t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},k=c()("isle:login"),T=function(e){function t(t){var n;return n=e.call(this,t)||this,b((0,s.Z)(n),"handleInputChange",(function(e){var t;e.stopPropagation();var s=e.target,a=s.value,o=s.name;n.setState(((t={})[o]=a,t))})),b((0,s.Z)(n),"handleForgotPassword",(function(e){(e.preventDefault(),""===n.state.email)?n.setState({showInputOverlay:!0,overlayTarget:r.findDOMNode(n.emailInput),invalidInputMessage:n.props.t("enter-email-before-password-reset")}):n.context.forgotPassword(n.state.email)})),b((0,s.Z)(n),"hideAfterDelay",(function(){setTimeout((function(){n.setState({showInputOverlay:!1})}),2e3)})),b((0,s.Z)(n),"handleKeyPress",(function(e){e.stopPropagation(),13===e.charCode&&n.handleSubmit(e)})),b((0,s.Z)(n),"handleSubmit",(function(e){e.preventDefault();var t={password:n.state.password,email:n.state.email};if(n.state.showTFA)return t.token=n.state.token,n.context.login(t,(function(e,t,s){e||"ok"!==s.message||n.props.onClose()}));if(""===t.email)k("Email input field is empty, show message..."),n.setState({showInputOverlay:!0,overlayTarget:r.findDOMNode(n.emailInput),invalidInputMessage:n.props.t("enter-email")},n.hideAfterDelay);else if(""===t.password)k("Password input field is empty, show message..."),n.setState({showInputOverlay:!0,overlayTarget:r.findDOMNode(n.passwordInput),invalidInputMessage:n.props.t("enter-password")},n.hideAfterDelay);else{n.context.login(t,(function(e,t,s){if(!e){var a=s.message,o=s.type;"ok"===a?n.props.onClose():"finish-login-via-tfa"===a?n.setState({showTFA:!0}):n.setState({showInputOverlay:!0,overlayTarget:"no_user"===o?n.emailInput:n.passwordInput,invalidInputMessage:a},n.hideAfterDelay)}}))}})),n.state={email:"",password:"",show:t.show,showTFA:!1,token:"",hasSSO:!1},n}(0,a.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return e.show!==t.show?{email:"",password:"",show:e.show,showTFA:!1}:null};var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.context;i().get(t.server+"/saml-xmw/login-type").then((function(n){"SSO"===n.data?window.location.assign(t.server+"/saml-xmw/login-choice?url=/"+t.namespaceName+"/"+t.lessonName):"Both"===n.data&&e.setState({hasSSO:!0})})).catch((function(e){k(e)}))},n.render=function(){var e=this,t=this.context;return o.createElement(Z.Z,{show:this.props.show,className:"login-modal",onHide:this.props.onClose},o.createElement(Z.Z.Header,{closeButton:!0},o.createElement(Z.Z.Title,{as:"h3"},this.props.t("login"))),o.createElement(Z.Z.Body,null,o.createElement(y.Z,{horizontal:!0,className:"d-grid gap-3"},o.createElement(f.Z,{controlId:"form-email"},o.createElement(g.Z,null,this.props.t("email")),o.createElement(w.Z,{name:"email",type:"email",placeholder:"Email",autoComplete:"username",onChange:this.handleInputChange,onKeyPress:this.handleKeyPress,ref:function(t){e.emailInput=t},disabled:this.state.showTFA})),o.createElement(f.Z,{controlId:"form-password"},o.createElement(g.Z,null,this.props.t("password")),o.createElement(w.Z,{name:"password",type:"password",placeholder:"Password",autoComplete:"current-password",onChange:this.handleInputChange,onKeyPress:this.handleKeyPress,ref:function(t){e.passwordInput=t},disabled:this.state.showTFA})),this.state.showTFA?o.createElement(f.Z,{controlId:"form-tfa"},o.createElement(g.Z,null,this.props.t("enter-tfa-token")),o.createElement(w.Z,{name:"token",type:"text",placeholder:this.props.t("enter-token"),onChange:this.handleInputChange,onKeyPress:this.handleKeyPress,autoFocus:!0})):null,o.createElement(d.Z,{variant:"primary",type:"submit",onClick:this.handleSubmit},this.props.t("signin")))),o.createElement(Z.Z.Footer,null,o.createElement("button",{className:"forgot-password-button",onClick:this.handleForgotPassword},this.props.t("forgot-password")),this.state.hasSSO?o.createElement("a",{className:"sso-link",href:t.server+"/saml-xmw/login-choice?url=/"+t.namespaceName+"/"+t.lessonName},this.props.t("login-with-sso")):null,!1!==t.settings.allowUserRegistrations?o.createElement(d.Z,{onClick:this.props.onShowSignup,variant:"secondary"},this.props.t("create-account")):null),o.createElement(v.Z,{show:this.state.showInputOverlay,target:this.state.overlayTarget,placement:"right",containerPadding:20},o.createElement(S.Z,{id:"popover-contained"},o.createElement(E.Z,null,this.props.t("invalid")),o.createElement(I.Z,null,this.state.invalidInputMessage))))},t}(o.Component);T.defaultProps={onClose:function(){},onShowSignup:function(){},show:!1},T.propTypes={onClose:h().func,onShowSignup:h().func,show:h().bool},T.contextType=C.Z,t.default=(0,m.Z)("internal/login")(T)}}]);