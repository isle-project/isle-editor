"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[22414],{667045:function(e,t,n){const a=(0,n(217431).Z)((()=>n.e(10112).then(n.bind(n,497925))));t.Z=a},956260:function(e,t,n){var a=n(202784),i=n(213980),l=n.n(i),s=Object.defineProperty,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const d=e=>{const t=e,{children:n}=t,i=((e,t)=>{var n={};for(var a in e)r.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&o)for(var a of o(e))t.indexOf(a)<0&&c.call(e,a)&&(n[a]=e[a]);return n})(t,["children"]);return a.createElement("div",((e,t)=>{for(var n in t||(t={}))r.call(t,n)&&u(e,n,t[n]);if(o)for(var n of o(t))c.call(t,n)&&u(e,n,t[n]);return e})({},i),n)};d.defaultProps={className:"",style:{}},d.propTypes={className:l().string,style:l().object},t.Z=d},370420:function(e,t,n){const a=(0,n(217431).Z)((()=>n.e(96131).then(n.bind(n,66720))));t.Z=a},800712:function(e,t,n){const a=(0,n(217431).Z)((()=>Promise.all([n.e(40532),n.e(34507)]).then(n.bind(n,307125))));t.Z=a},162653:function(e,t,n){n.r(t);var a=n(202784),i=n(213980),l=n.n(i),s=n(690299),o=n.n(s),r=n(498614),c=n(34002),u=n(790817),d=n(770561),m=n(287013),p=n.n(m),b=n(321182),f=n(810370),h=n(956260),g=n(380827),y=n(514921),E=n(667045),v=n(370420),k=n(539478),Z=n(172888),w=n(800712),N=n(123103),S=n(627939),O=n(477195),C=n(487890),P=n(691334),q=n(302108),j=n(741082),L=Object.defineProperty,T=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,D=(e,t,n)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const F=o()("isle:image-question"),x=/src="([^"]*)"/,B=e=>{const{id:t,retrieveLastAction:n,logAction:i}=(0,C.G)("IMAGE_QUESTION",e),l=(0,a.useContext)(N.Z),{t:s}=(0,r.$G)("questions/image"),o=(0,a.useRef)(null),[m,j]=(0,a.useState)(!1),L=n(P.gY),[B,R]=(0,a.useState)(L),[M,U]=(0,a.useState)(0===e.hints.length),[z,G]=(0,a.useState)(!1),[H,Y]=(0,a.useState)(!1),$=(0,a.useCallback)((()=>{F(`Set submission to last action for question ${t} if available...`);const e=n(P.gY);e&&e!==B&&(R(e),j(!0))}),[n,B,t]);(0,a.useEffect)((()=>{const e=l.subscribe((e=>{e===q.u&&$()}));return()=>{e()}}),[l,$]);const _=(0,a.useCallback)((e=>{F("File read..."),Y(!1),R(e.target.result)}),[]),W=(0,a.useCallback)((()=>{G(!z)}),[z]),{hints:Q}=e,J=Q.length,K=a.createElement(g.Z,{disabled:!m||!M,onClick:W,hasHints:Q.length>0}),V=(0,a.useCallback)((e=>{F("Logging hint..."),i(P.$M,e)}),[i]),X=(0,a.useCallback)((()=>{l.addNotification({title:s("submitted"),message:s("answer-submitted"),level:"info"})}),[l,s]),ee=(0,a.useCallback)((()=>{R(null)}),[]),te=(0,a.useCallback)((()=>{U(!0)}),[]),ne=()=>{const e=new FileReader,t=o.current.files[0];e.addEventListener("load",_,!1),e.readAsDataURL(t)},ae=()=>{if(e.disableSubmitNotification||X(),e.onSubmit(),j(!0),B)i(P.gY,B);else{document.getElementById(t+"-canvas").toBlob((e=>{(0,S.Z)(e).then((e=>{i(P.gY,e),R(e)}))}))}},ie=e=>{e.stopPropagation(),e.preventDefault(),Y(!0);const t=e.dataTransfer,n=new FileReader;let a=null;if(t.files&&t.files.length>0)F("File(s) dropped, processing the first one..."),a=t.files[0];else if(t.items&&t.items.length>0){F("Item(s) dropped, using  the first one...");const e=t.items[0];"file"===e.kind?a=e.getAsFile():"string"===e.kind&&e.getAsString((e=>{if(p()(e,"<img")){const t=e.match(x);t&&(R(t[1]),Y(!1))}else if(p()(e,"<thead")){const t=document.createElement("table");t.innerHTML=e,document.body.appendChild(t),(0,c.hi)(t,{backgroundColor:"white",style:{fontSize:12},width:600}).then((e=>{R(e),Y(!1),t.remove()}))}else{const t=document.createElement("pre");t.innerHTML=e,document.body.appendChild(t),(0,c.hi)(t,{backgroundColor:"white",style:{fontSize:14}}).then((e=>{R(e),Y(!1),t.remove()}))}}))}a&&(n.addEventListener("load",_,!1),n.readAsDataURL(a))};let le;return H||(le=B?a.createElement("div",{className:"center",style:{maxWidth:600}},z?a.createElement(b.Z,{alt:s("model-solution"),src:e.solution,width:"50%",height:"auto",style:{border:"solid 1px gold"}}):a.createElement(b.Z,{alt:s("upload"),src:B,width:"50%",height:"auto"})):a.createElement(a.Fragment,null,a.createElement("div",{className:"image-question-dropzone",onDrop:ie,onDragOver:O.Z,onDragEnd:O.Z},a.createElement("span",null,s("drop-image"))),a.createElement("p",{className:"center"},s("or")),a.createElement("input",{id:t+"-upload",className:"image-question-upload center",type:"file",accept:"image/*",onChange:ne,ref:o}),e.sketchpad?a.createElement(a.Fragment,null,a.createElement("p",{className:"center"},s("or")),a.createElement(k.Z,((e,t)=>{for(var n in t||(t={}))A.call(t,n)&&D(e,n,t[n]);if(T)for(var n of T(t))I.call(t,n)&&D(e,n,t[n]);return e})({id:t,hideNavigationButtons:!0,hideSaveButtons:!0,hideTransmitButtons:!0,canvasWidth:900,canvasHeight:600},e.sketchpad))):null)),a.createElement(u.Z,{id:t,className:`image-question ${e.className}`,style:e.style},a.createElement(u.Z.Body,{className:"d-grid gap-2",style:{width:e.feedback?"calc(100%-60px)":"100%",display:"inline-block"}},a.createElement("label",null,e.question),a.createElement(f.Z,{running:H,width:256,height:128}),le,e.feedback?a.createElement(Z.Z,{vertical:!0,id:t+"_feedback",style:{position:"absolute",right:"4px",top:"4px"}}):null,a.createElement(h.Z,{buttonLabel:"Answers",id:t,info:"IMAGE_QUESTION_SUBMISSION",data:{question:e.question,type:"image"},points:e.points}),a.createElement("div",{className:"image-question-toolbar"},J>0?a.createElement(E.Z,{onClick:V,hints:e.hints,placement:e.hintPlacement,onFinished:te}):null,B?a.createElement(d.Z,{size:"sm",variant:"warning",onClick:ee},s("reset")):null,e.until&&l.startTime>e.until?a.createElement("span",{className:"title",style:{marginLeft:4}},s("question-closed")):a.createElement(y.Z,{className:"submit-button",variant:"primary",size:"sm",onClick:ae,disabled:!B||H},s(m?"resubmit":"submit")),e.solution?K:null,e.chat?a.createElement(v.Z,{for:t}):null),a.createElement(w.Z,{for:t,points:e.points})))};B.defaultProps={question:"",hints:[],hintPlacement:"bottom",feedback:!0,chat:!1,disableSubmitNotification:!1,className:"",sketchpad:null,solution:null,until:null,points:10,style:{},onSubmit(){}},B.propTypes={question:l().oneOfType([l().string,l().node]),hintPlacement:l().string,hints:l().arrayOf(l().oneOfType([l().string,l().node])),feedback:l().bool,chat:l().bool,disableSubmitNotification:l().bool,className:l().string,sketchpad:l().object,solution:l().string,until:l().instanceOf(Date),points:l().number,style:l().object,onSubmit:l().func},t.default=(0,j.W)(B)},380827:function(e,t,n){const a=(0,n(217431).Z)((()=>n.e(78905).then(n.bind(n,960226))));t.Z=a},627939:function(e,t){t.Z=e=>{const{FileReader:t}=window,n=new t;return n.readAsDataURL(e),new Promise((e=>{n.onloadend=()=>{e(n.result)}}))}},477195:function(e,t){t.Z=function(e){e.stopPropagation(),e.preventDefault()}}}]);