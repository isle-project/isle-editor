(self.webpackChunk=self.webpackChunk||[]).push([[66634],{747126:function(t,e,r){"use strict";r.d(e,{DV:function(){return it},OI:function(){return at},tC:function(){return ot},fA:function(){return st}});var n,i=r(797479),o=(r(111246),r(21466),r(959588)),a=r.n(o),s=r(636150),c=r.n(s),u=r(636734),l=r.n(u),d=r(180909),h=r.n(d),p=r(857906),f=r.n(p),v=r(685267),m=r.n(v),y=r(264659),g=r(904730),Z=r(175663),T=r(750591),b=r(575630),x=r(858255),C=(r(382139),r(202784)),M=r(198),w=r(45562),D=r(817729),k=r(613323),O=r.n(k),I=r(790599),N=r(806258),P=r(673989),R=r(151119),S=(r(213980),r(770561)),q=r(81982),B=r(150275);function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,b.Z)(t);if(e){var i=(0,b.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,T.Z)(this,r)}}var E,F=function(t){(0,Z.Z)(r,t);var e=j(r);function r(){var t;return(0,y.Z)(this,r),t=e.call(this),(0,R.Z)((0,P.Z)(t),"toggleFullscreen",(function(){t.setState({fullscreen:!t.state.fullscreen})})),t.state={fullscreen:!1},t}return(0,g.Z)(r,[{key:"render",value:function(){var t=this.props.t;return(0,x.Z)(C.Fragment,{},void 0,(0,x.Z)(B.Z,{id:"fullscreen_tooltip",placement:"bottom",tooltip:t("toggle-fullscreen")},void 0,(0,x.Z)(S.Z,{variant:"outline-danger",size:"sm",onClick:this.toggleFullscreen,style:{position:"absolute",top:"10px",right:"32px"}},void 0,n||(n=(0,x.Z)("div",{className:"fa fa-window-maximize"})))),(0,x.Z)(q.Z,{show:this.state.fullscreen,onHide:this.toggleFullscreen,dialogClassName:"modal-100w"},void 0,(0,x.Z)(q.Z.Header,{closeButton:!0},void 0,(0,x.Z)(q.Z.Title,{as:"h1"},void 0,t("decision-tree"))),(0,x.Z)(q.Z.Body,{style:{height:.75*window.innerHeight,width:"100%",fontSize:32,overflow:"scroll"}},void 0,(0,x.Z)("div",{className:"decision-tree decision-tree-fullscreen"},void 0,this.props.tree)),(0,x.Z)(q.Z.Footer,{},void 0,(0,x.Z)(S.Z,{onClick:this.toggleFullscreen},void 0,t("close")))))}}]),r}(C.Component),z=(0,M.Z)("StatisticalModels")(F);function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,b.Z)(t);if(e){var i=(0,b.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,T.Z)(this,r)}}var V=/^[+-]?[\d.]+e?[+-]?\d*$/;function H(t,e){if(!t)return null;if(t.category){var r=t.category;return((0,D.isPrimitive)(r)||V.test(r))&&(r=Number(r),O()(r)||(r=r.toFixed(6))),(0,x.Z)("ul",{},void 0,(0,x.Z)("li",{},void 0,(0,x.Z)("span",{className:"decision-tree-leaf"},void 0,e("predict"),": ",r," ")))}return(0,x.Z)("ul",{},void 0,(0,x.Z)("li",{},void 0,(0,x.Z)("span",{},void 0,(0,x.Z)("b",{},void 0," ",t.attribute," ",t.predicateName," ",t.pivot," ?")),(0,x.Z)("ul",{},void 0,(0,x.Z)("li",{},void 0,(0,x.Z)("span",{},void 0,e("no")," ( ",t.notMatchedCount," ",e("obs"),") "),H(t.notMatch,e)),(0,x.Z)("li",{},void 0,(0,x.Z)("span",{},void 0,e("yes")," ( ",t.matchedCount," ",e("obs"),") "),H(t.match,e)))))}var W=function(t){(0,Z.Z)(r,t);var e=A(r);function r(t){var n;return(0,y.Z)(this,r),(n=e.call(this,t)).state={plotValue:null,plotKey:null,fullscreen:!1},n}return(0,g.Z)(r,[{key:"componentDidMount",value:function(){var t=this;this.tree&&(this.treeWrapper.scrollLeft=.4*this.tree.clientWidth,(0,w.hi)(this.tree,{backgroundColor:"white",style:{fontSize:22}}).then((function(e){var r='<img src="'.concat(e,'" style="display: block; margin: 0 auto; max-width: 100%; max-height: 100%" />');t.setState({plotKey:"\x3c!--IMAGE_LOG:".concat((0,I.Z)(6),"_").concat((0,I.Z)(6),"--\x3e"),plotValue:r})})))}},{key:"render",value:function(){var t=this,e=this.props.t,r=H(this.props.tree,e);return C.createElement("div",{className:"decision-tree-wrapper",ref:function(e){t.treeWrapper=e}},(0,x.Z)("button",{className:"decision-tree-draggable-bar",draggable:"true",onDragStart:function(e){e.dataTransfer.setData("text/html",t.state.plotValue),e.dataTransfer.setData("text/plain",t.state.plotKey)},onClick:function(){(0,N.Z)(t.state.plotValue)},style:{float:"left"}},void 0,e("drag-plot")),(0,x.Z)(z,{variant:"outline-danger",size:"sm",onClick:function(){t.setState({fullscreen:!t.state.fullscreen})},tree:r},void 0,E||(E=(0,x.Z)("div",{className:"fa fa-times"}))),C.createElement("div",{className:"decision-tree",ref:function(e){t.tree=e}},r))}}]),r}(C.Component),K=(0,M.Z)("StatisticalModels")(W);var L=function(t,e,r,n,i){for(var o=[],a=[],s=t[r],c=e.length-1;c>=0;c--){var u=e[c];n(s[u],i)?o.push(u):a.push(u)}return{match:o,notMatch:a}};function _(t,e){for(var r={},n=e.length-1;n>=0;n--){r[t[e[n]]]=0}for(var i=e.length-1;i>=0;i--){r[t[e[i]]]+=1}return r}function G(t,e){var r,n=_(t,e),i=0;for(var o in n)n[o]>i&&(i=n[o],r=o);return r}function X(t,e){var r=_(t,e),n=0;for(var i in r)if(l()(r,i)){var o=r[i]/e.length;n+=o*(1-o)}return n}function $(t,e){var r=_(t,e),n=0;for(var i in r)if(l()(r,i)){var o=r[i]/e.length;n+=-o*h()(o)}return n}function J(t,e){var r=e.length,n=0,i=0,o=0,a=0;if(!r)return null;if(r<2)return 0;for(var s=0;s<r;s++){var c=t[e[s]];o+=(n=c-i)*(c-(i+=n/(a+=1)))}return o/(a-1)}function Q(t,e){var r=e.length;if(!r)return null;for(var n=0,i=0;i<r;i++){n+=(t[e[i]]-n)/(i+1)}return n}var U={"==":function(t,e){return t==e},">=":function(t,e){return t>=e}};function Y(t){var e=this,r=t.data[t.response].length;this.importances={};for(var n=0;n<t.predictors.length;n++)this.importances[t.predictors[n]]=0;this.root=tt({data:t.data,response:t.response,predictors:t.predictors,indices:t.indices?t.indices:m()(0,r,1),minItemsCount:t.minItemsCount||50,minBucket:t.minBucket||f()((t.minItemsCount||50)/3),scoreThreshold:t.scoreThreshold||.01,maxTreeDepth:t.maxTreeDepth||20,quantitative:t.quantitative,criterion:"gini"===t.criterion?X:$},this.importances),this.predict=function(r,n){if(void 0===n){for(var i=r[t.predictors[0]].length,o=new Array(i),a=0;a<i;a++)o[a]=rt(e.root,r,a);return o}return rt(e.root,r,n)}}function tt(t,e){var r=t.data,n=t.predictors,o=t.indices,s=t.response,u=t.minItemsCount,l=t.scoreThreshold,d=t.maxTreeDepth,h=t.quantitative,p=t.criterion,f=t.minBucket,v=t.nTry,m=o.length;if(0===d||m<=u)return{category:G(r[s],o)};var y=p(r[s],o),g={},Z={gain:0};v&&(a()(n,{size:v}),(0,i.Z)("predictors"));for(var T=m-1;T>=0;T--)for(var b=o[T],x=0;x<n.length;x++){var C=n[x],M=r[C][b],w=void 0,D=C+(w=c()(h,C)?">=":"==")+M;if(!g[D]){g[D]=!0;var k=U[w],O=L(r,o,C,k,M),I=p(r[s],O.match),N=p(r[s],O.notMatch),P=0;P+=I*O.match.length,P+=N*O.notMatch.length;var R=y-(P/=m);R>Z.gain&&O.match.length>f&&O.notMatch.length>f&&((Z=O).predicateName=w,Z.predicate=k,Z.attribute=C,Z.pivot=M,Z.gain=R)}}if(!Z.gain||Z.gain/y<l)return{category:G(r[s],o)};t.maxTreeDepth=d-1,e[Z.attribute]+=Z.gain,t.indices=Z.match;var S=tt(t,e);t.indices=Z.notMatch;var q=tt(t,e);return{attribute:Z.attribute,predicate:Z.predicate,predicateName:Z.predicateName,pivot:Z.pivot,match:S,notMatch:q,matchedCount:Z.match.length,notMatchedCount:Z.notMatch.length}}function et(t){var e=t.data,r=t.predictors,n=t.indices,o=t.response,s=t.minItemsCount,u=t.scoreThreshold,l=t.maxTreeDepth,d=t.quantitative,h=t.minBucket,p=t.nTry,f=n.length;if(0===l||f<=s)return{category:Q(e[o],n)};var v=J(e[o],n),m={},y={gain:0};p&&(a()(r,{size:p}),(0,i.Z)("predictors"));for(var g=f-1;g>=0;g--)for(var Z=n[g],T=0;T<r.length;T++){var b=r[T],x=e[b][Z],C=void 0,M=b+(C=c()(d,b)?">=":"==")+x;if(!m[M]){m[M]=!0;var w=U[C],D=L(e,n,b,w,x),k=J(e[o],D.match),O=J(e[o],D.notMatch),I=0;I+=k*D.match.length,I+=O*D.notMatch.length;var N=v-(I/=f);N>y.gain&&D.match.length>h&&D.notMatch.length>h&&((y=D).predicateName=C,y.predicate=w,y.attribute=b,y.pivot=x,y.gain=N)}}if(!y.gain||y.gain/v<u)return{category:Q(e[o],n)};t.maxTreeDepth=l-1,t.indices=y.match;var P=et(t);t.indices=y.notMatch;var R=et(t);return{attribute:y.attribute,predicate:y.predicate,predicateName:y.predicateName,pivot:y.pivot,match:P,notMatch:R,matchedCount:y.match.length,notMatchedCount:y.notMatch.length}}function rt(t,e,r){for(;;){if(t.category)return t.category;var n=e[t.attribute][r];t=(0,t.predicate)(n,t.pivot)?t.match:t.notMatch}}function nt(t,e,r){for(var n={},i=0;i<t.length;i++){var o=t[i].predict(e,r);n[o]=n[o]?n[o]+1:1}var a,s=-1;for(var c in n)l()(n,c)&&n[c]>s&&(s=n[c],a=c);return a}var it=Y,ot=function(t){var e=this,r=t.data[t.response].length;this.root=et({data:t.data,response:t.response,predictors:t.predictors,indices:t.indices?t.indices:m()(0,r,1),minItemsCount:t.minItemsCount||50,minBucket:t.minBucket||f()((t.minItemsCount||50)/3),scoreThreshold:t.scoreThreshold||.01,maxTreeDepth:t.maxTreeDepth||20,quantitative:t.quantitative}),this.predict=function(r,n){if(void 0===n){for(var i=r[t.predictors[0]].length,o=new Array(i),a=0;a<i;a++)o[a]=Number(rt(e.root,r,a));return o}return Number(rt(e.root,r,n))}},at=function(t){var e=this;this.trees=function(t){for(var e=[],r=t.data[t.response].length,n=m()(0,r,1),i=0;i<t.nTrees;i++)e[i]=a()(n);for(var o=[],s=0;s<t.nTrees;s++){t.indices=e[s];var c=new Y(t);o.push(c)}return o}(t),this.importances={};for(var r=0;r<t.predictors.length;r++){var n=t.predictors[r];this.importances[n]=0;for(var i=0;i<this.trees.length;i++)this.importances[n]+=this.trees[i].importances[n];this.importances[n]/=this.trees.length}this.predict=function(r,n){if(void 0===n){for(var i=r[t.predictors[0]].length,o=new Array(i),a=0;a<i;a++)o[a]=nt(e.trees,r,a);return o}return nt(e.trees,r,n)}},st=K},556927:function(t,e,r){"use strict";r.r(e);r(382139),r(627476),r(95767),r(898837),r(694882),r(298351);var n=r(858255),i=r(264659),o=r(904730),a=r(673989),s=r(175663),c=r(750591),u=r(575630),l=r(151119),d=r(202784),h=(r(213980),r(198)),p=r(822736),f=r(770561),v=r(801420),m=r.n(v),y=r(292682),g=r(150275),Z=r(747126),T=r(320765),b=r(432261);r(927299);function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){(0,l.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,u.Z)(t);if(e){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}(0,T.E4)("StatisticalModels");var w=0,D=function(t){var e=t.y,r=t.x,n=t.type,i=t.nTrees,o=t.nTry,a=t.impurityMeasure,s=t.data,c=t.quantitative,u=t.scoreThreshold,l=t.maxTreeDepth,d=t.minItemsCount;try{var h,p;h=m()(r)?r:[r],"Classification"===n&&(p=new Z.OI({response:e,predictors:h,data:s,quantitative:c,criterion:a,nTrees:i,nTry:o,scoreThreshold:u,maxTreeDepth:l,minItemsCount:d}));for(var f=[],v=0;v<h.length;v++){var y=h[v];f.push(p.importances[y])}return{forest:p,predictors:h,importances:f}}catch(g){return{}}},k=function(t){(0,s.Z)(r,t);var e=M(r);function r(t){var n;(0,i.Z)(this,r),n=e.call(this,t),(0,l.Z)((0,a.Z)(n),"handlePredict",(function(){n.props.onPredict(n.state.forest,w)})),w+=1;var o=t.y,s=t.x,c=t.type,u=t.nTrees,d=t.nTry,h=t.impurityMeasure,p=t.data,f=t.quantitative,v=t.scoreThreshold,m=t.maxTreeDepth,y=t.minItemsCount;return n.state=C(C({},D({y:o,x:s,type:c,nTrees:u,nTry:d,impurityMeasure:h,data:p,quantitative:f,scoreThreshold:v,maxTreeDepth:m,minItemsCount:y})),t),n}return(0,o.Z)(r,[{key:"render",value:function(){var t=this.state.forest,e=this.props.t;return t?(0,n.Z)("div",{style:{overflowX:"auto",width:"100%"}},void 0,(0,n.Z)("span",{className:"title"},void 0,e("random-forest-for",{y:this.props.y,counter:w})),(0,n.Z)("p",{},void 0,e("created-from-trees",{nTrees:this.props.nTrees,nTry:this.props.nTry})),(0,n.Z)(y.Z,{editable:!0,data:[{type:"bar",x:this.state.predictors,y:this.state.importances}],layout:{xaxis:{title:e("variable")},yaxis:{title:e("importance")}}}),this.props.onPredict?(0,n.Z)(g.Z,{tooltip:e("predictions-attached")},void 0,(0,n.Z)(f.Z,{variant:"secondary",size:"sm",style:{marginTop:10},onClick:this.handlePredict},void 0,this.props.t("use-model-to-predict"))):null):(0,n.Z)(p.Z,{variant:"danger"},void 0,e("missing-attributes"))}}],[{key:"getDerivedStateFromProps",value:function(t,e){if(t.y!==e.y||t.x!==e.x||t.type!==e.type||t.nTrees!==e.nTrees||t.nTry!==e.nTry||t.impurityMeasure!==e.impurityMeasure||t.data!==e.data||t.quantitative!==e.quantitative||t.scoreThreshold!==e.scoreThreshold||t.maxTreeDepth!==e.maxTreeDepth||t.minItemsCount!==e.minItemsCount){var r=t.y,n=t.x,i=t.type,o=t.nTrees,a=t.nTry,s=t.impurityMeasure,c=t.data,u=t.quantitative,l=t.scoreThreshold,d=t.maxTreeDepth,h=t.minItemsCount;return C(C({},D({y:r,x:n,type:i,nTrees:o,nTry:a,impurityMeasure:s,data:c,quantitative:u,scoreThreshold:l,maxTreeDepth:d,minItemsCount:h})),t)}return null}}]),r}(d.Component);k.defaultProps={type:"Classification",nTrees:50,nTry:1,impurityMeasure:"gini",scoreThreshold:.01,maxTreeDepth:20,minItemsCount:50,onPredict:null},e.default=(0,h.Z)("StatisticalModels")((0,b.W)(k))},806258:function(t,e){"use strict";e.Z=function(t){var e=document.createElement("div");e.innerHTML=t,e.style.position="fixed",e.style.opacity=0,e.style.pointerEvents="none",document.body.appendChild(e),window.getSelection().removeAllRanges();var r=document.createRange();r.selectNode(e),window.getSelection().addRange(r),document.execCommand("copy"),document.body.removeChild(e)}},797479:function(t,e,r){"use strict";function n(t){throw new TypeError('"'+t+'" is read-only')}r.d(e,{Z:function(){return n}})},783679:function(t,e,r){"use strict";r.d(e,{Z:function(){return i}});var n=r(202784);function i(t){var e=(0,n.useRef)(null);return(0,n.useEffect)((function(){e.current=t})),e.current}},658092:function(t,e,r){"use strict";r.d(e,{Z:function(){return i}});var n=Function.prototype.bind.call(Function.prototype.call,[].slice);function i(t,e){return n(t.querySelectorAll(e))}}}]);