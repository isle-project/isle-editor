/*! For license information please see StatusBar.7023dbe1.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[83886,69254],{377174:function(e,t,n){const s=(0,n(217431).Z)((()=>Promise.all([n.e(40532),n.e(67139),n.e(69254)]).then(n.bind(n,487482))));t.Z=s},487482:function(e,t,n){n.r(t);var s=n(202784),o=n(213980),r=n.n(o),i=n(312341),a=n(955096),l=n(635314),c=n.n(l),u=n(113545),d=Object.defineProperty,h=Object.defineProperties,p=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,b=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,v=(e,t)=>{for(var n in t||(t={}))f.call(t,n)&&b(e,n,t[n]);if(m)for(var n of m(t))g.call(t,n)&&b(e,n,t[n]);return e},y=(e,t,n)=>(b(e,"symbol"!=typeof t?t+"":t,n),n);const w={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0};class E extends s.Component{constructor(){super(...arguments),y(this,"handleStop",((e,t)=>{!function(e){const t=document.getElementsByClassName("react-draggable-last");if(e.path){let n=e.path[1];for(let t=0;t<e.path.length;t++){const s=e.path[t];if(s.classList&&s.classList.contains("react-draggable-dragged")){n=s;break}}setTimeout((()=>{if(t)for(let e=0;e<t.length;e++)t[e].classList.remove("react-draggable-last");n.classList.add("react-draggable-last")}),0)}}(e),this.props.onStop(e,t)})),y(this,"handleEscape",(e=>{this.props.onEscape(e)})),y(this,"updateSize",(({width:e,height:t})=>{this.container.updateSize({width:e,height:t})}))}render(){const e=c()(this.props,["onStop","onEscape"]);let t="button, .btn, .nav";return e.cancel&&(t+=", "+e.cancel),s.createElement(a.Z,{node:document.body},s.createElement(i.s,(n=v({},e),o={cancel:t,onDragStop:this.handleStop,ref:e=>{this.container=e},default:v({x:window.pageXOffset+30,y:window.pageYOffset+30},this.props.default),position:this.props.position,enableResizing:!!this.props.resizable&&w,enableUserSelectHack:!1,style:v({position:"fixed"},this.props.style),disableDragging:this.props.disabled},h(n,p(o))),this.props.children),s.createElement(u.Z,{container:this.container,actions:{Escape:this.handleEscape}}));var n,o}}E.propTypes={disabled:r().bool,resizable:r().bool,position:r().shape({x:r().number,y:r().number}),style:r().object,onEscape:r().func,onStop:r().func},E.defaultProps={disabled:!1,resizable:!1,position:null,style:{},onEscape(){},onStop(){}},t.default=E},370420:function(e,t,n){const s=(0,n(217431).Z)((()=>n.e(96131).then(n.bind(n,66720))));t.Z=s},897606:function(e,t,n){const s=(0,n(217431).Z)((()=>Promise.all([n.e(40532),n.e(74438)]).then(n.bind(n,603396))));t.Z=s},447610:function(e,t,n){const s=(0,n(217431).Z)((()=>n.e(89036).then(n.bind(n,287576))));t.Z=s},164876:function(e,t,n){var s=n(202784),o=n(588703),r=n.n(o);t.Z=e=>{const t=e.session,n=t.cohorts,o=(0,s.useCallback)((e=>{t.selectCohort(e.target.value)}),[t]);if(!r()(n))return null;const i=s.createElement("select",{id:e.id,className:"cohort-select",onChange:o,onBlur:o,value:t.selectedCohort?t.selectedCohort.title:"all"},s.createElement("option",{value:"all"},e.t("all-cohorts")),n.map(((e,t)=>s.createElement("option",{key:t,value:e.title},e.title))));return s.createElement("div",{style:{padding:"5px"}},s.createElement("label",{htmlFor:e.id,style:{marginRight:5}},e.label),i)}},247638:function(e,t,n){n.r(t),n.d(t,{default:function(){return Tt}});var s=n(202784),o=n(690299),r=n.n(o),i=n(198),a=n(770561),l=n(998856),c=n(686605),u=n.n(c),d=n(588703),h=n.n(d),p=n(623102),m=n.n(p),f=n(447610),g=n(897606),b=n(770149),v=n(112114),y=n(113545),w=n(83744),E=n(539365),_=n(727187),k=n(370420),x=n(975813),S=n(123103),C=n(302108),O=n(557106),Z=n.n(O),M=n(487482),N=n(426214),P=Object.defineProperty,T=(e,t,n)=>(((e,t,n)=>{t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const D={DEFAULT_BACKGROUND:"#fffff8",DISABLE_VIDEO_BACKGROUND:!0,SHOW_JITSI_WATERMARK:!1,SHOW_WATERMARK_FOR_GUESTS:!1,INVITATION_POWERED_BY:!1,DEFAULT_REMOTE_DISPLAY_NAME:"Anonymous",DISPLAY_WELCOME_PAGE_CONTENT:!1,TOOLBAR_BUTTONS:["microphone","camera","closedcaptions","desktop","fullscreen","fodeviceselection","info","profile","settings","videoquality","filmstrip","shortcuts","tileview","download","help"],SETTINGS_SECTIONS:["devices","language"],MOBILE_APP_PROMO:!0,HIDE_KICK_BUTTON_FOR_GUESTS:!0,SHOW_CHROME_EXTENSION_BANNER:!1};class I extends s.Component{constructor(e){super(e),T(this,"handleClose",(e=>{const t=this.context;t.isOwner()&&this.api.executeCommand("hangup"),t.leaveVideoChat(this.props.roomName)})),T(this,"handleCompress",(e=>{this.setState({minimized:!this.state.minimized},(()=>{this.state.minimized?this.rnd.updateSize({width:160,height:100}):this.rnd.updateSize({width:Z()(.3*window.innerWidth,400),height:Z()(.3*window.innerHeight,400)})}))})),T(this,"stopScreenSharing",(e=>{this.api.executeCommand("toggleShareScreen")})),this.state={minimized:!1,screensharing:!1}}componentDidMount(){this.context.isOwner()?(D.TOOLBAR_BUTTONS.includes("mute-everyone")||D.TOOLBAR_BUTTONS.push("mute-everyone"),D.TOOLBAR_BUTTONS.includes("recording")||D.TOOLBAR_BUTTONS.push("recording"),D.TOOLBAR_BUTTONS.includes("livestreaming")||D.TOOLBAR_BUTTONS.push("livestreaming"),D.TOOLBAR_BUTTONS.includes("invite")||D.TOOLBAR_BUTTONS.push("invite"),D.SETTINGS_SECTIONS.includes("moderator")||D.SETTINGS_SECTIONS.push("moderator"),D.TOOLBAR_BUTTONS.includes("sharedvideo")||D.TOOLBAR_BUTTONS.push("sharedvideo")):D.TOOLBAR_BUTTONS.includes("raisehand")||D.TOOLBAR_BUTTONS.push("raisehand")}initialize(){const e=this.context,t={roomName:this.props.roomName,width:"100%",height:"100%",parentNode:this.videoChatContainer,userInfo:{email:e.user.email},interfaceConfigOverwrite:D,noSSL:!1,jwt:e.jitsi.token};this.api=new window.JitsiMeetExternalAPI(e.jitsi.server,t),this.api.executeCommand("displayName",e.user.name),this.api.executeCommand("subject",this.props.roomSubject),this.api.executeCommand("avatarUrl",e.user.picture),this.api.addEventListener("screenSharingStatusChanged",(e=>{this.setState({screensharing:e.on,minimized:e.on},(()=>{this.state.minimized?this.rnd.updateSize({width:160,height:100}):this.rnd.updateSize({width:Z()(.3*window.innerWidth,400),height:Z()(.3*window.innerHeight,400)})}))}))}render(){let e,t;this.state.minimized?t={display:"none"}:(e={height:"100%",width:"100%"},t={height:"100%",width:"100%"});const n=s.createElement(N.Z,{className:"video-chat-panel",style:e},s.createElement("div",{className:"video-chat-iframe",ref:e=>{this.videoChatContainer||(this.videoChatContainer=e,this.initialize())},style:t}),this.state.minimized?s.createElement("h3",{style:{marginTop:22}},this.state.screensharing?s.createElement("span",null,this.props.t("sharing-screen")," ",s.createElement(a.Z,{onClick:this.stopScreenSharing,variant:"secondary",size:"sm"},this.props.t("stop-sharing"))):this.props.t("video-active")):null,s.createElement(v.Z,{tooltip:this.state.minimized?this.props.t("maximize"):this.props.t("minimize")},s.createElement(a.Z,{size:"sm",onClick:this.handleCompress,className:"video-chat-minimized-button"},s.createElement("i",{className:this.state.minimized?"far fa-window-maximize":"fas fa-window-minimize"}))),s.createElement(v.Z,{tooltip:this.props.t("leave-video")},s.createElement(a.Z,{size:"sm",onClick:this.handleClose,className:"video-chat-button"},s.createElement("i",{className:"fas fa-video-slash"}))));return s.createElement(M.default,{default:{width:Z()(.3*window.innerWidth,400),height:Z()(.3*window.innerHeight,400)},ref:e=>{this.rnd=e},minWidth:160,minHeight:100,resizable:!this.state.minimized,lockAspectRatio:!0,cancel:".video-chat-iframe"},n)}}I.contextType=S.Z;var A=(0,i.Z)("internal/statusbar")(I);class j extends s.Component{constructor(e){super(e)}componentDidMount(){const e=this.context;this.unsubscribe=e.subscribe((e=>{e!==C.q&&e!==C.lK||this.forceUpdate()}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}render(){return this.context.videoChats.map((e=>s.createElement(A,{key:e.name,roomName:e.name,roomSubject:e.subject||e.name})))}}j.contextType=S.Z;var z=j,R=n(521536),L=n.n(R),B=n(783158),U=n.n(B),V=n(213980),F=n.n(V),$=n(313054),H=n.n($),W=n(302467),G=n.n(W),K=n(188304),q=n(912860),J=n(435376),Y=n(992500),X=n(862816),Q=n(306830),ee=n.n(Q),te=n(377174),ne=n(998325),se=n(107466),oe=n(979409),re=n(289846),ie=n(870781),ae=Object.defineProperty,le=(e,t,n)=>(((e,t,n)=>{t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const ce=r()("isle:statusbar:chat"),ue=H()({html:!1,xhtmlOut:!0,breaks:!1,typographer:!1});class de extends s.Component{constructor(e){super(e),le(this,"onScroll",(()=>{if(this.chatbody.scrollTop+this.chatbody.clientHeight>=this.chatbody.scrollHeight){this.context.markChatMessagesAsRead(this.props.chat.name)}})),le(this,"sendMessage",((e,t=!1)=>{let n=this.editorView.markdown;if(0===n.length)return;n=G()(n,"\\\n","\n");this.context.sendChatMessage(this.props.chat.name,n,t),(0,se.Z)(this.chatbody,this.chatbody.scrollHeight,1e3),this.setState({defaultValue:"",docId:this.state.docId+1})})),le(this,"sendAnonymousChatMessage",(e=>{this.sendMessage(e,!0)})),le(this,"handleEditorStateChange",(()=>{this.state.hasNews&&this.setState({hasNews:!1})})),le(this,"insertText",(e=>{e=this.editorView.markdown+" "+e,this.setState({defaultValue:e})})),le(this,"closeChat",(()=>{this.context.leaveChat(this.props.chat.name)})),le(this,"onMouseOver",(()=>{this.state.opened||(this.chat.style.opacity=this.state.opened?.7:1)})),le(this,"onMouseOut",(()=>{this.state.opened||(this.chat.style.opacity=this.state.opened?1:.7)})),le(this,"toggleMaximize",(()=>{const e={maximized:!this.state.maximized};e.maximized&&!this.state.opened&&(e.opened=!0),this.setState(e)})),le(this,"toggleChat",(()=>{this.setState({opened:!this.state.opened,hasNews:!1})})),this.state={opened:!0,hasNews:!1,maximized:!1,defaultValue:"",docId:0}}componentDidMount(){ce("Component has mounted. Subscribe to session: ");const e=this.context;this.unsubscribe=e.subscribe((e=>{e===C.LL||e===C.xG||e===C.Jz?this.setState({hasNews:!0}):e===C.NH&&this.setState({hasNews:!1})}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}renderMembers(){const{chat:e}=this.props,t=s.createElement(J.Z,{id:"userlistPopover"},s.createElement(Y.Z,null,this.props.t("chat-members",{name:e.name})),s.createElement(X.Z,null,s.createElement(K.Z,null,e.members.map(((e,t)=>s.createElement(q.Z,{style:{padding:"3px 3px"},key:t},e.name))))));return s.createElement(ne.Z,{trigger:["hover","focus"],placement:"bottom",overlay:t},s.createElement("div",{className:"chat-members",style:{display:this.state.opened?"block":"none"}},e.members.map(((t,n)=>s.createElement("span",{key:n},t.name,n!==e.members.length-1?", ":null)))))}renderChatBody(){const{chat:e}=this.props,t=this.context;return s.createElement("div",{className:"chat-body-outer",style:{display:this.state.opened?"block":"none"}},s.createElement("div",{className:"chat-body cancel",ref:e=>{this.chatbody=e},onScroll:this.onScroll,style:{height:this.state.maximized?"calc(85vh - 150px)":"150px"}},e.messages.map(((e,n)=>{const o={__html:ue.renderInline(e.content)};return s.createElement("div",{className:e.unread?"chat-message unread":"chat-message",key:n},s.createElement("img",{className:"chat-picture unselectable",src:t.server+"/thumbnail/"+(e.picture&&!e.anonymous?e.picture:"anonymous.jpg"),alt:this.props.t("profile-pic")}),s.createElement("div",{className:"chat-message-right"},s.createElement("span",{className:"chat-user"},e.anonymous?s.createElement(s.Fragment,null,s.createElement("span",{style:{marginRight:4}},this.props.t("anonymous")),s.createElement(b.Z,{owner:!0,showOwnerInPresentationMode:!1,banner:null},s.createElement(v.Z,{tooltip:e.user,placement:"right"},s.createElement("i",{className:"fas fa-user-secret"})))):e.user)," - ",s.createElement("span",{className:"chat-time"},(0,ie.Z)(e.time)),s.createElement("br",null),s.createElement("span",{className:"chat-message-content",dangerouslySetInnerHTML:o})))}))),s.createElement(oe.Z,{className:"chat-textarea cancel",onEditorState:this.handleEditorStateChange,showStatusBar:!1,showColorPicker:!1,defaultValue:this.state.defaultValue,docId:this.state.docId,menu:{marks:re.EI,wraps:re.Uy,insert:[re.$T[0],re.$T[1],re.$T[5]]},ref:e=>{this.editorView=e},onKeyDown:(e,t)=>{t.stopPropagation(),"Enter"!==t.key||t.shiftKey||(t.preventDefault(),this.sendMessage())},t:this.props.t}),s.createElement(a.Z,{size:"sm",variant:"light",onClick:this.sendMessage,style:{float:"left"}},this.props.t("send-message")),this.props.chat.anonymousSubmissions?s.createElement(a.Z,{size:"sm",variant:"light",onClick:this.sendAnonymousChatMessage,style:{float:"left",marginLeft:"4px"}},this.props.t("send-anonymously")):null)}render(){let{chat:e,left:t,width:n}=this.props;const o={position:E.Z?"absolute":"fixed",left:t};this.state.maximized&&this.state.opened?o.width="40vw":o.width=n,o.minWidth="275px";const r="chat_"+e.name;return s.createElement(te.Z,{cancel:".cancel",onEscape:this.props.chat.canLeave?this.closeChat:ee()},s.createElement("div",{id:r,className:"chat-outer-div",style:o,ref:e=>{this.chat=e}},s.createElement("div",{className:"chat-div",style:{opacity:this.state.opened?1:.7},onMouseOver:this.onMouseOver,onFocus:this.onMouseOver,onMouseOut:this.onMouseOut,onBlur:this.onMouseOut,tabIndex:0,role:"button"},s.createElement("span",{className:"chat-name"},e.name),s.createElement("span",{className:"chat-presence",style:{display:this.state.hasNews?"inline":"none"}}),e.canLeave?s.createElement(v.Z,{tooltip:`${this.props.t("close")} (Esc)`,placement:"bottom"},s.createElement("button",{className:"chat-header-button",onClick:this.closeChat,"aria-label":`${this.props.t("close")} (Esc)`},s.createElement("i",{className:"fas fa-times"}))):null,s.createElement(v.Z,{tooltip:this.state.maximized?this.props.t("shrink"):this.props.t("enlarge"),placement:"bottom"},s.createElement("button",{className:"chat-header-button",onClick:this.toggleMaximize,"aria-label":this.state.maximized?this.props.t("shrink"):this.props.t("enlarge")},s.createElement("i",{className:"far fa-window-maximize"}))),s.createElement(v.Z,{tooltip:this.state.opened?this.props.t("minimize"):this.props.t("maximize"),placement:"left"},s.createElement("button",{className:"chat-header-button",onClick:this.toggleChat,"aria-label":this.state.opened?this.props.t("minimize"):this.props.t("maximize")},s.createElement("i",{className:"far fa-window-minimize"})))),this.renderMembers(),this.renderChatBody()))}}de.defaultProps={left:400,width:600},de.propTypes={chat:F().object.isRequired,left:F().number,width:F().number},de.contextType=S.Z;var he=(0,i.Z)("internal/statusbar")(de),pe=Object.defineProperty,me=(e,t,n)=>(((e,t,n)=>{t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class fe extends s.Component{constructor(e){super(e),me(this,"getStatusbarInfo",(()=>{const e=Z()(.34*window.innerWidth,300),t=(window.innerWidth-e)/2;this.setState({statusbarWidth:e,side:t})}));const t=Z()(.34*window.innerWidth,300),n=(window.innerWidth-t)/2;this.state={statusbarWidth:t,side:n}}componentDidMount(){const e=this.context;this.unsubscribe=e.subscribe((e=>{e!==C._Z&&e!==C.PY||this.forceUpdate()})),window.addEventListener("resize",this.getStatusbarInfo)}componentWillUnmount(){this.unsubscribe&&this.unsubscribe(),window.removeEventListener("resize",this.getStatusbarInfo)}getChatPosition(e){const t=this.context,n=L()(t.chats.length/2),s=.6*this.state.side,o=U()((this.state.side-10-10*n)/n,s);let r=10+e*(o+10);e>n-1&&(r+=this.state.statusbarWidth,1===n&&1===e&&(r+=o+10));return{left:r,width:o}}render(){return this.context.chats.map(((e,t)=>{const n=this.getChatPosition(t);return s.createElement(he,{chat:e,idx:t,key:t,left:n.left,width:n.width})}))}}fe.contextType=S.Z;var ge=fe,be=n(715318);const ve=e=>s.createElement(be.Z,{show:e.show,onHide:e.close},s.createElement(be.Z.Header,null,s.createElement(be.Z.Title,null,e.title)),s.createElement(be.Z.Body,null,e.message),s.createElement(be.Z.Footer,null,s.createElement(a.Z,{onClick:e.close},e.t("cancel")),s.createElement(a.Z,{variant:"danger",onClick:e.onConfirm},e.t("confirm"))));ve.propTypes={close:F().func.isRequired,message:F().string.isRequired,onConfirm:F().func.isRequired,show:F().bool.isRequired,title:F().string.isRequired};var ye=ve,we=n(257513),Ee=n(691334),_e=n(165666),ke=n(902194),xe=Object.defineProperty,Se=(e,t,n)=>(((e,t,n)=>{t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Ce=r()("isle:statusbar:voice-control");function Oe(e){e.stopPropagation()}class Ze extends s.Component{constructor(e){super(e),Se(this,"handleFinalVoiceInput",(e=>{const t=e[0],n=this.state.transcript;n.push(t),this.setState({transcript:n,recordedText:t,isSegment:!1},this.renderRecordedText),setTimeout((()=>{this.setState({recordedText:null},this.renderRecordedText)}),3e3);this.props.session.log({id:C.Ac,type:C.Ac,value:t,noSave:!0},"members")})),Se(this,"handleVoiceInput",(e=>{Ce("Received voice input: "+e);const t=e[0];this.setState({recordedText:t,isSegment:!0},this.renderRecordedText);this.props.session.log({id:C.Be,type:C.Be,value:t,noSave:!0},"members")})),Se(this,"handleStartRecording",(()=>{this.props.session.setVoiceRecordingStatus(!0)})),Se(this,"handleStopRecording",(()=>{this.setState({recordedText:null},this.renderRecordedText);this.props.session.setVoiceRecordingStatus(!1)})),Se(this,"toggleTranscriptEditor",(e=>{e&&e.stopPropagation(),this.setState({showTranscriptEditor:!this.state.showTranscriptEditor})})),Se(this,"renderRecordedText",(()=>{this.state.recordedText?this.displayedText.innerHTML=this.state.recordedText:this.displayedText.innerHTML=""})),this.state={recordedText:null,transcript:[],showTranscriptEditor:!1,isSegment:!1}}componentDidMount(){const e=this.props.session;this.unsubscribe=e.subscribe(((e,t)=>{e===C.Wh&&(t.type===C.Ac?(this.setState({recordedText:t.value,isSegment:!1},this.renderRecordedText),setTimeout((()=>{this.setState({recordedText:null},this.renderRecordedText)}),3e3)):t.type===C.Be&&this.setState({recordedText:t.value,isSegment:!0},this.renderRecordedText))}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}render(){const e=this.props.session;let t="";if(this.state.showTranscriptEditor){const n=new Date;t+=`# ${this.props.t("transcript-header")} ${e.namespaceName+"/"+e.lessonName}`,m()(e.user)||(t+=`\n## ${this.props.t("by")} ${e.user.name} (${e.user.email})`),t+=`\n### ${n.toLocaleDateString()} - ${n.toLocaleTimeString()}`,t+="\n\n\n",t+=this.state.transcript.join("\n")}return s.createElement(s.Fragment,null,s.createElement("div",{className:"statusbar-voice",style:{display:e.config.hideVoiceControl?"none":"inherit"}},s.createElement(ke.Z,{id:"statusbar-voice",onClick:Oe,mode:"microphone",width:18,height:18,stopTooltip:`${this.props.t("disable-voice")} (F9)`,startTooltip:`${this.props.t("enable-voice")} (F9)`,onSegment:this.handleVoiceInput,onFinalText:this.handleFinalVoiceInput,onRecordingStart:this.handleStartRecording,onRecordingStop:this.handleStopRecording,maxAlternatives:5,speechInterface:e.speechInterface,remote:{toggle:120}})),this.state.transcript.length>0?s.createElement(v.Z,{placement:"bottom",tooltip:this.props.t("open-transcript")},s.createElement("span",{role:"button",tabIndex:0,onClick:this.toggleTranscriptEditor,onKeyPress:this.toggleTranscriptEditor,className:"statusbar-transcript-editor statusbar-icon"},s.createElement("span",{className:"fa fa-xs fa-closed-captioning"}))):null,s.createElement("span",{ref:e=>{this.displayedText=e},style:{color:this.state.isSegment?"darkslategray":"black"},className:"statusbar-voice-text"}),this.state.showTranscriptEditor?s.createElement(be.Z,{show:this.state.showTranscriptEditor,onHide:this.toggleTranscriptEditor,dialogClassName:"modal-100w"},s.createElement(be.Z.Header,{closeButton:!0},s.createElement(be.Z.Title,{as:"h3"},this.props.t("transcript"))),s.createElement(be.Z.Body,{style:{height:.8*window.innerHeight}},s.createElement(_e.Z,{id:`${e.namespaceName}-${e.lessonName}-transcript`,defaultValue:t,allowSubmissions:!1,resetModal:{title:this.props.t("load-latest-transcript"),body:this.props.t("transcript-click-discard"),buttonLabel:this.props.t("confirm"),tooltip:this.props.t("load-latest-transcript"),notificationTitle:this.props.t("transcript-loaded"),notification:this.props.t("transcript-discard-notification"),icon:s.createElement("i",{className:"prosemirror-icon fa fa-closed-captioning"})},canLoadHTML:!1})),s.createElement(be.Z.Footer,null,s.createElement(a.Z,{onClick:this.toggleTranscriptEditor},this.props.t("close")))):null)}}Ze.propTypes={session:F().object.isRequired};var Me=Ze,Ne=n(318967),Pe=n.n(Ne),Te=n(747153),De=n(156931),Ie=n(287013),Ae=n.n(Ie),je=n(294565),ze=n(295943),Re=n.n(ze),Le=n(240054),Be=n.n(Le),Ue=n(418823),Ve=n.n(Ue),Fe=n(380408),$e=n(156562),He=n(525678),We=n(506078),Ge=n(440835),Ke=n(351375),qe=n(298767);var Je=class{constructor(e,t){this.name=e,this.members=t}},Ye=n(164876),Xe=JSON.parse('["daffodil","dahlia","daisy","dandelion","forget-me-not","foxglove","geranium","lily","orchid","pansy","poppy","primrose","rose","snowdrop","sunflower","tulip","waterlily","bluebell","buttercup","carnation","chrysanthemum","crocus","alder","ash","beech","birch","cedar","elm","fir","hazel","hawthorn","holly","lime","maple","oak","plane","pine","poplar","sycamore","weeping-willow","willow","yew","apple-tree","cherry-tree","chestnut-tree","coconut-tree","fig-tree","horse-chestnut-tree","olive-tree","pear-tree","plum-tree"]'),Qe=n(422132),et=Object.defineProperty,tt=Object.defineProperties,nt=Object.getOwnPropertyDescriptors,st=Object.getOwnPropertySymbols,ot=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable,it=(e,t,n)=>t in e?et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,at=(e,t)=>{for(var n in t||(t={}))ot.call(t,n)&&it(e,n,t[n]);if(st)for(var n of st(t))rt.call(t,n)&&it(e,n,t[n]);return e},lt=(e,t)=>tt(e,nt(t)),ct=(e,t,n)=>(it(e,"symbol"!=typeof t?t+"":t,n),n);const ut=r()("isle:group-manager"),dt={multiValue:e=>lt(at({},e),{boxShadow:"0 0 2px black",marginRight:"4px"}),control:e=>lt(at({},e),{borderRadius:"0 0 4px 4px"})},ht={MultiValueLabel:e=>s.createElement(v.Z,{tooltip:e.data.value.email,placement:"bottom"},s.createElement("span",null,s.createElement("img",{className:"group-manager-profile-pic",alt:"User Profile",src:e.data.value.picture}),s.createElement(De.c.MultiValueLabel,at({},e))))};function pt(e){const t=[],n=e.responseVisualizerIds;for(let s=0;s<n.length;s++){const o=n[s];let r=e.responseVisualizers[o].ref.props.data.question;r=(0,je.isPrimitive)(r)?r:Pe()(r),t.push(`${r} (${o})`)}return t}function mt(e,t){t=Ve()(t);const n={},s=Re()(t.length/e);for(let o=0;o<e;o++)n[o]=t.slice(s*o,s*(o+1));for(let o=s*e;o<t.length;o++){n[o%e].push(t[o])}return n}function ft({nGroups:e,users:t,mode:n,progress:s,matching:o,randomNames:r}){let i,a;if(r)i=Be()(Xe,{size:e,replace:!1});else{i=[];for(let t=0;t<e;t++)i.push(`${t+1}`)}switch(n){case"empty":a=function(e){const t={};for(let n=0;n<e;n++)t[n]=[];return t}(e);break;case"random":case"answers":a=mt(e,t);break;case"progress":a=function(e,t,n,s){const o={},r=Re()(t.length/e);if(t=t.sort(((e,t)=>n[e.email]-n[t.email])),"similar"===s){const n=t.length%e;for(let s=0,i=0;s<e;s++){let e=r*s+i;s<n&&(i+=1);let a=r*(s+1)+i;o[s]=t.slice(e,a)}}else{for(let t=0;t<e;t++)o[t]=[];let n=0,s=!1;for(;t.length>0;)o[n].push(s?t.shift():t.pop()),n<e-1?n+=1:(n=0,s=!s)}return o}(e,t,s,o)}const l=[];for(let c=0;c<i.length;c++)l[c]=new Je(i[c],a[c]);return l}class gt extends s.Component{constructor(e){super(e),ct(this,"handleGroupCreation",(()=>{const e=this.context,t=function(e,t){if(t){const t=e.userList;if(!e.selectedCohort)return t.filter((e=>!e.owner&&!e.exitTime&&Ae()(e.email,"@")));const n=[];for(let s=0;s<t.length;s++){const o=t[s];!o.owner&&(0,Qe.Z)(e.selectedCohort,o.email)&&n.push(o)}return n}if(e.selectedCohort)return e.selectedCohort.members;let n=[];for(let s=0;s<e.cohorts.length;s++){const t=e.cohorts[s];n=n.concat(t.members)}return n}(e,this.state.onlyOnline),n=ft({nGroups:this.state.nGroups,users:t,mode:this.state.activeMode,progress:e.userProgress,matching:this.state.matching,randomNames:this.state.randomNames});if("empty"===this.state.activeMode){const n=this.state.notAssigned.slice();for(let s=0;s<t.length;s++){const o=t[s].picture.startsWith("http")?t[s].picture:e.server+"/thumbnail/"+t[s].picture,r={value:lt(at({},t[s]),{picture:o}),label:t[s].name};n.push(r)}this.setState({notAssigned:n})}e.createGroups(n)})),ct(this,"reuseLastGroups",(()=>{this.context.createGroups(this.state.lastGroups)})),ct(this,"updateGroups",(()=>{const e=this.context,t=e.allGroups;for(let n=0;n<this.state.toRemove.length;n++){const{email:e,group:s}=this.state.toRemove[n].value;for(let n=0;n<t.length;n++)if(t[n].name===s){t[n].members=t[n].members.filter((t=>t.email!==e));break}}for(let n=0;n<this.state.toAdd.length;n++){const e=this.state.toAdd[n].value;for(let n=0;n<t.length;n++){const s=t[n];if(s.name===e.group&&0===s.members.filter((t=>t.email===e.email)).length){s.members.push(e);break}}}e.deleteGroups(),e.createGroups(t),this.setState({toAdd:[],toRemove:[]})})),ct(this,"handleGroupDeletion",(()=>{const e=this.context;e.log({id:"group-manager",type:Ee.kK,value:!0},"members"),setTimeout(e.deleteGroups,6e4),this.setState({showCloseModal:!1})})),ct(this,"sendMessageToAll",(()=>{let e=this.editorView.markdown;if(0===e.length)return;e=G()(e,"\\\n","\n");const t=this.context;for(let n=0;n<t.allGroups.length;n++){const{name:s}=t.allGroups[n];t.sendChatMessage(s,e)}this.setState({message:"",docId:this.state.docId+1})})),ct(this,"toggleCloseConfirm",(()=>{this.setState({showCloseModal:!this.state.showCloseModal})})),this.state={activeMode:"random",matching:"similar",nGroups:1,isClosing:!1,showCloseModal:!1,notAssigned:[],toRemove:[],toAdd:[],lastGroups:null,message:"",randomNames:!0,docId:0,onlyOnline:!0}}componentDidMount(){ut("Component did mount...");const e=this.context;e&&(this.unsubscribe=e.subscribe(((t,n)=>{if(t===C.At&&e.allGroups.length>0&&!n.owner){if(!(0,qe.Z)(e.allGroups,n)){const t=this.state.notAssigned.slice(),s=e.server+"/thumbnail/"+n.picture,o={value:{email:n.email,picture:s},label:n.name};t.push(o),this.setState({notAssigned:t})}}else if(t===C.vB)e.removeNotification(this.closeNotification),this.setState({isClosing:!1,lastGroups:n});else if(t===C.Wh&&n.type===Ee.kK)this.closeNotification=e.addNotification({title:this.props.t("groups-close-soon"),message:this.props.t("groups-close-soon-instructor-message"),level:"info",position:"tr",dismissible:"none",autoDismiss:0,children:s.createElement(He.Z,{style:{position:"relative"},duration:60,active:!0,onTimeUp:()=>{this.forceUpdate()}})}),this.setState({isClosing:!0});else if(t===C.WF){const t=this.state.notAssigned.filter((t=>{for(let n=0;n<e.allGroups.length;n++){const{members:s}=e.allGroups[n];for(let e=0;e<s.length;e++)if(s[e].email===t.value.email)return!1}return!0}));this.setState({notAssigned:t})}else if(t===C.At||t===C.c_)this.forceUpdate();else if(t===C.vu){const e=this.state.notAssigned.filter((e=>e.value.email!==n));this.setState({notAssigned:e})}})))}componentWillUnmount(){ut("Component will unmount..."),this.unsubscribe&&this.unsubscribe()}renderModeOptions(){const e=s.createElement(Ge.Z,{options:["similar","dissimilar"],value:this.state.matching,inline:!0,onChange:e=>{this.setState({matching:e})},style:{width:150}}),t=s.createElement(Ge.Z,{options:pt(this.context),inline:!0,style:{width:412}}),{t:n}=this.props;switch(this.state.activeMode){case"progress":return s.createElement("div",null,s.createElement("p",null,n("create-groups-pairing-students"),e,"."));case"answers":return s.createElement("div",null,s.createElement("p",null,n("create-groups-with-answers"),e,s.createElement("br",null),n("to-the-question"),": ",t));case"empty":return s.createElement("div",null,s.createElement("p",null,this.props.t("empty-groups-description")));default:return s.createElement("div",null,s.createElement("p",null,this.props.t("random-groups-description")))}}renderGroups(){const e=this.context,t=[];for(let n=0;n<e.allGroups.length;n++){const{name:o,members:r}=e.allGroups[n],i=r.map((t=>{const n=t.picture.startsWith("http")?t.picture:e.server+"/thumbnail/"+t.picture;return{value:{email:t.email,name:t.name,picture:n,group:o},label:t.name}}));t[n]=s.createElement("div",{key:n},s.createElement("h3",{className:"group-manager-header"},s.createElement("span",{className:"group-manager-header-name"},this.props.t("group")," ",o),this.props.video?s.createElement(_.Z,{showTooltip:!1,for:o,subject:o,style:{float:"right",marginTop:-2,marginLeft:5}}):null,s.createElement(k.Z,{showTooltip:!1,for:o,style:{float:"right",marginTop:-2}})),s.createElement(Te.Z,{components:ht,isMulti:!0,isClearable:!1,defaultValue:i,options:this.state.notAssigned,styles:dt,menuPlacement:"bottom",menuShouldScrollIntoView:!1,onChange:(e,t)=>{if("remove-value"===t.action){console.log("Tentatively remove user from group: ",t.removedValue);const e=this.state.notAssigned.slice();e.push(t.removedValue);const n=this.state.toRemove.slice();n.push(t.removedValue),this.setState({notAssigned:e,toRemove:n})}else if("select-option"===t.action){console.log("Tentatively add user to group: ",t.option.value);const e=this.state.toAdd.slice();t.option.value.group=o,e.push(t.option);const n=this.state.notAssigned.filter((e=>e.value.email!==t.option.value.email));this.setState({notAssigned:n,toAdd:e})}}}))}return this.state.notAssigned.length>0&&t.push(s.createElement("span",{className:"group-manager-not-assigned-warning"},this.props.t("nonassigned-students",{n:this.state.notAssigned.length}))),t}renderBody(){const e=this.context,t=function(e,t){let n=0;if(t)if(e.selectedCohort)for(let s=0;s<e.userList.length;s++){const t=e.userList[s];t.owner||t.exitTime||!(0,Qe.Z)(e.selectedCohort,t.email)||(n+=1)}else for(let s=0;s<e.userList.length;s++){const t=e.userList[s];t.owner||t.exitTime||!Ae()(t.email,"@")||(n+=1)}else if(e.selectedCohort)n=e.selectedCohort.members.length;else for(let s=0;s<e.cohorts.length;s++)n+=e.cohorts[s].members.length;return n}(e,this.state.onlyOnline),n=Re()(t/this.state.nGroups);let o=`(${this.props.t("group-sizes")}: ${n}`;return t%this.state.nGroups!=0?o+=`-${n+1})`:o+=")",e.allGroups.length>0?s.createElement(s.Fragment,null,this.renderGroups(),s.createElement("div",{className:"group-manager-editor-wrapper"},s.createElement(oe.Z,{className:"group-manager-textarea cancel",showStatusBar:!1,defaultValue:this.state.message,showColorPicker:!1,menu:{marks:re.EI,wraps:re.Uy,insert:[re.$T[0],re.$T[1],re.$T[5]]},ref:e=>{this.editorView=e},onKeyDown:(e,t)=>{t.stopPropagation(),"Enter"!==t.key||t.shiftKey||(t.preventDefault(),this.sendMessageToAll())}}))):s.createElement(s.Fragment,null,s.createElement(Ye.Z,{id:"group-manager-cohort-select",label:this.props.t("pair-users-from"),session:this.context,t:this.props.t}),s.createElement(Ke.Z,{id:"group-manager-online-checkbox",legend:this.props.t("only-pair-online-users"),value:this.state.onlyOnline,onChange:e=>{this.setState({onlyOnline:e})}}),s.createElement(We.Z,{legend:this.props.t("number-of-groups"),value:this.state.nGroups,min:1,max:50,onChange:e=>{this.setState({nGroups:e})},inline:!0,inputStyle:{width:50}}),s.createElement("span",{className:"title"},o),s.createElement("div",{style:{padding:"5px"}},s.createElement("label",{htmlFor:"random-names-toggle-button",style:{marginRight:5}},this.props.t("group-names")),s.createElement(Fe.Z,{id:"random-names-toggle-button",name:"names",onChange:e=>{this.setState({randomNames:e})},type:"radio",size:"small",value:this.state.randomNames,style:{marginRight:"5px"}},s.createElement($e.Z,{id:"toggle-random-names",size:"sm",variant:"light",value:!0,style:{fontSize:"12px",color:this.state.randomNames?"black":"#A9A9A9"}},this.props.t("random")),s.createElement($e.Z,{id:"toggle-numeric-names",size:"sm",variant:"light",value:!1,style:{fontSize:"12px",color:this.state.randomNames?"#A9A9A9":"black"}},this.props.t("numeric")))),s.createElement("hr",null),s.createElement("div",null,s.createElement(v.Z,{tooltip:this.props.t("random-assignment"),placement:"bottom"},s.createElement(a.Z,{active:"random"===this.state.activeMode,size:"lg",variant:"outline-secondary",onClick:()=>{"random"!==this.state.activeMode&&this.setState({activeMode:"random"})},"aria-label":this.props.t("random-assignment")},s.createElement("span",{className:"fa fa-dice"}))),s.createElement(v.Z,{tooltip:this.props.t("no-assignment"),placement:"bottom"},s.createElement(a.Z,{active:"empty"===this.state.activeMode,size:"lg",variant:"outline-secondary",style:{marginLeft:6},onClick:()=>{"empty"!==this.state.activeMode&&this.setState({activeMode:"empty"})},"aria-label":this.props.t("empty-groups")},s.createElement("span",{className:"fa fa-0"}))),s.createElement(v.Z,{tooltip:this.props.t("match-by-progress"),placement:"bottom"},s.createElement(a.Z,{active:"progress"===this.state.activeMode,size:"lg",variant:"outline-secondary",style:{marginLeft:6},onClick:()=>{"progress"!==this.state.activeMode&&this.setState({activeMode:"progress"})},"aria-label":this.props.t("match-by-progress")},s.createElement("span",{className:"fa fa-trophy"}))),s.createElement(v.Z,{tooltip:this.props.t("match-by-answers"),placement:"bottom"},s.createElement(a.Z,{active:"answers"===this.state.activeMode,disabled:m()(e.responseVisualizers),size:"lg",variant:"outline-secondary",style:{marginLeft:6},onClick:()=>{"answers"!==this.state.activeMode&&this.setState({activeMode:"answers"})},"aria-label":this.props.t("match-by-answers")},s.createElement("span",{className:"fa fa-poll"})))),s.createElement("br",null),this.renderModeOptions())}renderFooter(){return this.context.allGroups.length>0?s.createElement(s.Fragment,null,s.createElement(v.Z,{tooltip:this.props.t("broadcast-message-tooltip"),placement:"bottom"},s.createElement(a.Z,{onClick:this.sendMessageToAll},this.props.t("broadcast-message"))),s.createElement(v.Z,{tooltip:this.props.t("close-groups-tooltip"),placement:"bottom"},s.createElement(a.Z,{variant:"danger",disabled:this.state.isClosing,onClick:this.toggleCloseConfirm,style:{float:"right"}},this.props.t("close-groups"))),this.state.toAdd.length>0||this.state.toRemove.length>0?s.createElement(v.Z,{tooltip:this.props.t("update-groups-tooltip"),placement:"bottom"},s.createElement(a.Z,{onClick:this.updateGroups,style:{float:"right",marginRight:6}},this.props.t("update-groups"))):null):s.createElement(s.Fragment,null,s.createElement(v.Z,{tooltip:this.props.t("reopen-last-groups-tooltip"),placement:"bottom",show:this.state.lastGroups},s.createElement(a.Z,{variant:"secondary",disabled:!this.state.lastGroups,onClick:this.reuseLastGroups},this.props.t("reopen-last-groups"))),s.createElement(v.Z,{tooltip:this.props.t("create-groups-tooltip"),placement:"bottom",show:!0},s.createElement(a.Z,{onClick:this.handleGroupCreation,style:{float:"right"}},this.props.t("create-groups"))))}render(){return this.props.active?s.createElement(s.Fragment,null,s.createElement(te.Z,{cancel:".card-body",default:{x:.4*window.innerWidth}},s.createElement(N.Z,{minimizable:!0,trapFocus:!0,header:s.createElement("span",null,s.createElement("span",{className:"fa fa-xs fa-user-friends",style:{marginRight:5}}),this.props.t("group-manager")),onHide:this.props.onHide,style:{width:600},bodyStyle:{maxHeight:"75vh"},footer:this.renderFooter()},this.renderBody())),s.createElement(ye,{show:this.state.showCloseModal,close:this.toggleCloseConfirm,title:this.props.t("close-groups"),message:this.props.t("close-groups-confirm"),onConfirm:this.handleGroupDeletion,t:this.props.t})):null}}gt.contextType=S.Z,gt.propTypes={video:F().bool},gt.defaultProps={video:!0};var bt=(0,i.Z)("internal/statusbar")(gt);class vt extends s.Component{constructor(e){super(e)}componentDidMount(){const e=this.context;this.unsubscribe=e.subscribe(((t,n)=>{t===C.WF?this.forceUpdate():t===C.vB?(e.removeNotification(this.closeNotification),this.forceUpdate()):t===C.Wh&&n.type===Ee.kK&&(this.closeNotification=e.addNotification({title:this.props.t("groups-close-soon"),message:this.props.t("groups-close-soon-message"),level:"info",position:"tr",dismissible:"none",autoDismiss:0,children:s.createElement(He.Z,{style:{position:"relative"},duration:60,active:!0})}))}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}renderMembers(){const e=this.context,t=e.group.members;return s.createElement(K.Z,null,t.map(((t,n)=>{const o=e.server+"/thumbnail/"+t.picture;return s.createElement(q.Z,{className:"group-client-list-item",key:n},s.createElement("img",{className:"group-client-user-picture",alt:"User Profile",src:o,height:"40px",width:"40px"}),s.createElement("span",null,t.name))})))}render(){const e=this.context;return e.group?s.createElement(te.Z,{default:{x:window.innerWidth-280}},s.createElement(N.Z,{minimizable:!0,header:s.createElement("span",null,s.createElement("span",{className:"fa fa-xs fa-user-friends",style:{marginRight:5}}),s.createElement("span",{className:"group-name"},this.props.t("group")," ",e.group.name)),className:"group-client-panel"},this.renderMembers(),this.props.video?s.createElement(_.Z,{for:e.group.name}):null)):null}}vt.contextType=S.Z,vt.propTypes={video:F().bool},vt.defaultProps={video:!0};var yt=(0,i.Z)("internal/statusbar")(vt);const wt=r()("isle:statusbar-score");function Et(e){e.stopPropagation()}class _t extends s.Component{constructor(e,t){super(e),this.state={score:t.get("score"),isReceiving:!1,addition:4}}componentDidMount(){wt("Component did mount...");const e=this.context;e&&(this.unsubscribe=e.subscribe(((e,t)=>{e===C.Zh&&this.addScore(t)})))}componentWillUnmount(){wt("Component will unmount..."),this.unsubscribe&&this.unsubscribe()}addScore(e){this.setState({addition:e,isReceiving:!0}),setTimeout((()=>{const t=this.state.score+e;this.setState({score:t,isReceiving:!1})}),2e3)}getAnimation(){return this.state.isReceiving&&this.rect?s.createElement("div",{className:"receiving-score",style:{left:this.rect.x,top:this.rect.y,transformOrigin:`${this.rect.width/2}px ${this.rect.height/2}px`}},"+",this.state.addition,s.createElement("div",{className:"receiving-score-outer-circle2"}),s.createElement("div",{className:"receiving-score-outer-circle"})):null}render(){return s.createElement(s.Fragment,null,s.createElement(v.Z,{placement:"bottom",tooltip:this.props.t("achievement-points")},s.createElement("div",{className:"statusbar-score",role:"button",ref:e=>{if(e){const t=e.getBoundingClientRect();t&&t.x>0&&t.y>0&&(this.rect=t)}},onClick:Et,onKeyPress:Et,tabIndex:0},this.state.score)),this.getAnimation())}}_t.contextType=S.Z;var kt=_t,xt=Object.defineProperty,St=(e,t,n)=>(((e,t,n)=>{t in e?xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Ct=(0,s.lazy)((()=>Promise.all([n.e(40532),n.e(79553),n.e(54851),n.e(68349),n.e(96823),n.e(40722),n.e(90111)]).then(n.bind(n,36673)))),Ot=r()("isle:statusbar");function Zt(e){let t=(new Date).getTime()-e.startTime;return t=u()(t/6e4),t}function Mt(e){e.stopPropagation()}function Nt(e){const t=document.createElement("div");t.setAttribute("id","blackscreen");document.getElementById("Lesson").appendChild(t);const n=document.createElement("div");n.setAttribute("id","blackscreen-notice"),n.innerText=e,t.append(n)}class Pt extends s.Component{constructor(e,t){super(e),St(this,"closeSignup",(()=>{this.setState({visibleSignup:!1})})),St(this,"closeLogin",(()=>{this.setState({visibleLogin:!1})})),St(this,"closeLogout",(()=>{this.setState({visibleLogout:!1})})),St(this,"toggleBarVisibility",(e=>{e&&e.stopPropagation();const t=this.context;t.togglePresentationView(),Ot("Toggle visibility of statusbar..."),t.config.hideStatusBar||this.setState({showStatusBar:!this.state.showStatusBar})})),St(this,"toggleGroupManager",(e=>{e&&e.stopPropagation(),this.setState({showGroupManager:!this.state.showGroupManager})})),St(this,"toggleBlackScreen",(e=>{e&&e.stopPropagation(),Ot("Toggling blackout mode...");let t=document.getElementById("blackscreen");const n=this.context;t?(t.parentElement.removeChild(t),n.log({id:"statusbar",type:Ee.TN,value:!1},"members")):(Nt(n.isOwner()?this.props.t("blackout-intro-owner",{hotkey:"F8"}):this.props.t("blackout-intro-user")),n.log({id:"statusbar",type:Ee.TN,value:!0},"members"))})),St(this,"toggleBar",(()=>{this.state.hidden?((0,x.Z)(this.statusbar,"top",0,300),this.statusbar.style.opacity=1,this.setState({hidden:!1})):((0,x.Z)(this.statusbar,"top",-32,300),this.statusbar.style.opacity=.95,this.setState({hidden:!0}))})),St(this,"onMouseOver",(()=>{this.state.hidden&&(this.statusbar.style.opacity=1)})),St(this,"onMouseOut",(()=>{this.state.hidden&&(this.statusbar.style.opacity=.95)})),St(this,"login",(e=>{e.stopPropagation(),this.setState({visibleLogin:!0})})),St(this,"signup",(e=>{e.stopPropagation(),this.setState({visibleSignup:!0})})),St(this,"logout",(e=>{e.stopPropagation(),this.setState({visibleLogout:!0})})),St(this,"handleLogout",(()=>{this.context.logout(),this.closeLogout()})),St(this,"handleBarClick",(e=>{this.toggleBar()})),St(this,"handleBarKeyPress",(()=>{this.toggleBar()})),St(this,"toggleProgress",(()=>{const e=this.context;e.setProgress(),this.state.isProgressLeaving||e.isOwner()||(this.state.showProgressBar?this.progressTimeout=setTimeout((()=>{this.setState({showProgressBar:!1,isProgressLeaving:!1,duration:Zt(this.context)}),this.progressTimeout=null}),12e3):this.setState({showProgressBar:!0,duration:Zt(this.context)}))})),St(this,"jumpToUnfinished",(e=>{Ot("Jump to next unfinished question..."),e.stopPropagation();const t=this.context.unfinished;if(h()(t)){const e=t[0];if(e){const t=document.getElementById(e);if(!t)return;if((0,we.Z)(t)){const e=t.cloneNode(!0),n=document.createElement("div");n.id="unfinished-container",e.id="unfinished-elem",e.classList.add("focus-glow"),n.append(e),document.body.appendChild(n),setTimeout((()=>{const e=document.getElementById("unfinished-container");e&&e.parentNode.removeChild(e)}),4e3)}else t.classList.add("focus-glow"),t.scrollIntoView(),setTimeout((()=>{t.classList.remove("focus-glow")}),4e3)}}})),St(this,"preventPropagationForUsers",(e=>{this.context.anonymous||e.stopPropagation()})),this.state={visibleSignup:!1,visibleLogin:!1,visibleLogout:!1,showGroupManager:!1,showStatusBar:!t.config.hideStatusBar,showProgressBar:!1,isProgressLeaving:!1,progress:0,duration:"0",hidden:!0}}componentDidMount(){let e=!1;const{t:t}=this.props,n=()=>{const e=this.context;!E.Z&&this.state.showStatusBar&&e.addNotification({title:t("login"),message:t("please-connect-message"),level:"success",autoDismiss:e.config.noLoginDismiss?0:15,position:"tl",children:s.createElement("div",{style:{marginBottom:"30px"}},!1!==e.settings.allowUserRegistrations?s.createElement(a.Z,{id:"statusbar-signup-button",size:"sm",style:{float:"right",marginRight:"10px"},onClick:this.signup},t("signup")):null,s.createElement(a.Z,{id:"statusbar-login-button",size:"sm",variant:"primary",style:{float:"right",marginRight:"10px"},onClick:this.login},t("login"))),onAdd(){},onRemove(){}})},o=this.context;this.unsubscribe=o.subscribe(((t,s)=>{if(setTimeout((()=>{!e&&o.anonymous&&o.live&&(n(),e=!0)}),3e3),t===C.Gq)this.setState({progress:u()(100*Number(s))});else if(t===C.tf||t===C.Zh){const e={showProgressBar:!0,isProgressLeaving:!0};t===C.tf&&(e.progress=u()(100*Number(s))),this.setState(e),this.progressTimeout&&(clearTimeout(this.progressTimeout),this.progressTimeout=null),this.progressTimeout=setTimeout((()=>{this.setState({showProgressBar:!1,isProgressLeaving:!1,duration:Zt(o)}),this.progressTimeout=null}),4e3)}else if(t===C.SC||t===C.Fw||t===C.E7||t===C.OG||t===C.YQ)this.forceUpdate();else if(t===C.Wh&&s.type===Ee.TN&&s.email!==o.user.email)if(s.value)Nt(o.isOwner()?this.props.t("blackout-intro-owner",{hotkey:"F8"}):this.props.t("blackout-intro-user"));else{const e=document.getElementById("blackscreen");e&&e.parentElement.removeChild(e)}else t!==C.WF||this.state.showGroupManager?t===Ee.x$&&this.state.showGroupManager&&this.toggleGroupManager():this.toggleGroupManager()})),this.renderTextInterval=setInterval(this.renderRecordedText,1e3)}componentWillUnmount(){this.unsubscribe&&this.unsubscribe(),this.renderTextInterval&&clearInterval(this.renderTextInterval),this.progressTimeout&&clearTimeout(this.progressTimeout)}renderUpperBar(){if(this.state.hidden)return null;const{t:e}=this.props,t=this.context;return t.anonymous?s.createElement("div",null,s.createElement(a.Z,{size:"sm",className:"statusbar-button",variant:"outline-secondary",style:{position:"absolute",right:"-20px"},onClick:this.login,disabled:!t.live},e("login"))):s.createElement(s.Fragment,null,s.createElement("a",{href:t.server,target:"_blank",rel:"noopener noreferrer",id:"statusbar-dashboard-button",size:"sm",className:"statusbar-button",style:{float:"right",marginRight:"60px"}},e("goto-dashboard")),s.createElement(a.Z,{size:"sm",className:"statusbar-button",variant:"outline-secondary",style:{position:"absolute",right:"-20px"},onClick:this.logout},e("logout")))}render(){const e=this.context,{t:t}=this.props,n=100===this.state.progress,o=e.isOwner()||E.Z,r=e.user.picture,i=s.createElement(s.Fragment,null,r?s.createElement("img",{className:"statusbar-profile",alt:"User Profile Pic",src:r,onClick:Mt}):null,s.createElement(v.Z,{placement:"bottom",tooltip:t("time-spent-tooltip")},s.createElement("div",{className:"progress-time",onClick:Mt},s.createElement("i",{className:"fas fa-clock"})," ",this.state.duration," MIN"))),a=e.namespaceName+"-"+e.lessonName;return s.createElement(s.Fragment,null,s.createElement(ge,null),s.createElement(z,null),o?s.createElement(bt,{active:this.state.showGroupManager,onHide:this.toggleGroupManager}):s.createElement(yt,null),s.createElement("div",null,s.createElement("div",{className:"statusbar unselectable",role:"button",tabIndex:0,ref:e=>{this.statusbar=e},onClick:this.handleBarClick,onKeyPress:this.handleBarKeyPress,onMouseOver:this.onMouseOver,onFocus:this.onMouseOver,onMouseOut:this.onMouseOut,onBlur:this.onMouseOut,style:{top:"-32px",display:this.state.showStatusBar?null:"none"}},s.createElement(v.Z,{tooltip:this.state.hidden?t("click-to-expand"):t("click-to-collapse"),placement:"left"},s.createElement("div",{className:"statusbar-left"})),s.createElement("div",{className:"statusbar-middle"},s.createElement(Me,{session:this.context,t:t}),o?s.createElement(v.Z,{placement:"bottom",tooltip:`${t("presentation-mode-tooltip")} (F7)`},s.createElement("span",{role:"button",tabIndex:0,onClick:this.toggleBarVisibility,onKeyPress:this.toggleBarVisibility,className:"statusbar-presentation-mode statusbar-icon","aria-label":t("presentation-mode-label")},s.createElement("span",{className:"fa fa-xs fa-eye-slash"}))):null,o?s.createElement(v.Z,{placement:"bottom",tooltip:`${t("blackout-tooltip")} (F8)`},s.createElement("span",{role:"button",tabIndex:0,"aria-label":t("blackout-label"),onClick:this.toggleBlackScreen,onKeyPress:this.toggleBlackScreen,className:"statusbar-blackscreen-mode statusbar-icon"},s.createElement("span",{className:"fa fa-xs fa-stop"}))):null,o?s.createElement(v.Z,{placement:"bottom",tooltip:`${t("group-manager")} (G)`},s.createElement("span",{role:"button",tabIndex:0,"aria-label":t("group-manager"),onClick:this.toggleGroupManager,onKeyPress:this.toggleGroupManager,className:"statusbar-group-manager statusbar-icon"},s.createElement("span",{className:"fa fa-xs fa-user-friends"}))):null,e.cohort?s.createElement("div",{className:"statusbar-cohort"},e.cohort):null,s.createElement(v.Z,{placement:"bottom",tooltip:e.live?t("connection-active"):t("connection-broken")},s.createElement("div",{className:"statusbar-presence",style:{backgroundColor:e.live?"rgb(130, 224, 160)":"rgb(209, 107, 71)"}},s.createElement("div",{className:"statusbar-inner-presence"}))),s.createElement("div",{role:"button",tabIndex:0,style:{cursor:this.context.anonymous?"pointer":"help"},className:"statusbar-username",onClick:this.preventPropagationForUsers,onKeyPress:this.preventPropagationForUsers,onMouseEnter:this.toggleProgress,onFocus:this.toggleProgress,onMouseOut:this.toggleProgress,onBlur:this.toggleProgress,"aria-label":t("user-progress")},e.anonymous?`${t("anonymous")} ${e.anonymousIdentifier}`:e.user.name),e.config.hideVideoChat?null:s.createElement(_.Z,{for:a,buttonVariant:"link",buttonLabel:s.createElement("i",{className:"fa fa-xs fa-video"}),tooltipPlacement:"bottom",tooltip:t("video-chat"),className:"statusbar-icon statusbar-video-chat",onClick:Mt}),e.config.hideTextChat?null:s.createElement(k.Z,{for:a,buttonVariant:"link",anonymousSubmissions:!0,buttonLabel:s.createElement("i",{className:"fas fa-comments"}),tooltipPlacement:"bottom",tooltip:t("text-chat"),className:"statusbar-icon statusbar-text-chat",onClick:Mt}),this.renderUpperBar(),s.createElement("div",{className:"statusbar-text"},"ISLE")),s.createElement(v.Z,{tooltip:this.state.hidden?t("click-to-expand"):t("click-to-collapse"),placement:"right"},s.createElement("div",{className:"statusbar-right"})),s.createElement("div",{className:`statusbar-progress ${this.state.isProgressLeaving?"progress-fade-out":""} `,style:{display:!e.config.hideProgressBar&&this.state.showProgressBar?"inherit":"none"}},s.createElement(b.Z,{user:!0,banner:null},i,m()(e.responseVisualizers)?s.createElement("div",{className:"outer-statusbar-progress-bar"}):s.createElement(v.Z,{placement:"bottom",tooltip:t(n?"completed":"preview-unfinished"),show:h()(e.unfinished)},s.createElement("div",{className:"outer-statusbar-progress-bar"},s.createElement(l.Z,{label:`${t("completion-rate")}: ${this.state.progress}%`,variant:"success",now:this.state.progress,style:{animation:"anim-fade-in 0.7s",border:"solid 1px darkgrey"},onClick:this.jumpToUnfinished}))),s.createElement(kt,{t:t})))),this.state.showStatusBar||!o&&!E.Z||this.context.config.hideStatusBar?null:s.createElement(v.Z,{placement:"bottom",tooltip:`${t("presentation-mode-exit")} (F7)`},s.createElement("span",{className:"statusbar-presentation-mode-lone-icon",role:"button",tabIndex:0,onClick:this.toggleBarVisibility,onKeyPress:this.toggleBarVisibility},s.createElement("span",{className:"fa fa-xs fa-eye-slash"})))),s.createElement(s.Suspense,{fallback:null},s.createElement(b.Z,{owner:!0,banner:null,showOwnerInPresentationMode:!1},s.createElement(Ct,null))),this.state.visibleLogin?s.createElement(g.Z,{show:this.state.visibleLogin,onClose:this.closeLogin,onShowSignup:this.signup}):null,this.state.visibleSignup?s.createElement(f.Z,{show:this.state.visibleSignup,onClose:this.closeSignup}):null,this.state.visibleLogout?s.createElement(ye,{show:this.state.visibleLogout,close:this.closeLogout,title:t("logout"),message:t("confirm-logout"),onConfirm:this.handleLogout,t:t}):null,s.createElement(y.Z,{actions:{F7:this.toggleBarVisibility,F8:this.toggleBlackScreen,g:this.toggleGroupManager}}),n&&!e.config.hideProgressBar?s.createElement(w.Z,{title:"100%",upper:t("congratulations"),lower:t("lesson-completed"),upperArc:120,lowerArc:120,noOrnaments:!0,removable:!0,style:{position:"fixed",right:"0px",bottom:"5%",transform:`rotate(-17deg) scale(${window.innerWidth/1920})`,transformOrigin:"100% 100%",animation:"anim-fade-in 1s forwards",background:"linear-gradient(to right, white, silver, white)",fontFamily:"Courier",zIndex:1002},innerStyle:{background:"linear-gradient(to right, ghostwhite, #ffc107, ghostwhite, #ffc107, silver)"}}):null)}}Pt.contextType=S.Z;var Tt=(0,i.Z)("internal/statusbar")(Pt)},727187:function(e,t,n){const s=(0,n(217431).Z)((()=>n.e(12273).then(n.bind(n,276235))));t.Z=s},734622:function(e,t){t.Z=function(e,t,n,s){if(!e.selection||!e.doc||!n)return e;const{empty:o,$cursor:r,ranges:i}=e.selection;if(o&&!r||!function(e,t,n){for(let s=0;s<t.length;s++){const{$from:o,$to:r}=t[s];let i=0===o.depth&&e.type.allowsMarkType(n);if(e.nodesBetween(o.pos,r.pos,(e=>!i&&(i=e.inlineContent&&e.type.allowsMarkType(n),!0))),i)return!0}return!1}(e.doc,i,n))return e;if(r)return e=e.removeStoredMark(n),s?e.addStoredMark(n.create(s)):e;let a=!1;for(let l=0;!a&&l<i.length;l++){const{$from:t,$to:s}=i[l];a=e.doc.rangeHasMark(t.pos,s.pos,n)}for(let l=0;l<i.length;l++){const{$from:t,$to:o}=i[l];a&&(e=e.removeMark(t.pos,o.pos,n)),s&&(e=e.addMark(t.pos,o.pos,n.create(s)))}return e}},193450:function(e,t,n){n.d(t,{wM:function(){return i},yz:function(){return r}});var s=n(627191);const o=new s.H$("cursor-parking");t.ZP=()=>new s.Sy({key:o,state:{init:()=>({inCursorParking:!1,storedMarks:null,bookmarkToRestore:null,pos:null}),apply(e,t){const n=e.getMeta(this);return n?n.inCursorParking?{inCursorParking:!0,pos:n.pos,storedMarks:e.storedMarks,bookmarkToRestore:e.selection.getBookmark()}:{inCursorParking:!1,pos:n.pos,storedMarks:null,bookmarkToRestore:null}:e.docChanged&&t.inCursorParking&&t.bookmarkToRestore?{inCursorParking:!0,pos:null,storedMarks:t.storedMarks,bookmarkToRestore:t.bookmarkToRestore.map(e.mapping)}:t}},view(){const e=document.createElement("cursor-parking");e.setAttribute("style","width:0px;height:0px;position:fixed;top:50%,left:50%;"),e.setAttribute("tabIndex","-1"),e.setAttribute("contenteditable","true");const t=()=>{e.innerHTML="<div><br/></div>"};return t(),document.body.appendChild(e),{update(n,r){const i=o.getState(r),a=o.getState(n.state);if(!i.inCursorParking&&a.inCursorParking&&(()=>{const t=document.createRange();t.selectNodeContents(e.firstChild);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)})(),i.inCursorParking&&!a.inCursorParking){const{dispatch:e,state:o}=n;let r=o.tr;if(i.bookmarkToRestore&&r.setSelection(i.bookmarkToRestore.resolve(r.doc)),i.storedMarks&&r.setStoredMarks(i.storedMarks),n.focus(),a.pos){const e=a.pos;r=r.setSelection(s.Bs.create(r.doc,e,e))}else e(r);t()}},destroy(){e.parentNode.removeChild(e)}}}});const r=(e,t)=>{return n=void 0,s=null,r=function*(){e.dispatch(e.state.tr.setMeta(o,{inCursorParking:!0,pos:t})),yield new Promise((e=>setTimeout(e,0))),e.dispatch(e.state.tr.setMeta(o,{inCursorParking:!1,pos:t}))},new Promise(((e,t)=>{var o=e=>{try{a(r.next(e))}catch(n){t(n)}},i=e=>{try{a(r.throw(e))}catch(n){t(n)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(o,i);a((r=r.apply(n,s)).next())}));var n,s,r},i=e=>{e.dispatch(e.state.tr.setMeta(o,{inCursorParking:!1,storedMarks:null,bookmarkToRestore:null,pos:null}))}},241490:function(e,t,n){n.d(t,{NV:function(){return d},ud:function(){return h}});var s=n(627191),o=n(952780);const r={name:"CursorPlaceholderPlugin"};let i=null;const a={state:{init:()=>o.EH.empty,apply(e,t){t=t.map(e.mapping,e.doc);const n=e.getMeta(this);if(!n)return t;if(n.add){const s=document.createElement("editor-cursor-placeholder");s.className="editor-cursor-placeholder";const i=o.p.widget(n.add.pos,s,{id:r});t=t.add(e.doc,[i])}else if(n.remove){const e=t.find(null,null,c);t=t.remove(e)}return t}},props:{decorations:e=>i?i.getState(e):null}};class l extends s.Sy{constructor(){if(super(a),i)return i;i=this}}function c(e){return e.id===r}function u(e){if(!i)return null;const t=i.getState(e).find(null,null,c);return(t.length?t[0].from:null)||null}function d(e){const t=i;let{tr:n}=e;if(!t||!n.selection)return n;return null===u(e)&&(n.selection.empty||(n=n.deleteSelection()),n=n.setMeta(t,{add:{pos:n.selection.from}})),n}function h(e){const t=i;let{tr:n}=e;if(!t)return n;return null!==u(e)&&(n=n.setMeta(t,{remove:{}})),n}t.ZP=l},840322:function(e,t,n){function s(e,t,n,s){let o=t;const r=e=>e.type===s;let i=null,a=null,l=null;for(;o<=n;){const t=e.nodeAt(o);if(!t||!t.marks)return null;const n=t.marks.find(r);if(!n)return null;if(i&&n!==i)return null;a=a||t,i=i||n,l=t,o++}let c=t,u=n,d=0;for(o=t-1;o>d;){const t=e.nodeAt(o),n=t&&t.marks.find(r);if(!n||n!==i)break;c=o,a=t,o--}for(o=n+1,d=e.nodeSize-2;o<d;){const t=e.nodeAt(o),n=t&&t.marks.find(r);if(!n||n!==i)break;u=o,l=t,o++}return{mark:i,from:{node:a,pos:c},to:{node:l,pos:u}}}n.d(t,{Z:function(){return s}})},812128:function(e,t,n){var s=n(202784);const o={alignLeft:s.createElement("i",{className:"prosemirror-icon fas fa-align-left"}),alignCenter:s.createElement("i",{className:"prosemirror-icon fas fa-align-center"}),alignRight:s.createElement("i",{className:"prosemirror-icon fas fa-align-right"}),alignJustify:s.createElement("i",{className:"prosemirror-icon fas fa-align-justify"}),annotation:s.createElement("i",{className:"prosemirror-icon fas fa-comment"}),blockquote:s.createElement("i",{className:"prosemirror-icon fas fa-quote-left"}),bold:s.createElement("i",{className:"prosemirror-icon fas fa-bold"}),bullet_list:s.createElement("i",{className:"prosemirror-icon fas fa-list-ul"}),code_block:s.createElement("i",{className:"prosemirror-icon fas fa-file-code"}),code:s.createElement("i",{className:"prosemirror-icon fas fa-code"}),color:s.createElement("i",{className:"prosemirror-icon fas fa-palette"}),editTable:s.createElement("i",{className:"prosemirror-icon fas fa-table"}),em:s.createElement("i",{className:"prosemirror-icon fas fa-italic"}),error:s.createElement("i",{className:"prosemirror-icon fas fa-bug"}),fullscreen:s.createElement("i",{className:"prosemirror-icon fas fa-expand"}),guides:s.createElement("i",{className:"prosemirror-icon fa fa-question-circle"}),history:s.createElement("i",{className:"prosemirror-icon fas fa-history"}),insert:s.createElement("i",{className:"prosemirror-icon fa fa-plus-square"}),link:s.createElement("i",{className:"prosemirror-icon fa fa-link"}),open:s.createElement("i",{className:"prosemirror-icon fa fa-folder-open"}),ordered_list:s.createElement("i",{className:"prosemirror-icon fas fa-list-ol"}),paragraph:s.createElement("i",{className:"prosemirror-icon fas fa-paragraph"}),pdf:s.createElement("i",{className:"prosemirror-icon fas fa-file-pdf"}),redo:s.createElement("i",{className:"prosemirror-icon fas fa-redo"}),reset:s.createElement("i",{className:"prosemirror-icon fa fa-eraser"}),save:s.createElement("i",{className:"prosemirror-icon fa fa-save"}),selectParent:s.createElement("i",{className:"prosemirror-icon far fa-object-group"}),strikethrough:s.createElement("i",{className:"prosemirror-icon fas fa-strikethrough"}),strong:s.createElement("i",{className:"prosemirror-icon fas fa-bold"}),submit:s.createElement("i",{className:"prosemirror-icon fa fa-share-square"}),subscript:s.createElement("i",{className:"prosemirror-icon fas fa-subscript"}),table:s.createElement("i",{className:"prosemirror-icon fas fa-table"}),superscript:s.createElement("i",{className:"prosemirror-icon fas fa-superscript"}),underline:s.createElement("i",{className:"prosemirror-icon fas fa-underline"}),undo:s.createElement("i",{className:"prosemirror-icon fas fa-undo"})};t.Z=o},859067:function(e,t,n){n.d(t,{q:function(){return m}});var s=n(627191),o=n(952780),r=n(409961),i=n.n(r),a=n(365601),l=n(19789);const c=(0,a.Z)("image_upload"),u=new Set(["image/jpeg","image/gif","image/png","image/jpg"]),d=new Array(4).join('<div class="editor-image-upload-placeholder-child"></div>');function h(e){return e instanceof f}function p(e){return e&&u.has(e.type)}function m(e,t,o){const{state:r,readOnly:a,disabled:u}=e,{schema:d,plugins:m}=r;if(a||u)return!1;const f=d.nodes.image;if(!f)return!1;const g=Array.from(t).filter(p);if(!g.length)return!1;const b=m.find(h);if(!b)return!1;const v={debugId:c()},y=(w=()=>{const t=t=>{const n=function(e,t,n){const s=e.getState(t).find(null,null,(e=>e.id===n));return s.length?s[0].from:null}(b,e.state,v);let s=e.state.tr;if(!n||e.readOnly||e.disabled)g.length=0;else{const e=f.create(t);s=s.replaceWith(n,n,e)}g.length?y():s=s.setMeta(b,{remove:{id:v}}),e.dispatch(s)},s=g.shift();if(i()(s))throw new Error("unexpected null value");const o=n.g.session;if(o.server&&o.uploadFile){const e=new FormData;e.append("file",s),o.uploadFile({formData:e,callback:(e,n)=>e?t({src:null}):n&&n.filename?t({src:o.server+"/"+n.filename}):t({src:null}),showNotification:!1})}else(0,l.Z)(s).then(t).catch(t.bind(null,{src:null}))},()=>{setTimeout(w,0)});var w;y();let{tr:E}=r,_=0;if(o){const t=e.posAtCoords({left:o.x,top:o.y});if(!t)return!1;_=t.pos,E=E.setSelection(s.Bs.create(E.doc,_,_))}else _=E.selection.to,E=E.setSelection(s.Bs.create(E.doc,_,_));const k={add:{id:v,pos:_}};return E=E.setMeta(b,k),e.dispatch(E),!0}class f extends s.Sy{constructor(){super({state:{init:()=>o.EH.empty,apply(e,t){t=t.map(e.mapping,e.doc);const n=e.getMeta(this);if(n&&n.add){const s=document.createElement("div");s.title="Uploading...",s.className="editor-image-upload-placeholder",s.innerHTML=d;const r=o.p.widget(n.add.pos,s,{id:n.add.id});t=t.add(e.doc,[r])}else if(n&&n.remove){const e=e=>e.id===n.remove.id;t=t.remove(t.find(null,null,e))}return t}},props:{decorations(e){return this.getState(e)}}})}}t.Z=f},450980:function(e,t,n){var s=n(627191);t.Z=function(e,t){const{selection:n,schema:o,tr:r}=e;if(!o.marks[t])return!1;if(!(n instanceof s.Bs||n instanceof s.C1))return!1;const{from:i,to:a}=e.selection;if(a===i+1){const e=r.doc.nodeAt(i);if(e.isAtom&&!e.isText&&e.isLeaf)return!1}return!0}},289846:function(e,t,n){n.d(t,{ZP:function(){return Qe},$T:function(){return Je},EI:function(){return $e},Uy:function(){return Ke}});var s=n(760737),o=n(141396),r=n(627191),i=n(951801),a=n(371405),l=n(732357),c=n(812128),u=n(922032);var d=e=>t=>{const{$from:n}=t.selection;for(let s=n.depth;s>=0;s--){const t=n.index(s);if(n.node(s).canReplaceWith(t,t,e))return!0}return!1},h=n(994643),p=n(734622),m=n(78708),f=n(450980),g=n(676065),b=n.n(g),v=n(552212),y=n(840322),w=n(346527),E=n(894778),_=n(562415),k=Object.defineProperty,x=(e,t,n)=>(((e,t,n)=>{t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class S extends E.Z{constructor(){super(...arguments),x(this,"_popUp",null),x(this,"title","apply-link"),x(this,"content",c.Z.link),x(this,"enable",(e=>{if(!(e.selection instanceof r.Bs))return!1;if(!e.schema.marks.link)return!1;const{from:t,to:n}=e.selection;return t<n})),x(this,"waitForUserInput",((e,t,n,s)=>{if(this._popUp)return Promise.resolve(void 0);t&&t((0,v.tk)(e));const{doc:o,schema:r,selection:i}=e,a=r.marks.link;if(!a)return Promise.resolve(void 0);const{from:l,to:c}=i,u=(0,y.Z)(o,l,c,a),d=u?u.mark.attrs.href:null;return new Promise((e=>{this._popUp=(0,_.Z)(w.Z,{href:d},{modal:!0,onClose:t=>{this._popUp&&(this._popUp=null,e(t))}})}))})),x(this,"executeWithUserInput",((e,t,n,s)=>{if(t){const{selection:o,schema:r}=e;let{tr:i}=e;if(i=n?(0,v.be)(n.state):i,i=i.setSelection(o),!b()(s)){const t=r.marks.link,n=s?{href:s}:null;i=(0,p.Z)(i.setSelection(e.selection),r,t,n)}t(i)}return n&&n.focus(),!0}))}}var C=S,O=n(130764),Z=n(241490),M=Object.defineProperty,N=(e,t,n)=>(((e,t,n)=>{t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class P extends E.Z{constructor(){super(...arguments),N(this,"_popUp",null),N(this,"enable",((e,t)=>this.__isEnabled(e,t))),N(this,"waitForUserInput",((e,t,n,s)=>this._popUp?Promise.resolve(void 0):(t&&t((0,Z.NV)(e)),new Promise((e=>{const t={runtime:n?n.runtime:null};this._popUp=(0,_.Z)(this.getEditor(),t,{modal:!0,onClose:t=>{this._popUp&&(this._popUp=null,e(t))}})}))))),N(this,"executeWithUserInput",((e,t,n,s)=>{if(t){const{selection:o,schema:r}=e;let{tr:i}=e;if(i=n?(0,Z.ud)(n.state):i,i=i.setSelection(o),s){const{src:e}=s;i=function(e,t,n){const{selection:s}=e;if(!s)return e;const{from:o,to:r}=s;if(o!==r)return e;const i=t.nodes.image;if(!i)return e;const a={src:n||"",alt:"",title:""},l=i.create(a,null,null),c=O.HY.from(l);return e.insert(o,c)}(i,r,e)}t(i),n&&n.focus()}return!1})),N(this,"__isEnabled",((e,t)=>{const n=e,{selection:s}=n;return s instanceof r.Bs&&s.from===s.to}))}}var T=P,D=n(202784),I=n(922730),A=n(513014),j=n(816092),z=n(978491),R=Object.defineProperty,L=Object.defineProperties,B=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable,$=(e,t,n)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,H=(e,t,n)=>($(e,"symbol"!=typeof t?t+"":t,n),n);class W extends D.PureComponent{constructor(e){var t;super(e),H(this,"_onSrcChange",(e=>{const t=e.target.value;this.setState({src:t,validValue:null},this._didSrcChange)})),H(this,"_didSrcChange",(()=>{(0,z.Z)(this.state.src).then((e=>{if(this.state.src===e.src&&!this._unmounted){const t=e.complete?e:null;this.setState({validValue:t})}}))})),H(this,"_cancel",(()=>{this.props.close()})),H(this,"_insert",(()=>{const{validValue:e}=this.state;this.props.close(e)})),this._img=null,this._unmounted=!1,this.state=(t=((e,t)=>{for(var n in t||(t={}))V.call(t,n)&&$(e,n,t[n]);if(U)for(var n of U(t))F.call(t,n)&&$(e,n,t[n]);return e})({},this.props.initialValue||{}),L(t,B({validValue:null})))}componentWillUnmount(){this._unmounted=!0}render(){const{src:e,validValue:t}=this.state,n=t?D.createElement("div",{className:"editor-image-url-editor-input-preview",style:{backgroundImage:`url(${String(t.src)}`}}):null;return D.createElement("div",{className:"editor-image-url-editor"},D.createElement("form",{className:"editor-form",onSubmit:j.Z},D.createElement("fieldset",null,D.createElement("legend",null,I.a.t("text-editor:insert-image")),D.createElement("div",{className:"editor-image-url-editor-src-input-row"},D.createElement("input",{autoFocus:!0,className:"editor-image-url-editor-src-input",onChange:this._onSrcChange,placeholder:"Paste URL of Image...",type:"text",value:e||""}),n),D.createElement("em",null,I.a.t("text-editor:require-license"))),D.createElement("div",{className:"editor-form-buttons"},D.createElement(A.Z,{label:I.a.t("text-editor:cancel"),onClick:this._cancel}),D.createElement(A.Z,{active:!!t,disabled:!t,label:I.a.t("text-editor:insert"),onClick:this._insert}))))}}var G=W,K=Object.defineProperty,q=(e,t,n)=>(((e,t,n)=>{t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);var J=class extends T{constructor(){super(...arguments),q(this,"title","insert-image-url"),q(this,"content","insert-image-url")}getEditor(){return G}},Y=n(72779),X=n.n(Y),Q=n(294325),ee=n(365601),te=n(19789),ne=Object.defineProperty,se=(e,t,n)=>(((e,t,n)=>{t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const oe=(0,ee.Z)("image-upload-editor");class re extends D.PureComponent{constructor(e){super(e),se(this,"_onSelectFile",(e=>{const t=e.target.files&&e.target.files[0];t&&"object"==typeof t&&this._upload(t)})),se(this,"_onSuccess",(e=>{this._unmounted||this.props.close(e)})),se(this,"_onError",(e=>{this._unmounted||this.setState({error:e,id:oe(),pending:!1})})),se(this,"_upload",(e=>{this.setState({pending:!0,error:null});const t=n.g.session;if(t.server&&t.uploadFile){const n=new FormData;n.append("file",e),t.uploadFile({formData:n,callback:(e,n)=>e?this._onError(e):n&&n.filename?this._onSuccess({src:t.server+"/"+n.filename}):this._onSuccess({src:null}),showNotification:!1})}else(0,te.Z)(e).then((e=>{this._onSuccess(e)})).catch((e=>{this._onError(e)}))})),se(this,"_cancel",(()=>{this.props.close()})),this._img=null,this._unmounted=!1,this.state={error:null,id:oe(),pending:!1}}componentWillUnmount(){this._unmounted=!0}render(){const{id:e,error:t,pending:n}=this.state,s=X()("editor-image-upload-editor",{pending:n,error:t});let o=I.a.t("text-editor:choose-an-image-file");return n?o=D.createElement(Q.Z,{animation:"border",role:"status"}):t&&(o=I.a.t("text-editor:error-while-uploading")),D.createElement("div",{className:s},D.createElement("form",{className:"editor-form"},D.createElement("fieldset",null,D.createElement("legend",null,I.a.t("text-editor:upload-image")),D.createElement("div",{className:"editor-image-upload-editor-body"},D.createElement("div",{className:"editor-image-upload-editor-label"},o),D.createElement("input",{accept:"image/png,image/gif,image/jpeg,image/jpg",className:"editor-image-upload-editor-input",disabled:n,id:e,key:e,onChange:this._onSelectFile,type:"file"}))),D.createElement("div",{className:"editor-form-buttons"},D.createElement(A.Z,{label:I.a.t("text-editor:cancel"),onClick:this._cancel}))))}}var ie=re,ae=Object.defineProperty,le=(e,t,n)=>(((e,t,n)=>{t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);var ce=class extends T{constructor(){super(...arguments),le(this,"title","upload-image"),le(this,"content","upload-image")}getEditor(){return ie}},ue=n(57444),de=n(928316),he=n(306830),pe=n.n(he),me=n(877119),fe=n.n(me),ge=n(686605),be=n.n(ge),ve=n(521536),ye=n.n(ve),we=n(557106),Ee=n.n(we),_e=n(783158),ke=n.n(_e),xe=n(452626),Se=Object.defineProperty,Ce=(e,t,n)=>(((e,t,n)=>{t in e?Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Oe=16;class Ze extends D.PureComponent{render(){const{x:e,y:t,selected:n}=this.props,s={left:e+"px",top:t+"px",width:"16px",height:"16px"},o=X()("editor-table-grid-size-editor-cell",{selected:n});return D.createElement("div",{className:o,style:s})}}class Me extends D.PureComponent{constructor(e){super(e),Ce(this,"_onRef",(e=>{this._ref=e})),Ce(this,"_onMouseEnter",(e=>{const t=e.currentTarget;if(t instanceof HTMLElement){const n=(0,xe.hs)(t),s=be()(e.clientX),o=be()(e.clientY);this._ex=n.x,this._ey=n.y,this._mx=s,this._my=o,this._entered||(this._entered=!0,document.addEventListener("mousemove",this._onMouseMove,!0))}})),Ce(this,"_onMouseMove",(e=>{const t=this._ref&&de.findDOMNode(this._ref),n=t?function(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top,w:t.width,h:t.height}}(t):null,s=(0,xe.mv)(e.screenX,e.screenY,10);n&&s&&(0,xe.vY)(n,s,50)&&(e.preventDefault(),e.stopImmediatePropagation());const o=be()(e.clientX),r=be()(e.clientY);o===this._mx&&r===this._my||(this._mx=o,this._my=r,this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._updateGridSize))})),Ce(this,"_updateGridSize",(()=>{this._rafID=0;const e=this._mx,t=this._my,n=e-this._ex,s=t-this._ey,o=fe()(ye()(s/21),1,20),r=fe()(ye()(n/21),1,20),{rows:i,cols:a}=this.state;i===o&&a===r||this.setState({rows:o,cols:r})})),Ce(this,"_onMouseDown",(e=>{e.preventDefault(),this.props.close(this.state)})),this._ex=0,this._ey=0,this._mx=0,this._my=0,this._rafID=0,this._ref=null,this._entered=!1,this.state={rows:1,cols:1}}componentWillUnmount(){this._entered&&document.removeEventListener("mousemove",this._onMouseMove,!0),this._rafID&&cancelAnimationFrame(this._rafID)}render(){const{rows:e,cols:t}=this.state;let n=Ee()(5,e),s=Ee()(5,t);n===e&&(n=ke()(20,n+1)),s===t&&(s=ke()(20,s+1));const o=[];let r=0,i=0,a=0,l=0;for(;r<n;){i+=5;let n=0,c=0;for(;n<s;){c+=5;const s=r<e&&n<t;o.push(D.createElement(Ze,{key:`${String(r)}-${String(n)}`,selected:s,x:c,y:i})),c+=Oe,a=c+5,n++}i+=Oe,l=i+5,r++}const c={width:a+"px",height:l+"px"};return D.createElement("div",{className:"editor-table-grid-size-editor",ref:this._onRef},D.createElement("div",{className:"editor-table-grid-size-editor-body",onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter,style:c,role:"button",tabIndex:0},o),D.createElement("div",{className:"editor-table-grid-size-editor-footer"},D.createElement("b",null,e)," ",D.createElement("i",{className:"fa fa-times"})," ",D.createElement("b",null,t)))}}Me.defaultProps={close:pe()};var Ne=Me,Pe=n(871199),Te=n.n(Pe),De=Object.defineProperty,Ie=(e,t,n)=>(((e,t,n)=>{t in e?De(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class Ae extends E.Z{constructor(){super(...arguments),Ie(this,"_popUp",null),Ie(this,"title","insert-table"),Ie(this,"content","insert-table"),Ie(this,"enable",(e=>{const t=e,{selection:n}=t;return n instanceof r.Bs&&n.from===n.to})),Ie(this,"waitForUserInput",((e,t,n,s)=>{if(this._popUp)return Promise.resolve(void 0);if(!(function(e){if(!Te()(e))return e;const t=new Error("Received unexpected "+e);throw t.framesToPop=1,t}(s).target instanceof HTMLElement))return Promise.resolve(void 0);const o=s?s.target.parentElement.parentElement:null;return new Promise((e=>{this._popUp=(0,_.Z)(Ne,null,{anchor:o,position:ue.SC,onClose:t=>{this._popUp&&(this._popUp=null,e(t))}})}))})),Ie(this,"executeWithUserInput",((e,t,n,s)=>{if(t){const{schema:n}=e;if(s){let{rows:o,cols:r}=s;const i=[];for(;r--;)i.push(n.nodes.table_cell.createAndFill());const a=[];for(;o--;)a.push(n.nodes.table_row.createAndFill(void 0,i));const l=n.nodes.table.createAndFill(void 0,a);t(e.tr.replaceSelectionWith(l))}}return!1}))}}var je=Ae;const ze=e=>{const{selection:t}=e;return t instanceof r.Bs||t instanceof r.C1},Re=e=>{const t=e,{selection:n}=t;return n instanceof r.Bs&&n.from===n.to},Le=e=>t=>{const{from:n,$from:s,to:o,empty:r}=t.selection;return r?!!e.isInSet(t.storedMarks||s.marks()):!!t.doc.rangeHasMark(n,o,e)},Be=(e,t={})=>n=>{const{$from:s,to:o,node:r}=n.selection;return r?r.hasMarkup(e,t):o<=s.end()&&s.parent.hasMarkup(e,t)},Ue=e=>(t,n)=>{const{schema:s,selection:o}=t,r=((e,t,n)=>{const s=t.marks.fontSize;if(!s)return e;const o=n?{pt:n}:null;return(0,p.Z)(e,t,s,o)})(t.tr.setSelection(o),s,e);return!(!r.docChanged&&!r.storedMarksSet)&&(!n||n(r))},Ve=e=>(0,f.Z)(e,"fontSize"),Fe=e=>t=>{const n=t.schema.nodes.heading;let s;return s=n?(0,o.Tr)(n)(t.selection):t.selection,s&&s.node&&s.node.attrs&&s.node.attrs.level===e},$e=[{title:"strong",content:c.Z.strong,enable:ze,active:Le(u.Z.marks.strong),run:(0,s.w9)(u.Z.marks.strong),hotkey:"Ctrl+B"},{title:"emphasis",content:c.Z.em,enable:ze,active:Le(u.Z.marks.em),run:(0,s.w9)(u.Z.marks.em),hotkey:"Ctrl+I"},new C],He=[{title:"underline",content:c.Z.underline,enable:ze,active:Le(u.Z.marks.underline),run:(0,s.w9)(u.Z.marks.underline),hotkey:"Ctrl+U"},{title:"strikethrough",content:c.Z.strikethrough,enable:ze,active:Le(u.Z.marks.strikethrough),run:(0,s.w9)(u.Z.marks.strikethrough),hotkey:"Ctrl+S"},{title:"code",content:c.Z.code,enable:ze,active:Le(u.Z.marks.code),run:(0,s.w9)(u.Z.marks.code),hotkey:"Ctrl+M"},{title:"subscript",content:c.Z.subscript,enable:ze,active:Le(u.Z.marks.subscript),run:(0,s.w9)(u.Z.marks.subscript),hotkey:"Ctrl+L"},{title:"superscript",content:c.Z.superscript,enable:ze,active:Le(u.Z.marks.superscript),run:(0,s.w9)(u.Z.marks.superscript),hotkey:"Ctrl+P"}],We=[{title:"change-paragraph",content:c.Z.paragraph,active:Be(u.Z.nodes.paragraph),enable:(0,s.uJ)(u.Z.nodes.paragraph),run:(0,s.uJ)(u.Z.nodes.paragraph)},{title:"change-heading-1",content:"H1",active:Fe(1),enable:(0,s.uJ)(u.Z.nodes.heading,{level:1}),run:(0,s.uJ)(u.Z.nodes.heading,{level:1}),hotkey:"Shift+Ctrl+1"},{title:"change-heading-2",content:"H2",active:Fe(2),enable:(0,s.uJ)(u.Z.nodes.heading,{level:2}),run:(0,s.uJ)(u.Z.nodes.heading,{level:2}),hotkey:"Shift+Ctrl+2"}],Ge=[{title:"change-heading-3",content:"Heading 3",enable:(0,s.uJ)(u.Z.nodes.heading,{level:3}),run:(0,s.uJ)(u.Z.nodes.heading,{level:3}),hotkey:"Shift+Ctrl+3"},{title:"change-heading-4",content:"Heading 4",enable:(0,s.uJ)(u.Z.nodes.heading,{level:4}),run:(0,s.uJ)(u.Z.nodes.heading,{level:4}),hotkey:"Shift+Ctrl+4"},{title:"change-heading-5",content:"Heading 5",enable:(0,s.uJ)(u.Z.nodes.heading,{level:5}),run:(0,s.uJ)(u.Z.nodes.heading,{level:5}),hotkey:"Shift+Ctrl+5"}],Ke=[{title:"wrap-block-quote",content:c.Z.blockquote,active:Be(u.Z.nodes.blockquote),enable:(0,s.ym)(u.Z.nodes.blockquote),run:(0,s.ym)(u.Z.nodes.blockquote),hotkey:"Ctrl+>"},{title:"wrap-bullet-list",content:c.Z.bullet_list,active:Be(u.Z.nodes.bullet_list),enable:(0,a.KI)(u.Z.nodes.bullet_list),run:(0,a.KI)(u.Z.nodes.bullet_list),hotkey:"Shift+Ctrl+8"},{title:"wrap-ordered-list",content:c.Z.ordered_list,active:Be(u.Z.nodes.ordered_list),enable:(0,a.KI)(u.Z.nodes.ordered_list),run:(0,a.KI)(u.Z.nodes.ordered_list),hotkey:"Shift+Ctrl+9"}],qe=[{title:"lift-out-enclosing",content:"lift-out-enclosing",enable:s.xb,run:s.xb},{title:"join-with-above",content:"join-with-above",enable:s.MI,run:s.MI},{title:"join-with-below",content:"join-with-below",enable:s.Ig,run:s.Ig}],Je=[new J,new ce,{title:"insert-footnote",content:"insert-footnote",enable:d(u.Z.nodes.footnote),run:(e,t)=>{const n=u.Z.nodes.footnote.create();t(e.tr.replaceSelectionWith(n))}},{title:"insert-figure-caption",content:"insert-figure-caption",enable:Re,run:(e,t)=>{const n=u.Z.nodes.figureCaption.create();t(e.tr.replaceSelectionWith(n))}},{title:"insert-table-caption",content:"insert-table-caption",enable:Re,run:(e,t)=>{const n=u.Z.nodes.tableCaption.create();t(e.tr.replaceSelectionWith(n))}},{title:"insert-code-block",content:"insert-code-block",enable:d(u.Z.nodes.code_block),run:(e,t)=>{const n=u.Z.nodes.code_block.create();t(e.tr.replaceSelectionWith(n))}}],Ye=[{title:"undo-last-change",content:c.Z.undo,enable:i.Yw,run:i.Yw,hotkey:"Ctrl+Z"},{title:"redo-last-undone-change",content:c.Z.redo,enable:i.KX,run:i.KX,hotkey:"Ctrl+Y"},{title:"select-parent-node",content:c.Z.selectParent,run:s.N0,select:e=>(0,s.N0)(e),hotkey:"Escape"}],Xe=[new je,{title:"insert-column-before",content:"insert-column-before",run:l.I_},{title:"insert-column-after",content:"insert-column-after",run:l.e2},{title:"insert-row-before",content:"insert-row-before",run:l.z2},{title:"insert-row-after",content:"insert-row-after",run:l.dl},{title:"delete-column",content:"delete-column",run:l.eA},{title:"delete-row",content:"delete-row",run:l.qK},{title:"merge-cells",content:"merge-cells",run:l.JX},{title:"split-cells",content:"split-cells",run:l.Cr},{title:"toggle-header-column",content:"toggle-header-column",run:l.sr},{title:"toggle-header-row",content:"toggle-header-row",run:l.lm},{title:"delete-table",content:"delete-table",run:l.WQ}];var Qe={marks:$e,extraMarks:He,blocks:We,headers:Ge,alignment:h.ZP,wraps:Ke,fontSizes:m.map((e=>({title:String(e),content:String(e),run:Ue(e),enable:Ve}))),actions:qe,insert:Je,history:Ye,tableEdits:Xe}},690202:function(e,t,n){n.d(t,{Z:function(){return he}});var s=n(580722),o=n(203027),r=n(951801),i=n(732357),a=n(627191),l=n(676065),c=n.n(l),u=n(552212),d=n(734622),h=n(840322);var p=function(e,t){for(;e&&e.nodeName;){if(t(e))return e;e=e.parentElement}return null},m=n(202784),f=n(175676),g=n(768466),b=n(513014),v=Object.defineProperty,y=(e,t,n)=>(((e,t,n)=>{t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class w extends m.PureComponent{constructor(){super(...arguments),y(this,"_openLink",(e=>{if(e&&0===e.indexOf("#")){const t=e.substr(1),n=document.getElementById(t);if(n){const{onCancel:e,editorView:t}=this.props;e(t),(()=>{return e=this,t=null,s=function*(){yield(0,f.Z)(n,{scrollMode:"if-needed",behavior:"smooth"})},new Promise(((n,o)=>{var r=e=>{try{a(s.next(e))}catch(t){o(t)}},i=e=>{try{a(s.throw(e))}catch(t){o(t)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,i);a((s=s.apply(e,t)).next())}));var e,t,s})()}}else e&&window.open((0,g.Z)(e))}))}render(){const{href:e,editorView:t,onEdit:n,onRemove:s}=this.props;return m.createElement("div",{className:"editor-link-tooltip"},m.createElement("div",{className:"editor-link-tooltip-body"},m.createElement("div",{className:"editor-link-tooltip-row"},m.createElement(b.Z,{className:"editor-link-tooltip-href",label:e,onClick:this._openLink,target:"new",title:e,value:e}),m.createElement(b.Z,{label:"Change",onClick:n,value:t}),m.createElement(b.Z,{label:"Remove",onClick:s,value:t}))))}}var E=w,_=n(346527),k=n(57444),x=n(562415),S=Object.defineProperty,C=(e,t,n)=>(((e,t,n)=>{t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const O={view:e=>new M(e)};class Z extends a.Sy{constructor(){super(O)}}class M{constructor(e){C(this,"_anchorEl",null),C(this,"_popup",null),C(this,"_editor",null),C(this,"_onCancel",(e=>{this.destroy(),e.focus()})),C(this,"_onClose",(()=>{this._anchorEl=null,this._editor=null,this._popup=null})),C(this,"_onEdit",(e=>{if(this._editor)return;const{state:t}=e,{schema:n,doc:s,selection:o}=t,{from:r,to:i}=o,l=n.marks.link,c=(0,h.Z)(s,r,i,l);if(!c)return;let{tr:d}=t;const p=a.Bs.create(d.doc,c.from.pos,c.to.pos+1);d=d.setSelection(p),d=(0,u.tk)(t,d),e.dispatch(d);const m=c?c.mark.attrs.href:null;this._editor=(0,x.Z)(_.Z,{href:m},{onClose:t=>{this._editor=null,this._onEditEnd(e,o,t)}})})),C(this,"_onRemove",(e=>{this._onEditEnd(e,e.state.selection,null)})),C(this,"_onEditEnd",((e,t,n)=>{const{state:s,dispatch:o}=e;let r=(0,u.be)(s);if(!c()(n)){const{schema:e}=s,o=e.marks.link;if(o){const s=(0,h.Z)(r.doc,t.from,t.to,o);if(s){const t=a.Bs.create(r.doc,s.from.pos,s.to.pos+1);r=r.setSelection(t);const i=n?{href:n}:null;r=(0,d.Z)(r,e,o,i)}}}r.setSelection(t.map(r.doc,r.mapping)),o(r),e.focus()})),this.update(e,null)}update(e,t){if(e.readOnly)return void this.destroy();const{state:n}=e,{doc:s,selection:o,schema:r}=n,i=r.marks.link;if(!i)return;const{from:a,to:l}=o,c=(0,h.Z)(s,a,l,i);if(!c)return void this.destroy();const u=e.domAtPos(a);if(!u)return void this.destroy();const d=p(u.node,(e=>"A"===e.nodeName));if(!d)return void this.destroy();const m=this._popup,f={editorState:n,editorView:e,href:c.mark.attrs.href,onCancel:this._onCancel,onEdit:this._onEdit,onRemove:this._onRemove};m&&d===this._anchorEl?m.update(f):(m&&m.close(),this._anchorEl=d,this._popup=(0,x.Z)(E,f,{anchor:d,autoDismiss:!1,onClose:this._onClose,position:k.DL}))}destroy(){this._popup&&this._popup.close(),this._editor&&this._editor.close()}}var N=Z,P=n(241490),T=n(859067),D=n(141396);function I(e){const{doc:t,selection:n,schema:s}=e,o=s.nodes.table_cell,r=s.nodes.table_header;if(!o&&!r)return null;let l=n;if(l instanceof a.Bs){const e=o&&(0,D.Tr)(o)(n)||r&&(0,D.Tr)(r)(n);if(!e)return null;l=i.Xc.create(t,e.pos)}return l instanceof i.Xc?function(e){const{$anchorCell:t}=e,n=t.start(-1),s=t.node(-1),o=i.rU.get(s);let r,a=null,l=null;return e.forEachCell(((e,t)=>{const s=o.findCell(t-n);(!r||s.top>=r.top&&s.left>r.left)&&(r=s,a=t,l=e)})),null===a?null:{node:l,pos:a}}(l):null}var A=n(185610),j=n(155061),z=n(922730),R=n(812128),L=n(289846),B=Object.defineProperty,U=(e,t,n)=>(((e,t,n)=>{t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class V extends m.PureComponent{constructor(){super(...arguments),U(this,"onMenuMouseDown",(e=>t=>{t.preventDefault(),e.run&&e.run(this.props.editorState,this.props.editorView.dispatch,this.props.editorView,t.nativeEvent)})),U(this,"createDropdownButtons",((e,t)=>m.createElement(j.Z,{key:`dropdown-item-${t}`,onMouseDown:this.onMenuMouseDown(e)},z.a.t(`text-editor:${e.content}`))))}render(){return m.createElement(A.Z,{title:R.Z.table,variant:"outline-secondary",size:"sm",style:{display:"inline-block"}},L.ZP.tableEdits.map(this.createDropdownButtons))}}var F=V;var $=n(452626);function H(e){const{x:t,y:n,w:s,h:o}=(0,$.hs)(e),r=s&&o&&e?e.ownerDocument.elementFromPoint(t+1,n+1):null;return!!r&&(r===e||!!e.contains(r))}var W=Object.defineProperty,G=(e,t,n)=>(((e,t,n)=>{t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class K{constructor(e){G(this,"destroy",(()=>{this._popUp&&this._popUp.close(),this._popUp=null})),G(this,"_onOpen",(()=>{const e=this._cellElement;e&&(this._scrollHandle=function(e,t){if(!e)return;const n=e.ownerDocument.defaultView,s=[];let o=0,r=()=>{o&&cancelAnimationFrame(o),o=requestAnimationFrame(t)},i=e;for(;i;){const e=n.getComputedStyle(i).overflow;(r&&"auto"===e||"scroll"===e)&&(i.addEventListener("scroll",r,!1),s.push(i)),i=i.parentElement}return{dispose(){for(;r&&s.length;)i=s.pop(),i&&i.removeEventListener("scroll",r,!1);r=null,o&&window.cancelAnimationFrame(o),o=0}}}(e,this._onScroll))})),G(this,"_onClose",(()=>{this._popUp=null,this._scrollHandle&&this._scrollHandle.dispose(),this._scrollHandle=null})),G(this,"_onScroll",(()=>{const e=this._popUp,t=this._cellElement;e&&t&&(H(t)||e.close())})),this._cellElement=null,this._popUp=null,this._scrollHandle=null,this.update(e,null)}update(e,t){const{state:n,readOnly:s}=e,o=I(n);if(!o||s)return void this.destroy();const r=e.domAtPos(o.pos+1);if(!r)return void this.destroy();let i=r.node;const a=this._popUp,l={editorState:n,editorView:e};i&&!H(i)&&(i=null),i?a&&i===this._cellElement?a.update(l):(a&&a.close(),this._cellElement=i,this._popUp=(0,x.Z)(F,l,{anchor:i,autoDismiss:!1,onClose:this._onClose,position:k.ID}),this._onOpen()):(a&&a.close(),this._cellElement=null)}}const q={view:e=>new K(e)};class J extends a.Sy{constructor(){super(q)}}var Y=J,X=n(193450),Q=n(760737),ee=n(788892),te=n(59195),ne=n(371405),se=n(437069),oe=n.n(se),re=n(994643),ie=n(922032);const ae=(e,t)=>{const n=ie.Z.nodes.hard_break.create();return t(e.tr.replaceSelectionWith(n).scrollIntoView()),!0},le={"Alt-ArrowDown":Q.Ig,"Alt-ArrowUp":Q.MI,"Ctrl-Enter":(0,Q.QF)(Q.uo,ae),"Mod->":(0,Q.ym)(ie.Z.nodes.blockquote),"Mod-_":(e,t)=>{const n=ie.Z.nodes.horizontal_rule.create();return t(e.tr.replaceSelectionWith(n).scrollIntoView()),!0},"Mod-[":(0,ne.IB)(ie.Z.nodes.list_item),"Mod-]":(0,ne.bw)(ie.Z.nodes.list_item),"Mod-b":(0,Q.w9)(ie.Z.marks.strong),"Mod-BracketLeft":Q.xb,"Mod-Enter":(0,Q.QF)(Q.uo,ae),"Mod-i":(0,Q.w9)(ie.Z.marks.em),"Mod-u":(0,Q.w9)(ie.Z.marks.underline),"Mod-m":(0,Q.w9)(ie.Z.marks.code),"Mod-l":(0,Q.w9)(ie.Z.marks.subscript),"Mod-s":(0,Q.w9)(ie.Z.marks.strikethrough),"Mod-p":(0,Q.w9)(ie.Z.marks.superscript),"Mod-y":r.KX,"Mod-z":r.Yw,"Shift-Ctrl-\\":(0,Q.uJ)(ie.Z.nodes.code_block),"Shift-Ctrl-0":(0,Q.uJ)(ie.Z.nodes.paragraph),"Shift-Ctrl-1":(0,Q.uJ)(ie.Z.nodes.heading,{level:1}),"Shift-Ctrl-2":(0,Q.uJ)(ie.Z.nodes.heading,{level:2}),"Shift-Ctrl-3":(0,Q.uJ)(ie.Z.nodes.heading,{level:3}),"Shift-Ctrl-4":(0,Q.uJ)(ie.Z.nodes.heading,{level:4}),"Shift-Ctrl-5":(0,Q.uJ)(ie.Z.nodes.heading,{level:5}),"Shift-Ctrl-6":(0,Q.uJ)(ie.Z.nodes.heading,{level:6}),"Shift-Ctrl-8":(0,ne.KI)(ie.Z.nodes.bullet_list),"Shift-Ctrl-9":(0,ne.KI)(ie.Z.nodes.ordered_list),"Shift-Enter":(0,Q.QF)(Q.uo,ae),"Alt-Ctrl-l":re.H_,"Alt-Ctrl-r":re.cP,"Alt-Ctrl-c":re.A8,"Alt-Ctrl-j":re.nx,"Shift-Mod-z":r.KX,"Shift-Tab":(0,i.nA)(-1),Backspace:ee.dU,Enter:(0,ne.s6)(ie.Z.nodes.list_item),Escape:Q.N0,Tab:(0,i.nA)(1)};oe()(Q.YR).forEach((e=>{le[e]?le[e]=(0,Q.QF)(le[e],Q.YR[e]):le[e]=Q.YR[e]}));var ce=(0,te.h)(le);function ue(e,t,n){return new ee.VK(e,((e,s,o,r)=>{let i=n instanceof Function?n(s):n,a=e.tr;if(s[1]){let e=o+s[0].indexOf(s[1]),t=e+s[1].length;t<r&&a.delete(t,r),e>o&&a.delete(o,e),r=o+s[1].length}return a.addMark(o,r,t.create(i)),a.removeStoredMark(t),a}))}var de=(0,ee.Hw)({rules:[...ee.yR,ee.LH,ee.pR,(0,ee.S0)(/^\s*>\s$/,ie.Z.nodes.blockquote),(0,ee.S0)(/^(\d+)\.\s$/,ie.Z.nodes.ordered_list,(e=>({order:+e[1]})),((e,t)=>t.childCount+t.attrs.order===+e[1])),(0,ee.S0)(/^\s*([-+*])\s$/,ie.Z.nodes.bullet_list),(0,ee.zK)(/^```$/,ie.Z.nodes.code_block),ue(/(?:^|[^`])`([^`]+)`$/,ie.Z.marks.code),ue(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,ie.Z.marks.strong),ue(/(?:^|[^*_])(?:\*|_)([^*_]+)(?:\*|_)$/,ie.Z.marks.em),ue(/(?:\+\+)([^+]+)(?:\+\+)$/,ie.Z.marks.underline),ue(/(?:~~)([^~]+)(?:~~)$/,ie.Z.marks.strikethrough),(0,ee.zK)(new RegExp("^(#{1,6})\\s$"),ie.Z.nodes.heading,(e=>({level:e[1].length})))]}),he=[new T.Z,new N,new u.ZP,new P.ZP,de,ce,(0,s.q)(),(0,o.d)(),(0,r.m8)(),(0,i.VH)({}),new Y,(0,i.G3)(),(0,X.ZP)()];document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)},768466:function(e,t,n){n.d(t,{Z:function(){return o}});const s=/^http(s?):*\/\//i;function o(e){return e?s.test(e)?e:"http://"+e:"http://"}},922032:function(e,t,n){n.d(t,{Z:function(){return gt}});var s=n(130764);var o={attrs:{href:{},target:{default:"blank"},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(e){const t=e.getAttribute("href"),n=t&&0===t.indexOf("#")?"":"blank";return{href:e.getAttribute("href"),title:e.getAttribute("title"),target:n}}}],toDOM(e){const{href:t,title:n,target:s}=e.attrs;return["a",{href:t,title:n,target:s},0]}};var r={parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]};var i={parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>["strong",0]};var a={parseDOM:[{tag:"code"}],toDOM:()=>["code",0]};var l={excludes:"superscript",parseDOM:[{tag:"sub"},{style:"vertical-align=sub"}],toDOM:()=>["sub"]};var c={attrs:{color:""},inline:!0,group:"inline",parseDOM:[{style:"color",getAttrs:e=>({color:e})}],toDOM(e){const{color:t}=e.attrs;let n="";return t&&(n+=`color: ${t};`),["span",{style:n},0]}},u=n(32593),d=n.n(u),h=n(395465),p=n.n(h),m=n(78708);const f=/([\d.]+)(px|pt)/i;function g(e){const t=function(e){const t=e.match(f);if(!t)return 0;let n=parseFloat(t[1]);const s=t[2];return n&&s?("px"===s&&(n*=.7518796992481203),n):0}(e);return m.includes(t)?t:m.reduce(((e,n)=>d()(n-t)<d()(e-t)?n:e),p())}var b={link:o,code:a,em:r,fontSize:{attrs:{pt:{default:null}},inline:!0,group:"inline",parseDOM:[{style:"font-size",getAttrs:function(e){const t={};if(!e)return t;const n=g(e);if(!n)return t;return{pt:n}}}],toDOM(e){const{pt:t}=e.attrs;return["span",t?{style:`font-size: ${t}pt;`,class:"pm-font-size-mark"}:null,0]}},strikethrough:{parseDOM:[{tag:"strike"},{style:"text-decoration:line-through"},{style:"text-decoration-line:line-through"}],toDOM:()=>["strike"]},strong:i,subscript:l,superscript:{excludes:"subscript",parseDOM:[{tag:"sup"},{style:"vertical-align=super"}],toDOM:()=>["sup"]},textColor:c,underline:{parseDOM:[{tag:"u"},{style:"text-decoration:underline",getAttrs:e=>"underline"===e&&null}],toDOM:()=>["u",0]}},v=n(732357);const y=/(left|right|center|justify)/,w="data-indent",E=new Set(["","0%","0pt","0px"]);function _(e){const{textAlign:t,paddingTop:n,paddingBottom:s}=e.style;let o=e.getAttribute("align")||t||"";o=y.test(o)?o:null;return{align:o,indent:parseInt(e.getAttribute(w),10),paddingTop:n,paddingBottom:s,id:e.getAttribute("id")||""}}function k(e){const{align:t,indent:n,paddingTop:s,paddingBottom:o,id:r}=e.attrs,i={};let a="";return t&&"left"!==t&&(a+=`text-align: ${t};`),s&&!E.has(s)&&(a+=`padding-top: ${s};`),o&&!E.has(o)&&(a+=`padding-bottom: ${o};`),a&&(i.style=a),n&&(i["data-indent"]=String(n)),r&&(i.id=r),["p",i,0]}const x=k,S=_;var C={attrs:{align:{default:null},color:{default:null},id:{default:null},indent:{default:null},lineSpacing:{default:null},paddingBottom:{default:null},paddingTop:{default:null}},content:"inline*",group:"block",parseDOM:[{tag:"p",getAttrs:_}],toDOM:k},O=Object.defineProperty,Z=Object.defineProperties,M=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,D=(e,t,n)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))P.call(t,n)&&D(e,n,t[n]);if(N)for(var n of N(t))T.call(t,n)&&D(e,n,t[n]);return e},A=(e,t)=>Z(e,M(t));const j={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};function z(e){const t=S(e),n=j[e.nodeName.toUpperCase()]||1;return t.level=n,t}var R=A(I({},C),{attrs:A(I({},C.attrs),{level:{default:1}}),content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",getAttrs:z},{tag:"h2",getAttrs:z},{tag:"h3",getAttrs:z},{tag:"h4",getAttrs:z},{tag:"h5",getAttrs:z},{tag:"h6",getAttrs:z}],toDOM:function(e){const t=x(e),n=e.attrs.level||1;return t[0]=`h${n}`,t}});var L={group:"inline",content:"inline*",inline:!0,atom:!0,toDOM:()=>["footnote",0],parseDOM:[{tag:"footnote"}]},B=Object.defineProperty,U=Object.defineProperties,V=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,W=(e,t,n)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,G=(e,t)=>{for(var n in t||(t={}))$.call(t,n)&&W(e,n,t[n]);if(F)for(var n of F(t))H.call(t,n)&&W(e,n,t[n]);return e};var K,q,J=(K=G({},C),q={attrs:G({},C.attrs),content:"inline*",group:"block",defining:!0,toDOM:function(e){const t=x(e);return t[0]="legend",t[1].class="figure-caption",t},parseDOM:[{tag:"legend",getAttrs:function(e){return S(e)}}]},U(K,V(q))),Y=Object.defineProperty,X=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable,se=(e,t,n)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oe=(e,t)=>{for(var n in t||(t={}))te.call(t,n)&&se(e,n,t[n]);if(ee)for(var n of ee(t))ne.call(t,n)&&se(e,n,t[n]);return e};const re=((e,t)=>X(e,Q(t)))(oe({},C),{attrs:oe({},C.attrs),content:"inline*",group:"block",defining:!0,toDOM:function(e){const t=x(e);return t[0]="legend",t[1].class="table-caption",t},parseDOM:[{tag:"legend",getAttrs:function(e){return S(e)}}]});var ie=re;const ae=/rotate\(([0-9.]+)rad\)/i,le=new Set(["0%","0pt","0px"]);function ce(e){const{cssFloat:t,display:n,marginTop:s,marginLeft:o}=e.style;let{width:r,height:i}=e.style,a=e.getAttribute("data-align")||e.getAttribute("align");a?a=/(left|right|center)/.test(a)?a:null:"left"!==t||n?"right"!==t||n?t||"block"!==n||(a="block"):a="right":a="left",r=r||e.getAttribute("width"),i=i||e.getAttribute("height");let l=null,c=null;const{parentElement:u}=e;if(u instanceof HTMLElement){const e=u.style;if("inline-block"===e.display&&"hidden"===e.overflow&&e.width&&e.height&&o&&!le.has(o)&&s&&!le.has(s)&&(l={width:parseInt(e.width,10)||0,height:parseInt(e.height,10)||0,left:parseInt(o,10)||0,top:parseInt(s,10)||0}),e.transform){const t=e.transform.match(ae);t&&t[1]&&(c=parseFloat(t[1])||null)}}return{align:a,alt:e.getAttribute("alt")||null,crop:l,height:parseInt(i,10)||null,rotate:c,src:e.getAttribute("src")||null,title:e.getAttribute("title")||null,width:parseInt(r,10)||null}}const ue=ce;var de={inline:!0,attrs:{align:{default:null},alt:{default:"An inserted image"},crop:{default:null},height:{default:null},rotate:{default:null},src:{default:null},title:{default:"None"},width:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:ce}],toDOM:e=>["img",e.attrs]},he=Object.defineProperty,pe=Object.defineProperties,me=Object.getOwnPropertyDescriptors,fe=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,ve=(e,t,n)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const ye={attrs:{src:{},plotID:{default:null},align:{default:null},alt:{default:""},crop:{default:null},title:{default:""},meta:{default:null},width:{default:null},height:{default:null},rotate:{default:null}},inline:!0,group:"inline",draggable:!0,toDOM:e=>["div",{class:"img-container","data-plot-id":e.attrs.plotID,align:e.attrs.align},["img",{src:e.attrs.src,align:e.attrs.align,alt:e.attrs.alt,crop:e.attrs.crop,title:e.attrs.title,width:e.attrs.width,height:e.attrs.height,rotate:e.attrs.rotate}],["pre",{class:"img-tooltip"},e.attrs.meta]],parseDOM:[{priority:51,tag:"div[data-plot-id]",getAttrs:e=>{const t=e.getAttribute("data-plot-id"),n=e.firstChild,s=ue(n),o=e.lastChild.innerText;return((e,t)=>pe(e,me(t)))(((e,t)=>{for(var n in t||(t={}))ge.call(t,n)&&ve(e,n,t[n]);if(fe)for(var n of fe(t))be.call(t,n)&&ve(e,n,t[n]);return e})({},s),{meta:o,plotID:t})}}]};var we=ye,Ee=Object.defineProperty,_e=Object.defineProperties,ke=Object.getOwnPropertyDescriptors,xe=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable,Oe=(e,t,n)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Ze={attrs:{src:{},plotID:{default:null},align:{default:null},alt:{default:""},crop:{default:null},title:{default:""},meta:{default:null},width:{default:null},height:{default:null},rotate:{default:null}},inline:!0,group:"inline",draggable:!0,toDOM:e=>["div",{class:"img-container","data-plot-id":e.attrs.plotID,align:e.attrs.align},["img",{src:e.attrs.src,align:e.attrs.align,alt:e.attrs.alt,crop:e.attrs.crop,title:e.attrs.title,width:e.attrs.width,height:e.attrs.height,rotate:e.attrs.rotate}],["pre",{class:"img-tooltip"},e.attrs.meta]],parseDOM:[{priority:51,tag:"img[data-plot-id]",getAttrs:e=>{const t=e.getAttribute("align"),n=e.getAttribute("width"),s=ue(e);t||(s.align="center"),n||(s.width=550);const o=e.getAttribute("data-plot-id"),r=e.getAttribute("data-plot-meta");return((e,t)=>_e(e,ke(t)))(((e,t)=>{for(var n in t||(t={}))Se.call(t,n)&&Oe(e,n,t[n]);if(xe)for(var n of xe(t))Ce.call(t,n)&&Oe(e,n,t[n]);return e})({},s),{meta:r,plotID:o})}}]};var Me=Ze;var Ne={content:"block+"};var Pe={content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]};var Te={group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]};var De={content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>["pre",["code",0]]};var Ie={group:"inline"};var Ae={inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]},je=n(371405),ze=Object.defineProperty,Re=Object.defineProperties,Le=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertySymbols,Ue=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable,Fe=(e,t,n)=>t in e?ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const $e=((e,t)=>Re(e,Le(t)))(((e,t)=>{for(var n in t||(t={}))Ue.call(t,n)&&Fe(e,n,t[n]);if(Be)for(var n of Be(t))Ve.call(t,n)&&Fe(e,n,t[n]);return e})({},je.dq),{content:"list_item+",group:"block"});var He=$e,We=Object.defineProperty,Ge=Object.defineProperties,Ke=Object.getOwnPropertyDescriptors,qe=Object.getOwnPropertySymbols,Je=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable,Xe=(e,t,n)=>t in e?We(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Qe=((e,t)=>Ge(e,Ke(t)))(((e,t)=>{for(var n in t||(t={}))Je.call(t,n)&&Xe(e,n,t[n]);if(qe)for(var n of qe(t))Ye.call(t,n)&&Xe(e,n,t[n]);return e})({},je.iI),{content:"list_item+",group:"block"});var et=Qe,tt=Object.defineProperty,nt=Object.defineProperties,st=Object.getOwnPropertyDescriptors,ot=Object.getOwnPropertySymbols,rt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable,at=(e,t,n)=>t in e?tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const lt=((e,t)=>nt(e,st(t)))(((e,t)=>{for(var n in t||(t={}))rt.call(t,n)&&at(e,n,t[n]);if(ot)for(var n of ot(t))it.call(t,n)&&at(e,n,t[n]);return e})({},je.qb),{content:"paragraph block*",group:"block"});var ct=lt,ut=Object.defineProperty,dt=Object.getOwnPropertySymbols,ht=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable,mt=(e,t,n)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ft=((e,t)=>{for(var n in t||(t={}))ht.call(t,n)&&mt(e,n,t[n]);if(dt)for(var n of dt(t))pt.call(t,n)&&mt(e,n,t[n]);return e})({doc:Ne,plot:Me,plotContainer:we,footnote:L,paragraph:C,ordered_list:He,bullet_list:et,list_item:ct,blockquote:Pe,horizontal_rule:Te,heading:R,code_block:De,text:Ie,image:de,hard_break:Ae,figureCaption:J,tableCaption:ie},(0,v.V3)({tableGroup:"block",cellContent:"block+"})),gt=new s.V_({nodes:ft,marks:b})},552212:function(e,t,n){n.d(t,{be:function(){return h},tk:function(){return d}});var s=n(627191),o=n(952780);const r={name:"SelectionPlaceholderPlugin"};let i=null;const a={state:{init:()=>o.EH.empty,apply(e,t){t=t.map(e.mapping,e.doc);const n=e.getMeta(this);if(!n)return t;if(n.add){const s=o.p.inline(n.add.from,n.add.to,{class:"selection-placeholder"},{id:r});t=t.add(e.doc,[s])}else if(n.remove){const e=t.find(null,null,c);t=t.remove(e)}return t}},props:{decorations:e=>i?i.getState(e):null}};class l extends s.Sy{constructor(){if(super(a),i)return i;i=this}}function c(e){return e.id===r}function u(e){if(!i)return null;if(!e.plugins.includes(i))return null;const t=i.getState(e).find(null,null,c);return(t.length?t[0]:null)||null}function d(e,t){t=t||e.tr;const n=i;if(!n||!t.selection||t.selection.empty)return t;return null===u(e)&&(t=t.setMeta(n,{add:{from:t.selection.from,to:t.selection.to}})),t}function h(e,t){t=t||e.tr;const n=i;if(!n)return t;return u(e)&&(t=t.setMeta(n,{remove:{}})),t}t.ZP=l},994643:function(e,t,n){n.d(t,{A8:function(){return v},H_:function(){return b},cP:function(){return y},nx:function(){return w}});var s=n(627191),o=n(812128),r=Object.defineProperty,i=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,d=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,h=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&d(e,n,t[n]);if(l)for(var n of l(t))u.call(t,n)&&d(e,n,t[n]);return e},p=(e,t)=>i(e,a(t));const m=e=>{const{selection:t}=e;return t instanceof s.Bs||t instanceof s.C1},f=(e,t,n)=>{const{selection:s,doc:o}=e;if(!s||!o)return e;const{from:r,to:i}=s,{nodes:a}=t,l=a.blockquote,c=a.list_item,u=a.heading,d=a.paragraph,m=[];n=n||null;const f=new Set([l,u,c,d]);return o.nodesBetween(r,i,((e,t,s)=>{const o=e.type;return(e.attrs.align||null)!==n&&f.has(o)&&m.push({node:e,pos:t,nodeType:o}),!0})),m.length?(m.forEach((t=>{const{node:s,pos:o,nodeType:r}=t;let{attrs:i}=s;i=p(h({},i),n?{align:n}:{align:null}),e=e.setNodeMarkup(o,r,i,s.marks)})),e):e},g=e=>t=>{const{selection:n,doc:s}=t,{from:o,to:r}=n;let i=!0,a=!1;return s.nodesBetween(o,r,((t,n)=>(i&&t.attrs.align===e&&(i=!1,a=!0),i))),a};function b(e,t){const{schema:n,selection:s}=e,o=f(e.tr.setSelection(s),n,"left");return!!o.docChanged&&(t&&t(o))}function v(e,t){const{schema:n,selection:s}=e,o=f(e.tr.setSelection(s),n,"center");return!!o.docChanged&&(t&&t(o))}function y(e,t){const{schema:n,selection:s}=e,o=f(e.tr.setSelection(s),n,"right");return!!o.docChanged&&(t&&t(o))}function w(e,t){const{schema:n,selection:s}=e,o=f(e.tr.setSelection(s),n,"justify");return!!o.docChanged&&(t&&t(o))}const E=[{title:"align-left",content:o.Z.alignLeft,enable:m,active:g("left"),run:b,hotkey:"Ctrl+Alt+L"},{title:"align-center",content:o.Z.alignCenter,enable:m,active:g("center"),run:v,hotkey:"Ctrl+Alt+C"},{title:"align-right",content:o.Z.alignRight,enable:m,active:g("right"),run:y,hotkey:"Ctrl+Alt+R"},{title:"justified",content:o.Z.alignJustify,enable:m,active:g("justify"),run:w,hotkey:"Ctrl+Alt+J"}];t.ZP=E},562415:function(e,t,n){n.d(t,{Z:function(){return T}});var s=n(202784),o=n(117029),r=n(452626),i=n(877119),a=n.n(i),l=Object.defineProperty,c=(e,t,n)=>(((e,t,n)=>{t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const u={x:-1e4,y:-1e4,w:0,h:0};var d=new class{constructor(){c(this,"_bridges",new Map),c(this,"_positions",new Map),c(this,"_mx",0),c(this,"_my",0),c(this,"_rafID",0),c(this,"_onScroll",(()=>{this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._syncPosition)})),c(this,"_onResize",(e=>{this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._syncPosition)})),c(this,"_onMouseChange",(e=>{this._mx=Math.round(e.clientX),this._my=Math.round(e.clientY),this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._syncPosition)})),c(this,"_onClick",(e=>{const t=Date.now();let n;for(const[r,l]of this._bridges)if(t-l>350){const e=r.getDetails();e.modal&&e.autoDismiss&&(n=e)}if(!n)return;const{body:s,close:o}=n,i=(0,r.mv)(e.clientX,e.clientY,1),a=s?(0,r.hs)(s):null;a&&(0,r.vY)(i,a)||o()})),c(this,"_syncPosition",(()=>{this._rafID=0;const e=new Map;for(const[o,i]of this._bridges){const t=o.getDetails();e.set(o,t);const{anchor:n,body:s}=t;s instanceof HTMLElement&&(t.bodyRect=(0,r.hs)(s)),n instanceof HTMLElement&&(t.anchorRect=(0,r.hs)(n))}const t=(0,r.mv)(this._mx,this._my,2),n=new Set;for(const[o,i]of e){const{anchor:e,bodyRect:s,anchorRect:l,position:c,body:d}=i;if(!s&&!l)continue;const{x:h,y:p}=c(l,s),m=`${h}-${p}`;if(d&&s&&this._positions.get(o)!==m){const e=l?a()(0,l.x-h+l.w/2,s.w-l.w/2):0;this._positions.set(o,m);const t=d.style;t.position="absolute",t.left=`${h}px`,t.top=`${p}px`,t.setProperty("--editor-pop-up-anchor-offset-left",`${e}px`),s.x=h,s.y=p}((0,r.vY)(t,s||u,0)||(0,r.vY)(t,l||u,0))&&e&&n.add(e)}for(;;){const t=n.size;for(const[s,o]of e){const{anchor:e,body:t}=o;for(const s of n)e&&t&&!n.has(e)&&t.contains(s)&&n.add(e)}if(n.size===t)break}const s=Date.now();for(const[o,r]of this._bridges){const t=e.get(o);if(t){const{autoDismiss:e,anchor:o,close:i,modal:a}=t;e&&!a&&s-r>350&&!n.has(o)&&i()}}}))}register(e){this._bridges.set(e,Date.now()),this._positions.set(e,null),1===this._bridges.size&&this._observe(),this._rafID=requestAnimationFrame(this._syncPosition)}unregister(e){this._bridges.delete(e),this._positions.delete(e),0===this._bridges.size&&this._unobserve(),this._rafID&&cancelAnimationFrame(this._rafID)}_observe(){document.addEventListener("mousemove",this._onMouseChange,!1),document.addEventListener("mouseup",this._onMouseChange,!1),document.addEventListener("click",this._onClick,!1),window.addEventListener("scroll",this._onScroll,!0),window.addEventListener("resize",this._onResize,!0)}_unobserve(){document.removeEventListener("mousemove",this._onMouseChange,!1),document.removeEventListener("mouseup",this._onMouseChange,!1),document.removeEventListener("click",this._onClick,!1),window.removeEventListener("scroll",this._onScroll,!0),window.removeEventListener("resize",this._onResize,!0),this._rafID&&cancelAnimationFrame(this._rafID)}},h=n(57444),p=n(365601),m=Object.defineProperty,f=Object.defineProperties,g=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,w=(e,t,n)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const E=(0,p.Z)("popup");class _ extends s.PureComponent{constructor(e){var t;super(e),w(this,"symbol"!=typeof(t="_getDetails")?t+"":t,(()=>{const{close:e,popUpParams:t}=this.props,{anchor:n,autoDismiss:s,position:o,modal:r}=t;return{anchor:n,autoDismiss:!1!==s,body:document.getElementById(this._id),close:e,modal:!0===r,position:o||(r?h.Oi:h.SC)}})),this._bridge=null,this._id=E()}componentDidMount(){this._bridge={getDetails:this._getDetails},d.register(this._bridge)}componentWillUnmount(){this._bridge&&d.unregister(this._bridge)}render(){const{View:e,viewProps:t,close:n}=this.props;return s.createElement("div",{"data-pop-up-id":this._id,id:this._id},s.createElement(e,(o=((e,t)=>{for(var n in t||(t={}))v.call(t,n)&&w(e,n,t[n]);if(b)for(var n of b(t))y.call(t,n)&&w(e,n,t[n]);return e})({},t||{}),f(o,g({close:n})))));var o}}var k=_;const x=(0,p.Z)("create-popup");let S,C=0,O=0;const Z="pop-up-modal-mask-"+x();function M(){const e=document.getElementById(Z);e&&e.parentElement&&e.parentElement.removeChild(e)}function N(e,t,n,s){const o=n&&n.container||document.body||document.documentElement;let r=document.getElementById(e);if(!r&&t&&(r=document.createElement("div")),!r)return null;n&&n.modal&&r.setAttribute("data-pop-up-modal","y"),r.className="pop-up-element vars",r.id=e;const i=r.style,a=n&&n.modal?1:0;return n&&n.container||(i.zIndex=1005+3*O+a),s&&(i.zIndex+=s),r.setAttribute("role","dialog"),r.setAttribute("aria-modal","true"),o&&!r.parentElement&&o.appendChild(r),r}function P(e,t,n,r,i){let a=0;document.getElementsByClassName("editorview-wrapper fullscreen")[0]&&(a+=1e3);const l=N(e,!0,i,a);if(l){const e=s.createElement(k,{View:n,close:t,popUpParams:i,viewProps:r});S=(0,o.s)(l),S.render(e)}C>0?function(){const e=document.body||document.documentElement;let t=document.getElementById(Z);t||(t=document.createElement("div"),t.id=Z,t.className="pop-up-modal-mask",t.setAttribute("data-mask-type","pop-up-modal-mask"),t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true")),e&&!t.parentElement&&e.appendChild(t);const n=t.style,s=Array.from(document.querySelectorAll(".pop-up-element[data-pop-up-modal]")).reduce(((e,t)=>Math.max(e,Number(t.style.zIndex))),0);n.zIndex=s-1}():M()}function T(e,t,n){const s=x();let o=null,r=t;t=t||{};const i=(n=n||{}).modal||!n.anchor;n.modal=i,O++,i&&C++;const a=e=>{if(!o)return;i&&C--,O--,o=null,function(e){const t=N(e,!1);t&&(S.unmount(),t.parentElement&&t.parentElement.removeChild(t)),0===C&&M()}(s);const t=n&&n.onClose;t&&t(e)},l=P.bind(null,s,a,e),c={};return o={close:a,update:e=>{r=e,l(r||c,n||c)}},l(r||c,n||c),o}},513014:function(e,t,n){n.d(t,{Z:function(){return Z}});var s=n(72779),o=n.n(s),r=n(202784),i=n(816092),a=Object.defineProperty,l=(e,t,n)=>(((e,t,n)=>{t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class c extends r.PureComponent{constructor(e){super(e),l(this,"_onMouseEnter",(e=>{this._pressedTarget=null,e.preventDefault();const{onMouseEnter:t,value:n}=this.props;t&&t(n,e)})),l(this,"_onMouseLeave",(e=>{this._pressedTarget=null;const t=e;this._onMouseUpCapture(t)})),l(this,"_onMouseDown",(e=>{e.preventDefault(),this._pressedTarget=null,this._clicked=!1,3!==e.which&&2!==e.button&&(this.setState({pressed:!0}),this._pressedTarget=e.currentTarget,this._clicked=!1,this._mul||(document.addEventListener("mouseup",this._onMouseUpCapture,!0),this._mul=!0))})),l(this,"_onMouseUp",(e=>{if(e.preventDefault(),this._clicked||"keypress"===e.type){const{onClick:t,value:n,disabled:s}=this.props;!s&&t&&t(n,e)}this._pressedTarget=null,this._clicked=!1})),l(this,"_onMouseUpCapture",(e=>{this._mul&&(this._mul=!1,document.removeEventListener("mouseup",this._onMouseUpCapture,!0));const t=e.target;this._clicked=this._pressedTarget instanceof HTMLElement&&t instanceof HTMLElement&&(t===this._pressedTarget||t.contains(this._pressedTarget)||this._pressedTarget.contains(t)),this.setState({pressed:!1})})),this._clicked=!1,this._mul=!1,this._pressedTarget=null,this._unmounted=!1,this.state={pressed:!1}}componentWillUnmount(){this._unmounted=!0,this._mul&&(this._mul=!1,document.removeEventListener("mouseup",this._onMouseUpCapture,!0))}render(){const{className:e,disabled:t,active:n,id:s,style:a,title:l,children:c}=this.props,{pressed:u}=this.state,d=o()(e,{active:n,disabled:t,pressed:u});return r.createElement("span",{"aria-disabled":t,"aria-pressed":u,className:d,disabled:t,id:s,onKeyPress:t?i.Z:this._onMouseUp,onMouseDown:t?i.Z:this._onMouseDown,onMouseEnter:t?i.Z:this._onMouseEnter,onMouseLeave:t?null:this._onMouseLeave,onMouseUp:t?i.Z:this._onMouseUp,role:"button",style:a,tabIndex:t?null:0,title:l},c)}}var u=c,d=n(365601),h=n(562415),p=n(57444),m=Object.defineProperty,f=(e,t,n)=>(((e,t,n)=>{t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const g=(0,d.Z)("tooltip-surface");class b extends r.PureComponent{render(){const{tooltip:e}=this.props;return r.createElement("div",{className:"editor-tooltip-view editor-animation-fade-in"},e)}}class v extends r.PureComponent{constructor(e){super(e),f(this,"_onMouseEnter",(()=>{if(!this._popUp){const{tooltip:e}=this.props;this._popUp=(0,h.Z)(b,{tooltip:e},{anchor:document.getElementById(this._id),onClose:this._onClose,position:p.lS})}})),f(this,"_onMouseLeave",(()=>{this._popUp&&this._popUp.close(),this._popUp=null})),f(this,"_onClose",(()=>{this._popUp=null})),this._id=g(),this._popUp=null}componentWillUnmount(){this._popUp&&this._popUp.close()}render(){const{tooltip:e,children:t}=this.props;return r.createElement("span",{"aria-label":e,className:"editor-tooltip-surface","data-tooltip":e,id:this._id,onMouseDown:e&&this._onMouseLeave,onMouseEnter:e&&this._onMouseEnter,onMouseLeave:e&&this._onMouseLeave,role:"tooltip"},t)}}var y=v,w=Object.defineProperty,E=Object.defineProperties,_=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,C=(e,t,n)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class O extends r.PureComponent{render(){const e=this.props,{icon:t,label:n,className:s,title:i}=e,a=((e,t)=>{var n={};for(var s in e)x.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&k)for(var s of k(e))t.indexOf(s)<0&&S.call(e,s)&&(n[s]=e[s]);return n})(e,["icon","label","className","title"]),l=o()(s,"editor-custom-button",{"use-icon":!!t});return r.createElement(y,{tooltip:i},r.createElement(u,(c=((e,t)=>{for(var n in t||(t={}))x.call(t,n)&&C(e,n,t[n]);if(k)for(var n of k(t))S.call(t,n)&&C(e,n,t[n]);return e})({},a),E(c,_({className:l}))),t,n));var c}}var Z=O},565784:function(e,t,n){n.d(t,{Z:function(){return ve}});var s=n(72779),o=n.n(s),r=n(202784),i=n(928316),a=n(365601),l=n(922730),c=n(117029),u=Object.defineProperty,d=(e,t,n)=>(((e,t,n)=>{t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const h=Object.freeze({from:0,to:0});function p(e){if(!window.getSelection)return console.warn("window.getSelection() is not supported"),h;const t=window.getSelection();if(!t.containsNode)return console.warn("selection.containsNode() is not supported"),h;if(!t.rangeCount)return h;const n=t.getRangeAt(0);if(!n)return h;const{startContainer:s,endContainer:o,startOffset:r,endOffset:i}=n;return s===e||o===e||s&&e.contains(s)||o&&e.contains(o)?{from:r,to:i}:h}var m=Object.defineProperty,f=Object.defineProperties,g=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,w=(e,t,n)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const E="ProseMirror-selectednode",_=new Set,k=new Set;const x=new class{constructor(e){d(this,"_observables",[]),d(this,"_callback",null),d(this,"_onClick",(()=>{const e=this._callback;if(this._observables=this._observables.map((e=>{const{target:t}=e;return{target:t,selection:p(t)}})),e)return e(this.takeRecords(),this)})),d(this,"_check",(()=>{let e=!1;const t=this._callback;if(this._observables=this._observables.map((t=>{const{target:n,selection:s}=t,o=p(n);return s===o||s.from===o.from&&s.to===o.to?t:(e=!0,{target:n,selection:o})})),e&&t)return t(this.takeRecords(),this)})),this._callback=e}disconnect(){this._observables.forEach((e=>{const t=e.target;t.removeEventListener("click",this._check,!1),t.removeEventListener("selectionchange",this._check,!1)})),this._observables=[]}observe(e){if(!window.getSelection)return void console.warn("window.getSelection() is not supported");if(this._observables.some((t=>t.target===e)))return;const t={target:e,selection:p(e)};e.addEventListener("click",this._check,!1),e.addEventListener("selectionchange",this._check,!1),this._observables.push(t)}takeRecords(){return this._observables.slice(0)}}((function(e,t){if(!window.getSelection)return console.warn("window.getSelection() is not supported"),void t.disconnect();const n=window.getSelection();if(!n.containsNode)return console.warn("selection.containsNode() is not supported"),void t.disconnect();for(const s of _){const e=s.dom;n.containsNode(e)?s.selectNode():s.deselectNode()}0===_.size&&t.disconnect()})),S=new MutationObserver((function(e,t){const n=document.body;if(!n)return;const s=[];for(const o of k){const e=o.dom;n.contains(e)&&(k.delete(o),s.push(o),o.__renderReactComponent())}for(const o of _){const e=o.dom;n.contains(e)||(_.delete(e),o.root.unmount())}s.forEach((e=>_.add(e))),0===_.size&&t.disconnect()}));var C=class{constructor(e,t,n,s){this.props={decorations:s,editorView:t,getPos:n,node:e,selected:!1,focused:!1},k.add(this);const o=this.createDOMElement();this.dom=o,this._selected=null,o.onClick=this._onClick,1===k.size&&(S.observe(document,{childList:!0,subtree:!0}),x.observe(document))}update(e,t){var n;return this.props=(n=((e,t)=>{for(var n in t||(t={}))v.call(t,n)&&w(e,n,t[n]);if(b)for(var n of b(t))y.call(t,n)&&w(e,n,t[n]);return e})({},this.props),f(n,g({node:e}))),this.__renderReactComponent(),!0}stopEvent(){return!1}selectNode(){this._selected=!0,this.dom.classList.add(E),this.__renderReactComponent()}deselectNode(){this._selected=!1,this.dom.classList.remove(E),this.__renderReactComponent()}createDOMElement(){throw new Error("not implemented")}renderReactComponent(){throw new Error("not implemented")}destroy(){}__renderReactComponent(){const{editorView:e,getPos:t}=this.props;if(e.state&&e.state.selection){const{from:n}=e.state.selection,s=t();this.props.selected=this._selected,this.props.focused=e.focused&&s===n}else this.props.selected=!1,this.props.focused=!1;this.root=(0,c.s)(this.dom),this.root.render(this.renderReactComponent())}};n(871199),n(676065);r.PureComponent;var O=n(812128),Z=n(513014),M=Object.defineProperty,N=(e,t,n)=>(((e,t,n)=>{t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const P={NONE:{value:null,text:"Inline"},LEFT:{value:"left",text:"Float left"},CENTER:{value:"center",text:"Center"},RIGHT:{value:"right",text:"Float right"}};class T extends r.PureComponent{constructor(){super(...arguments),N(this,"_onClick",(e=>{this.props.onSelect({align:e})}))}render(){const e=this.props.value?this.props.value.align:null,t=this._onClick,n=Object.keys(P).map((n=>{const{value:s,text:o}=P[n];return r.createElement(Z.Z,{active:e===s,key:n,label:o,onClick:t,value:s})}));return r.createElement("div",{className:"editor-inline-editor"},n)}}var D=T,I=n(877119),A=n.n(I),j=n(409961),z=n.n(j),R=Object.defineProperty,L=(e,t,n)=>(((e,t,n)=>{t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const B=(0,a.Z)("image-resize-box"),U=20,V={top:$,top_right:H,right:F,bottom_right:H,bottom:$,bottom_left:H,left:F,top_left:H};function F(e,t,n){e.style.width=t+"px"}function $(e,t,n){e.style.height=n+"px"}function H(e,t,n){e.style.width=Math.round(t)+"px",e.style.height=Math.round(n)+"px"}class W extends r.PureComponent{constructor(e){super(e),L(this,"_syncSize",(()=>{if(!this._active)return;const{direction:e,width:t,height:n}=this.props,s=(this._x2-this._x1)*(/left/.test(e)?-1:1),o=(this._y2-this._y1)*(/top/.test(e)?-1:1),r=this._el;if(z()(r))throw new Error("Encountered an error: `el` should not be null.");const i=V[e];if(z()(i))throw new Error("Encountered an error: `fn` should not be null.");const a=t/n;let l=A()(U,t+Math.round(s),1e4),c=A()(U,n+Math.round(o),1e4);i===H&&(c=Math.max(l/a,U),l=c*a),i(r,Math.round(l),Math.round(c)),this._ww=l,this._hh=c})),L(this,"_onMouseDown",(e=>{e.preventDefault(),e.stopPropagation(),this._end(),this._start(e)})),L(this,"_onMouseMove",(e=>{e.preventDefault(),e.stopPropagation(),this._x2=e.clientX,this._y2=e.clientY,this._rafID=requestAnimationFrame(this._syncSize)})),L(this,"_onMouseUp",(e=>{e.preventDefault(),e.stopPropagation(),this._x2=e.clientX,this._y2=e.clientY;const{direction:t}=this.props,n=this._el;if(z()(n))throw new Error("Encountered an error: `el` should not be null.");n.classList.remove(t),this._end(),this.props.onResizeEnd(this._ww,this._hh)})),this._active=!1,this._el=null,this._h="",this._rafID=0,this._w="",this._x1=0,this._x2=0,this._y1=0,this._y2=0,this._ww=0,this._hh=0}componentWillUnmount(){this._end()}_start(e){this._active&&this._end(),this._active=!0;const{boxID:t,direction:n,width:s,height:o}=this.props,r=document.getElementById(t);if(z()(r))throw new Error("Encountered an error: `el` should not be null.");r.className+=" "+n,this._el=r,this._x1=e.clientX,this._y1=e.clientY,this._x2=this._x1,this._y2=this._y1,this._w=this._el.style.width,this._h=this._el.style.height,this._ww=s,this._hh=o,document.addEventListener("mousemove",this._onMouseMove,!0),document.addEventListener("mouseup",this._onMouseUp,!0)}_end(){if(!this._active)return;this._active=!1,document.removeEventListener("mousemove",this._onMouseMove,!0),document.removeEventListener("mouseup",this._onMouseUp,!0);const e=this._el;if(z()(e))throw new Error("Encountered an error: `el` should not be null.");e.style.width=this._w,e.style.height=this._h,e.className="editor-image-resize-box",this._el=null,this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=null}render(){const{direction:e}=this.props,t=o()({"editor-image-resize-box-control":!0,[e]:!0});return r.createElement("span",{role:"button",tabIndex:-1,className:t,onMouseDown:this._onMouseDown})}}class G extends r.PureComponent{constructor(e){super(e),this._id=B()}render(){const{onResizeEnd:e,width:t,height:n,src:s}=this.props,o={height:n+"px",width:t+"px"},i=this._id,a=Object.keys(V).map((s=>r.createElement(W,{boxID:i,config:V[s],direction:s,height:n,key:s,onResizeEnd:e,width:t})));return r.createElement("span",{className:"editor-image-resize-box",id:i,style:o},a,r.createElement("img",{className:"editor-image-resize-box-image",alt:"Resize Box",src:s}))}}var K=G,q=n(57444),J=n(297209);let Y=null;const X=new Map;function Q(e){e.forEach(ee)}function ee(e){const t=e.target,n=X.get(t),s=t=>t(e);n&&n.forEach(s)}var te={observe:function(e,t){const n=e,s=Y||(Y=new J.default(Q));if(X.has(n)){let e=X.get(n);if(z()(e))throw new Error("Encountered an error: callbacks are missing.");e.push(t)}else{const e=[t];X.set(n,e),s.observe(n)}},unobserve:function(e,t){const n=Y;if(!n)return;const s=e;if(n.unobserve(s),t){let e=null;if(X.has(s)){if(e=X.get(s),z()(e))throw new Error("Encountered an error: callbacks are missing.");e=e.filter((e=>e!==t))}e&&e.length?X.set(s,e):X.delete(s)}else X.delete(s);X.size||(n.disconnect(),Y=null)}},ne=n(562415),se=n(978491),oe=Object.defineProperty,re=Object.defineProperties,ie=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,ue=(e,t,n)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,de=(e,t)=>{for(var n in t||(t={}))le.call(t,n)&&ue(e,n,t[n]);if(ae)for(var n of ae(t))ce.call(t,n)&&ue(e,n,t[n]);return e},he=(e,t)=>re(e,ie(t)),pe=(e,t,n)=>(ue(e,"symbol"!=typeof t?t+"":t,n),n);const me=(0,a.Z)("image-node-view"),fe=1e5,ge={src:"",complete:!1,height:0,width:0};class be extends r.PureComponent{constructor(e){super(e),pe(this,"_resolveOriginalSize",(()=>{return e=this,t=null,n=function*(){if(!this._mounted)return;this.setState({originalSize:ge});const e=this.props.node.attrs.src,t=e,n=yield(0,se.Z)(t);this._mounted&&this.props.node.attrs.src===e&&(n.complete||(n.width=U,n.height=U),this.setState({originalSize:n}))},new Promise(((s,o)=>{var r=e=>{try{a(n.next(e))}catch(t){o(t)}},i=e=>{try{a(n.throw(e))}catch(t){o(t)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,i);a((n=n.apply(e,t)).next())}));var e,t,n})),pe(this,"_onResizeEnd",((e,t)=>{const{getPos:n,node:s,editorView:o}=this.props,r=n(),i=he(de({},s.attrs),{crop:null,width:e,height:t});let a=o.state.tr;const{selection:l}=o.state;a=a.setNodeMarkup(r,null,i),a=a.setSelection(l.map(a.doc,a.mapping)),o.dispatch(a)})),pe(this,"_onChange",(e=>{if(!this._mounted)return;const t=e?e.align:null,{getPos:n,node:s,editorView:o}=this.props,r=n(),i=he(de({},s.attrs),{align:t});let a=o.state.tr;const{selection:l}=o.state;a=a.setNodeMarkup(r,null,i),a=a.setSelection(l.map(a.doc,a.mapping)),o.dispatch(a)})),pe(this,"_onBodyRef",(e=>{if(e){this._body=e;const t=i.findDOMNode(e);t instanceof HTMLElement&&te.observe(t,this._onBodyResize)}else{const e=this._body&&i.findDOMNode(this._body);e instanceof HTMLElement&&te.unobserve(e),this._body=null}})),pe(this,"_onBodyResize",(e=>{const t=this._body?function(e){let t=e.parentElement;for(;t&&!t.offsetParent;)t=t.parentElement;if(t&&t.offsetParent&&t.offsetParent.offsetWidth&&t.offsetParent.offsetWidth>0){const{offsetParent:n}=t,s=e.ownerDocument.defaultView.getComputedStyle(n);let o=n.clientWidth-4;return"border-box"===s.boxSizing&&(o-=parseInt(s.paddingLeft,10)+parseInt(s.paddingRight,10)),Math.max(o,U)}return fe}(i.findDOMNode(this._body)):fe;this.setState({maxSize:{width:t,height:fe,complete:!!this._body}})})),this._body=null,this._id=me(),this._inlineEditor=null,this._mounted=!1,this.state={maxSize:{width:fe,height:fe,complete:!1},originalSize:ge}}componentDidMount(){this._mounted=!0,this._resolveOriginalSize(),this._renderInlineEditor()}componentDidUpdate(e){const t=e.node.attrs.src,{node:n}=this.props,{src:s}=n.attrs;t!==s&&this._resolveOriginalSize(),this._renderInlineEditor()}componentWillUnmount(){this._mounted=!1,this._inlineEditor&&this._inlineEditor.close(),this._inlineEditor=null}_renderInlineEditor(){const e=document.getElementById(this._id);if(!e||"true"!==e.getAttribute("data-active"))return void(this._inlineEditor&&this._inlineEditor.close());const{node:t}=this.props,n={value:t.attrs,onSelect:this._onChange};this._inlineEditor?this._inlineEditor.update(n):this._inlineEditor=(0,ne.Z)(D,n,{anchor:e,autoDismiss:!1,container:e.closest?e.closest(".text-editor-frame-body"):null,position:q.lS,onClose:()=>{this._inlineEditor=null}})}render(){const{originalSize:e,maxSize:t}=this.state,{editorView:n,node:s,selected:i,focused:a}=this.props,{readOnly:c}=n,{attrs:u}=s,{align:d,crop:h,rotate:p}=u,m=e===ge,f=!m&&a&&!c&&e.complete,g=e.complete?e.src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",b=m?1:e.width/e.height,v=!m&&!e.complete;let{width:y,height:w}=u;m&&(y=y||24,w=w||24),y&&!w?w=y/b:w&&!y?y=w*b:y||w||(y=e.width,w=e.height);let E=1;y>t.width&&(!h||h.width>t.width)&&(y=t.width,w=y/b,E=t.width/y);const _=o()("editor-image-view-body",{active:f,error:v,focused:a,loading:m,selected:i}),k=!f||h||p?null:r.createElement(K,{height:w,onResizeEnd:this._onResizeEnd,src:g,width:y}),x={display:"inline-block",height:w+"px",left:"0",top:"0",width:y+"px",position:"relative"},S={};if(h){const e=de({},h);1!==E&&(E=t.width/e.width,e.width*=E,e.height*=E,e.left*=E,e.top*=E),S.width=e.width+"px",S.height=e.height+"px",x.left=e.left+"px",x.top=e.top+"px"}p&&(S.transform=`rotate(${p}rad)`);let C=null;u.meta&&(C=r.createElement("pre",{className:"img-tooltip"},u.meta));const Z=v?r.createElement("span",{className:"editor-image-view-error"},O.Z.error," "):null,M=v?`${l.a.t("text-editor:unable-to-load-image")} ${u.src||""}`:void 0,N=r.createElement("img",{alt:"",className:"editor-image-view-body-img","data-align":d,height:w,id:`${this._id}-img`,src:g,width:y});return r.createElement(r.Fragment,null,C,r.createElement("span",{className:_,"data-active":f?"true":void 0,"data-original-src":String(u.src),id:this._id,ref:this._onBodyRef,title:M},r.createElement("span",{className:"editor-image-view-body-img-clip",style:S},r.createElement("span",{style:x},Z,N)),k))}}var ve=class extends C{createDOMElement(){const e=document.createElement("span");return e.className="editor-image-view",e.addEventListener("dragstart",(e=>{var t=document.createElement("img");t.src=this.props.node.attrs.src,e.dataTransfer.setDragImage(t,0,0)}),!1),this._updateDOM(e),e}update(e,t){return super.update(e,t),this._updateDOM(this.dom),!0}renderReactComponent(){return r.createElement(be,de({},this.props))}_updateDOM(e){const{align:t}=this.props.node.attrs;let n="editor-image-view";t&&(n+=" align-"+t),e.className=n}}},346527:function(e,t,n){var s=n(202784),o=n(922730),r=n(768466),i=n(513014),a=n(816092),l=Object.defineProperty,c=(e,t,n)=>(((e,t,n)=>{t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const u=/\s/;class d extends s.PureComponent{constructor(){super(...arguments),c(this,"state",{url:this.props.href}),c(this,"_onKeyDown",(e=>{13===e.keyCode&&(e.preventDefault(),this._apply())})),c(this,"_onURLChange",(e=>{const t=e.target.value;this.setState({url:t})})),c(this,"_cancel",(()=>{this.props.close()})),c(this,"_apply",(()=>{const{url:e}=this.state;e&&!u.test(e)&&this.props.close((0,r.Z)(e))}))}render(){const{href:e}=this.props,{url:t}=this.state,n=!!t&&u.test(t);let r=o.a.t("text-editor:apply"),l=!!n;return e?(r=t?o.a.t("text-editor:apply"):o.a.t("text-editor:remove"),l=n):l=n||!t,s.createElement("div",{className:"image-url-editor"},s.createElement("form",{className:"editor-form",onSubmit:a.Z},s.createElement("fieldset",null,s.createElement("legend",null,o.a.t("text-editor:add-link")),s.createElement("input",{autoFocus:!0,onChange:this._onURLChange,onKeyDown:this._onKeyDown,placeholder:o.a.t("text-editor:paste-url"),spellCheck:!1,type:"text",value:t||""})),s.createElement("div",{className:"editor-form-buttons"},s.createElement(i.Z,{label:o.a.t("text-editor:cancel"),onClick:this._cancel}),s.createElement(i.Z,{active:!0,disabled:l,label:r,onClick:this._apply}))))}}t.Z=d},57444:function(e,t,n){n.d(t,{DL:function(){return l},ID:function(){return a},Oi:function(){return i},SC:function(){return o},lS:function(){return r}});var s=n(452626);function o(e,t){const n={x:0,y:0,w:0,h:0};if(e&&t){n.x=e.x,n.y=e.y+e.h;const s=window.innerWidth,o=window.innerHeight;n.x+t.w>s&&(n.x=e.x-t.w+e.w),n.y+t.h>o&&(n.y=Math.max(e.y-t.h,2))}return e&&!(0,s.zb)(e)||(n.x=-1e4),n}function r(e,t){const n={x:0,y:0,w:0,h:0};return e&&t&&(n.x=Math.max(e.x-(t.w-e.w)/2,10),n.y=e.y+e.h),e&&!(0,s.zb)(e)||(n.x=-1e4),n}function i(e,t){const n={x:0,y:0,w:0,h:0};return t&&(n.x=(window.innerWidth-t.w)/2,n.y=(window.innerHeight-t.h)/2),t&&!(0,s.zb)(t)||(n.x=-1e4),n}function a(e,t){const n={x:0,y:0,w:0,h:0};return e&&t&&(n.x=e.x+e.w+1-t.w,n.y=e.y),e&&!(0,s.zb)(e)||(n.x=-1e4),n}function l(e,t){const n={x:0,y:0,w:0,h:0};return e&&t&&(n.x=e.x+(e.w-t.w)/2,n.y=e.y),e&&!(0,s.zb)(e)||(n.x=-1e4),n}},816092:function(e,t,n){function s(e){e.preventDefault()}n.d(t,{Z:function(){return s}})},452626:function(e,t,n){function s(e){return 0===e.w||0===e.h}function o(e,t,n){const s=n||0;return!(t.x-s>e.x+e.w+s||t.x+t.w+s<e.x-s||t.y-s>e.y+e.h+s||t.y+t.h+s<e.y-s)}function r(e,t,n){return{x:e-(n=n||0),y:t-n,w:2*n,h:2*n}}function i(e){if("contents"===document.defaultView.getComputedStyle(e).display&&1===e.children.length)return i(e.children[0]);const t=e.getBoundingClientRect();return{x:t.left,y:t.top,w:t.width,h:t.height}}n.d(t,{hs:function(){return i},mv:function(){return r},vY:function(){return o},zb:function(){return s}})},978491:function(e,t,n){n.d(t,{Z:function(){return f}});var s=n(900883),o=n(700601),r=n.n(o);var i=function(){return!!r()(window.navigator,"onLine")&&!window.navigator.onLine},a=Object.defineProperty,l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,d=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const h={},p=[];function m(){const e=p.shift();e&&function(e,t,n){const o={complete:!1,height:0,naturalHeight:0,naturalWidth:0,src:e||"",width:0};if(i())return void t(o);const r=e||"";if(!r)return void t(o);if(h[r]){const e=Object.assign({},h[r]);return void t(e)}const a=s.parse(r),{protocol:p,port:f}=a;if(!/(http:|https:|data:)/.test(p||window.location.protocol)||f)return void t(o);let g;const b=()=>{g&&(o.width=g.width,o.height=g.height,o.naturalWidth=g.width,o.naturalHeight=g.height,o.complete=!0),t(o),y(),h[r]=((e,t)=>{for(var n in t||(t={}))c.call(t,n)&&d(e,n,t[n]);if(l)for(var n of l(t))u.call(t,n)&&d(e,n,t[n]);return e})({},o)},v=()=>{t(o),y()};function y(){if(g){if(g instanceof HTMLElement){const e=g.parentNode;e&&e.removeChild(g)}g.onload=null,g.onerror=null,g=null}m()}const{body:w}=document;w?(g=document.createElement("img"),g.style.cssText="position:fixed;left:-10000000000px;width:auto;height:auto;",g.onload=b,g.onerror=v,g.src=r,w.appendChild(g)):(g=new Image,g.onload=b,g.onerror=v,g.src=r)}(e.src,e.resolve,e.reject)}var f=function(e){return new Promise(((t,n)=>{const s={src:e,resolve:t,reject:n};p.push(s),m()}))}},894778:function(e,t,n){var s=n(526151),o=Object.defineProperty,r=(e,t,n)=>(((e,t,n)=>{t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);function i(e,t){const n=e[t];return"tr"===t&&n instanceof s.wx?n.setMeta("dryrun",!0):n}function a(e,t,n){return e[t]=n,!0}const l=class{constructor(){r(this,"shouldRespondToUIEvent",(e=>e.type===l.EventType.CLICK)),r(this,"active",(e=>!1)),r(this,"enable",((e,t)=>this.dryRun(e,t))),r(this,"dryRun",((e,t)=>{const{Proxy:n}=window,s=n?new n(e,{get:i,set:a}):e;return this.run(s,null,t)})),r(this,"run",((e,t,n,s)=>(this.waitForUserInput(e,t,n,s).then((s=>{this.executeWithUserInput(e,t,n,s)})).catch((e=>{console.error(e)})),!1))),r(this,"waitForUserInput",((e,t,n,s)=>Promise.resolve(void 0))),r(this,"executeWithUserInput",((e,t,n,s)=>!1))}cancel(){}};let c=l;r(c,"EventType",{CLICK:"mouseup",MOUSEENTER:"mouseenter"}),t.Z=c},208757:function(e,t){t.Z=function(e){const t=e.match(/[a-zA-Z0-9_\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g);let n=0;if(null===t)return n;for(let s=0;s<t.length;s++)t[s].charCodeAt(0)>=19968?n+=t[s].length:n+=1;return n}},563135:function(e,t,n){var s=n(690299),o=n.n(s),r=n(193450),i=n(859067);const a=o()("isle:text-editor");t.Z=(e,t)=>{a("Handle drop event...");const n={x:t.clientX,y:t.clientY},s=e.posAtCoords({left:n.x,top:n.y}),o=s?s.pos:null,{dataTransfer:l}=t;if(l&&l.files&&l.files.length>0){t.preventDefault();const{files:s}=l,o=Array.from(s);(0,i.q)(e,o,n)&&(0,r.wM)(e)}else(0,r.yz)(e,o)}},966123:function(e,t,n){n.d(t,{Z:function(){return M}});var s=n(202784),o=n(690299),r=n.n(o),i=n(198),a=n(581440),l=n(185610),c=n(153446),u=n(836663),d=n(296781),h=n(155061),p=n(294565),m=n(112114),f=n(812128),g=n(141396),b=n(557106),v=n.n(b),y=n(783158),w=n.n(y);var E=function(e,t,n,s){let o=t;if(e.nodeSize<=2)return null;const r=e=>e.type===s;for(t=v()(2,t),n=w()(n,e.nodeSize-2);o<=n;){const t=e.nodeAt(o);if(!t||!t.marks){o++;continue}const n=t.marks.find(r);if(n)return n;o+=1}return null};const _={1:26,2:20,3:18,4:15,5:12};var k=function(e){const{schema:t,doc:n,selection:s,tr:o}=e,r=t.marks.fontSize,i=t.nodes.heading,a=String(12);if(!r)return a;const{from:l,to:c,empty:u}=s;if(u){const t=(o.storedMarks||e.storedMarks||s.$cursor&&s.$cursor.marks&&s.$cursor.marks()||[]).find((e=>e.type===r));return t?String(t.attrs.pt||a):a}const d=r?E(n,l,c,r):null;if(d)return String(d.attrs.pt);if(!i)return a;const h=(0,g.Tr)(i)(e.selection);if(!h)return a;const p=String(h.node.attrs.level);return _[p]||a},x=n(450980),S=JSON.parse('["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b","#000000"]');const C=r()("isle:text-editor"),O="#6e6e6e",Z=e=>{if(e.disabled)return s.createElement("button",{onClick:e.onClick,style:{active:e.active,color:e.active?"black":O,opacity:.2},disabled:!0,className:"menu-item","aria-label":e.t(e.title)},e.children);let t=e.t(e.title);return e.hotkey&&(t+=` (${e.hotkey})`),s.createElement(m.Z,{key:`${e.itemKey}-tooltip`,tooltip:t,placement:"bottom"},s.createElement("button",{onClick:e.onClick,style:{active:e.active,color:e.active?"black":O},className:"menu-item","aria-label":e.t(e.title)},e.children))};var M=(0,i.Z)("text-editor")((({menu:e,children:t,state:n,dispatch:o,view:r,fullscreen:i,showColorPicker:m,onColorChoice:g,container:b,t:v})=>{const y=e=>t=>{t.preventDefault(),e.run&&(C("Run command",e,t),e.run(n,o,r,t.nativeEvent))},w=(e,t)=>s.createElement(Z,{key:t,itemKey:t,type:"button",active:!(!e.active||!n)&&e.active(n),disabled:!(!e.enable||!n)&&!e.enable(n),title:"string"==typeof e.title?v(e.title):"",hotkey:e.hotkey,onClick:y(e),t:v},(0,p.isPrimitive)(e.content)?v(e.content):e.content),E=(e,t)=>e.enable&&n&&!e.enable(n)?s.createElement(h.Z,{key:`dropdown-item-${t}`,disabled:!0},(0,p.isPrimitive)(e.content)?v(e.content):e.content):s.createElement(h.Z,{key:`dropdown-item-${t}`,onClick:y(e)},(0,p.isPrimitive)(e.content)?v(e.content):e.content),_=e=>e?e.map(w):null;return s.createElement("div",{className:"prose-menu-bar cancel"},t,_(e.blocks),e.headers?s.createElement(s.Fragment,null,s.createElement(l.Z,{title:s.createElement("span",{className:"screenreader"},v("headers")),variant:"outline-secondary",size:"sm",style:{display:"inline-block",marginRight:4}},e.headers.map(E)),s.createElement("i",{className:"prose-separator"},"|")):null,_(e.marks),i?_(e.extraMarks):null,s.createElement("div",{style:{display:m?"initial":"none",position:"absolute",top:"50px",left:"100px",zIndex:2}},s.createElement(a.Z,{width:"600px",colors:S,circleSize:16,onChangeComplete:g})),s.createElement("i",{className:"prose-separator"},"|"),e.fontSizes?s.createElement(c.Z,{style:{display:"inline-block",marginLeft:4}},s.createElement(d.Z,{size:"sm",variant:"outline-secondary",disabled:!n||!(0,x.Z)(n,"fontSize")},n?k(n):"12"),s.createElement(u.Z,{style:{minWidth:"24px"}},e.fontSizes.map(((e,t)=>s.createElement(h.Z,{key:`font-buttons-${t}`,style:{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3},onClick:y(e)},e.content))))):null,_(e.wraps),i&&e.alignment?s.createElement(s.Fragment,null,s.createElement("i",{className:"prose-separator"},"|"),_(e.alignment)):null,e.insert?s.createElement(s.Fragment,null,s.createElement("i",{className:"prose-separator"},"|"),s.createElement(l.Z,{title:s.createElement(s.Fragment,null,f.Z.insert,s.createElement("span",{className:"screenreader"},v("insert"))),variant:"outline-secondary",size:"sm",style:{display:"inline-block"},name:"Insert"},e.insert.map(E))):null,e.tableEdits?s.createElement(s.Fragment,null,s.createElement("i",{className:"prose-separator"},"|"),s.createElement(l.Z,{title:s.createElement(s.Fragment,null,f.Z.table,s.createElement("span",{className:"screenreader"},v("table"))),variant:"outline-secondary",size:"sm",style:{display:"inline-block"},name:"Table"},e.tableEdits.map(E))):null,i&&e.history?s.createElement(s.Fragment,null,s.createElement("i",{className:"prose-separator"},"|"),e.history.map(w)):null,e.addons?s.createElement("i",{className:"prose-separator"},"|"):null,_(e.addons))}))},592941:function(e,t,n){var s=n(130764),o=n(922032);t.Z=e=>{const t=document.createElement("div");return t.innerHTML=e,s.aw.fromSchema(o.Z).parse(t)}},706e3:function(e,t,n){var s=n(202784);t.Z=e=>s.createElement("div",{className:"prose-statusbar"},s.createElement("span",null,e.t("words"),": ",e.nWords),s.createElement("span",{style:{marginLeft:5}},e.t("characters"),": ",e.nChars))},979409:function(e,t,n){var s=n(202784),o=n(213980),r=n.n(o),i=n(690299),a=n.n(i),l=n(130764),c=n(952780),u=n(627191),d=n(732357),h=n(814361),p=n(151300),m=n.n(p),f=n(690202),g=n(966123),b=n(922032),v=n(5027),y=n(565784),w=n(193450),E=n(706e3),_=n(208757),k=n(563135),x=n(592941),S=Object.defineProperty,C=(e,t,n)=>(((e,t,n)=>{t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const O=a()("isle:text-editor");class Z extends s.Component{constructor(e){let t;super(e),C(this,"_createEditorView",(e=>{this.editorDiv=e,null!==e&&(this.editorView=new c.tk(e,{state:this.state.editorState,dispatchTransaction:this.dispatchTransaction,nodeViews:{footnote:(e,t,n,s)=>new v.Z(e,t,n,s),image:(e,t,n,s)=>new y.Z(e,t,n,s),plot:(e,t,n,s)=>new y.Z(e,t,n,s),plotContainer:(e,t,n,s)=>new y.Z(e,t,n,s)},handleDOMEvents:{dragenter:e=>{O("Handle drag enter event..."),(0,w.yz)(e)},drop:k.Z,keydown:this.props.onKeyDown}})),this.props.onMount(this.editorDiv)})),C(this,"onEditorState",(e=>{let t=0,n=0;this.props.showStatusBar&&e.doc.forEach((e=>{e.forEach((e=>{e.text&&(t+=e.text.length,n+=(0,_.Z)(e.text))}))})),this.props.onEditorState(e),this.setState({editorState:e,nWords:n,nChars:t})})),C(this,"dispatchTransaction",(e=>{let t=this.state.editorState.apply(e);null!==this.editorView&&this.editorView.updateState(t);let n=(0,d.tp)(this.state.editorState);n&&(t=t.apply(n.setMeta("addToHistory",!1))),this.onEditorState(t)})),C(this,"saveInBrowser",(()=>{O("Saving document state to local storage..."),this.state.editorState&&localStorage.setItem(this.props.id,JSON.stringify(this.state.editorState.doc.toJSON()))})),e.id&&(t=localStorage.getItem(e.id)),t||(t=e.defaultValue);const n=m()(t)?l.NB.fromJSON(b.Z,JSON.parse(t)):(0,x.Z)(t);this.state={editorState:u.yy.create({doc:n,schema:b.Z,plugins:f.Z})}}componentDidMount(){this.props.autoSave&&this.props.id&&(this.saveInterval=setInterval(this.saveInBrowser,this.props.intervalTime)),window.addEventListener("unload",this.saveInBrowser)}componentDidUpdate(e){if(this.props.defaultValue!==e.defaultValue||this.props.docId!==e.docId){O("Re-creating editor state...");const e=m()(this.props.defaultValue)?l.NB.fromJSON(b.Z,JSON.parse(this.props.defaultValue)):(0,x.Z)(this.props.defaultValue);this.setState({editorState:u.yy.create({doc:e,schema:b.Z,plugins:f.Z})},(()=>{this.editorView.destroy(),this._createEditorView(this.editorDiv)}))}}componentWillUnmount(){this.editorView&&this.editorView.destroy(),this.saveInterval&&clearInterval(this.saveInterval),window.removeEventListener("unload",this.saveInBrowser)}get markdown(){return h.Dm.serialize(this.state.editorState.doc)}focus(){this.editorView&&this.editorView.focus()}render(){return s.createElement(s.Fragment,null,s.createElement(g.Z,{menu:this.props.menu,state:this.state.editorState,dispatch:this.dispatchTransaction,view:this.editorView,fullscreen:this.props.fullscreen,showColorPicker:this.props.showColorPicker,onColorChoice:this.props.onColorChoice}),s.createElement("div",{className:this.props.className,ref:this._createEditorView}),this.props.showStatusBar?s.createElement(E.Z,{nWords:this.state.nWords,nChars:this.state.nChars,t:this.props.t}):null)}}Z.propTypes={autoSave:r().bool,intervalTime:r().number,defaultValue:r().string.isRequired,docId:r().number.isRequired,fullscreen:r().bool.isRequired,showColorPicker:r().bool.isRequired,menu:r().object.isRequired,showStatusBar:r().bool,t:r().func,onColorChoice:r().func,onEditorState:r().func,onKeyDown:r().func,onMount:r().func},Z.defaultProps={autoSave:!0,intervalTime:1e4,showStatusBar:!0,t(){},onColorChoice(){},onEditorState(){},onKeyDown(){},onMount(){}},t.Z=Z},5027:function(e,t,n){var s=n(952780),o=n(627191),r=n(951801),i=n(59195),a=n(526151),l=n(409961),c=n.n(l),u=n(783158),d=n.n(u),h=Object.defineProperty,p=(e,t,n)=>(((e,t,n)=>{t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);t.Z=class{constructor(e,t,n){p(this,"dispatchInner",(e=>{let{state:t,transactions:n}=this.innerView.state.applyTransaction(e);if(this.innerView.updateState(t),!e.getMeta("fromOutside")){let e=this.outerView.state.tr,t=a.KS.offset(this.getPos()+1);for(let s=0;s<n.length;s++){let o=n[s].steps;for(let n=0;n<o.length;n++)e.step(o[n].map(t))}e.docChanged&&this.outerView.dispatch(e)}})),this.node=e,this.outerView=t,this.getPos=n,this.dom=document.createElement("footnote"),this.innerView=null}selectNode(){this.dom.classList.add("ProseMirror-selectednode"),this.innerView||this.open()}deselectNode(){this.dom.classList.remove("ProseMirror-selectednode"),this.innerView&&this.close()}open(){let e=this.dom.appendChild(document.createElement("div"));e.className="footnote-tooltip",this.innerView=new s.tk(e,{state:o.yy.create({doc:this.node,plugins:[(0,i.h)({"Mod-z":()=>(0,r.Yw)(this.outerView.state,this.outerView.dispatch),"Mod-y":()=>(0,r.KX)(this.outerView.state,this.outerView.dispatch)})]}),dispatchTransaction:this.dispatchInner,handleDOMEvents:{mousedown:()=>{this.outerView.hasFocus()&&this.innerView.focus()}}})}close(){this.innerView.destroy(),this.innerView=null,this.dom.textContent=""}update(e){if(!e.sameMarkup(this.node))return!1;if(this.node=e,this.innerView){let t=this.innerView.state,n=e.content.findDiffStart(t.doc.content);if(!c()(n)){let{a:s,b:o}=e.content.findDiffEnd(t.doc.content),r=n-d()(s,o);r>0&&(s+=r,o+=r),this.innerView.dispatch(t.tr.replace(n,o,e.slice(n,s)).setMeta("fromOutside",!0))}}return!0}destroy(){this.innerView&&this.close()}stopEvent(e){return this.innerView&&this.innerView.dom.contains(e.target)}ignoreMutation(){return!0}}},975813:function(e,t,n){var s=n(609512);t.Z=function e(t,n,o,r){if(r<=0)return;const i=(0,s.Z)(t.style[n]),a=(o-i)/r*10;setTimeout((function(){const i=(0,s.Z)(t.style[n])+a;t.style[n]=`${i}px`,i!==o&&e(t,n,o,r-10)}),10)}},257513:function(e,t){t.Z=function(e){return!e||null===e.offsetParent}},422132:function(e,t){t.Z=function(e,t){const n=e.members;for(let s=0;s<n.length;s++){if(n[s].email===t)return!0}return!1}},19789:function(e,t){t.Z=function(e){return new Promise(((t,n)=>{const{FileReader:s}=window;if(s){const o=new s;o.onload=e=>{const n=e.target.result;t({src:n,height:0,width:0,id:""})},o.onerror=()=>{n(new Error("FileReader failed"))},o.readAsDataURL(e)}else n(new Error("FileReader is not available"))}))}},609512:function(e,t,n){var s=n(302467),o=n.n(s),r=n(792424),i=n.n(r);t.Z=function(e){return i()(e,"px")&&(e=parseFloat(o()(e,"px",""))),e}},870781:function(e,t){t.Z=function(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric"})}},107466:function(e,t){t.Z=function e(t,n,s){if(s<=0)return;const o=(n-t.scrollTop)/s*10;setTimeout((function(){t.scrollTop=t.scrollTop+o,t.scrollTop!==n&&e(t,n,s-10)}),10)}},365601:function(e,t){t.Z=function(e){let t=0;return()=>(t+=1,`${e}-${t}`)}},78708:function(e){e.exports=JSON.parse("[8,9,10,11,12,14,18,24,30,36,48,60,72]")}}]);