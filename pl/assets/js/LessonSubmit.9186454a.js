"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[29080],{897606:function(e,t,s){const i=(0,s(217431).Z)((()=>Promise.all([s.e(40532),s.e(74438)]).then(s.bind(s,603396))));t.Z=i},447610:function(e,t,s){const i=(0,s(217431).Z)((()=>s.e(89036).then(s.bind(s,287576))));t.Z=i},25046:function(e,t,s){s.r(t),s.d(t,{default:function(){return I}});var i=s(202784),n=s(690299),o=s.n(n),a=s(213980),l=s.n(a),r=s(498614),c=s(912895),p=s.n(c),h=s(318967),u=s.n(h),d=s(770561),m=s(715318),g=s(294565),f=s(623102),b=s.n(f),y=s(588703),v=s.n(y),S=s(686605),x=s.n(S),E=s(180024),w=s(653195),Z=s(447610),C=s(897606),L=s(351375),N=s(123103),z=s(302108),$=s(691334),U=(s(697927),s(741082)),k=s(487890);var P=function(e,t,s){return{text:s("lesson-completed-msg",{name:e.user.name,lessonName:e.lessonName,namespaceName:e.namespaceName,msg:t||""}),subject:`${e.lessonName} ${s("successfully-completed")}!`}},T=Object.defineProperty,A=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,j=(e,t,s)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,B=(e,t)=>{for(var s in t||(t={}))O.call(t,s)&&j(e,s,t[s]);if(A)for(var s of A(t))M.call(t,s)&&j(e,s,t[s]);return e},R=(e,t,s)=>(j(e,"symbol"!=typeof t?t+"":t,s),s);const D=o()("isle:lesson-submit");class q extends i.Component{constructor(e){super(e),R(this,"createResponseSummaryDoc",(()=>{const e=this.context,t={content:[{text:`${this.props.t("responses-header")} ${e.namespaceName+"/"+e.lessonName}`,style:"header",alignment:"center"}],styles:{header:{fontSize:24,bold:!0,margin:[0,0,0,10]},author:{fontSize:16,italics:!0,margin:[0,0,0,10],alignment:"center"},date:{fontSize:16,italics:!0,alignment:"right",margin:[0,15,0,15]},elapsed:{fontSize:16,italics:!0,alignment:"right",margin:[0,15,0,15]},subheader:{fontSize:18,bold:!0,margin:[0,30,0,10]},question:{fontSize:15,margin:[0,0,0,10],italics:!0}}};b()(e.user)||t.content.push({text:`${this.props.t("by")} ${e.user.name} (${e.user.email})`,style:"author"});const s=new Date;if(t.content.push({text:`${s.toLocaleDateString()} - ${s.toLocaleTimeString()}`,style:"date"}),t.content.push({text:`${this.props.t("elapsed")}: ${x()(e.duration/6e4)}min`,style:"elapsed"}),e.currentUserActions){let s=e.responseVisualizerIds;this.props.coverage&&(s=s.filter((e=>this.props.coverage.includes(e))));for(let i=0;i<s.length;i++){const n=e.responseVisualizers[s[i]];if(t.content.push({text:s[i],style:"subheader"}),n){const{type:o}=n,a=n.ref.props.data.question,l=n.ref.props.data.type;t.content.push({text:(0,g.isPrimitive)(a)?a:u()(a),style:"question"});let r=e.currentUserActions[s[i]];if(r){if(r=r.filter((e=>e.type===o)),r=r.sort(((e,t)=>e.absoluteTime-t.absoluteTime)),this.props.includeSolutions&&t.content.push({text:this.props.t("your-answer")+":"}),this.state.onlyLatest){const e=r[r.length-1];this.addAction(e,t,l,n)}else r.forEach(((e,s)=>{t.content.push({text:this.props.t("submission")+" #"+(s+1)+":"}),this.addAction(e,t,l,n)}));this.props.includeSolutions&&void 0!==n.ref.props.data.solution&&(t.content.push({text:this.props.t("solution")+":"}),this.addAction({type:o,value:n.ref.props.data.solution},t,l,n))}}}}p().createPdf(t).download("responses.pdf")})),R(this,"addAction",((e,t,s,i)=>{if("image"===s)t.content.push({image:e.value,width:500});else if("factor"===s){let s,n=i.ref.props.data.levels;n=n.map(((e,t)=>{let s=(0,g.isPrimitive)(e)?e:u()(e);return s||(s=`${this.props.t("choice")} ${t+1}`),s})),v()(e.value)?(s="",e.value.forEach(((e,t)=>{e&&(s&&(s+=", "),s+=n[t])}))):s=n[e.value],s||(s=this.props.t("none")),t.content.push({text:s})}else t.content.push({text:e.value})})),R(this,"closeUserModal",(()=>{this.setState({showUserModal:!1,visibleLogin:!1,visibleSignup:!1})})),R(this,"login",(e=>{e.stopPropagation(),this.setState({visibleLogin:!0,visibleSignup:!1})})),R(this,"signup",(e=>{e.stopPropagation(),this.setState({visibleSignup:!0,visibleLogin:!1})})),R(this,"closeSignup",(()=>{this.setState({visibleSignup:!1,showUserModal:!1})})),R(this,"closeLogin",(()=>{this.setState({visibleLogin:!1,showUserModal:!1})})),R(this,"handleLatestChange",(()=>{this.setState({onlyLatest:!this.state.onlyLatest})})),R(this,"finalizeSession",(()=>{D("Finalizing session...");const e=this.context;let t;if(this.props.coverage){const e=this.props.coverage.map((e=>`#${e} .submit-button`)).join(", ");t=document.querySelectorAll(e)}else t=document.getElementsByClassName("submit-button");for(let i=0;i<t.length;i++)t[i].innerText===this.props.t("submit")&&t[i].click();e.finalize();let s=this.props.t("lesson-successfully-completed");if(!b()(e.user)&&this.props.sendConfirmationEmail){s+=this.props.t("confirmation-email");const t=P(e,this.props.message,this.props.t);e.sendMail(t,e.user.email)}let n=!1;(e.responseVisualizerIds||[]).forEach((t=>{(e.currentUserActions[t]||[]).length>1&&(n=!0)})),e.addNotification({title:this.props.t("completed"),message:s,level:"success",position:"bc",autoDismiss:0,dismissible:"button",children:i.createElement("div",{style:{marginBottom:"40px"}},n?i.createElement(L.Z,{legend:this.props.t("only-latest"),defaultValue:this.state.onlyLatest,onChange:this.handleLatestChange}):null,i.createElement(d.Z,{variant:"success",size:"sm",style:{float:"right",marginRight:"10px",marginTop:n?"0px":"10px"},onClick:this.createResponseSummaryDoc},this.props.t("download-pdf"))),onRemove:()=>{this.setState({disabled:!1})}}),this.props.logAction($.gY),this.setState({disabled:!0}),window.removeEventListener("beforeunload",E.Z)})),R(this,"handleClick",(()=>{this.props.onClick();const e=this.context;if(this.props.requireLogin&&b()(e.user))return this.setState({showUserModal:!0});this.props.alertUnfinished&&e.unfinished&&e.unfinished.length>0?e.addNotification({title:this.props.t("unfinished"),message:this.props.t("unfinished-lesson-msg"),level:"warning",position:"bc",autoDismiss:0,dismissible:"both",children:i.createElement("div",{style:{marginBottom:"40px"}},i.createElement(d.Z,{variant:"success",size:"sm",style:{float:"right",marginRight:"10px",marginTop:"10px"},onClick:this.finalizeSession},this.props.t("submit")),i.createElement(d.Z,{variant:"success",size:"sm",style:{float:"right",marginRight:"10px",marginTop:"10px"},onClick:()=>{const e=this.context.unfinished;(0,w.Z)(e)}},this.props.t("show-unfinished"))),onRemove:()=>{this.setState({disabled:!1})}}):this.finalizeSession()})),this.state={showUserModal:!1,visibleLogin:!1,visibleSignup:!1,onlyLatest:!0}}componentDidMount(){const e=this.context;this.unsubscribe=e.subscribe((e=>{e!==z.YQ&&e!==z.Fw&&e!==z.E7||this.forceUpdate()}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}render(){const e=!this.context.live||this.state.disabled;return i.createElement("div",{className:`bg-light ${this.props.className}`,style:B({maxWidth:400,margin:"0 auto 0px",padding:"20px",fontFamily:"Arial"},this.props.style)},i.createElement("div",{className:"d-grid gap-2"},i.createElement(d.Z,{disabled:e,variant:"primary",size:"large",onClick:this.handleClick},this.props.label?this.props.label:this.props.t("finish-lesson"))),i.createElement(m.Z,{show:this.state.showUserModal,onHide:this.closeUserModal},i.createElement(m.Z.Header,{closeButton:!0},i.createElement(m.Z.Title,null,this.props.t("authentication"))),i.createElement(m.Z.Body,null,i.createElement("p",null,this.props.t("authentication-prompt"))),i.createElement(m.Z.Footer,{style:{textAlign:"center"}},i.createElement(d.Z,{variant:"primary",onClick:this.login.bind(this),style:{marginRight:"10px"}},this.props.t("login")),i.createElement(d.Z,{onClick:this.signup.bind(this)},this.props.t("signup")))),i.createElement(C.Z,{show:this.state.visibleLogin,onClose:this.closeLogin}),i.createElement(Z.Z,{show:this.state.visibleSignup,onClose:this.closeSignup}))}}q.defaultProps={alertUnfinished:!1,coverage:null,includeSolutions:!1,label:null,message:"",requireLogin:!0,sendConfirmationEmail:!0,className:"",style:{},onClick(){}},q.propTypes={alertUnfinished:l().bool,coverage:l().arrayOf(l().string),includeSolutions:l().bool,label:l().string,message:l().string,requireLogin:l().bool,sendConfirmationEmail:l().bool,className:l().string,style:l().object,onClick:l().func},q.contextType=N.Z;var I=(0,k.D)("LESSON_SUBMIT")((0,r.Zh)("lesson-submit")((0,U.W)(q)))},257513:function(e,t){t.Z=function(e){return!e||null===e.offsetParent}},653195:function(e,t,s){var i=s(588703),n=s.n(i),o=s(257513);t.Z=function(e){if(n()(e)){const t=e[0];if(t){const e=document.getElementById(t);if(!e)return;if((0,o.Z)(e)){const t=e.cloneNode(!0),s=document.createElement("div");s.id="unfinished-container",t.id="unfinished-elem",t.classList.add("focus-glow"),s.append(t),document.body.appendChild(s),setTimeout((()=>{const e=document.getElementById("unfinished-container");e&&e.parentNode.removeChild(e)}),4e3)}else e.classList.add("focus-glow"),e.scrollIntoView(),setTimeout((()=>{e.classList.remove("focus-glow")}),4e3)}}}},770561:function(e,t,s){var i=s(72779),n=s.n(i),o=s(202784),a=s(247830),l=s(429658),r=s(552322);const c=o.forwardRef((({as:e,bsPrefix:t,variant:s,size:i,active:o,className:c,...p},h)=>{const u=(0,l.vE)(t,"btn"),[d,{tagName:m}]=(0,a.FT)({tagName:e,...p}),g=m;return(0,r.jsx)(g,{...d,...p,ref:h,className:n()(c,u,o&&"active",s&&`${u}-${s}`,i&&`${u}-${i}`,p.href&&p.disabled&&"disabled")})}));c.displayName="Button",c.defaultProps={variant:"primary",active:!1,disabled:!1},t.Z=c},318967:function(e){var t=function(e,t){return e+s(t)},s=function(e){return null===e||"boolean"==typeof e||void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?e:Array.isArray(e)?e.reduce(t,""):function(e){return Object.prototype.hasOwnProperty.call(e,"props")}(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?s(e.props.children):""};s.default=s,e.exports=s}}]);