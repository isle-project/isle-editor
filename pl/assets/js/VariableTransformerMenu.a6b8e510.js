/*! For license information please see VariableTransformerMenu.a6b8e510.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3047],{234506:function(e,t,n){n.r(t),n.d(t,{default:function(){return vt}});var a=n(202784),r=n(213980),l=n.n(r),o=n(770561),i=n(467177),s=n(690299),c=n.n(s),u=n(579553),m=n.n(u),d=n(26266),p=n(830650),f=n(10863),g=n(96904),h=n(822736),v=n(260952),b=n(458264),E=n(312594),y=n(501258),Z=n.n(y),C=n(437069),w=n.n(C),N=n(74039),k=n.n(N),x=n(224008),V=n.n(x),q=n(309765),P=n(929321),F=n(656278),S=n(586318),G=n(473861),H=n(584443),A=n(262600),T=n(837898),R=n(316305),L=n.n(R),O=n(412042),z=n(519907),j=n(630132),M=n(292169),K=n(382617),B=n(147282),D=n(907756),I=n(80674),Y=n(153225),J=Object.defineProperty,W=Object.defineProperties,$=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,_=function(e,t,n){return t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},ee=function(e,t){for(var n in t||(t={}))X.call(t,n)&&_(e,n,t[n]);if(U)for(var a,r=(0,i.Z)(U(t));!(a=r()).done;){n=a.value;Q.call(t,n)&&_(e,n,t[n])}return e},te=function(e,t){return W(e,$(t))},ne=c()("isle:data-explorer:variable-transformer"),ae=/shapes\[(\d)\]\.x0/,re={group:null,displayDensity:!0,densityType:"Data-driven",chooseBins:!1,nBins:null},le={clickOutsideDeactivates:!0};function oe(e,t){return e-t}var ie=function(e){for(var t=[],n=0;n<e.length;n++)t.push({type:"line",x0:e[n],y0:-100,x1:e[n],y1:100,line:{color:"red",width:3}});return t},se=function(e,t){var n=new Array(t.length);t[0]?n[0]=t[0]:n[0]="(-\u221e,"+e[0]+")";for(var a=1;a<t.length;a++)t[a]?n[a]=t[a]:n[a]="["+e[a-1]+","+e[a]+")";var r=t.length-1;return t[r]?n[r]=t[r]:n[r]="["+e[e.length-1]+",\u221e)",n},ce=function(e){var t,n,r=(0,a.useState)(""),l=r[0],i=r[1],s=(0,a.useState)(0),c=s[0],u=s[1],y=(0,a.useState)({variable:null,configHist:null,breakpoints:null,categories:null,customNames:null}),C=y[0],N=y[1],x=l.length<2,R=function(){var t=C.variable,n=C.categories,a=C.breakpoints,r=e.data[t],o=(0,I.Z)(r,n,a);e.logAction(K.dU,{name:l,variable:t,breaks:a,categories:n});var i=(0,O.Z)(l,n);e.onGenerate(i,o),e.onHide()},J=function(e){13!==e.charCode||x||R()},W=function(e){i(e.target.value)},$=function(e){return function(t){ne("Change break point...");var n=C.breakpoints.slice();n[e]=k()(t,-c),n.sort(oe);var a=V()(C.configHist);a.layout.shapes=ie(n),N(te(ee({},C),{configHist:a,breakpoints:n,categories:se(n,C.customNames)}))}},U=function(e){return function(t){var n=C.categories.slice();n[e]=t;var a=C.customNames.slice();a[e]=t;var r=te(ee({},C),{categories:n,customNames:a});N(r)}},X=function(e){return function(){var t=C.breakpoints,n=C.categories,a=C.customNames;t.splice(e,1),n.splice(e,1),a.splice(e,1);var r=ee({},C.configHist);r.layout.shapes=ie(t),N(te(ee({},C),{configHist:r,categories:n,customNames:a,breakpoints:t}))}},Q=function(e){var t=w()(e),n=ae.exec(t[0]);if(n){var a=n[1],r=C.breakpoints.slice();r[a]=k()(e[t[0]],-c),r.sort(oe);var l=V()(C.configHist);l.layout.shapes=ie(r),N(te(ee({},C),{configHist:l,breakpoints:r,categories:se(r,C.customNames)}))}},_=function(t){ne("Change variable to bin...");var n=ee({data:e.data,variable:t},re),a=(0,B.N)(n);a.layout.yaxis={range:[(0,j.Z)(a.data[1].y),(0,M.Z)(a.data[1].y)],fixedrange:!0},a.layout.xaxis={fixedrange:!0};var r=e.data[t];r=r.filter((function(e){return(0,q.isPrimitive)(e)&&!L()(e)}));var l=[k()((0,z.Z)(r),-c)];a.layout.shapes=ie(l);var o=[!1,!1];N({variable:t,configHist:a,breakpoints:l,customNames:o,categories:se(l,o)})},ce=function(){var t=C.breakpoints.slice(),n=e.data[C.variable];n=n.filter((function(e){return(0,q.isPrimitive)(e)&&!L()(e)}));var a=Z()(.8,1.2)*(0,z.Z)(n);t.push(k()(a,-c)),t.sort(oe);var r=V()(C.configHist);r.layout.shapes=ie(t);var l=C.customNames;l.push(!1);var o=te(ee({},C),{breakpoints:t,configHist:r,categories:se(t,l)});N(o)};return a.createElement(G.Z,{cancel:".card-body",onDragStart:D.Z,style:{zIndex:1006}},a.createElement(m(),{focusTrapOptions:le},a.createElement(A.Z,{onHide:e.onHide,show:e.show,header:e.t("bin-transformer-header"),footer:a.createElement(o.Z,{onClick:R,disabled:x},e.t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},(t=C.configHist,n=a.createElement(F.Z,{legend:e.t("variable-to-bin"),defaultValue:C.variable,options:e.quantitative,onChange:_,style:{maxWidth:400}}),t?a.createElement(a.Fragment,null,n,a.createElement(o.Z,{className:"insert-line-button",onClick:ce},e.t("insert-break-line")),a.createElement("p",null,e.t("drag-red-bars"),"(",a.createElement(P.Z,{legend:e.t("digits-after-decimal-snap"),min:0,max:9,inline:!0,defaultValue:c,onChange:u}),")"),a.createElement("div",{style:{height:250}},a.createElement(H.Z,{data:t.data,layout:t.layout,editable:!0,fit:!0,removeButtons:!0,legendButtons:!1,onRelayout:Q})),a.createElement("div",null,a.createElement(v.Z,{className:"mb-2"},a.createElement(v.Z.Header,null,e.t("choose-category-labels"),":"),a.createElement(v.Z.Body,null,function(){var t=[],n=C.breakpoints,r=1===n.length;if(t.push(a.createElement(b.Z,{key:"div-0"},a.createElement(E.Z,{md:7},a.createElement(T.Z,{raw:"x < "}),a.createElement(P.Z,{inline:!0,onBlur:$(0),defaultValue:n[0],step:"any"})),a.createElement(E.Z,{md:4},a.createElement(S.Z,{key:0,legend:e.t("label")+" 1",defaultValue:C.categories[0],onChange:U(0),style:{width:200}})),a.createElement(E.Z,{md:1}))),n.length>1)for(var l=0;l<n.length-1;l++){var o=U(l+1);t.push(a.createElement(b.Z,{key:"div-"+(l+1)},a.createElement(E.Z,{md:7},a.createElement(P.Z,{inline:!0,onBlur:$(l),defaultValue:n[l],step:"any"}),a.createElement(T.Z,{raw:"\\le x <"}),a.createElement(P.Z,{inline:!0,onBlur:$(l+1),defaultValue:n[l+1],step:"any"})),a.createElement(E.Z,{md:4},a.createElement(S.Z,{key:1+l,legend:e.t("label")+" "+(l+2),defaultValue:C.categories[l+1],onChange:o,style:{width:200}})),a.createElement(E.Z,{md:1},a.createElement(Y.Z,{onClick:X(l),style:{marginTop:"5px"},disabled:r,tooltipPlacement:"right"}))))}var i=n.length;return t.push(a.createElement(b.Z,{key:"div-"+i},a.createElement(E.Z,{md:7},a.createElement(T.Z,{raw:"x \\ge"}),a.createElement(P.Z,{inline:!0,onChange:$(i-1),defaultValue:n[i-1],step:"any"})),a.createElement(E.Z,{md:4},a.createElement(S.Z,{legend:"Label "+(i+1),defaultValue:C.categories[i],onChange:U(i),key:i,style:{width:200}})),a.createElement(E.Z,{md:1},a.createElement(Y.Z,{onClick:X(i-1),style:{marginTop:"5px"},disabled:r})))),t}()))),a.createElement(f.Z,{style:{width:"fit-content"}},a.createElement(p.Z,null,e.t("name-new-variable"),":"),a.createElement(d.Z,{type:"text",placeholder:e.t("select-name"),onChange:W,onKeyPress:J}),a.createElement(g.Z,null,e.t("new-variable-appended")))):a.createElement(a.Fragment,null,n,a.createElement(h.Z,{variant:"info"},e.t("select-variable-bin")))))))};ce.defaultProps={logAction:function(){},onGenerate:function(){}},ce.propTypes={show:l().bool.isRequired,data:l().object.isRequired,quantitative:l().array.isRequired,logAction:l().func,onHide:l().func.isRequired,onGenerate:l().func};var ue=ce,me=n(497326),de=n(894578),pe=n(387612),fe=n(845450),ge=n(423184),he=n(482228),ve=n(738314),be=n(380408),Ee=n(156562),ye=n(298166),Ze=n(584195),Ce=n(708579),we=n(605977),Ne=n.n(we),ke=n(287013),xe=n.n(ke),Ve=n(302467),qe=n.n(Ve),Pe=n(271743),Fe=n(714785),Se=Object.defineProperty,Ge=function(e,t,n){return function(e,t,n){t in e?Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},He=/datum\.([^0-9]+)(\d+):datum\.\1(\d+)/,Ae=Ne()(0,10,1),Te=/(?:^|\n)([^\n]*)$/,Re=/^[0-9]/,Le={clickOutsideDeactivates:!0},Oe=a.forwardRef((function(e,t){var n=e.children,r=e.style,l=e.className,o=e["aria-labelledby"],i=(0,a.useState)(""),s=i[0],c=i[1];return a.createElement("div",{ref:t,style:r,className:l,"aria-labelledby":o},a.createElement(d.Z,{className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return c(e.target.value)},value:s}),a.createElement("ul",{className:"list-unstyled"},a.Children.toArray(n).filter((function(e){return!s||e.props.children.toLowerCase().startsWith(s)}))))})),ze=function(e){function t(t){var n;return n=e.call(this,t)||this,Ge((0,me.Z)(n),"handleGenerate",(function(){var e,t=n.state,a=t.code,r=t.name;if(He.test(a)){for(var l=He.exec(a),o=l[1],i=parseInt(l[2],10),s=parseInt(l[3],10),c="",u=i;u<=s;u++)c+="datum."+o+u,c+=u<s?",":"";a=qe()(a,l[0],c)}xe()(a,"return ")||(a=qe()(a,Te,"\nreturn $1"));try{e=(0,Pe.Z)(a,n.props.data),n.props.logAction(K.gx,{code:a,name:r}),n.state.asCategorical&&(e=e.map((function(e){return String(e)}))),n.props.onGenerate(r,e)}catch(m){return n.props.session.addNotification({title:"Errored",message:"Encountered the following error: "+m.message,level:"error",position:"tr"})}n.props.onHide()})),Ge((0,me.Z)(n),"handleNameChange",(function(e){n.setState({name:e.target.value})})),Ge((0,me.Z)(n),"handleCodeChange",(function(e){n.setState({code:e})})),Ge((0,me.Z)(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.name.length>=2&&n.handleGenerate()})),Ge((0,me.Z)(n),"insertVarFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a="datum";t+=a+=!xe()(e," ")&&!xe()(e,".")&&!Re.test(e)?"."+e:"['"+e+"']",t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),Ge((0,me.Z)(n),"insertLiteralFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=e;t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),Ge((0,me.Z)(n),"insertFuncFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=" "+e+"()";t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length-1})}})),n.state={code:t.defaultCode,selection:null,name:"",showGuide:!1,asCategorical:!1},n}return(0,de.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props.t,n=this.props.quantitative.map((function(t,n){return a.createElement(ve.Z.Item,{key:n,onClick:e.insertVarFactory(t),eventKey:n},t)}));return a.createElement(G.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},a.createElement(m(),{focusTrapOptions:Le},a.createElement(A.Z,{show:this.props.show,onHide:this.props.onHide,header:this.props.t("formula-transformer-header"),footer:a.createElement(o.Z,{onClick:this.handleGenerate,disabled:this.state.name.length<2},this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},a.createElement("div",{className:"formula-transformer-body"},a.createElement(ye.Z,{headerClassName:"title",header:this.state.showGuide?t("hide-example-guide"):t("show-example-guide"),visible:this.state.showGuide,onClick:function(){return e.setState({showGuide:!e.state.showGuide})}},a.createElement("p",null,t("formula-transformer-example-intro")),a.createElement(fe.Z,{condensed:!0},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,t("type")),a.createElement("th",null,t("example")),a.createElement("th",null,t("description")))),a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,t("interaction"),":"),a.createElement("td",null,a.createElement("code",null,"datum.",this.props.quantitative[0]," * datum.",this.props.quantitative[1])),a.createElement("td",null,a.createElement(pe.c,{i18nKey:"example-description-multiply",ns:"DataExplorer"},"Multiply values of variables ",a.createElement("code",null,{first:this.props.quantitative[0]})," and ",a.createElement("code",null,{second:this.props.quantitative[1]})))),a.createElement("tr",null,a.createElement("td",null,t("transformation"),":"),a.createElement("td",null,a.createElement("code",null,"exp( datum.",this.props.quantitative[0]," )")),a.createElement("td",null,a.createElement(pe.c,{i18nKey:"example-description-exponential",ns:"DataExplorer"},"Natural exponential function of variable ",a.createElement("code",null,{variable:this.props.quantitative[0]})))),a.createElement("tr",null,a.createElement("td",null,t("function"),":"),a.createElement("td",null,a.createElement("code",null,"9/5 * ",this.props.quantitative[0]," + 32")),a.createElement("td",null,a.createElement(pe.c,{i18nKey:"example-description-calculation",ns:"DataExplorer"},"Multiply values of ",a.createElement("code",null,{variable:this.props.quantitative[0]})," by ",a.createElement("code",null,"9/5")," and add ",a.createElement("code",null,"32"))))))),a.createElement("hr",null),a.createElement("div",{className:"mb-2"},a.createElement(he.Z,{style:{marginBottom:5}},a.createElement(ve.Z,{className:"mr-2"},a.createElement(ve.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},t("quantitative")),a.createElement(ve.Z.Menu,{variant:"light",as:Oe,id:"bg-nested-dropdown"},n)),a.createElement(ve.Z,{className:"mr-2"},a.createElement(ve.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},t("categorical")),a.createElement(ve.Z.Menu,{variant:"light",as:Oe,id:"bg-nested-dropdown"},this.props.categorical.map((function(t,n){return a.createElement(ve.Z.Item,{key:n,onClick:e.insertVarFactory(t),eventKey:n},t)})))))),a.createElement(v.Z,{className:"mb-2"},a.createElement(v.Z.Body,null,a.createElement(he.Z,{style:{marginBottom:5}},a.createElement(ge.Z,{size:"sm",className:"mr-2"},a.createElement(Ce.Z,{placement:"top",tooltip:t("smaller-than")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" < ")},"<")),a.createElement(Ce.Z,{placement:"top",tooltip:t("greater-than")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" > ")},">")),a.createElement(Ce.Z,{placement:"top",tooltip:t("smaller-or-equal")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" <= ")},"<=")),a.createElement(Ce.Z,{placement:"top",tooltip:t("greater-or-equal")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" >= ")},">="))),a.createElement(ge.Z,{size:"sm",className:"mr-2"},a.createElement(Ce.Z,{placement:"top",tooltip:t("open-parenthesis")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" ( ")},"(")),a.createElement(Ce.Z,{placement:"top",tooltip:t("closing-parenthesis")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" ) ")},")"))),a.createElement(ge.Z,{size:"sm",className:"mr-2"},a.createElement(Ce.Z,{placement:"top",tooltip:t("addition")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" + ")},"+")),a.createElement(Ce.Z,{placement:"top",tooltip:t("subtraction")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" - ")},"-")),a.createElement(Ce.Z,{placement:"top",tooltip:t("multiplication")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" * ")},"*")),a.createElement(Ce.Z,{placement:"top",tooltip:t("division")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" / ")},"/"))),a.createElement(ge.Z,{size:"sm",className:"mr-2"},a.createElement(Ce.Z,{placement:"top",tooltip:t("boolean-and")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" && ")},t("and"))),a.createElement(Ce.Z,{placement:"top",tooltip:t("boolean-or")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" || ")},t("or"))),a.createElement(Ce.Z,{placement:"top",tooltip:t("boolean-not")},a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(" !")},t("not"))))),a.createElement(he.Z,{style:{marginBottom:5}},a.createElement(ge.Z,{size:"sm",className:"mr-2"},Ae.map((function(t,n){return a.createElement(o.Z,{key:n,variant:"light",onClick:e.insertLiteralFactory(""+t)},t)})),a.createElement(o.Z,{variant:"light",onClick:this.insertLiteralFactory(".")},"."))),a.createElement(he.Z,null,a.createElement(ge.Z,{size:"sm",className:"me-2"},Fe.map((function(n,r){return a.createElement(Ce.Z,{key:r,placement:"bottom",tooltip:t(n+"-tooltip")},a.createElement(o.Z,{variant:"light",onClick:e.insertFuncFactory(n),eventKey:r},n))})))))),a.createElement(v.Z,{className:"mb-2"},a.createElement(v.Z.Body,null,a.createElement(Ze.Z,{ref:function(t){e.textarea=t},legend:t("expression")+":",placeholder:t("enter-formula"),value:this.state.code,onChange:this.handleCodeChange,onBlur:function(t){var n=t.target.selectionStart;e.setState({selection:n})},rows:3}))),a.createElement(f.Z,{style:{margin:8}},a.createElement(p.Z,null,t("name-new-variable"),":"),a.createElement(d.Z,{type:"text",placeholder:t("select-name"),onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),a.createElement(g.Z,null,t("new-variable-appended"))),a.createElement(be.Z,{name:"options",onChange:function(t){e.setState({asCategorical:t})},type:"radio",size:"small",value:this.state.asCategorical,style:{padding:6}},a.createElement(Ee.Z,{variant:"outline-secondary",value:!1},t("treat-as-quantitative")),a.createElement(Ee.Z,{variant:"outline-secondary",value:!0},t("treat-as-categorical")))))))},t}(a.Component);ze.defaultProps={logAction:function(){},onGenerate:function(){},defaultCode:"",session:{}},ze.propTypes={show:l().bool.isRequired,categorical:l().array.isRequired,quantitative:l().array.isRequired,data:l().object.isRequired,defaultCode:l().string,logAction:l().func,onGenerate:l().func,onHide:l().func.isRequired,session:l().object};var je=ze,Me=n(43649),Ke=n(147777),Be=n.n(Ke),De=n(471205),Ie=n.n(De),Ye=n(888244),Je=n.n(Ye),We=n(413262),$e=n(378176),Ue=n(151127),Xe=Object.defineProperty,Qe=function(e,t,n){return function(e,t,n){t in e?Xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},_e=c()("isle:data-explorer:variable-transformer"),et={clickOutsideDeactivates:!0};function tt(e){return e?qe()(e,".","[dot]"):e}function nt(e){for(var t=w()(e),n=!0,a=0;a<t.length;a++)Je()(e[t[a]])||(n=!1);return n}var at=function(e){function t(t){var n;n=e.call(this,t)||this,Qe((0,me.Z)(n),"handleFirstVariableChange",(function(e){var t,a={};if(n.state.secondVar){var r=e,l=n.state.secondVar,o=n.props.data[r];t=Be()(o,Ie());for(var i=(0,Ue.Z)(t,r),s=(0,Ue.Z)(n.state.secondFreqs,l),c=0;c<i.length;c++)for(var u=0;u<s.length;u++){var m=i[c]+"-"+s[u];a[tt(m)]=m}}else{var d=n.props.data[e];t=Be()(d,Ie());for(var p=(0,Ue.Z)(t,e),f=0;f<p.length;f++)a[tt(p[f])]=p[f]}var g=nt(a);n.setState({firstVar:e,firstFreqs:t,nameMappings:a,onlyNumbers:g})})),Qe((0,me.Z)(n),"handleSecondVariableChange",(function(e){if(!e){for(var t=n.state.firstVar,a=(0,Ue.Z)(n.state.firstFreqs,t),r={},l=0;l<a.length;l++)r[tt(a[l])]=a[l];return n.setState({secondVar:e,nameMappings:r})}for(var o={},i=n.state.firstVar,s=n.props.data[e],c=Be()(s,Ie()),u=(0,Ue.Z)(n.state.firstFreqs,i),m=(0,Ue.Z)(c,e),d=0;d<u.length;d++)for(var p=0;p<m.length;p++){var f=u[d]+"-"+m[p];o[tt(f)]=f}var g=nt(o);n.setState({secondVar:e,secondFreqs:c,nameMappings:o,onlyNumbers:g})})),Qe((0,me.Z)(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.generatedName.length>=2&&n.makeNewVar()})),Qe((0,me.Z)(n),"changeFreqFactory",(function(e){return function(t){var a=V()(n.state.nameMappings);a[tt(e)]=t.target.value;var r=nt(a);n.setState({nameMappings:a,onlyNumbers:r})}})),Qe((0,me.Z)(n),"changeContigencyFactory",(function(e,t){return function(a){var r=V()(n.state.nameMappings);r[tt(t)+"-"+tt(e)]=a.target.value,n.setState({nameMappings:r})}})),Qe((0,me.Z)(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),Qe((0,me.Z)(n),"makeNewVar",(function(){_e("Generating new categorical variable...");var e=n.state,t=e.firstVar,a=e.secondVar,r=e.nameMappings,l=e.castNumeric,o=(0,$e.Z)(t,a,r,n.props.data,l);n.props.onGenerate(n.state.generatedName,o),n.props.logAction(K.CS,{name:n.state.generatedName,firstVar:t,secondVar:a,nameMappings:r,castNumeric:l}),n.props.onHide()})),Qe((0,me.Z)(n),"renderFrequencyTable",(function(){var e=n.state.firstVar,t=n.props.data[e],r=Be()(t,Ie()),l=(0,Ue.Z)(r,e);return a.createElement(Me.Z,{bordered:!0,style:{margin:8},clickable:!1},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,n.props.t("old"),":"),l.map((function(t,n){return a.createElement("th",{key:e+"-"+n+"-old"},t)})))),a.createElement("tbody",null,a.createElement("tr",null,a.createElement("th",null,n.props.t("new"),":"),l.map((function(t,r){return a.createElement("th",{key:e+"-"+r+"-new"},a.createElement("input",{className:"transformer-table-input",type:"text",defaultValue:t,onChange:n.changeFreqFactory(t)}))}))),a.createElement("tr",{style:{borderTop:"1px solid black"}},a.createElement("th",null,n.props.t("frequencies"),":"),l.map((function(t,r){var l=n.state.firstFreqs[t];return a.createElement("td",{key:e+"-"+r+"-freq"},l)})))))})),Qe((0,me.Z)(n),"renderContingencyTable",(function(){var e=n.state.secondVar,t=n.state.firstVar,r=n.props.data[e],l=n.props.data[t],o=Be()(r,Ie()),i=Be()(l,Ie()),s=(0,Ue.Z)(o,e),c=(0,Ue.Z)(i,t);return a.createElement(Me.Z,{bordered:!0,style:{margin:8}},a.createElement("tr",null,a.createElement("th",null),c.map((function(e,t){return a.createElement("th",{key:e+"-"+t},e)}))),s.map((function(e,t){return a.createElement("tr",{key:e+"-"+t},a.createElement("th",null,e),c.map((function(t,r){return a.createElement("td",{key:e+"-"+t+"-"+r},a.createElement("input",{className:"transformer-table-input",type:"text",defaultValue:t+"-"+e,onChange:n.changeContigencyFactory(e,t)}))})))})))}));for(var r=t.categorical[0],l=t.data[r],o=Be()(l,Ie()),i=(0,Ue.Z)(o,r),s={},c=0;c<i.length;c++)s[tt(i[c])]=i[c];return n.state={generatedName:"",firstVar:r,firstFreqs:o,nameMappings:s,secondVar:null,secondFreqs:null,castNumeric:!1,onlyNumbers:!1},n}(0,de.Z)(t,e);var n=t.prototype;return n.renderTable=function(){return this.state.firstVar&&this.state.secondVar?this.renderContingencyTable():this.state.firstVar||this.state.secondVar?this.renderFrequencyTable():null},n.render=function(){var e=this,t=this.props.t;return a.createElement(G.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},a.createElement(m(),{focusTrapOptions:et},a.createElement(A.Z,{onHide:this.props.onHide,show:this.props.show,header:t("categorical-transformer-header"),footer:a.createElement(o.Z,{onClick:this.makeNewVar,disabled:this.state.generatedName.length<2},t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},a.createElement(b.Z,null,a.createElement(E.Z,{md:4},a.createElement(F.Z,{legend:t("first-variable"),defaultValue:this.state.firstVar||"",options:this.props.categorical,onChange:this.handleFirstVariableChange})),a.createElement(E.Z,{md:4},a.createElement(F.Z,{clearable:!0,legend:t("optional-second-variable"),defaultValue:this.state.secondVar||"",options:this.props.categorical,onChange:this.handleSecondVariableChange}))),a.createElement(b.Z,{style:{overflowX:"auto",width:"100%"}},this.renderTable()),a.createElement(b.Z,null,a.createElement(Ce.Z,{tooltip:t("treat-labels-as-numbers-tooltip")},a.createElement(We.Z,{legend:t("treat-labels-as-numbers"),defaultValue:!1,disabled:!this.state.onlyNumbers,onChange:function(){e.setState({castNumeric:!e.state.castNumeric})}}))),a.createElement(b.Z,null,a.createElement(f.Z,{style:{margin:8}},a.createElement(p.Z,null,t("name-new-variable"),":"),a.createElement(d.Z,{type:"text",placeholder:t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),a.createElement(g.Z,null,t("new-variable-appended")))))))},t}(a.Component);at.defaultProps={logAction:function(){}},at.propTypes={categorical:l().array.isRequired,data:l().object.isRequired,onGenerate:l().func.isRequired,logAction:l().func,onHide:l().func.isRequired,show:l().bool.isRequired};var rt=at,lt=n(240054),ot=n.n(lt),it=n(1570),st=n.n(it),ct=Object.defineProperty,ut=function(e,t,n){return function(e,t,n){t in e?ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},mt=c()("isle:data-explorer:group-transformer"),dt={clickOutsideDeactivates:!0},pt=function(e){function t(t){var n;return n=e.call(this,t)||this,ut((0,me.Z)(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),ut((0,me.Z)(n),"handleGroupNumberChange",(function(e){for(var t=new Array(e).fill(1/e),a=new Array(e),r=0;r<a.length;r++)a[r]=n.props.t("group")+" "+(r+1);n.setState({groupProbs:t,labels:a,nGroups:e})})),ut((0,me.Z)(n),"handleKeyPress",(function(e){if(13===e.charCode){for(var t=0,a=0;a<n.state.groupProbs.length;a++)t+=n.state.groupProbs[a];n.state.generatedName.length>2&&st()(t,1)<=15e-9&&n.makeNewVar()}})),ut((0,me.Z)(n),"makeNewVar",(function(){mt("Generating new categorical variable...");var e=w()(n.props.data),t=n.props.data[e[0]].length,a=ot()(n.state.labels,{size:t,probs:n.state.groupProbs,replace:!0});n.props.onGenerate(n.state.generatedName,a),n.props.logAction(K.Dp,{name:n.state.generatedName,labels:n.state.labels,groupProbs:n.state.groupProbs}),n.props.onHide()})),n.state={generatedName:"",nGroups:2,groupProbs:[.5,.5],labels:["Group 1","Group 2"]},n}(0,de.Z)(t,e);var n=t.prototype;return n.renderTable=function(){for(var e=this,t=new Array(this.state.nGroups),n=function(n){t[n]=a.createElement(b.Z,{key:n},a.createElement(E.Z,null,a.createElement(S.Z,{legend:"Label for Group "+(n+1),defaultValue:e.state.labels[n],onChange:function(t){var a=e.state.labels.slice();a[n]=t,e.setState({labels:a})}})),a.createElement(E.Z,null,a.createElement(P.Z,{legend:e.props.t("group-proportion"),onChange:function(t){var a=e.state.groupProbs.slice();a[n]=t,e.setState({groupProbs:a})},defaultValue:e.state.groupProbs[n],step:.01,min:0,max:1,numbersOnly:!1})))},r=0;r<t.length;r++)n(r);return a.createElement(a.Fragment,null,t,a.createElement("p",null,this.props.t("proportions-sum-one")))},n.render=function(){for(var e=0,t=0;t<this.state.groupProbs.length;t++)e+=this.state.groupProbs[t];var n=this.state.generatedName.length>2&&st()(e,1)<=15e-9;return a.createElement(G.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},a.createElement(m(),{focusTrapOptions:dt},a.createElement(A.Z,{onHide:this.props.onHide,show:this.props.show,header:this.props.t("group-transformer-header"),footer:a.createElement(o.Z,{onClick:this.makeNewVar,disabled:!n},this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},a.createElement(b.Z,null,a.createElement(E.Z,null,a.createElement(P.Z,{legend:this.props.t("number-of-groups"),onChange:this.handleGroupNumberChange,defaultValue:this.state.nGroups,step:1,min:1,max:99}))),this.renderTable(),a.createElement(b.Z,null,a.createElement(f.Z,{style:{margin:8}},a.createElement(p.Z,null,this.props.t("name-new-variable"),":"),a.createElement(d.Z,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),a.createElement(g.Z,null,this.props.t("new-variable-appended")))))))},t}(a.Component);pt.defaultProps={logAction:function(){}},pt.propTypes={data:l().object.isRequired,onGenerate:l().func.isRequired,logAction:l().func,onHide:l().func.isRequired,show:l().bool.isRequired};var ft=pt,gt=(0,n(525263).Z)((function(){return Promise.all([n.e(8941),n.e(8226),n.e(2460),n.e(4145),n.e(9956),n.e(7293)]).then(n.bind(n,147335))})),ht=function(e){var t,n=e.data,r=e.categorical,l=e.quantitative,i=e.t,s=e.session,c=e.defaultCode,u=e.logAction,m=e.onGenerate,d=(0,a.useState)(null),p=d[0],f=d[1],g=function(){var t="formula"===p?null:"formula";f(t),e.onActive(t)},h=function(){var t="bin"===p?null:"bin";f(t),e.onActive(t)},v=function(){var t="categorical"===p?null:"categorical";f(t),e.onActive(t)},b=function(){var t="group"===p?null:"group";f(t),e.onActive(t)},E=function(){var t="random"===p?null:"random";f(t),e.onActive(t)};if(n)switch(p){case"bin":t=a.createElement(ue,{show:!0,onHide:h,quantitative:l,logAction:u,onGenerate:m,data:n,t:i});break;case"categorical":t=a.createElement(rt,{show:!0,onHide:v,categorical:r,logAction:u,onGenerate:m,data:n,t:i});break;case"formula":t=a.createElement(je,{show:!0,onHide:g,categorical:r,quantitative:l,data:n,defaultCode:c,logAction:u,onGenerate:m,session:s,t:i});break;case"group":t=a.createElement(ft,{show:!0,onHide:b,logAction:u,onGenerate:m,data:n,t:i});break;case"random":t=a.createElement(gt,{show:!0,onHide:E,logAction:u,onGenerate:m,data:n,t:i})}return a.createElement(a.Fragment,null,a.createElement("div",{className:"well",style:{padding:15,margin:15}},a.createElement("div",{style:{padding:12}},a.createElement(o.Z,{onClick:g,variant:"primary",block:!0,style:{fontSize:"1.2em"}},i("interactions-functions"))),a.createElement("div",{style:{padding:12}},a.createElement(o.Z,{onClick:h,disabled:!l||0===l.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},i("bin-quantitative"))),a.createElement("div",{style:{padding:12}},a.createElement(o.Z,{onClick:v,disabled:!r||0===r.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},i("rename-or-combine"))),a.createElement("div",{style:{padding:12}},a.createElement(o.Z,{onClick:b,variant:"primary",block:!0,style:{fontSize:"1.2em"}},i("create-groups"))),a.createElement("div",{style:{padding:12}},a.createElement(o.Z,{onClick:E,variant:"primary",block:!0,style:{fontSize:"1.2em"}},i("generate-random-data")))),t)};ht.defaultProps={logAction:function(){},onActive:function(){},onGenerate:function(){},defaultCode:"",session:{}},ht.propTypes={categorical:l().array.isRequired,quantitative:l().array.isRequired,data:l().object.isRequired,defaultCode:l().string,logAction:l().func,onActive:l().func,onGenerate:l().func,session:l().object};var vt=ht},907756:function(e,t){t.Z=function(e){e.stopPropagation()}},888244:function(e,t,n){var a=n(667237);e.exports=a},667237:function(e,t,n){var a=n(294565).isPrimitive;e.exports=function(e){var t,n,r;if(!a(e))return!1;if(0===(t=e.length))return!1;for(r=0;r<t;r++)if((n=e.charCodeAt(r))<48||n>57)return!1;return!0}},915521:function(e,t,n){var a=n(501874),r=n(567359),l=n(268949),o=n(833022),i=n(213939),s=n(700601),c=n(362739),u=n(306830),m=n(149074).factory,d=n(422957),p=n(488088),f=n(15311),g=n(583764);e.exports=function(){var e,t,n,h,v,b;if(0===arguments.length)t=m();else if(1===arguments.length){if(!o(e=arguments[0]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(s(e,"prng")){if(!i(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=m(e)}else{if(h=f(v=arguments[0],b=arguments[1]))throw h;if(arguments.length>2){if(!o(e=arguments[2]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(s(e,"prng")){if(!i(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=m(e)}else t=m()}return a(n=void 0===v?V:x,"NAME","uniform"),e&&e.prng?(a(n,"seed",null),a(n,"seedLength",null),l(n,"state",c(null),u),a(n,"stateLength",null),a(n,"byteLength",null),a(n,"toJSON",c(null)),a(n,"PRNG",t)):(r(n,"seed",E),r(n,"seedLength",y),l(n,"state",w,N),r(n,"stateLength",Z),r(n,"byteLength",C),a(n,"toJSON",k),a(n,"PRNG",t),t=t.normalized),n;function E(){return t.seed}function y(){return t.seedLength}function Z(){return t.stateLength}function C(){return t.byteLength}function w(){return t.state}function N(e){t.state=e}function k(){var e={type:"PRNG"};return e.name=n.NAME,e.state=p(t.state),e.params=void 0===v?[]:[v,b],e}function x(){return g(t,v,b)}function V(e,n){return d(e)||d(n)||e>=n?NaN:g(t,e,n)}}},501258:function(e,t,n){var a=n(501874),r=n(387944);a(r,"factory",n(915521)),e.exports=r},387944:function(e,t,n){var a=n(915521)();e.exports=a},583764:function(e){e.exports=function(e,t,n){var a=e();return n*a+(1-a)*t}},15311:function(e,t,n){var a=n(309765).isPrimitive,r=n(316305);e.exports=function(e,t){return!a(e)||r(e)?new TypeError("invalid argument. First argument must be a number primitive and not `NaN`. Value: `"+e+"`."):!a(t)||r(t)?new TypeError("invalid argument. Second argument must be a number primitive and not `NaN`. Value: `"+t+"`."):e>=t?new RangeError("invalid argument. Minimum support `a` must be less than maximum support `b`. Value: `["+e+","+t+"]`."):null}},482228:function(e,t,n){var a=n(807896),r=n(231461),l=n(72779),o=n.n(l),i=n(202784),s=n(429658),c=["bsPrefix","className"],u=i.forwardRef((function(e,t){var n=e.bsPrefix,l=e.className,u=(0,r.Z)(e,c),m=(0,s.vE)(n,"btn-toolbar");return i.createElement("div",(0,a.Z)({},u,{ref:t,className:o()(l,m)}))}));u.displayName="ButtonToolbar",u.defaultProps={role:"toolbar"},t.Z=u},845450:function(e,t,n){var a=n(807896),r=n(231461),l=n(72779),o=n.n(l),i=n(202784),s=n(429658),c=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],u=i.forwardRef((function(e,t){var n=e.bsPrefix,l=e.className,u=e.striped,m=e.bordered,d=e.borderless,p=e.hover,f=e.size,g=e.variant,h=e.responsive,v=(0,r.Z)(e,c),b=(0,s.vE)(n,"table"),E=o()(l,b,g&&b+"-"+g,f&&b+"-"+f,u&&b+"-striped",m&&b+"-bordered",d&&b+"-borderless",p&&b+"-hover"),y=i.createElement("table",(0,a.Z)({},v,{className:E,ref:t}));if(h){var Z=b+"-responsive";return"string"==typeof h&&(Z=Z+"-"+h),i.createElement("div",{className:Z},y)}return y}));t.Z=u}}]);