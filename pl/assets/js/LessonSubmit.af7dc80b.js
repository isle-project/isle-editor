(self.webpackChunk=self.webpackChunk||[]).push([[9080],{701501:function(e,t,n){"use strict";var s=(0,n(844601).Z)((function(){return Promise.all([n.e(532),n.e(4438)]).then(n.bind(n,664062))}));t.Z=s},460231:function(e,t,n){"use strict";var s=(0,n(844601).Z)((function(){return n.e(9036).then(n.bind(n,358699))}));t.Z=s},825818:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return V}});n(382139),n(627476),n(95767),n(694882),n(298351);var s=n(858255),i=n(264659),o=n(904730),r=n(673989),a=n(175663),c=n(750591),l=n(575630),u=n(151119),p=(n(6059),n(898837),n(319371),n(202784)),f=n(911755),d=n.n(f),m=(n(213980),n(198)),h=n(912895),v=n.n(h),b=n(318967),g=n.n(b),y=n(770561),Z=n(81982),S=n(294565),x=n(623102),w=n.n(x),k=n(588703),O=n.n(k),P=n(686605),L=n.n(P),C=n(509901),N=n(460231),z=n(701501),j=n(785745),E=n(741319),U=n(964909),R=n(5140),A=(n(697927),n(432261));var D=function(e,t,n){return{text:n("lesson-completed-msg",{name:e.user.name,lessonName:e.lessonName,namespaceName:e.namespaceName,msg:t||""}),subject:"".concat(e.lessonName," ").concat(n("successfully-completed"),"!")}};function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;n=Reflect.construct(s,arguments,i)}else n=s.apply(this,arguments);return(0,c.Z)(this,n)}}var q=d()("isle:lesson-submit"),F=function(e){(0,a.Z)(n,e);var t=T(n);function n(e){var o;return(0,i.Z)(this,n),o=t.call(this,e),(0,u.Z)((0,r.Z)(o),"createResponseSummaryDoc",(function(){var e=o.context,t={content:[{text:"".concat(o.props.t("responses-header")," ").concat(e.namespaceName+"/"+e.lessonName),style:"header",alignment:"center"}],styles:{header:{fontSize:24,bold:!0,margin:[0,0,0,10]},author:{fontSize:16,italics:!0,margin:[0,0,0,10],alignment:"center"},date:{fontSize:16,italics:!0,alignment:"right",margin:[0,15,0,15]},elapsed:{fontSize:16,italics:!0,alignment:"right",margin:[0,15,0,15]},subheader:{fontSize:18,bold:!0,margin:[0,30,0,10]},question:{fontSize:15,margin:[0,0,0,10],italics:!0}}};w()(e.user)||t.content.push({text:"".concat(o.props.t("by")," ").concat(e.user.name," (").concat(e.user.email,")"),style:"author"});var n=new Date;if(t.content.push({text:"".concat(n.toLocaleDateString()," - ").concat(n.toLocaleTimeString()),style:"date"}),t.content.push({text:"".concat(o.props.t("elapsed"),": ").concat(L()(e.duration/6e4),"min"),style:"elapsed"}),e.currentUserActions)for(var s=e.responseVisualizerIds,i=function(n){var i=e.responseVisualizers[s[n]];if(t.content.push({text:s[n],style:"subheader"}),i){var r=i.type,a=i.ref.props.data.question,c=i.ref.props.data.type;t.content.push({text:(0,S.isPrimitive)(a)?a:g()(a),style:"question"});var l=e.currentUserActions[s[n]];if(l)if(l=(l=l.filter((function(e){return e.type===r}))).sort((function(e,t){return e.absoluteTime-t.absoluteTime})),o.state.onlyLatest){var u=l[l.length-1];o.addAction(u,t,c,i)}else l.forEach((function(e,n){t.content.push({text:o.props.t("submission")+" #"+(n+1)+":"}),o.addAction(e,t,c,i)}))}},r=0;r<s.length;r++)i(r);v().createPdf(t).download("responses.pdf")})),(0,u.Z)((0,r.Z)(o),"addAction",(function(e,t,n,s){if("image"===n)t.content.push({image:e.value,width:500});else if("factor"===n){var i,r=s.ref.props.data.levels;r=r.map((function(e,t){var n=(0,S.isPrimitive)(e)?e:g()(e);return n||(n="".concat(o.props.t("choice")," ").concat(t+1)),n})),i=O()(e.value)?e.value.map((function(e){return r[e]})).join(", "):r[e.value],t.content.push({text:i})}else t.content.push({text:e.value})})),(0,u.Z)((0,r.Z)(o),"closeUserModal",(function(){o.setState({showUserModal:!1,visibleLogin:!1,visibleSignup:!1})})),(0,u.Z)((0,r.Z)(o),"login",(function(e){e.stopPropagation(),o.setState({visibleLogin:!0,visibleSignup:!1})})),(0,u.Z)((0,r.Z)(o),"signup",(function(e){e.stopPropagation(),o.setState({visibleSignup:!0,visibleLogin:!1})})),(0,u.Z)((0,r.Z)(o),"closeSignup",(function(){o.setState({visibleSignup:!1,showUserModal:!1})})),(0,u.Z)((0,r.Z)(o),"closeLogin",(function(){o.setState({visibleLogin:!1,showUserModal:!1})})),(0,u.Z)((0,r.Z)(o),"handleLatestChange",(function(){o.setState({onlyLatest:!o.state.onlyLatest})})),(0,u.Z)((0,r.Z)(o),"finalizeSession",(function(){q("Finalizing session...");for(var e=o.context,t=document.getElementsByClassName("submit-button"),n=0;n<t.length;n++)t[n].innerText===o.props.t("submit")&&t[n].click();e.finalize();var i=o.props.t("lesson-successfully-completed");if(!w()(e.user)&&o.props.sendConfirmationEmail){i+=o.props.t("confirmation-email");var r=D(e,o.props.message,o.props.t);e.sendMail(r,e.user.email)}var a=!1;(e.responseVisualizerIds||[]).forEach((function(t){(e.currentUserActions[t]||[]).length>1&&(a=!0)})),e.addNotification({title:o.props.t("completed"),message:i,level:"success",position:"tr",autoDismiss:0,dismissible:"button",children:(0,s.Z)("div",{style:{marginBottom:"40px"}},void 0,a?(0,s.Z)(j.Z,{legend:o.props.t("only-latest"),defaultValue:o.state.onlyLatest,onChange:o.handleLatestChange}):null,(0,s.Z)(y.Z,{variant:"success",size:"sm",style:{float:"right",marginRight:"10px",marginTop:a?"0px":"10px"},onClick:o.createResponseSummaryDoc},void 0,o.props.t("download-pdf"))),onRemove:function(){o.setState({disabled:!1})}}),e.log({id:e.lessonName,type:R.kv,value:o.props.t("lesson-submitted")}),o.setState({disabled:!0}),window.removeEventListener("beforeunload",C.Z)})),(0,u.Z)((0,r.Z)(o),"handleClick",(function(){o.props.onClick();var e=o.context;if(o.props.requireLogin&&w()(e.user))return o.setState({showUserModal:!0});o.finalizeSession()})),o.state={showUserModal:!1,visibleLogin:!1,visibleSignup:!1,onlyLatest:!0},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.context;this.unsubscribe=t.subscribe((function(t){t!==U.YQ&&t!==U.Fw&&t!==U.E7||e.forceUpdate()}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe()}},{key:"render",value:function(){var e=!this.context.live||this.state.disabled;return(0,s.Z)("div",{className:"bg-light ".concat(this.props.className),style:B({maxWidth:400,margin:"0 auto 0px",padding:"20px",fontFamily:"Arial"},this.props.style)},void 0,(0,s.Z)(y.Z,{disabled:e,variant:"primary",size:"large",onClick:this.handleClick,block:!0},void 0,this.props.label?this.props.label:this.props.t("finish-lesson")),(0,s.Z)(Z.Z,{show:this.state.showUserModal,onHide:this.closeUserModal},void 0,(0,s.Z)(Z.Z.Header,{closeButton:!0},void 0,(0,s.Z)(Z.Z.Title,{},void 0,this.props.t("authentication"))),(0,s.Z)(Z.Z.Body,{},void 0,(0,s.Z)("p",{},void 0,this.props.t("authentication-prompt"))),(0,s.Z)(Z.Z.Footer,{style:{textAlign:"center"}},void 0,(0,s.Z)(y.Z,{variant:"primary",onClick:this.login.bind(this),style:{marginRight:"10px"}},void 0,this.props.t("login")),(0,s.Z)(y.Z,{onClick:this.signup.bind(this)},void 0,this.props.t("signup")))),(0,s.Z)(z.Z,{show:this.state.visibleLogin,onClose:this.closeLogin}),(0,s.Z)(N.Z,{show:this.state.visibleSignup,onClose:this.closeSignup}))}}]),n}(p.Component);F.defaultProps={label:null,message:"",requireLogin:!0,sendConfirmationEmail:!0,className:"",style:{},onClick:function(){}},F.contextType=E.Z;var V=(0,m.Z)("lesson-submit")((0,A.W)(F))},783679:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(202784);function i(e){var t=(0,s.useRef)(null);return(0,s.useEffect)((function(){t.current=e})),t.current}},770561:function(e,t,n){"use strict";var s=n(607560),i=n(998283),o=n(72779),r=n.n(o),a=n(202784),c=n(429658),l=n(482695),u=["bsPrefix","variant","size","active","className","block","type","as"],p=a.forwardRef((function(e,t){var n=e.bsPrefix,o=e.variant,p=e.size,f=e.active,d=e.className,m=e.block,h=e.type,v=e.as,b=(0,i.Z)(e,u),g=(0,c.vE)(n,"btn"),y=r()(d,g,f&&"active",o&&g+"-"+o,m&&g+"-block",p&&g+"-"+p);if(b.href)return a.createElement(l.Z,(0,s.Z)({},b,{as:v,ref:t,className:r()(y,b.disabled&&"disabled")}));t&&(b.ref=t),h?b.type=h:v||(b.type="button");var Z=v||"button";return a.createElement(Z,(0,s.Z)({},b,{className:y}))}));p.displayName="Button",p.defaultProps={variant:"primary",active:!1,disabled:!1},t.Z=p},318967:function(e){"use strict";var t=function(e,t){return e+n(t)},n=function(e){return null===e||"boolean"==typeof e||void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?e:Array.isArray(e)?e.reduce(t,""):function(e){return Object.prototype.hasOwnProperty.call(e,"props")}(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?n(e.props.children):""};n.default=n,e.exports=n}}]);