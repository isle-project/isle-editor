/*! For license information please see TextEditor.1a4e8a26.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[33553],{734622:function(t,e){e.Z=function(t,e,n,o){if(!t.selection||!t.doc||!n)return t;const{empty:s,$cursor:r,ranges:i}=t.selection;if(s&&!r||!function(t,e,n){for(let o=0;o<e.length;o++){const{$from:s,$to:r}=e[o];let i=0===s.depth&&t.type.allowsMarkType(n);if(t.nodesBetween(s.pos,r.pos,(t=>!i&&(i=t.inlineContent&&t.type.allowsMarkType(n),!0))),i)return!0}return!1}(t.doc,i,n))return t;if(r)return t=t.removeStoredMark(n),o?t.addStoredMark(n.create(o)):t;let a=!1;for(let l=0;!a&&l<i.length;l++){const{$from:e,$to:o}=i[l];a=t.doc.rangeHasMark(e.pos,o.pos,n)}for(let l=0;l<i.length;l++){const{$from:e,$to:s}=i[l];a&&(t=t.removeMark(e.pos,s.pos,n)),o&&(t=t.addMark(e.pos,s.pos,n.create(o)))}return t}},193450:function(t,e,n){n.d(e,{wM:function(){return i},yz:function(){return r}});var o=n(627191);const s=new o.H$("cursor-parking");e.ZP=()=>new o.Sy({key:s,state:{init(){return{inCursorParking:!1,storedMarks:null,bookmarkToRestore:null,pos:null}},apply(t,e){const n=t.getMeta(this);return n?n.inCursorParking?{inCursorParking:!0,pos:n.pos,storedMarks:t.storedMarks,bookmarkToRestore:t.selection.getBookmark()}:{inCursorParking:!1,pos:n.pos,storedMarks:null,bookmarkToRestore:null}:t.docChanged&&e.inCursorParking&&e.bookmarkToRestore?{inCursorParking:!0,pos:null,storedMarks:e.storedMarks,bookmarkToRestore:e.bookmarkToRestore.map(t.mapping)}:e}},view(){const t=document.createElement("cursor-parking");t.setAttribute("style","width:0px;height:0px;position:fixed;top:50%,left:50%;"),t.setAttribute("tabIndex","-1"),t.setAttribute("contenteditable","true");const e=()=>{t.innerHTML="<div><br/></div>"};return e(),document.body.appendChild(t),{update(n,r){const i=s.getState(r),a=s.getState(n.state);if(!i.inCursorParking&&a.inCursorParking&&(()=>{const e=document.createRange();e.selectNodeContents(t.firstChild);const n=window.getSelection();n.removeAllRanges(),n.addRange(e)})(),i.inCursorParking&&!a.inCursorParking){const{dispatch:t,state:s}=n;let r=s.tr;if(i.bookmarkToRestore&&r.setSelection(i.bookmarkToRestore.resolve(r.doc)),i.storedMarks&&r.setStoredMarks(i.storedMarks),n.focus(),a.pos){const t=a.pos;r=r.setSelection(o.Bs.create(r.doc,t,t))}else t(r);e()}},destroy(){t.parentNode.removeChild(t)}}}});const r=(t,e)=>{return n=void 0,o=null,r=function*(){t.dispatch(t.state.tr.setMeta(s,{inCursorParking:!0,pos:e})),yield new Promise((t=>setTimeout(t,0))),t.dispatch(t.state.tr.setMeta(s,{inCursorParking:!1,pos:e}))},new Promise(((t,e)=>{var s=t=>{try{a(r.next(t))}catch(n){e(n)}},i=t=>{try{a(r.throw(t))}catch(n){e(n)}},a=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,i);a((r=r.apply(n,o)).next())}));var n,o,r},i=t=>{t.dispatch(t.state.tr.setMeta(s,{inCursorParking:!1,storedMarks:null,bookmarkToRestore:null,pos:null}))}},241490:function(t,e,n){n.d(e,{NV:function(){return u},ud:function(){return p}});var o=n(627191),s=n(952780);const r={name:"CursorPlaceholderPlugin"};let i=null;const a={state:{init(){return s.EH.empty},apply(t,e){e=e.map(t.mapping,t.doc);const n=t.getMeta(this);if(!n)return e;if(n.add){const o=document.createElement("editor-cursor-placeholder");o.className="editor-cursor-placeholder";const i=s.p.widget(n.add.pos,o,{id:r});e=e.add(t.doc,[i])}else if(n.remove){const t=e.find(null,null,c);e=e.remove(t)}return e}},props:{decorations:t=>i?i.getState(t):null}};class l extends o.Sy{constructor(){if(super(a),i)return i;i=this}}function c(t){return t.id===r}function d(t){if(!i)return null;const e=i.getState(t).find(null,null,c);return(e.length?e[0].from:null)||null}function u(t){const e=i;let{tr:n}=t;if(!e||!n.selection)return n;return null===d(t)&&(n.selection.empty||(n=n.deleteSelection()),n=n.setMeta(e,{add:{pos:n.selection.from}})),n}function p(t){const e=i;let{tr:n}=t;if(!e)return n;return null!==d(t)&&(n=n.setMeta(e,{remove:{}})),n}e.ZP=l},840322:function(t,e,n){function o(t,e,n,o){let s=e;const r=t=>t.type===o;let i=null,a=null,l=null;for(;s<=n;){const e=t.nodeAt(s);if(!e||!e.marks)return null;const n=e.marks.find(r);if(!n)return null;if(i&&n!==i)return null;a=a||e,i=i||n,l=e,s++}let c=e,d=n,u=0;for(s=e-1;s>u;){const e=t.nodeAt(s),n=e&&e.marks.find(r);if(!n||n!==i)break;c=s,a=e,s--}for(s=n+1,u=t.nodeSize-2;s<u;){const e=t.nodeAt(s),n=e&&e.marks.find(r);if(!n||n!==i)break;d=s,l=e,s++}return{mark:i,from:{node:a,pos:c},to:{node:l,pos:d}}}n.d(e,{Z:function(){return o}})},812128:function(t,e,n){var o=n(202784);const s={alignLeft:o.createElement("i",{className:"prosemirror-icon fas fa-align-left"}),alignCenter:o.createElement("i",{className:"prosemirror-icon fas fa-align-center"}),alignRight:o.createElement("i",{className:"prosemirror-icon fas fa-align-right"}),alignJustify:o.createElement("i",{className:"prosemirror-icon fas fa-align-justify"}),annotation:o.createElement("i",{className:"prosemirror-icon fas fa-comment"}),blockquote:o.createElement("i",{className:"prosemirror-icon fas fa-quote-left"}),bold:o.createElement("i",{className:"prosemirror-icon fas fa-bold"}),bullet_list:o.createElement("i",{className:"prosemirror-icon fas fa-list-ul"}),code_block:o.createElement("i",{className:"prosemirror-icon fas fa-file-code"}),code:o.createElement("i",{className:"prosemirror-icon fas fa-code"}),color:o.createElement("i",{className:"prosemirror-icon fas fa-palette"}),editTable:o.createElement("i",{className:"prosemirror-icon fas fa-table"}),em:o.createElement("i",{className:"prosemirror-icon fas fa-italic"}),error:o.createElement("i",{className:"prosemirror-icon fas fa-bug"}),fullscreen:o.createElement("i",{className:"prosemirror-icon fas fa-expand"}),guides:o.createElement("i",{className:"prosemirror-icon fa fa-question-circle"}),history:o.createElement("i",{className:"prosemirror-icon fas fa-history"}),insert:o.createElement("i",{className:"prosemirror-icon fa fa-plus-square"}),link:o.createElement("i",{className:"prosemirror-icon fa fa-link"}),open:o.createElement("i",{className:"prosemirror-icon fa fa-folder-open"}),ordered_list:o.createElement("i",{className:"prosemirror-icon fas fa-list-ol"}),paragraph:o.createElement("i",{className:"prosemirror-icon fas fa-paragraph"}),pdf:o.createElement("i",{className:"prosemirror-icon fas fa-file-pdf"}),redo:o.createElement("i",{className:"prosemirror-icon fas fa-redo"}),reset:o.createElement("i",{className:"prosemirror-icon fa fa-eraser"}),save:o.createElement("i",{className:"prosemirror-icon fa fa-save"}),selectParent:o.createElement("i",{className:"prosemirror-icon far fa-object-group"}),strikethrough:o.createElement("i",{className:"prosemirror-icon fas fa-strikethrough"}),strong:o.createElement("i",{className:"prosemirror-icon fas fa-bold"}),submit:o.createElement("i",{className:"prosemirror-icon fa fa-share-square"}),subscript:o.createElement("i",{className:"prosemirror-icon fas fa-subscript"}),table:o.createElement("i",{className:"prosemirror-icon fas fa-table"}),superscript:o.createElement("i",{className:"prosemirror-icon fas fa-superscript"}),underline:o.createElement("i",{className:"prosemirror-icon fas fa-underline"}),undo:o.createElement("i",{className:"prosemirror-icon fas fa-undo"})};e.Z=s},859067:function(t,e,n){n.d(e,{q:function(){return m}});var o=n(627191),s=n(952780),r=n(409961),i=n.n(r),a=n(365601),l=n(19789);const c=(0,a.Z)("image_upload"),d=new Set(["image/jpeg","image/gif","image/png","image/jpg"]),u=new Array(4).join('<div class="editor-image-upload-placeholder-child"></div>');function p(t){return t instanceof f}function h(t){return t&&d.has(t.type)}function m(t,e,s){const{state:r,readOnly:a,disabled:d}=t,{schema:u,plugins:m}=r;if(a||d)return!1;const f=u.nodes.image;if(!f)return!1;const g=Array.from(e).filter(h);if(!g.length)return!1;const b=m.find(p);if(!b)return!1;const v={debugId:c()},y=(w=()=>{const e=e=>{const n=function(t,e,n){const o=t.getState(e).find(null,null,(t=>t.id===n));return o.length?o[0].from:null}(b,t.state,v);let o=t.state.tr;if(!n||t.readOnly||t.disabled)g.length=0;else{const t=f.create(e);o=o.replaceWith(n,n,t)}g.length?y():o=o.setMeta(b,{remove:{id:v}}),t.dispatch(o)},o=g.shift();if(i()(o))throw new Error("unexpected null value");const s=n.g.session;if(s.server&&s.uploadFile){const t=new FormData;t.append("file",o),s.uploadFile({formData:t,callback:(t,n)=>t?e({src:null}):n&&n.filename?e({src:s.server+"/"+n.filename}):e({src:null}),showNotification:!1})}else(0,l.Z)(o).then(e).catch(e.bind(null,{src:null}))},()=>{setTimeout(w,0)});var w;y();let{tr:E}=r,_=0;if(s){const e=t.posAtCoords({left:s.x,top:s.y});if(!e)return!1;_=e.pos,E=E.setSelection(o.Bs.create(E.doc,_,_))}else _=E.selection.to,E=E.setSelection(o.Bs.create(E.doc,_,_));const S={add:{id:v,pos:_}};return E=E.setMeta(b,S),t.dispatch(E),!0}class f extends o.Sy{constructor(){super({state:{init(){return s.EH.empty},apply(t,e){e=e.map(t.mapping,t.doc);const n=t.getMeta(this);if(n&&n.add){const o=document.createElement("div");o.title="Uploading...",o.className="editor-image-upload-placeholder",o.innerHTML=u;const r=s.p.widget(n.add.pos,o,{id:n.add.id});e=e.add(t.doc,[r])}else if(n&&n.remove){const t=t=>t.id===n.remove.id;e=e.remove(e.find(null,null,t))}return e}},props:{decorations(t){return this.getState(t)}}})}}e.Z=f},450980:function(t,e,n){var o=n(627191);e.Z=function(t,e){const{selection:n,schema:s,tr:r}=t;if(!s.marks[e])return!1;if(!(n instanceof o.Bs||n instanceof o.C1))return!1;const{from:i,to:a}=t.selection;if(a===i+1){const t=r.doc.nodeAt(i);if(t.isAtom&&!t.isText&&t.isLeaf)return!1}return!0}},289846:function(t,e,n){n.d(e,{ZP:function(){return te},$T:function(){return Yt},EI:function(){return Bt},Uy:function(){return Kt}});var o=n(760737),s=n(141396),r=n(627191),i=n(951801),a=n(371405),l=n(732357),c=n(812128),d=n(922032);var u=t=>e=>{const{$from:n}=e.selection;for(let o=n.depth;o>=0;o--){const e=n.index(o);if(n.node(o).canReplaceWith(e,e,t))return!0}return!1},p=n(994643),h=n(734622),m=n(78708),f=n(450980),g=n(676065),b=n.n(g),v=n(552212),y=n(840322),w=n(346527),E=n(894778),_=n(562415),S=Object.defineProperty,k=(t,e,n)=>(((t,e,n)=>{e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const x="link";class C extends E.Z{constructor(){super(...arguments),k(this,"_popUp",null),k(this,"title","apply-link"),k(this,"content",c.Z.link),k(this,"enable",(t=>{if(!(t.selection instanceof r.Bs))return!1;if(!t.schema.marks[x])return!1;const{from:e,to:n}=t.selection;return e<n})),k(this,"waitForUserInput",((t,e,n,o)=>{if(this._popUp)return Promise.resolve(void 0);e&&e((0,v.tk)(t));const{doc:s,schema:r,selection:i}=t,a=r.marks[x];if(!a)return Promise.resolve(void 0);const{from:l,to:c}=i,d=(0,y.Z)(s,l,c,a),u=d?d.mark.attrs.href:null;return new Promise((t=>{this._popUp=(0,_.Z)(w.Z,{href:u},{modal:!0,onClose:e=>{this._popUp&&(this._popUp=null,t(e))}})}))})),k(this,"executeWithUserInput",((t,e,n,o)=>{if(e){const{selection:s,schema:r}=t;let{tr:i}=t;if(i=n?(0,v.be)(n.state):i,i=i.setSelection(s),!b()(o)){const e=r.marks[x],n=o?{href:o}:null;i=(0,h.Z)(i.setSelection(t.selection),r,e,n)}e(i)}return n&&n.focus(),!0}))}}var M=C,O=n(130764),Z=n(241490),D=Object.defineProperty,P=(t,e,n)=>(((t,e,n)=>{e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class N extends E.Z{constructor(){super(...arguments),P(this,"_popUp",null),P(this,"enable",((t,e)=>this.__isEnabled(t,e))),P(this,"waitForUserInput",((t,e,n,o)=>this._popUp?Promise.resolve(void 0):(e&&e((0,Z.NV)(t)),new Promise((t=>{const e={runtime:n?n.runtime:null};this._popUp=(0,_.Z)(this.getEditor(),e,{modal:!0,onClose:e=>{this._popUp&&(this._popUp=null,t(e))}})}))))),P(this,"executeWithUserInput",((t,e,n,o)=>{if(e){const{selection:s,schema:r}=t;let{tr:i}=t;if(i=n?(0,Z.ud)(n.state):i,i=i.setSelection(s),o){const{src:t}=o;i=function(t,e,n){const{selection:o}=t;if(!o)return t;const{from:s,to:r}=o;if(s!==r)return t;const i=e.nodes.image;if(!i)return t;const a={src:n||"",alt:"",title:""},l=i.create(a,null,null),c=O.HY.from(l);return t.insert(s,c)}(i,r,t)}e(i),n&&n.focus()}return!1})),P(this,"__isEnabled",((t,e)=>{const n=t,{selection:o}=n;return o instanceof r.Bs&&o.from===o.to}))}}var I=N,j=n(202784),A=n(922730),R=n(513014),T=n(816092),V=n(978491),L=Object.defineProperty,z=Object.defineProperties,U=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,B=(t,e,n)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W=(t,e,n)=>(B(t,"symbol"!=typeof e?e+"":e,n),n);class q extends j.PureComponent{constructor(t){var e;super(t),W(this,"_onSrcChange",(t=>{const e=t.target.value;this.setState({src:e,validValue:null},this._didSrcChange)})),W(this,"_didSrcChange",(()=>{(0,V.Z)(this.state.src).then((t=>{if(this.state.src===t.src&&!this._unmounted){const e=t.complete?t:null;this.setState({validValue:e})}}))})),W(this,"_cancel",(()=>{this.props.close()})),W(this,"_insert",(()=>{const{validValue:t}=this.state;this.props.close(t)})),this._img=null,this._unmounted=!1,this.state=(e=((t,e)=>{for(var n in e||(e={}))$.call(e,n)&&B(t,n,e[n]);if(F)for(var n of F(e))H.call(e,n)&&B(t,n,e[n]);return t})({},this.props.initialValue||{}),z(e,U({validValue:null})))}componentWillUnmount(){this._unmounted=!0}render(){const{src:t,validValue:e}=this.state,n=e?j.createElement("div",{className:"editor-image-url-editor-input-preview",style:{backgroundImage:`url(${String(e.src)}`}}):null;return j.createElement("div",{className:"editor-image-url-editor"},j.createElement("form",{className:"editor-form",onSubmit:T.Z},j.createElement("fieldset",null,j.createElement("legend",null,A.a.t("text-editor:insert-image")),j.createElement("div",{className:"editor-image-url-editor-src-input-row"},j.createElement("input",{autoFocus:!0,className:"editor-image-url-editor-src-input",onChange:this._onSrcChange,placeholder:"Paste URL of Image...",type:"text",value:t||""}),n),j.createElement("em",null,A.a.t("text-editor:require-license"))),j.createElement("div",{className:"editor-form-buttons"},j.createElement(R.Z,{label:A.a.t("text-editor:cancel"),onClick:this._cancel}),j.createElement(R.Z,{active:!!e,disabled:!e,label:A.a.t("text-editor:insert"),onClick:this._insert}))))}}var J=q,K=Object.defineProperty,G=(t,e,n)=>(((t,e,n)=>{e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);var Y=class extends I{constructor(){super(...arguments),G(this,"title","insert-image-url"),G(this,"content","insert-image-url")}getEditor(){return J}},X=n(72779),Q=n.n(X),tt=n(294325),et=n(365601),nt=n(19789),ot=Object.defineProperty,st=(t,e,n)=>(((t,e,n)=>{e in t?ot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const rt=(0,et.Z)("image-upload-editor");class it extends j.PureComponent{constructor(t){super(t),st(this,"_onSelectFile",(t=>{const e=t.target.files&&t.target.files[0];e&&"object"==typeof e&&this._upload(e)})),st(this,"_onSuccess",(t=>{this._unmounted||this.props.close(t)})),st(this,"_onError",(t=>{this._unmounted||this.setState({error:t,id:rt(),pending:!1})})),st(this,"_upload",(t=>{this.setState({pending:!0,error:null});const e=n.g.session;if(e.server&&e.uploadFile){const n=new FormData;n.append("file",t),e.uploadFile({formData:n,callback:(t,n)=>t?this._onError(t):n&&n.filename?this._onSuccess({src:e.server+"/"+n.filename}):this._onSuccess({src:null}),showNotification:!1})}else(0,nt.Z)(t).then((t=>{this._onSuccess(t)})).catch((t=>{this._onError(t)}))})),st(this,"_cancel",(()=>{this.props.close()})),this._img=null,this._unmounted=!1,this.state={error:null,id:rt(),pending:!1}}componentWillUnmount(){this._unmounted=!0}render(){const{id:t,error:e,pending:n}=this.state,o=Q()("editor-image-upload-editor",{pending:n,error:e});let s=A.a.t("text-editor:choose-an-image-file");return n?s=j.createElement(tt.Z,{animation:"border",role:"status"}):e&&(s=A.a.t("text-editor:error-while-uploading")),j.createElement("div",{className:o},j.createElement("form",{className:"editor-form"},j.createElement("fieldset",null,j.createElement("legend",null,A.a.t("text-editor:upload-image")),j.createElement("div",{className:"editor-image-upload-editor-body"},j.createElement("div",{className:"editor-image-upload-editor-label"},s),j.createElement("input",{accept:"image/png,image/gif,image/jpeg,image/jpg",className:"editor-image-upload-editor-input",disabled:n,id:t,key:t,onChange:this._onSelectFile,type:"file"}))),j.createElement("div",{className:"editor-form-buttons"},j.createElement(R.Z,{label:A.a.t("text-editor:cancel"),onClick:this._cancel}))))}}var at=it,lt=Object.defineProperty,ct=(t,e,n)=>(((t,e,n)=>{e in t?lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);var dt=class extends I{constructor(){super(...arguments),ct(this,"title","upload-image"),ct(this,"content","upload-image")}getEditor(){return at}},ut=n(57444),pt=n(928316),ht=n(306830),mt=n.n(ht),ft=n(877119),gt=n.n(ft),bt=n(686605),vt=n.n(bt),yt=n(521536),wt=n.n(yt),Et=n(557106),_t=n.n(Et),St=n(783158),kt=n.n(St),xt=n(452626),Ct=Object.defineProperty,Mt=(t,e,n)=>(((t,e,n)=>{e in t?Ct(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const Ot=16;class Zt extends j.PureComponent{render(){const{x:t,y:e,selected:n}=this.props,o={left:t+"px",top:e+"px",width:"16px",height:"16px"},s=Q()("editor-table-grid-size-editor-cell",{selected:n});return j.createElement("div",{className:s,style:o})}}class Dt extends j.PureComponent{constructor(t){super(t),Mt(this,"_onRef",(t=>{this._ref=t})),Mt(this,"_onMouseEnter",(t=>{const e=t.currentTarget;if(e instanceof HTMLElement){const n=(0,xt.hs)(e),o=vt()(t.clientX),s=vt()(t.clientY);this._ex=n.x,this._ey=n.y,this._mx=o,this._my=s,this._entered||(this._entered=!0,document.addEventListener("mousemove",this._onMouseMove,!0))}})),Mt(this,"_onMouseMove",(t=>{const e=this._ref&&pt.findDOMNode(this._ref),n=e?function(t){const e=t.getBoundingClientRect();return{x:e.left,y:e.top,w:e.width,h:e.height}}(e):null,o=(0,xt.mv)(t.screenX,t.screenY,10);n&&o&&(0,xt.vY)(n,o,50)&&(t.preventDefault(),t.stopImmediatePropagation());const s=vt()(t.clientX),r=vt()(t.clientY);s===this._mx&&r===this._my||(this._mx=s,this._my=r,this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._updateGridSize))})),Mt(this,"_updateGridSize",(()=>{this._rafID=0;const t=this._mx,e=this._my,n=t-this._ex,o=e-this._ey,s=gt()(wt()(o/21),1,20),r=gt()(wt()(n/21),1,20),{rows:i,cols:a}=this.state;i===s&&a===r||this.setState({rows:s,cols:r})})),Mt(this,"_onMouseDown",(t=>{t.preventDefault(),this.props.close(this.state)})),this._ex=0,this._ey=0,this._mx=0,this._my=0,this._rafID=0,this._ref=null,this._entered=!1,this.state={rows:1,cols:1}}componentWillUnmount(){this._entered&&document.removeEventListener("mousemove",this._onMouseMove,!0),this._rafID&&cancelAnimationFrame(this._rafID)}render(){const{rows:t,cols:e}=this.state;let n=_t()(5,t),o=_t()(5,e);n===t&&(n=kt()(20,n+1)),o===e&&(o=kt()(20,o+1));const s=[];let r=0,i=0,a=0,l=0;for(;r<n;){i+=5;let n=0,c=0;for(;n<o;){c+=5;const o=r<t&&n<e;s.push(j.createElement(Zt,{key:`${String(r)}-${String(n)}`,selected:o,x:c,y:i})),c+=Ot,a=c+5,n++}i+=Ot,l=i+5,r++}const c={width:a+"px",height:l+"px"};return j.createElement("div",{className:"editor-table-grid-size-editor",ref:this._onRef},j.createElement("div",{className:"editor-table-grid-size-editor-body",onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter,style:c,role:"button",tabIndex:0},s),j.createElement("div",{className:"editor-table-grid-size-editor-footer"},j.createElement("b",null,t)," ",j.createElement("i",{className:"fa fa-times"})," ",j.createElement("b",null,e)))}}Dt.defaultProps={close:mt()};var Pt=Dt,Nt=n(871199),It=n.n(Nt),jt=Object.defineProperty,At=(t,e,n)=>(((t,e,n)=>{e in t?jt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class Rt extends E.Z{constructor(){super(...arguments),At(this,"_popUp",null),At(this,"title","insert-table"),At(this,"content","insert-table"),At(this,"enable",(t=>{const e=t,{selection:n}=e;return n instanceof r.Bs&&n.from===n.to})),At(this,"waitForUserInput",((t,e,n,o)=>{if(this._popUp)return Promise.resolve(void 0);if(!(function(t){if(!It()(t))return t;const e=new Error("Received unexpected "+t);throw e.framesToPop=1,e}(o).target instanceof HTMLElement))return Promise.resolve(void 0);const s=o?o.target.parentElement.parentElement:null;return new Promise((t=>{this._popUp=(0,_.Z)(Pt,null,{anchor:s,position:ut.SC,onClose:e=>{this._popUp&&(this._popUp=null,t(e))}})}))})),At(this,"executeWithUserInput",((t,e,n,o)=>{if(e){const{schema:n}=t;if(o){let{rows:s,cols:r}=o;const i=[];for(;r--;)i.push(n.nodes.table_cell.createAndFill());const a=[];for(;s--;)a.push(n.nodes.table_row.createAndFill(void 0,i));const l=n.nodes.table.createAndFill(void 0,a);e(t.tr.replaceSelectionWith(l))}}return!1}))}}var Tt=Rt;const Vt=t=>{const{selection:e}=t;return e instanceof r.Bs||e instanceof r.C1},Lt=t=>{const e=t,{selection:n}=e;return n instanceof r.Bs&&n.from===n.to},zt=t=>e=>{const{from:n,$from:o,to:s,empty:r}=e.selection;return r?!!t.isInSet(e.storedMarks||o.marks()):!!e.doc.rangeHasMark(n,s,t)},Ut=(t,e={})=>n=>{const{$from:o,to:s,node:r}=n.selection;return r?r.hasMarkup(t,e):s<=o.end()&&o.parent.hasMarkup(t,e)},Ft=t=>(e,n)=>{const{schema:o,selection:s}=e,r=((t,e,n)=>{const o=e.marks.fontSize;if(!o)return t;const s=n?{pt:n}:null;return(0,h.Z)(t,e,o,s)})(e.tr.setSelection(s),o,t);return!(!r.docChanged&&!r.storedMarksSet)&&(!n||n(r))},$t=t=>(0,f.Z)(t,"fontSize"),Ht=t=>e=>{const n=e.schema.nodes.heading;let o;return o=n?(0,s.Tr)(n)(e.selection):e.selection,o&&o.node&&o.node.attrs&&o.node.attrs.level===t},Bt=[{title:"strong",content:c.Z.strong,enable:Vt,active:zt(d.Z.marks.strong),run:(0,o.w9)(d.Z.marks.strong),hotkey:"Ctrl+B"},{title:"emphasis",content:c.Z.em,enable:Vt,active:zt(d.Z.marks.em),run:(0,o.w9)(d.Z.marks.em),hotkey:"Ctrl+I"},new M],Wt=[{title:"underline",content:c.Z.underline,enable:Vt,active:zt(d.Z.marks.underline),run:(0,o.w9)(d.Z.marks.underline),hotkey:"Ctrl+U"},{title:"strikethrough",content:c.Z.strikethrough,enable:Vt,active:zt(d.Z.marks.strikethrough),run:(0,o.w9)(d.Z.marks.strikethrough),hotkey:"Ctrl+S"},{title:"code",content:c.Z.code,enable:Vt,active:zt(d.Z.marks.code),run:(0,o.w9)(d.Z.marks.code),hotkey:"Ctrl+M"},{title:"subscript",content:c.Z.subscript,enable:Vt,active:zt(d.Z.marks.subscript),run:(0,o.w9)(d.Z.marks.subscript),hotkey:"Ctrl+L"},{title:"superscript",content:c.Z.superscript,enable:Vt,active:zt(d.Z.marks.superscript),run:(0,o.w9)(d.Z.marks.superscript),hotkey:"Ctrl+P"}],qt=[{title:"change-paragraph",content:c.Z.paragraph,active:Ut(d.Z.nodes.paragraph),enable:(0,o.uJ)(d.Z.nodes.paragraph),run:(0,o.uJ)(d.Z.nodes.paragraph)},{title:"change-heading-1",content:"H1",active:Ht(1),enable:(0,o.uJ)(d.Z.nodes.heading,{level:1}),run:(0,o.uJ)(d.Z.nodes.heading,{level:1}),hotkey:"Shift+Ctrl+1"},{title:"change-heading-2",content:"H2",active:Ht(2),enable:(0,o.uJ)(d.Z.nodes.heading,{level:2}),run:(0,o.uJ)(d.Z.nodes.heading,{level:2}),hotkey:"Shift+Ctrl+2"}],Jt=[{title:"change-heading-3",content:"Heading 3",enable:(0,o.uJ)(d.Z.nodes.heading,{level:3}),run:(0,o.uJ)(d.Z.nodes.heading,{level:3}),hotkey:"Shift+Ctrl+3"},{title:"change-heading-4",content:"Heading 4",enable:(0,o.uJ)(d.Z.nodes.heading,{level:4}),run:(0,o.uJ)(d.Z.nodes.heading,{level:4}),hotkey:"Shift+Ctrl+4"},{title:"change-heading-5",content:"Heading 5",enable:(0,o.uJ)(d.Z.nodes.heading,{level:5}),run:(0,o.uJ)(d.Z.nodes.heading,{level:5}),hotkey:"Shift+Ctrl+5"}],Kt=[{title:"wrap-block-quote",content:c.Z.blockquote,active:Ut(d.Z.nodes.blockquote),enable:(0,o.ym)(d.Z.nodes.blockquote),run:(0,o.ym)(d.Z.nodes.blockquote),hotkey:"Ctrl+>"},{title:"wrap-bullet-list",content:c.Z.bullet_list,active:Ut(d.Z.nodes.bullet_list),enable:(0,a.KI)(d.Z.nodes.bullet_list),run:(0,a.KI)(d.Z.nodes.bullet_list),hotkey:"Shift+Ctrl+8"},{title:"wrap-ordered-list",content:c.Z.ordered_list,active:Ut(d.Z.nodes.ordered_list),enable:(0,a.KI)(d.Z.nodes.ordered_list),run:(0,a.KI)(d.Z.nodes.ordered_list),hotkey:"Shift+Ctrl+9"}],Gt=[{title:"lift-out-enclosing",content:"lift-out-enclosing",enable:o.xb,run:o.xb},{title:"join-with-above",content:"join-with-above",enable:o.MI,run:o.MI},{title:"join-with-below",content:"join-with-below",enable:o.Ig,run:o.Ig}],Yt=[new Y,new dt,{title:"insert-footnote",content:"insert-footnote",enable:u(d.Z.nodes.footnote),run:(t,e)=>{const n=d.Z.nodes.footnote.create();e(t.tr.replaceSelectionWith(n))}},{title:"insert-figure-caption",content:"insert-figure-caption",enable:Lt,run:(t,e)=>{const n=d.Z.nodes.figureCaption.create();e(t.tr.replaceSelectionWith(n))}},{title:"insert-table-caption",content:"insert-table-caption",enable:Lt,run:(t,e)=>{const n=d.Z.nodes.tableCaption.create();e(t.tr.replaceSelectionWith(n))}},{title:"insert-code-block",content:"insert-code-block",enable:u(d.Z.nodes.code_block),run:(t,e)=>{const n=d.Z.nodes.code_block.create();e(t.tr.replaceSelectionWith(n))}}],Xt=[{title:"undo-last-change",content:c.Z.undo,enable:i.Yw,run:i.Yw,hotkey:"Ctrl+Z"},{title:"redo-last-undone-change",content:c.Z.redo,enable:i.KX,run:i.KX,hotkey:"Ctrl+Y"},{title:"select-parent-node",content:c.Z.selectParent,run:o.N0,select:t=>(0,o.N0)(t),hotkey:"Escape"}],Qt=[new Tt,{title:"insert-column-before",content:"insert-column-before",run:l.I_},{title:"insert-column-after",content:"insert-column-after",run:l.e2},{title:"insert-row-before",content:"insert-row-before",run:l.z2},{title:"insert-row-after",content:"insert-row-after",run:l.dl},{title:"delete-column",content:"delete-column",run:l.eA},{title:"delete-row",content:"delete-row",run:l.qK},{title:"merge-cells",content:"merge-cells",run:l.JX},{title:"split-cells",content:"split-cells",run:l.Cr},{title:"toggle-header-column",content:"toggle-header-column",run:l.sr},{title:"toggle-header-row",content:"toggle-header-row",run:l.lm},{title:"delete-table",content:"delete-table",run:l.WQ}];var te={marks:Bt,extraMarks:Wt,blocks:qt,headers:Jt,alignment:p.ZP,wraps:Kt,fontSizes:m.map((t=>({title:String(t),content:String(t),run:Ft(t),enable:$t}))),actions:Gt,insert:Yt,history:Xt,tableEdits:Qt}},690202:function(t,e,n){n.d(e,{Z:function(){return ht}});var o=n(580722),s=n(203027),r=n(951801),i=n(732357),a=n(627191),l=n(676065),c=n.n(l),d=n(552212),u=n(734622),p=n(840322);var h=function(t,e){for(;t&&t.nodeName;){if(e(t))return t;t=t.parentElement}return null},m=n(202784),f=n(508575),g=n(768466),b=n(513014),v=Object.defineProperty,y=(t,e,n)=>(((t,e,n)=>{e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class w extends m.PureComponent{constructor(){super(...arguments),y(this,"_openLink",(t=>{if(t&&0===t.indexOf("#")){const e=t.substr(1),n=document.getElementById(e);if(n){const{onCancel:t,editorView:e}=this.props;t(e),(()=>{return t=this,e=null,o=function*(){yield(0,f.Z)(n,{scrollMode:"if-needed",behavior:"smooth"})},new Promise(((n,s)=>{var r=t=>{try{a(o.next(t))}catch(e){s(e)}},i=t=>{try{a(o.throw(t))}catch(e){s(e)}},a=t=>t.done?n(t.value):Promise.resolve(t.value).then(r,i);a((o=o.apply(t,e)).next())}));var t,e,o})()}}else t&&window.open((0,g.Z)(t))}))}render(){const{href:t,editorView:e,onEdit:n,onRemove:o}=this.props;return m.createElement("div",{className:"editor-link-tooltip"},m.createElement("div",{className:"editor-link-tooltip-body"},m.createElement("div",{className:"editor-link-tooltip-row"},m.createElement(b.Z,{className:"editor-link-tooltip-href",label:t,onClick:this._openLink,target:"new",title:t,value:t}),m.createElement(b.Z,{label:"Change",onClick:n,value:e}),m.createElement(b.Z,{label:"Remove",onClick:o,value:e}))))}}var E=w,_=n(346527),S=n(57444),k=n(562415),x=Object.defineProperty,C=(t,e,n)=>(((t,e,n)=>{e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const M="link",O={view(t){return new D(t)}};class Z extends a.Sy{constructor(){super(O)}}class D{constructor(t){C(this,"_anchorEl",null),C(this,"_popup",null),C(this,"_editor",null),C(this,"_onCancel",(t=>{this.destroy(),t.focus()})),C(this,"_onClose",(()=>{this._anchorEl=null,this._editor=null,this._popup=null})),C(this,"_onEdit",(t=>{if(this._editor)return;const{state:e}=t,{schema:n,doc:o,selection:s}=e,{from:r,to:i}=s,l=n.marks[M],c=(0,p.Z)(o,r,i,l);if(!c)return;let{tr:u}=e;const h=a.Bs.create(u.doc,c.from.pos,c.to.pos+1);u=u.setSelection(h),u=(0,d.tk)(e,u),t.dispatch(u);const m=c?c.mark.attrs.href:null;this._editor=(0,k.Z)(_.Z,{href:m},{onClose:e=>{this._editor=null,this._onEditEnd(t,s,e)}})})),C(this,"_onRemove",(t=>{this._onEditEnd(t,t.state.selection,null)})),C(this,"_onEditEnd",((t,e,n)=>{const{state:o,dispatch:s}=t;let r=(0,d.be)(o);if(!c()(n)){const{schema:t}=o,s=t.marks[M];if(s){const o=(0,p.Z)(r.doc,e.from,e.to,s);if(o){const e=a.Bs.create(r.doc,o.from.pos,o.to.pos+1);r=r.setSelection(e);const i=n?{href:n}:null;r=(0,u.Z)(r,t,s,i)}}}r.setSelection(e.map(r.doc,r.mapping)),s(r),t.focus()})),this.update(t,null)}update(t,e){if(t.readOnly)return void this.destroy();const{state:n}=t,{doc:o,selection:s,schema:r}=n,i=r.marks[M];if(!i)return;const{from:a,to:l}=s,c=(0,p.Z)(o,a,l,i);if(!c)return void this.destroy();const d=t.domAtPos(a);if(!d)return void this.destroy();const u=h(d.node,(t=>"A"===t.nodeName));if(!u)return void this.destroy();const m=this._popup,f={editorState:n,editorView:t,href:c.mark.attrs.href,onCancel:this._onCancel,onEdit:this._onEdit,onRemove:this._onRemove};m&&u===this._anchorEl?m.update(f):(m&&m.close(),this._anchorEl=u,this._popup=(0,k.Z)(E,f,{anchor:u,autoDismiss:!1,onClose:this._onClose,position:S.DL}))}destroy(){this._popup&&this._popup.close(),this._editor&&this._editor.close()}}var P=Z,N=n(241490),I=n(859067),j=n(141396);function A(t){const{doc:e,selection:n,schema:o}=t,s=o.nodes.table_cell,r=o.nodes.table_header;if(!s&&!r)return null;let l=n;if(l instanceof a.Bs){const t=s&&(0,j.Tr)(s)(n)||r&&(0,j.Tr)(r)(n);if(!t)return null;l=i.Xc.create(e,t.pos)}return l instanceof i.Xc?function(t){const{$anchorCell:e}=t,n=e.start(-1),o=e.node(-1),s=i.rU.get(o);let r,a=null,l=null;return t.forEachCell(((t,e)=>{const o=s.findCell(e-n);(!r||o.top>=r.top&&o.left>r.left)&&(r=o,a=e,l=t)})),null===a?null:{node:l,pos:a}}(l):null}var R=n(185610),T=n(155061),V=n(922730),L=n(812128),z=n(289846),U=Object.defineProperty,F=(t,e,n)=>(((t,e,n)=>{e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class $ extends m.PureComponent{constructor(){super(...arguments),F(this,"onMenuMouseDown",(t=>e=>{e.preventDefault(),t.run&&t.run(this.props.editorState,this.props.editorView.dispatch,this.props.editorView,e.nativeEvent)})),F(this,"createDropdownButtons",((t,e)=>m.createElement(T.Z,{key:`dropdown-item-${e}`,onMouseDown:this.onMenuMouseDown(t)},V.a.t(`text-editor:${t.content}`))))}render(){return m.createElement(R.Z,{title:L.Z.table,variant:"outline-secondary",size:"sm",style:{display:"inline-block"}},z.ZP.tableEdits.map(this.createDropdownButtons))}}var H=$;var B=n(452626);function W(t){const{x:e,y:n,w:o,h:s}=(0,B.hs)(t),r=o&&s&&t?t.ownerDocument.elementFromPoint(e+1,n+1):null;return!!r&&(r===t||!!t.contains(r))}var q=Object.defineProperty,J=(t,e,n)=>(((t,e,n)=>{e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class K{constructor(t){J(this,"destroy",(()=>{this._popUp&&this._popUp.close(),this._popUp=null})),J(this,"_onOpen",(()=>{const t=this._cellElement;t&&(this._scrollHandle=function(t,e){if(!t)return;const n=t.ownerDocument.defaultView,o=[];let s=0,r=()=>{s&&cancelAnimationFrame(s),s=requestAnimationFrame(e)},i=t;for(;i;){const t=n.getComputedStyle(i).overflow;(r&&"auto"===t||"scroll"===t)&&(i.addEventListener("scroll",r,!1),o.push(i)),i=i.parentElement}return{dispose(){for(;r&&o.length;)i=o.pop(),i&&i.removeEventListener("scroll",r,!1);r=null,s&&window.cancelAnimationFrame(s),s=0}}}(t,this._onScroll))})),J(this,"_onClose",(()=>{this._popUp=null,this._scrollHandle&&this._scrollHandle.dispose(),this._scrollHandle=null})),J(this,"_onScroll",(()=>{const t=this._popUp,e=this._cellElement;t&&e&&(W(e)||t.close())})),this._cellElement=null,this._popUp=null,this._scrollHandle=null,this.update(t,null)}update(t,e){const{state:n,readOnly:o}=t,s=A(n);if(!s||o)return void this.destroy();const r=t.domAtPos(s.pos+1);if(!r)return void this.destroy();let i=r.node;const a=this._popUp,l={editorState:n,editorView:t};i&&!W(i)&&(i=null),i?a&&i===this._cellElement?a.update(l):(a&&a.close(),this._cellElement=i,this._popUp=(0,k.Z)(H,l,{anchor:i,autoDismiss:!1,onClose:this._onClose,position:S.ID}),this._onOpen()):(a&&a.close(),this._cellElement=null)}}const G={view(t){return new K(t)}};class Y extends a.Sy{constructor(){super(G)}}var X=Y,Q=n(193450),tt=n(760737),et=n(788892),nt=n(59195),ot=n(371405),st=n(437069),rt=n.n(st),it=n(994643),at=n(922032);const lt=(t,e)=>{const n=at.Z.nodes.hard_break.create();return e(t.tr.replaceSelectionWith(n).scrollIntoView()),!0},ct={"Alt-ArrowDown":tt.Ig,"Alt-ArrowUp":tt.MI,"Ctrl-Enter":(0,tt.QF)(tt.uo,lt),"Mod->":(0,tt.ym)(at.Z.nodes.blockquote),"Mod-_":(t,e)=>{const n=at.Z.nodes.horizontal_rule.create();return e(t.tr.replaceSelectionWith(n).scrollIntoView()),!0},"Mod-[":(0,ot.IB)(at.Z.nodes.list_item),"Mod-]":(0,ot.bw)(at.Z.nodes.list_item),"Mod-b":(0,tt.w9)(at.Z.marks.strong),"Mod-BracketLeft":tt.xb,"Mod-Enter":(0,tt.QF)(tt.uo,lt),"Mod-i":(0,tt.w9)(at.Z.marks.em),"Mod-u":(0,tt.w9)(at.Z.marks.underline),"Mod-m":(0,tt.w9)(at.Z.marks.code),"Mod-l":(0,tt.w9)(at.Z.marks.subscript),"Mod-s":(0,tt.w9)(at.Z.marks.strikethrough),"Mod-p":(0,tt.w9)(at.Z.marks.superscript),"Mod-y":r.KX,"Mod-z":r.Yw,"Shift-Ctrl-\\":(0,tt.uJ)(at.Z.nodes.code_block),"Shift-Ctrl-0":(0,tt.uJ)(at.Z.nodes.paragraph),"Shift-Ctrl-1":(0,tt.uJ)(at.Z.nodes.heading,{level:1}),"Shift-Ctrl-2":(0,tt.uJ)(at.Z.nodes.heading,{level:2}),"Shift-Ctrl-3":(0,tt.uJ)(at.Z.nodes.heading,{level:3}),"Shift-Ctrl-4":(0,tt.uJ)(at.Z.nodes.heading,{level:4}),"Shift-Ctrl-5":(0,tt.uJ)(at.Z.nodes.heading,{level:5}),"Shift-Ctrl-6":(0,tt.uJ)(at.Z.nodes.heading,{level:6}),"Shift-Ctrl-8":(0,ot.KI)(at.Z.nodes.bullet_list),"Shift-Ctrl-9":(0,ot.KI)(at.Z.nodes.ordered_list),"Shift-Enter":(0,tt.QF)(tt.uo,lt),"Alt-Ctrl-l":it.H_,"Alt-Ctrl-r":it.cP,"Alt-Ctrl-c":it.A8,"Alt-Ctrl-j":it.nx,"Shift-Mod-z":r.KX,"Shift-Tab":(0,i.nA)(-1),Backspace:et.dU,Enter:(0,ot.s6)(at.Z.nodes.list_item),Escape:tt.N0,Tab:(0,i.nA)(1)};rt()(tt.YR).forEach((t=>{ct[t]?ct[t]=(0,tt.QF)(ct[t],tt.YR[t]):ct[t]=tt.YR[t]}));var dt=(0,nt.h)(ct);function ut(t,e,n){return new et.VK(t,((t,o,s,r)=>{let i=n instanceof Function?n(o):n,a=t.tr;if(o[1]){let t=s+o[0].indexOf(o[1]),e=t+o[1].length;e<r&&a.delete(e,r),t>s&&a.delete(s,t),r=s+o[1].length}return a.addMark(s,r,e.create(i)),a.removeStoredMark(e),a}))}var pt=(0,et.Hw)({rules:[...et.yR,et.LH,et.pR,(0,et.S0)(/^\s*>\s$/,at.Z.nodes.blockquote),(0,et.S0)(/^(\d+)\.\s$/,at.Z.nodes.ordered_list,(t=>({order:+t[1]})),((t,e)=>e.childCount+e.attrs.order===+t[1])),(0,et.S0)(/^\s*([-+*])\s$/,at.Z.nodes.bullet_list),(0,et.zK)(/^```$/,at.Z.nodes.code_block),ut(/(?:^|[^`])`([^`]+)`$/,at.Z.marks.code),ut(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,at.Z.marks.strong),ut(/(?:^|[^*_])(?:\*|_)([^*_]+)(?:\*|_)$/,at.Z.marks.em),ut(/(?:\+\+)([^+]+)(?:\+\+)$/,at.Z.marks.underline),ut(/(?:~~)([^~]+)(?:~~)$/,at.Z.marks.strikethrough),(0,et.zK)(new RegExp("^(#{1,6})\\s$"),at.Z.nodes.heading,(t=>({level:t[1].length})))]}),ht=[new I.Z,new P,new d.ZP,new N.ZP,pt,dt,(0,o.q)(),(0,s.d)(),(0,r.m8)(),(0,i.VH)({}),new X,(0,i.G3)(),(0,Q.ZP)()];document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)},768466:function(t,e,n){n.d(e,{Z:function(){return s}});const o=/^http(s?):*\/\//i;function s(t){return t?o.test(t)?t:"http://"+t:"http://"}},922032:function(t,e,n){n.d(e,{Z:function(){return ge}});var o=n(130764);var s={attrs:{href:{},target:{default:"blank"},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(t){const e=t.getAttribute("href"),n=e&&0===e.indexOf("#")?"":"blank";return{href:t.getAttribute("href"),title:t.getAttribute("title"),target:n}}}],toDOM(t){const{href:e,title:n,target:o}=t.attrs;return["a",{href:e,title:n,target:o},0]}};var r={parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM(){return["em",0]}};var i={parseDOM:[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],toDOM(){return["strong",0]}};var a={parseDOM:[{tag:"code"}],toDOM(){return["code",0]}};var l={excludes:"superscript",parseDOM:[{tag:"sub"},{style:"vertical-align=sub"}],toDOM:()=>["sub"]};var c={attrs:{color:""},inline:!0,group:"inline",parseDOM:[{style:"color",getAttrs:t=>({color:t})}],toDOM(t){const{color:e}=t.attrs;let n="";return e&&(n+=`color: ${e};`),["span",{style:n},0]}},d=n(32593),u=n.n(d),p=n(395465),h=n.n(p),m=n(78708);const f=/([\d.]+)(px|pt)/i;function g(t){const e=function(t){const e=t.match(f);if(!e)return 0;let n=parseFloat(e[1]);const o=e[2];return n&&o?("px"===o&&(n*=.7518796992481203),n):0}(t);return m.includes(e)?e:m.reduce(((t,n)=>u()(n-e)<u()(t-e)?n:t),h())}var b={link:s,code:a,em:r,fontSize:{attrs:{pt:{default:null}},inline:!0,group:"inline",parseDOM:[{style:"font-size",getAttrs:function(t){const e={};if(!t)return e;const n=g(t);if(!n)return e;return{pt:n}}}],toDOM(t){const{pt:e}=t.attrs;return["span",e?{style:`font-size: ${e}pt;`,class:"pm-font-size-mark"}:null,0]}},strikethrough:{parseDOM:[{tag:"strike"},{style:"text-decoration:line-through"},{style:"text-decoration-line:line-through"}],toDOM:()=>["strike"]},strong:i,subscript:l,superscript:{excludes:"subscript",parseDOM:[{tag:"sup"},{style:"vertical-align=super"}],toDOM:()=>["sup"]},textColor:c,underline:{parseDOM:[{tag:"u"},{style:"text-decoration:underline",getAttrs:t=>"underline"===t&&null}],toDOM:()=>["u",0]}},v=n(732357);const y=/(left|right|center|justify)/,w="data-indent",E=new Set(["","0%","0pt","0px"]);function _(t){const{textAlign:e,paddingTop:n,paddingBottom:o}=t.style;let s=t.getAttribute("align")||e||"";s=y.test(s)?s:null;return{align:s,indent:parseInt(t.getAttribute(w),10),paddingTop:n,paddingBottom:o,id:t.getAttribute("id")||""}}function S(t){const{align:e,indent:n,paddingTop:o,paddingBottom:s,id:r}=t.attrs,i={};let a="";return e&&"left"!==e&&(a+=`text-align: ${e};`),o&&!E.has(o)&&(a+=`padding-top: ${o};`),s&&!E.has(s)&&(a+=`padding-bottom: ${s};`),a&&(i.style=a),n&&(i[w]=String(n)),r&&(i.id=r),["p",i,0]}const k=S,x=_;var C={attrs:{align:{default:null},color:{default:null},id:{default:null},indent:{default:null},lineSpacing:{default:null},paddingBottom:{default:null},paddingTop:{default:null}},content:"inline*",group:"block",parseDOM:[{tag:"p",getAttrs:_}],toDOM:S},M=Object.defineProperty,O=Object.defineProperties,Z=Object.getOwnPropertyDescriptors,D=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,I=(t,e,n)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,j=(t,e)=>{for(var n in e||(e={}))P.call(e,n)&&I(t,n,e[n]);if(D)for(var n of D(e))N.call(e,n)&&I(t,n,e[n]);return t},A=(t,e)=>O(t,Z(e));const R={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};function T(t){const e=x(t),n=R[t.nodeName.toUpperCase()]||1;return e.level=n,e}var V=A(j({},C),{attrs:A(j({},C.attrs),{level:{default:1}}),content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",getAttrs:T},{tag:"h2",getAttrs:T},{tag:"h3",getAttrs:T},{tag:"h4",getAttrs:T},{tag:"h5",getAttrs:T},{tag:"h6",getAttrs:T}],toDOM:function(t){const e=k(t),n=t.attrs.level||1;return e[0]=`h${n}`,e}});var L={group:"inline",content:"inline*",inline:!0,atom:!0,toDOM:()=>["footnote",0],parseDOM:[{tag:"footnote"}]},z=Object.defineProperty,U=Object.defineProperties,F=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,W=(t,e,n)=>e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,q=(t,e)=>{for(var n in e||(e={}))H.call(e,n)&&W(t,n,e[n]);if($)for(var n of $(e))B.call(e,n)&&W(t,n,e[n]);return t};var J,K,G=(J=q({},C),K={attrs:q({},C.attrs),content:"inline*",group:"block",defining:!0,toDOM:function(t){const e=k(t);return e[0]="legend",e[1].class="figure-caption",e},parseDOM:[{tag:"legend",getAttrs:function(t){return x(t)}}]},U(J,F(K))),Y=Object.defineProperty,X=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertySymbols,et=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable,ot=(t,e,n)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,st=(t,e)=>{for(var n in e||(e={}))et.call(e,n)&&ot(t,n,e[n]);if(tt)for(var n of tt(e))nt.call(e,n)&&ot(t,n,e[n]);return t};const rt=((t,e)=>X(t,Q(e)))(st({},C),{attrs:st({},C.attrs),content:"inline*",group:"block",defining:!0,toDOM:function(t){const e=k(t);return e[0]="legend",e[1].class="table-caption",e},parseDOM:[{tag:"legend",getAttrs:function(t){return x(t)}}]});var it=rt;const at=/rotate\(([0-9.]+)rad\)/i,lt=new Set(["0%","0pt","0px"]);function ct(t){const{cssFloat:e,display:n,marginTop:o,marginLeft:s}=t.style;let{width:r,height:i}=t.style,a=t.getAttribute("data-align")||t.getAttribute("align");a?a=/(left|right|center)/.test(a)?a:null:"left"!==e||n?"right"!==e||n?e||"block"!==n||(a="block"):a="right":a="left",r=r||t.getAttribute("width"),i=i||t.getAttribute("height");let l=null,c=null;const{parentElement:d}=t;if(d instanceof HTMLElement){const t=d.style;if("inline-block"===t.display&&"hidden"===t.overflow&&t.width&&t.height&&s&&!lt.has(s)&&o&&!lt.has(o)&&(l={width:parseInt(t.width,10)||0,height:parseInt(t.height,10)||0,left:parseInt(s,10)||0,top:parseInt(o,10)||0}),t.transform){const e=t.transform.match(at);e&&e[1]&&(c=parseFloat(e[1])||null)}}return{align:a,alt:t.getAttribute("alt")||null,crop:l,height:parseInt(i,10)||null,rotate:c,src:t.getAttribute("src")||null,title:t.getAttribute("title")||null,width:parseInt(r,10)||null}}const dt=ct;var ut={inline:!0,attrs:{align:{default:null},alt:{default:"An inserted image"},crop:{default:null},height:{default:null},rotate:{default:null},src:{default:null},title:{default:"None"},width:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:ct}],toDOM(t){return["img",t.attrs]}},pt=Object.defineProperty,ht=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,ft=Object.getOwnPropertySymbols,gt=Object.prototype.hasOwnProperty,bt=Object.prototype.propertyIsEnumerable,vt=(t,e,n)=>e in t?pt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const yt={attrs:{src:{},plotID:{default:null},align:{default:null},alt:{default:""},crop:{default:null},title:{default:""},meta:{default:null},width:{default:null},height:{default:null},rotate:{default:null}},inline:!0,group:"inline",draggable:!0,toDOM:t=>["div",{class:"img-container","data-plot-id":t.attrs.plotID,align:t.attrs.align},["img",{src:t.attrs.src,align:t.attrs.align,alt:t.attrs.alt,crop:t.attrs.crop,title:t.attrs.title,width:t.attrs.width,height:t.attrs.height,rotate:t.attrs.rotate}],["pre",{class:"img-tooltip"},t.attrs.meta]],parseDOM:[{priority:51,tag:"div[data-plot-id]",getAttrs:t=>{const e=t.getAttribute("data-plot-id"),n=t.firstChild,o=dt(n),s=t.lastChild.innerText;return((t,e)=>ht(t,mt(e)))(((t,e)=>{for(var n in e||(e={}))gt.call(e,n)&&vt(t,n,e[n]);if(ft)for(var n of ft(e))bt.call(e,n)&&vt(t,n,e[n]);return t})({},o),{meta:s,plotID:e})}}]};var wt=yt,Et=Object.defineProperty,_t=Object.defineProperties,St=Object.getOwnPropertyDescriptors,kt=Object.getOwnPropertySymbols,xt=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable,Mt=(t,e,n)=>e in t?Et(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const Ot={attrs:{src:{},plotID:{default:null},align:{default:null},alt:{default:""},crop:{default:null},title:{default:""},meta:{default:null},width:{default:null},height:{default:null},rotate:{default:null}},inline:!0,group:"inline",draggable:!0,toDOM:t=>["div",{class:"img-container","data-plot-id":t.attrs.plotID,align:t.attrs.align},["img",{src:t.attrs.src,align:t.attrs.align,alt:t.attrs.alt,crop:t.attrs.crop,title:t.attrs.title,width:t.attrs.width,height:t.attrs.height,rotate:t.attrs.rotate}],["pre",{class:"img-tooltip"},t.attrs.meta]],parseDOM:[{priority:51,tag:"img[data-plot-id]",getAttrs:t=>{const e=t.getAttribute("align"),n=t.getAttribute("width"),o=dt(t);e||(o.align="center"),n||(o.width=550);const s=t.getAttribute("data-plot-id"),r=t.getAttribute("data-plot-meta");return((t,e)=>_t(t,St(e)))(((t,e)=>{for(var n in e||(e={}))xt.call(e,n)&&Mt(t,n,e[n]);if(kt)for(var n of kt(e))Ct.call(e,n)&&Mt(t,n,e[n]);return t})({},o),{meta:r,plotID:s})}}]};var Zt=Ot;var Dt={content:"block+"};var Pt={content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}};var Nt={group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["hr"]}};var It={content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(){return["pre",["code",0]]}};var jt={group:"inline"};var At={inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return["br"]}},Rt=n(371405),Tt=Object.defineProperty,Vt=Object.defineProperties,Lt=Object.getOwnPropertyDescriptors,zt=Object.getOwnPropertySymbols,Ut=Object.prototype.hasOwnProperty,Ft=Object.prototype.propertyIsEnumerable,$t=(t,e,n)=>e in t?Tt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const Ht=((t,e)=>Vt(t,Lt(e)))(((t,e)=>{for(var n in e||(e={}))Ut.call(e,n)&&$t(t,n,e[n]);if(zt)for(var n of zt(e))Ft.call(e,n)&&$t(t,n,e[n]);return t})({},Rt.dq),{content:"list_item+",group:"block"});var Bt=Ht,Wt=Object.defineProperty,qt=Object.defineProperties,Jt=Object.getOwnPropertyDescriptors,Kt=Object.getOwnPropertySymbols,Gt=Object.prototype.hasOwnProperty,Yt=Object.prototype.propertyIsEnumerable,Xt=(t,e,n)=>e in t?Wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const Qt=((t,e)=>qt(t,Jt(e)))(((t,e)=>{for(var n in e||(e={}))Gt.call(e,n)&&Xt(t,n,e[n]);if(Kt)for(var n of Kt(e))Yt.call(e,n)&&Xt(t,n,e[n]);return t})({},Rt.iI),{content:"list_item+",group:"block"});var te=Qt,ee=Object.defineProperty,ne=Object.defineProperties,oe=Object.getOwnPropertyDescriptors,se=Object.getOwnPropertySymbols,re=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,ae=(t,e,n)=>e in t?ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const le=((t,e)=>ne(t,oe(e)))(((t,e)=>{for(var n in e||(e={}))re.call(e,n)&&ae(t,n,e[n]);if(se)for(var n of se(e))ie.call(e,n)&&ae(t,n,e[n]);return t})({},Rt.qb),{content:"paragraph block*",group:"block"});var ce=le,de=Object.defineProperty,ue=Object.getOwnPropertySymbols,pe=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,me=(t,e,n)=>e in t?de(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fe=((t,e)=>{for(var n in e||(e={}))pe.call(e,n)&&me(t,n,e[n]);if(ue)for(var n of ue(e))he.call(e,n)&&me(t,n,e[n]);return t})({doc:Dt,plot:Zt,plotContainer:wt,footnote:L,paragraph:C,ordered_list:Bt,bullet_list:te,list_item:ce,blockquote:Pt,horizontal_rule:Nt,heading:V,code_block:It,text:jt,image:ut,hard_break:At,figureCaption:G,tableCaption:it},(0,v.V3)({tableGroup:"block",cellContent:"block+"})),ge=new o.V_({nodes:fe,marks:b})},552212:function(t,e,n){n.d(e,{be:function(){return p},tk:function(){return u}});var o=n(627191),s=n(952780);const r={name:"SelectionPlaceholderPlugin"};let i=null;const a={state:{init(){return s.EH.empty},apply(t,e){e=e.map(t.mapping,t.doc);const n=t.getMeta(this);if(!n)return e;if(n.add){const o=s.p.inline(n.add.from,n.add.to,{class:"selection-placeholder"},{id:r});e=e.add(t.doc,[o])}else if(n.remove){const t=e.find(null,null,c);e=e.remove(t)}return e}},props:{decorations:t=>i?i.getState(t):null}};class l extends o.Sy{constructor(){if(super(a),i)return i;i=this}}function c(t){return t.id===r}function d(t){if(!i)return null;if(!t.plugins.includes(i))return null;const e=i.getState(t).find(null,null,c);return(e.length?e[0]:null)||null}function u(t,e){e=e||t.tr;const n=i;if(!n||!e.selection||e.selection.empty)return e;return null===d(t)&&(e=e.setMeta(n,{add:{from:e.selection.from,to:e.selection.to}})),e}function p(t,e){e=e||t.tr;const n=i;if(!n)return e;return d(t)&&(e=e.setMeta(n,{remove:{}})),e}e.ZP=l},994643:function(t,e,n){n.d(e,{A8:function(){return v},H_:function(){return b},cP:function(){return y},nx:function(){return w}});var o=n(627191),s=n(812128),r=Object.defineProperty,i=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(t,e,n)=>e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e)=>{for(var n in e||(e={}))c.call(e,n)&&u(t,n,e[n]);if(l)for(var n of l(e))d.call(e,n)&&u(t,n,e[n]);return t},h=(t,e)=>i(t,a(e));const m=t=>{const{selection:e}=t;return e instanceof o.Bs||e instanceof o.C1},f=(t,e,n)=>{const{selection:o,doc:s}=t;if(!o||!s)return t;const{from:r,to:i}=o,{nodes:a}=e,l=a.blockquote,c=a.list_item,d=a.heading,u=a.paragraph,m=[];n=n||null;const f=new Set([l,d,c,u]);return s.nodesBetween(r,i,((t,e,o)=>{const s=t.type;return(t.attrs.align||null)!==n&&f.has(s)&&m.push({node:t,pos:e,nodeType:s}),!0})),m.length?(m.forEach((e=>{const{node:o,pos:s,nodeType:r}=e;let{attrs:i}=o;i=h(p({},i),n?{align:n}:{align:null}),t=t.setNodeMarkup(s,r,i,o.marks)})),t):t},g=t=>e=>{const{selection:n,doc:o}=e,{from:s,to:r}=n;let i=!0,a=!1;return o.nodesBetween(s,r,((e,n)=>(i&&e.attrs.align===t&&(i=!1,a=!0),i))),a};function b(t,e){const{schema:n,selection:o}=t,s=f(t.tr.setSelection(o),n,"left");return!!s.docChanged&&(e&&e(s))}function v(t,e){const{schema:n,selection:o}=t,s=f(t.tr.setSelection(o),n,"center");return!!s.docChanged&&(e&&e(s))}function y(t,e){const{schema:n,selection:o}=t,s=f(t.tr.setSelection(o),n,"right");return!!s.docChanged&&(e&&e(s))}function w(t,e){const{schema:n,selection:o}=t,s=f(t.tr.setSelection(o),n,"justify");return!!s.docChanged&&(e&&e(s))}const E=[{title:"align-left",content:s.Z.alignLeft,enable:m,active:g("left"),run:b,hotkey:"Ctrl+Alt+L"},{title:"align-center",content:s.Z.alignCenter,enable:m,active:g("center"),run:v,hotkey:"Ctrl+Alt+C"},{title:"align-right",content:s.Z.alignRight,enable:m,active:g("right"),run:y,hotkey:"Ctrl+Alt+R"},{title:"justified",content:s.Z.alignJustify,enable:m,active:g("justify"),run:w,hotkey:"Ctrl+Alt+J"}];e.ZP=E},562415:function(t,e,n){n.d(e,{Z:function(){return N}});var o=n(202784),s=n(117029),r=n(452626),i=n(877119),a=n.n(i),l=Object.defineProperty,c=(t,e,n)=>(((t,e,n)=>{e in t?l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const d={x:-1e4,y:-1e4,w:0,h:0};var u=new class{constructor(){c(this,"_bridges",new Map),c(this,"_positions",new Map),c(this,"_mx",0),c(this,"_my",0),c(this,"_rafID",0),c(this,"_onScroll",(()=>{this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._syncPosition)})),c(this,"_onResize",(t=>{this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._syncPosition)})),c(this,"_onMouseChange",(t=>{this._mx=Math.round(t.clientX),this._my=Math.round(t.clientY),this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=requestAnimationFrame(this._syncPosition)})),c(this,"_onClick",(t=>{const e=Date.now();let n;for(const[r,l]of this._bridges)if(e-l>350){const t=r.getDetails();t.modal&&t.autoDismiss&&(n=t)}if(!n)return;const{body:o,close:s}=n,i=(0,r.mv)(t.clientX,t.clientY,1),a=o?(0,r.hs)(o):null;a&&(0,r.vY)(i,a)||s()})),c(this,"_syncPosition",(()=>{this._rafID=0;const t=new Map;for(const[s,i]of this._bridges){const e=s.getDetails();t.set(s,e);const{anchor:n,body:o}=e;o instanceof HTMLElement&&(e.bodyRect=(0,r.hs)(o)),n instanceof HTMLElement&&(e.anchorRect=(0,r.hs)(n))}const e=(0,r.mv)(this._mx,this._my,2),n=new Set;for(const[s,i]of t){const{anchor:t,bodyRect:o,anchorRect:l,position:c,body:u}=i;if(!o&&!l)continue;const{x:p,y:h}=c(l,o),m=`${p}-${h}`;if(u&&o&&this._positions.get(s)!==m){const t=l?a()(0,l.x-p+l.w/2,o.w-l.w/2):0;this._positions.set(s,m);const e=u.style;e.position="absolute",e.left=`${p}px`,e.top=`${h}px`,e.setProperty("--editor-pop-up-anchor-offset-left",`${t}px`),o.x=p,o.y=h}((0,r.vY)(e,o||d,0)||(0,r.vY)(e,l||d,0))&&t&&n.add(t)}for(;;){const e=n.size;for(const[o,s]of t){const{anchor:t,body:e}=s;for(const o of n)t&&e&&!n.has(t)&&e.contains(o)&&n.add(t)}if(n.size===e)break}const o=Date.now();for(const[s,r]of this._bridges){const e=t.get(s);if(e){const{autoDismiss:t,anchor:s,close:i,modal:a}=e;t&&!a&&o-r>350&&!n.has(s)&&i()}}}))}register(t){this._bridges.set(t,Date.now()),this._positions.set(t,null),1===this._bridges.size&&this._observe(),this._rafID=requestAnimationFrame(this._syncPosition)}unregister(t){this._bridges.delete(t),this._positions.delete(t),0===this._bridges.size&&this._unobserve(),this._rafID&&cancelAnimationFrame(this._rafID)}_observe(){document.addEventListener("mousemove",this._onMouseChange,!1),document.addEventListener("mouseup",this._onMouseChange,!1),document.addEventListener("click",this._onClick,!1),window.addEventListener("scroll",this._onScroll,!0),window.addEventListener("resize",this._onResize,!0)}_unobserve(){document.removeEventListener("mousemove",this._onMouseChange,!1),document.removeEventListener("mouseup",this._onMouseChange,!1),document.removeEventListener("click",this._onClick,!1),window.removeEventListener("scroll",this._onScroll,!0),window.removeEventListener("resize",this._onResize,!0),this._rafID&&cancelAnimationFrame(this._rafID)}},p=n(57444),h=n(365601),m=Object.defineProperty,f=Object.defineProperties,g=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,w=(t,e,n)=>e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const E=(0,h.Z)("popup");class _ extends o.PureComponent{constructor(t){var e;super(t),w(this,"symbol"!=typeof(e="_getDetails")?e+"":e,(()=>{const{close:t,popUpParams:e}=this.props,{anchor:n,autoDismiss:o,position:s,modal:r}=e;return{anchor:n,autoDismiss:!1!==o,body:document.getElementById(this._id),close:t,modal:!0===r,position:s||(r?p.Oi:p.SC)}})),this._bridge=null,this._id=E()}componentDidMount(){this._bridge={getDetails:this._getDetails},u.register(this._bridge)}componentWillUnmount(){this._bridge&&u.unregister(this._bridge)}render(){const{View:t,viewProps:e,close:n}=this.props;return o.createElement("div",{"data-pop-up-id":this._id,id:this._id},o.createElement(t,(s=((t,e)=>{for(var n in e||(e={}))v.call(e,n)&&w(t,n,e[n]);if(b)for(var n of b(e))y.call(e,n)&&w(t,n,e[n]);return t})({},e||{}),f(s,g({close:n})))));var s}}var S=_;const k=(0,h.Z)("create-popup");let x,C=0,M=0;const O="pop-up-modal-mask-"+k();function Z(){const t=document.getElementById(O);t&&t.parentElement&&t.parentElement.removeChild(t)}function D(t,e,n,o){const s=n&&n.container||document.body||document.documentElement;let r=document.getElementById(t);if(!r&&e&&(r=document.createElement("div")),!r)return null;n&&n.modal&&r.setAttribute("data-pop-up-modal","y"),r.className="pop-up-element vars",r.id=t;const i=r.style,a=n&&n.modal?1:0;return n&&n.container||(i.zIndex=1005+3*M+a),o&&(i.zIndex+=o),r.setAttribute("role","dialog"),r.setAttribute("aria-modal","true"),s&&!r.parentElement&&s.appendChild(r),r}function P(t,e,n,r,i){let a=0;document.getElementsByClassName("editorview-wrapper fullscreen")[0]&&(a+=1e3);const l=D(t,!0,i,a);if(l){const t=o.createElement(S,{View:n,close:e,popUpParams:i,viewProps:r});x=(0,s.s)(l),x.render(t)}C>0?function(){const t=document.body||document.documentElement;let e=document.getElementById(O);e||(e=document.createElement("div"),e.id=O,e.className="pop-up-modal-mask",e.setAttribute("data-mask-type","pop-up-modal-mask"),e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true")),t&&!e.parentElement&&t.appendChild(e);const n=e.style,o=Array.from(document.querySelectorAll(".pop-up-element[data-pop-up-modal]")).reduce(((t,e)=>Math.max(t,Number(e.style.zIndex))),0);n.zIndex=o-1}():Z()}function N(t,e,n){const o=k();let s=null,r=e;e=e||{};const i=(n=n||{}).modal||!n.anchor;n.modal=i,M++,i&&C++;const a=t=>{if(!s)return;i&&C--,M--,s=null,function(t){const e=D(t,!1);e&&(x.unmount(),e.parentElement&&e.parentElement.removeChild(e)),0===C&&Z()}(o);const e=n&&n.onClose;e&&e(t)},l=P.bind(null,o,a,t),c={};return s={close:a,update:t=>{r=t,l(r||c,n||c)}},l(r||c,n||c),s}},513014:function(t,e,n){n.d(e,{Z:function(){return O}});var o=n(72779),s=n.n(o),r=n(202784),i=n(816092),a=Object.defineProperty,l=(t,e,n)=>(((t,e,n)=>{e in t?a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class c extends r.PureComponent{constructor(t){super(t),l(this,"_onMouseEnter",(t=>{this._pressedTarget=null,t.preventDefault();const{onMouseEnter:e,value:n}=this.props;e&&e(n,t)})),l(this,"_onMouseLeave",(t=>{this._pressedTarget=null;const e=t;this._onMouseUpCapture(e)})),l(this,"_onMouseDown",(t=>{t.preventDefault(),this._pressedTarget=null,this._clicked=!1,3!==t.which&&2!==t.button&&(this.setState({pressed:!0}),this._pressedTarget=t.currentTarget,this._clicked=!1,this._mul||(document.addEventListener("mouseup",this._onMouseUpCapture,!0),this._mul=!0))})),l(this,"_onMouseUp",(t=>{if(t.preventDefault(),this._clicked||"keypress"===t.type){const{onClick:e,value:n,disabled:o}=this.props;!o&&e&&e(n,t)}this._pressedTarget=null,this._clicked=!1})),l(this,"_onMouseUpCapture",(t=>{this._mul&&(this._mul=!1,document.removeEventListener("mouseup",this._onMouseUpCapture,!0));const e=t.target;this._clicked=this._pressedTarget instanceof HTMLElement&&e instanceof HTMLElement&&(e===this._pressedTarget||e.contains(this._pressedTarget)||this._pressedTarget.contains(e)),this.setState({pressed:!1})})),this._clicked=!1,this._mul=!1,this._pressedTarget=null,this._unmounted=!1,this.state={pressed:!1}}componentWillUnmount(){this._unmounted=!0,this._mul&&(this._mul=!1,document.removeEventListener("mouseup",this._onMouseUpCapture,!0))}render(){const{className:t,disabled:e,active:n,id:o,style:a,title:l,children:c}=this.props,{pressed:d}=this.state,u=s()(t,{active:n,disabled:e,pressed:d});return r.createElement("span",{"aria-disabled":e,"aria-pressed":d,className:u,disabled:e,id:o,onKeyPress:e?i.Z:this._onMouseUp,onMouseDown:e?i.Z:this._onMouseDown,onMouseEnter:e?i.Z:this._onMouseEnter,onMouseLeave:e?null:this._onMouseLeave,onMouseUp:e?i.Z:this._onMouseUp,role:"button",style:a,tabIndex:e?null:0,title:l},c)}}var d=c,u=n(365601),p=n(562415),h=n(57444),m=Object.defineProperty,f=(t,e,n)=>(((t,e,n)=>{e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const g=(0,u.Z)("tooltip-surface");class b extends r.PureComponent{render(){const{tooltip:t}=this.props;return r.createElement("div",{className:"editor-tooltip-view editor-animation-fade-in"},t)}}class v extends r.PureComponent{constructor(t){super(t),f(this,"_onMouseEnter",(()=>{if(!this._popUp){const{tooltip:t}=this.props;this._popUp=(0,p.Z)(b,{tooltip:t},{anchor:document.getElementById(this._id),onClose:this._onClose,position:h.lS})}})),f(this,"_onMouseLeave",(()=>{this._popUp&&this._popUp.close(),this._popUp=null})),f(this,"_onClose",(()=>{this._popUp=null})),this._id=g(),this._popUp=null}componentWillUnmount(){this._popUp&&this._popUp.close()}render(){const{tooltip:t,children:e}=this.props;return r.createElement("span",{"aria-label":t,className:"editor-tooltip-surface","data-tooltip":t,id:this._id,onMouseDown:t&&this._onMouseLeave,onMouseEnter:t&&this._onMouseEnter,onMouseLeave:t&&this._onMouseLeave,role:"tooltip"},e)}}var y=v,w=Object.defineProperty,E=Object.defineProperties,_=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,C=(t,e,n)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;class M extends r.PureComponent{render(){const t=this.props,{icon:e,label:n,className:o,title:i}=t,a=((t,e)=>{var n={};for(var o in t)k.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&S)for(var o of S(t))e.indexOf(o)<0&&x.call(t,o)&&(n[o]=t[o]);return n})(t,["icon","label","className","title"]),l=s()(o,"editor-custom-button",{"use-icon":!!e});return r.createElement(y,{tooltip:i},r.createElement(d,(c=((t,e)=>{for(var n in e||(e={}))k.call(e,n)&&C(t,n,e[n]);if(S)for(var n of S(e))x.call(e,n)&&C(t,n,e[n]);return t})({},a),E(c,_({className:l}))),e,n));var c}}var O=M},565784:function(t,e,n){n.d(e,{Z:function(){return wt}});var o=n(72779),s=n.n(o),r=n(202784),i=n(928316),a=n(365601),l=n(922730),c=n(117029),d=Object.defineProperty,u=(t,e,n)=>(((t,e,n)=>{e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const p=Object.freeze({from:0,to:0});function h(t){if(!window.getSelection)return console.warn("window.getSelection() is not supported"),p;const e=window.getSelection();if(!e.containsNode)return console.warn("selection.containsNode() is not supported"),p;if(!e.rangeCount)return p;const n=e.getRangeAt(0);if(!n)return p;const{startContainer:o,endContainer:s,startOffset:r,endOffset:i}=n;return o===t||s===t||o&&t.contains(o)||s&&t.contains(s)?{from:r,to:i}:p}var m=Object.defineProperty,f=Object.defineProperties,g=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,w=(t,e,n)=>e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const E="ProseMirror-selectednode",_=new Set,S=new Set;const k=new class{constructor(t){u(this,"_observables",[]),u(this,"_callback",null),u(this,"_onClick",(()=>{const t=this._callback;if(this._observables=this._observables.map((t=>{const{target:e}=t;return{target:e,selection:h(e)}})),t)return t(this.takeRecords(),this)})),u(this,"_check",(()=>{let t=!1;const e=this._callback;if(this._observables=this._observables.map((e=>{const{target:n,selection:o}=e,s=h(n);return o===s||o.from===s.from&&o.to===s.to?e:(t=!0,{target:n,selection:s})})),t&&e)return e(this.takeRecords(),this)})),this._callback=t}disconnect(){this._observables.forEach((t=>{const e=t.target;e.removeEventListener("click",this._check,!1),e.removeEventListener("selectionchange",this._check,!1)})),this._observables=[]}observe(t){if(!window.getSelection)return void console.warn("window.getSelection() is not supported");if(this._observables.some((e=>e.target===t)))return;const e={target:t,selection:h(t)};t.addEventListener("click",this._check,!1),t.addEventListener("selectionchange",this._check,!1),this._observables.push(e)}takeRecords(){return this._observables.slice(0)}}((function(t,e){if(!window.getSelection)return console.warn("window.getSelection() is not supported"),void e.disconnect();const n=window.getSelection();if(!n.containsNode)return console.warn("selection.containsNode() is not supported"),void e.disconnect();for(const o of _){const t=o.dom;n.containsNode(t)?o.selectNode():o.deselectNode()}0===_.size&&e.disconnect()})),x=new MutationObserver((function(t,e){const n=document.body;if(!n)return;const o=[];for(const s of S){const t=s.dom;n.contains(t)&&(S.delete(s),o.push(s),s.__renderReactComponent())}for(const s of _){const t=s.dom;n.contains(t)||(_.delete(t),s.root.unmount())}o.forEach((t=>_.add(t))),0===_.size&&e.disconnect()}));var C=class{constructor(t,e,n,o){this.props={decorations:o,editorView:e,getPos:n,node:t,selected:!1,focused:!1},S.add(this);const s=this.createDOMElement();this.dom=s,this._selected=null,s.onClick=this._onClick,1===S.size&&(x.observe(document,{childList:!0,subtree:!0}),k.observe(document))}update(t,e){var n;return this.props=(n=((t,e)=>{for(var n in e||(e={}))v.call(e,n)&&w(t,n,e[n]);if(b)for(var n of b(e))y.call(e,n)&&w(t,n,e[n]);return t})({},this.props),f(n,g({node:t}))),this.__renderReactComponent(),!0}stopEvent(){return!1}selectNode(){this._selected=!0,this.dom.classList.add(E),this.__renderReactComponent()}deselectNode(){this._selected=!1,this.dom.classList.remove(E),this.__renderReactComponent()}createDOMElement(){throw new Error("not implemented")}renderReactComponent(){throw new Error("not implemented")}destroy(){}__renderReactComponent(){const{editorView:t,getPos:e}=this.props;if(t.state&&t.state.selection){const{from:n}=t.state.selection,o=e();this.props.selected=this._selected,this.props.focused=t.focused&&o===n}else this.props.selected=!1,this.props.focused=!1;this.root=(0,c.s)(this.dom),this.root.render(this.renderReactComponent())}};n(871199),n(676065);const M="text-editor-frame-body";class O extends r.PureComponent{render(){const{body:t,className:e,embedded:n,header:o,height:s,toolbarPlacement:r,toolbar:i,width:a}=this.props,l=!isUndefined(a)||!isUndefined(s),c=cx(e,{"text-editor-frameset":!0,"with-fixed-layout":l,embedded:n}),d={width:toCSS(isUndefined(a)&&l?"auto":a),height:toCSS(isUndefined(s)&&l?"auto":s)},u="header"!==r&&r?null:i,p="body"===r&&i;return React.createElement("div",{className:c,style:d},React.createElement("div",{className:"text-editor-frame-main"},React.createElement("div",{className:"text-editor-frame-head"},o,u),React.createElement("div",{className:M},p,React.createElement("div",{className:"text-editor-frame-body-scroll"},t)),React.createElement("div",{className:"text-editor-frame-footer"})))}}var Z=n(812128),D=n(513014),P=Object.defineProperty,N=(t,e,n)=>(((t,e,n)=>{e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const I={NONE:{value:null,text:"Inline"},LEFT:{value:"left",text:"Float left"},CENTER:{value:"center",text:"Center"},RIGHT:{value:"right",text:"Float right"}};class j extends r.PureComponent{constructor(){super(...arguments),N(this,"_onClick",(t=>{this.props.onSelect({align:t})}))}render(){const t=this.props.value?this.props.value.align:null,e=this._onClick,n=Object.keys(I).map((n=>{const{value:o,text:s}=I[n];return r.createElement(D.Z,{active:t===o,key:n,label:s,onClick:e,value:o})}));return r.createElement("div",{className:"editor-inline-editor"},n)}}var A=j,R=n(877119),T=n.n(R),V=n(409961),L=n.n(V),z=Object.defineProperty,U=(t,e,n)=>(((t,e,n)=>{e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const F=(0,a.Z)("image-resize-box"),$=20,H={top:W,top_right:q,right:B,bottom_right:q,bottom:W,bottom_left:q,left:B,top_left:q};function B(t,e,n){t.style.width=e+"px"}function W(t,e,n){t.style.height=n+"px"}function q(t,e,n){t.style.width=Math.round(e)+"px",t.style.height=Math.round(n)+"px"}class J extends r.PureComponent{constructor(t){super(t),U(this,"_syncSize",(()=>{if(!this._active)return;const{direction:t,width:e,height:n}=this.props,o=(this._x2-this._x1)*(/left/.test(t)?-1:1),s=(this._y2-this._y1)*(/top/.test(t)?-1:1),r=this._el;if(L()(r))throw new Error("Encountered an error: `el` should not be null.");const i=H[t];if(L()(i))throw new Error("Encountered an error: `fn` should not be null.");const a=e/n;let l=T()($,e+Math.round(o),1e4),c=T()($,n+Math.round(s),1e4);i===q&&(c=Math.max(l/a,$),l=c*a),i(r,Math.round(l),Math.round(c)),this._ww=l,this._hh=c})),U(this,"_onMouseDown",(t=>{t.preventDefault(),t.stopPropagation(),this._end(),this._start(t)})),U(this,"_onMouseMove",(t=>{t.preventDefault(),t.stopPropagation(),this._x2=t.clientX,this._y2=t.clientY,this._rafID=requestAnimationFrame(this._syncSize)})),U(this,"_onMouseUp",(t=>{t.preventDefault(),t.stopPropagation(),this._x2=t.clientX,this._y2=t.clientY;const{direction:e}=this.props,n=this._el;if(L()(n))throw new Error("Encountered an error: `el` should not be null.");n.classList.remove(e),this._end(),this.props.onResizeEnd(this._ww,this._hh)})),this._active=!1,this._el=null,this._h="",this._rafID=0,this._w="",this._x1=0,this._x2=0,this._y1=0,this._y2=0,this._ww=0,this._hh=0}componentWillUnmount(){this._end()}_start(t){this._active&&this._end(),this._active=!0;const{boxID:e,direction:n,width:o,height:s}=this.props,r=document.getElementById(e);if(L()(r))throw new Error("Encountered an error: `el` should not be null.");r.className+=" "+n,this._el=r,this._x1=t.clientX,this._y1=t.clientY,this._x2=this._x1,this._y2=this._y1,this._w=this._el.style.width,this._h=this._el.style.height,this._ww=o,this._hh=s,document.addEventListener("mousemove",this._onMouseMove,!0),document.addEventListener("mouseup",this._onMouseUp,!0)}_end(){if(!this._active)return;this._active=!1,document.removeEventListener("mousemove",this._onMouseMove,!0),document.removeEventListener("mouseup",this._onMouseUp,!0);const t=this._el;if(L()(t))throw new Error("Encountered an error: `el` should not be null.");t.style.width=this._w,t.style.height=this._h,t.className="editor-image-resize-box",this._el=null,this._rafID&&cancelAnimationFrame(this._rafID),this._rafID=null}render(){const{direction:t}=this.props,e=s()({"editor-image-resize-box-control":!0,[t]:!0});return r.createElement("span",{role:"button",tabIndex:-1,className:e,onMouseDown:this._onMouseDown})}}class K extends r.PureComponent{constructor(t){super(t),this._id=F()}render(){const{onResizeEnd:t,width:e,height:n,src:o}=this.props,s={height:n+"px",width:e+"px"},i=this._id,a=Object.keys(H).map((o=>r.createElement(J,{boxID:i,config:H[o],direction:o,height:n,key:o,onResizeEnd:t,width:e})));return r.createElement("span",{className:"editor-image-resize-box",id:i,style:s},a,r.createElement("img",{className:"editor-image-resize-box-image",alt:"Resize Box",src:o}))}}var G=K,Y=n(57444),X=n(297209);let Q=null;const tt=new Map;function et(t){t.forEach(nt)}function nt(t){const e=t.target,n=tt.get(e),o=e=>e(t);n&&n.forEach(o)}var ot={observe:function(t,e){const n=t,o=Q||(Q=new X.default(et));if(tt.has(n)){let t=tt.get(n);if(L()(t))throw new Error("Encountered an error: callbacks are missing.");t.push(e)}else{const t=[e];tt.set(n,t),o.observe(n)}},unobserve:function(t,e){const n=Q;if(!n)return;const o=t;if(n.unobserve(o),e){let t=null;if(tt.has(o)){if(t=tt.get(o),L()(t))throw new Error("Encountered an error: callbacks are missing.");t=t.filter((t=>t!==e))}t&&t.length?tt.set(o,t):tt.delete(o)}else tt.delete(o);tt.size||(n.disconnect(),Q=null)}},st=n(562415),rt=n(978491),it=Object.defineProperty,at=Object.defineProperties,lt=Object.getOwnPropertyDescriptors,ct=Object.getOwnPropertySymbols,dt=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable,pt=(t,e,n)=>e in t?it(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ht=(t,e)=>{for(var n in e||(e={}))dt.call(e,n)&&pt(t,n,e[n]);if(ct)for(var n of ct(e))ut.call(e,n)&&pt(t,n,e[n]);return t},mt=(t,e)=>at(t,lt(e)),ft=(t,e,n)=>(pt(t,"symbol"!=typeof e?e+"":e,n),n);const gt=(0,a.Z)("image-node-view"),bt=1e5,vt={src:"",complete:!1,height:0,width:0};class yt extends r.PureComponent{constructor(t){super(t),ft(this,"_resolveOriginalSize",(()=>{return t=this,e=null,n=function*(){if(!this._mounted)return;this.setState({originalSize:vt});const t=this.props.node.attrs.src,e=t,n=yield(0,rt.Z)(e);this._mounted&&this.props.node.attrs.src===t&&(n.complete||(n.width=$,n.height=$),this.setState({originalSize:n}))},new Promise(((o,s)=>{var r=t=>{try{a(n.next(t))}catch(e){s(e)}},i=t=>{try{a(n.throw(t))}catch(e){s(e)}},a=t=>t.done?o(t.value):Promise.resolve(t.value).then(r,i);a((n=n.apply(t,e)).next())}));var t,e,n})),ft(this,"_onResizeEnd",((t,e)=>{const{getPos:n,node:o,editorView:s}=this.props,r=n(),i=mt(ht({},o.attrs),{crop:null,width:t,height:e});let a=s.state.tr;const{selection:l}=s.state;a=a.setNodeMarkup(r,null,i),a=a.setSelection(l.map(a.doc,a.mapping)),s.dispatch(a)})),ft(this,"_onChange",(t=>{if(!this._mounted)return;const e=t?t.align:null,{getPos:n,node:o,editorView:s}=this.props,r=n(),i=mt(ht({},o.attrs),{align:e});let a=s.state.tr;const{selection:l}=s.state;a=a.setNodeMarkup(r,null,i),a=a.setSelection(l.map(a.doc,a.mapping)),s.dispatch(a)})),ft(this,"_onBodyRef",(t=>{if(t){this._body=t;const e=i.findDOMNode(t);e instanceof HTMLElement&&ot.observe(e,this._onBodyResize)}else{const t=this._body&&i.findDOMNode(this._body);t instanceof HTMLElement&&ot.unobserve(t),this._body=null}})),ft(this,"_onBodyResize",(t=>{const e=this._body?function(t){let e=t.parentElement;for(;e&&!e.offsetParent;)e=e.parentElement;if(e&&e.offsetParent&&e.offsetParent.offsetWidth&&e.offsetParent.offsetWidth>0){const{offsetParent:n}=e,o=t.ownerDocument.defaultView.getComputedStyle(n);let s=n.clientWidth-4;return"border-box"===o.boxSizing&&(s-=parseInt(o.paddingLeft,10)+parseInt(o.paddingRight,10)),Math.max(s,$)}return bt}(i.findDOMNode(this._body)):bt;this.setState({maxSize:{width:e,height:bt,complete:!!this._body}})})),this._body=null,this._id=gt(),this._inlineEditor=null,this._mounted=!1,this.state={maxSize:{width:bt,height:bt,complete:!1},originalSize:vt}}componentDidMount(){this._mounted=!0,this._resolveOriginalSize(),this._renderInlineEditor()}componentDidUpdate(t){const e=t.node.attrs.src,{node:n}=this.props,{src:o}=n.attrs;e!==o&&this._resolveOriginalSize(),this._renderInlineEditor()}componentWillUnmount(){this._mounted=!1,this._inlineEditor&&this._inlineEditor.close(),this._inlineEditor=null}_renderInlineEditor(){const t=document.getElementById(this._id);if(!t||"true"!==t.getAttribute("data-active"))return void(this._inlineEditor&&this._inlineEditor.close());const{node:e}=this.props,n={value:e.attrs,onSelect:this._onChange};this._inlineEditor?this._inlineEditor.update(n):this._inlineEditor=(0,st.Z)(A,n,{anchor:t,autoDismiss:!1,container:t.closest?t.closest(`.${M}`):null,position:Y.lS,onClose:()=>{this._inlineEditor=null}})}render(){const{originalSize:t,maxSize:e}=this.state,{editorView:n,node:o,selected:i,focused:a}=this.props,{readOnly:c}=n,{attrs:d}=o,{align:u,crop:p,rotate:h}=d,m=t===vt,f=!m&&a&&!c&&t.complete,g=t.complete?t.src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",b=m?1:t.width/t.height,v=!m&&!t.complete;let{width:y,height:w}=d;m&&(y=y||24,w=w||24),y&&!w?w=y/b:w&&!y?y=w*b:y||w||(y=t.width,w=t.height);let E=1;y>e.width&&(!p||p.width>e.width)&&(y=e.width,w=y/b,E=e.width/y);const _=s()("editor-image-view-body",{active:f,error:v,focused:a,loading:m,selected:i}),S=!f||p||h?null:r.createElement(G,{height:w,onResizeEnd:this._onResizeEnd,src:g,width:y}),k={display:"inline-block",height:w+"px",left:"0",top:"0",width:y+"px",position:"relative"},x={};if(p){const t=ht({},p);1!==E&&(E=e.width/t.width,t.width*=E,t.height*=E,t.left*=E,t.top*=E),x.width=t.width+"px",x.height=t.height+"px",k.left=t.left+"px",k.top=t.top+"px"}h&&(x.transform=`rotate(${h}rad)`);let C=null;d.meta&&(C=r.createElement("pre",{className:"img-tooltip"},d.meta));const M=v?r.createElement("span",{className:"editor-image-view-error"},Z.Z.error," "):null,O=v?`${l.a.t("text-editor:unable-to-load-image")} ${d.src||""}`:void 0,D=r.createElement("img",{alt:"",className:"editor-image-view-body-img","data-align":u,height:w,id:`${this._id}-img`,src:g,width:y});return r.createElement(r.Fragment,null,C,r.createElement("span",{className:_,"data-active":f?"true":void 0,"data-original-src":String(d.src),id:this._id,ref:this._onBodyRef,title:O},r.createElement("span",{className:"editor-image-view-body-img-clip",style:x},r.createElement("span",{style:k},M,D)),S))}}var wt=class extends C{createDOMElement(){const t=document.createElement("span");return t.className="editor-image-view",t.addEventListener("dragstart",(t=>{var e=document.createElement("img");e.src=this.props.node.attrs.src,t.dataTransfer.setDragImage(e,0,0)}),!1),this._updateDOM(t),t}update(t,e){return super.update(t,e),this._updateDOM(this.dom),!0}renderReactComponent(){return r.createElement(yt,ht({},this.props))}_updateDOM(t){const{align:e}=this.props.node.attrs;let n="editor-image-view";e&&(n+=" align-"+e),t.className=n}}},346527:function(t,e,n){var o=n(202784),s=n(922730),r=n(768466),i=n(513014),a=n(816092),l=Object.defineProperty,c=(t,e,n)=>(((t,e,n)=>{e in t?l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const d=/\s/;class u extends o.PureComponent{constructor(){super(...arguments),c(this,"state",{url:this.props.href}),c(this,"_onKeyDown",(t=>{13===t.keyCode&&(t.preventDefault(),this._apply())})),c(this,"_onURLChange",(t=>{const e=t.target.value;this.setState({url:e})})),c(this,"_cancel",(()=>{this.props.close()})),c(this,"_apply",(()=>{const{url:t}=this.state;t&&!d.test(t)&&this.props.close((0,r.Z)(t))}))}render(){const{href:t}=this.props,{url:e}=this.state,n=!!e&&d.test(e);let r=s.a.t("text-editor:apply"),l=!!n;return t?(r=e?s.a.t("text-editor:apply"):s.a.t("text-editor:remove"),l=n):l=n||!e,o.createElement("div",{className:"image-url-editor"},o.createElement("form",{className:"editor-form",onSubmit:a.Z},o.createElement("fieldset",null,o.createElement("legend",null,s.a.t("text-editor:add-link")),o.createElement("input",{autoFocus:!0,onChange:this._onURLChange,onKeyDown:this._onKeyDown,placeholder:s.a.t("text-editor:paste-url"),spellCheck:!1,type:"text",value:e||""})),o.createElement("div",{className:"editor-form-buttons"},o.createElement(i.Z,{label:s.a.t("text-editor:cancel"),onClick:this._cancel}),o.createElement(i.Z,{active:!0,disabled:l,label:r,onClick:this._apply}))))}}e.Z=u},57444:function(t,e,n){n.d(e,{DL:function(){return l},ID:function(){return a},Oi:function(){return i},SC:function(){return s},lS:function(){return r}});var o=n(452626);function s(t,e){const n={x:0,y:0,w:0,h:0};if(t&&e){n.x=t.x,n.y=t.y+t.h;const o=window.innerWidth,s=window.innerHeight;n.x+e.w>o&&(n.x=t.x-e.w+t.w),n.y+e.h>s&&(n.y=Math.max(t.y-e.h,2))}return t&&!(0,o.zb)(t)||(n.x=-1e4),n}function r(t,e){const n={x:0,y:0,w:0,h:0};return t&&e&&(n.x=Math.max(t.x-(e.w-t.w)/2,10),n.y=t.y+t.h),t&&!(0,o.zb)(t)||(n.x=-1e4),n}function i(t,e){const n={x:0,y:0,w:0,h:0};return e&&(n.x=(window.innerWidth-e.w)/2,n.y=(window.innerHeight-e.h)/2),e&&!(0,o.zb)(e)||(n.x=-1e4),n}function a(t,e){const n={x:0,y:0,w:0,h:0};return t&&e&&(n.x=t.x+t.w+1-e.w,n.y=t.y),t&&!(0,o.zb)(t)||(n.x=-1e4),n}function l(t,e){const n={x:0,y:0,w:0,h:0};return t&&e&&(n.x=t.x+(t.w-e.w)/2,n.y=t.y),t&&!(0,o.zb)(t)||(n.x=-1e4),n}},816092:function(t,e,n){function o(t){t.preventDefault()}n.d(e,{Z:function(){return o}})},452626:function(t,e,n){function o(t){return 0===t.w||0===t.h}function s(t,e,n){const o=n||0;return!(e.x-o>t.x+t.w+o||e.x+e.w+o<t.x-o||e.y-o>t.y+t.h+o||e.y+e.h+o<t.y-o)}function r(t,e,n){return{x:t-(n=n||0),y:e-n,w:2*n,h:2*n}}function i(t){if("contents"===document.defaultView.getComputedStyle(t).display&&1===t.children.length)return i(t.children[0]);const e=t.getBoundingClientRect();return{x:e.left,y:e.top,w:e.width,h:e.height}}n.d(e,{hs:function(){return i},mv:function(){return r},vY:function(){return s},zb:function(){return o}})},978491:function(t,e,n){n.d(e,{Z:function(){return f}});var o=n(900883),s=n(700601),r=n.n(s);var i=function(){return!!r()(window.navigator,"onLine")&&!window.navigator.onLine},a=Object.defineProperty,l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(t,e,n)=>e in t?a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const p={},h=[];function m(){const t=h.shift();t&&function(t,e,n){const s={complete:!1,height:0,naturalHeight:0,naturalWidth:0,src:t||"",width:0};if(i())return void e(s);const r=t||"";if(!r)return void e(s);if(p[r]){const t=Object.assign({},p[r]);return void e(t)}const a=o.parse(r),{protocol:h,port:f}=a;if(!/(http:|https:|data:)/.test(h||window.location.protocol)||f)return void e(s);let g;const b=()=>{g&&(s.width=g.width,s.height=g.height,s.naturalWidth=g.width,s.naturalHeight=g.height,s.complete=!0),e(s),y(),p[r]=((t,e)=>{for(var n in e||(e={}))c.call(e,n)&&u(t,n,e[n]);if(l)for(var n of l(e))d.call(e,n)&&u(t,n,e[n]);return t})({},s)},v=()=>{e(s),y()};function y(){if(g){if(g instanceof HTMLElement){const t=g.parentNode;t&&t.removeChild(g)}g.onload=null,g.onerror=null,g=null}m()}const{body:w}=document;w?(g=document.createElement("img"),g.style.cssText="position:fixed;left:-10000000000px;width:auto;height:auto;",g.onload=b,g.onerror=v,g.src=r,w.appendChild(g)):(g=new Image,g.onload=b,g.onerror=v,g.src=r)}(t.src,t.resolve,t.reject)}var f=function(t){return new Promise(((e,n)=>{const o={src:t,resolve:e,reject:n};h.push(o),m()}))}},894778:function(t,e,n){var o=n(526151),s=Object.defineProperty,r=(t,e,n)=>(((t,e,n)=>{e in t?s(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);function i(t,e){const n=t[e];return"tr"===e&&n instanceof o.wx?n.setMeta("dryrun",!0):n}function a(t,e,n){return t[e]=n,!0}const l=class{constructor(){r(this,"shouldRespondToUIEvent",(t=>t.type===l.EventType.CLICK)),r(this,"active",(t=>!1)),r(this,"enable",((t,e)=>this.dryRun(t,e))),r(this,"dryRun",((t,e)=>{const{Proxy:n}=window,o=n?new n(t,{get:i,set:a}):t;return this.run(o,null,e)})),r(this,"run",((t,e,n,o)=>(this.waitForUserInput(t,e,n,o).then((o=>{this.executeWithUserInput(t,e,n,o)})).catch((t=>{console.error(t)})),!1))),r(this,"waitForUserInput",((t,e,n,o)=>Promise.resolve(void 0))),r(this,"executeWithUserInput",((t,e,n,o)=>!1))}cancel(){}};let c=l;r(c,"EventType",{CLICK:"mouseup",MOUSEENTER:"mouseenter"}),e.Z=c},208757:function(t,e){e.Z=function(t){const e=t.match(/[a-zA-Z0-9_\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g);let n=0;if(null===e)return n;for(let o=0;o<e.length;o++)e[o].charCodeAt(0)>=19968?n+=e[o].length:n+=1;return n}},563135:function(t,e,n){var o=n(690299),s=n.n(o),r=n(193450),i=n(859067);const a=s()("isle:text-editor");e.Z=(t,e)=>{a("Handle drop event...");const n={x:e.clientX,y:e.clientY},o=t.posAtCoords({left:n.x,top:n.y}),s=o?o.pos:null,{dataTransfer:l}=e;if(l&&l.files&&l.files.length>0){e.preventDefault();const{files:o}=l,s=Array.from(o);(0,i.q)(t,s,n)&&(0,r.wM)(t)}else(0,r.yz)(t,s)}},410664:function(t,e,n){n.r(e),n.d(e,{default:function(){return Ue}});var o=n(202784),s=n(213980),r=n.n(s),i=n(313054),a=n.n(i),l=n(912895),c=n.n(l),d=n(498614),u=n(822736),p=n(780594),h=n.n(p),m=n(217431),f=n(902194),g=n(770149),b=n(440835),v=n(690299),y=n.n(v),w=n(130764),E=n(207315),_=n.n(E),S=n(224008),k=n.n(S),x=n(306830),C=n.n(x),M=n(294565),O=n(302467),Z=n.n(O),D=n(569257),P=n.n(D),N=n(55257),I=n(708984),j=n(627939),A=n(539365),R=n(123103),T=n(289846),V=n(812128),L=n(979409),z=n(627191);class U{constructor(t,e,n){this.step=t,this.inverted=e,this.origin=n}}class F{constructor(t,e){this.version=t,this.unconfirmed=e}}const $=new z.H$("collab");function H(t={}){let e={version:t.version||0,clientID:null==t.clientID?Math.floor(4294967295*Math.random()):t.clientID};return new z.Sy({key:$,state:{init:()=>new F(e.version,[]),apply(t,e){let n=t.getMeta($);return n||(t.docChanged?new F(e.version,e.unconfirmed.concat(function(t){let e=[];for(let n=0;n<t.steps.length;n++)e.push(new U(t.steps[n],t.steps[n].invert(t.docs[n]),t));return e}(t))):e)}},config:e,historyPreserveItems:!0})}function B(t,e,n,o={}){let s=$.getState(t),r=s.version+e.length,i=$.get(t).spec.config.clientID,a=0;for(;a<n.length&&n[a]==i;)++a;let l=s.unconfirmed.slice(a);if(!(e=a?e.slice(a):e).length)return t.tr.setMeta($,new F(r,l));let c=l.length,d=t.tr;if(c)l=function(t,e,n){for(let s=t.length-1;s>=0;s--)n.step(t[s].inverted);for(let s=0;s<e.length;s++)n.step(e[s]);let o=[];for(let s=0,r=t.length;s<t.length;s++){let e=t[s].step.map(n.mapping.slice(r));r--,e&&!n.maybeStep(e).failed&&(n.mapping.setMirror(r,n.steps.length-1),o.push(new U(e,e.invert(n.docs[n.docs.length-1]),t[s].origin)))}return o}(l,e,d);else{for(let t=0;t<e.length;t++)d.step(e[t]);l=[]}let u=new F(r,l);return o&&o.mapSelectionBackward&&t.selection instanceof z.Bs&&(d.setSelection(z.Bs.between(d.doc.resolve(d.mapping.map(t.selection.anchor,-1)),d.doc.resolve(d.mapping.map(t.selection.head,-1)),-1)),d.updated&=-2),d.setMeta("rebased",c).setMeta("addToHistory",!1).setMeta($,u)}function W(t){return $.getState(t).version}var q=n(526151),J=n(952780),K=n(732357),G=n(151300),Y=n.n(G),X=n(437069),Q=n.n(X),tt=n(112114),et=n(763489),nt=n(690202),ot=n(966123),st=n(922032);class rt{constructor(t,e){this.id=e,this.text=t}}function it(t,e,n){return J.p.inline(t,e,{class:"comment"},{comment:n})}class at{constructor(t,e,n){this.version=t,this.decos=e,this.unsent=n}findComment(t){let e=this.decos.find();for(let n=0;n<e.length;n++)if(e[n].spec.comment.id===t)return e[n]}commentsAt(t){return this.decos.find(t,t)}apply(t){let e=t.getMeta(lt),n=e&&e.type;if(!e&&!t.docChanged)return this;let o=this;"receive"===n&&(o=o.receive(e,t.doc));let s=o.decos,r=o.unsent;return s=s.map(t.mapping,t.doc),"newComment"===n?(s=s.add(t.doc,[it(e.from,e.to,e.comment)]),r=r.concat(e)):"deleteComment"===n&&(s=s.remove([this.findComment(e.comment.id)]),r=r.concat(e)),new at(o.version,s,r)}receive({version:t,events:e,sent:n},o){let s=this.decos;for(let r=0;r<e.length;r++){let t=e[r];if("delete"===t.type){let e=this.findComment(t.id);e&&(s=s.remove([e]))}else this.findComment(t.id)||(s=s.add(o,[it(t.from,t.to,new rt(t.text,t.id))]))}return new at(t,s,this.unsent.slice(n))}unsentEvents(){let t=[];for(let e=0;e<this.unsent.length;e++){let n=this.unsent[e];if("newComment"===n.type){let e=this.findComment(n.comment.id);e&&t.push({type:"create",id:n.comment.id,from:e.from,to:e.to,text:n.comment.text})}else t.push({type:"delete",id:n.comment.id})}return t}static init(t){let e=t.comments.comments.map((t=>it(t.from,t.to,new rt(t.text,t.id))));return new at(t.comments.version,J.EH.create(t.doc,e),[])}}const lt=new z.Sy({state:{init:at.init,apply(t,e){return e.apply(t)}},props:{decorations(t){return this.getState(t).decos}}}),ct=t=>new z.Sy({props:{decorations(e){return function(t,e){let n=t.selection;if(!n.empty)return null;let o=lt.getState(t).commentsAt(n.from);if(!o.length)return null;return J.EH.create(t.doc,[J.p.widget(n.from,dt(o,e,t))])}(e,t)}}});function dt(t,e,n){const o=document.createElement("div");o.className="tooltip-wrapper";const s=document.createElement("ul");s.className="commentList";for(let r=0;r<t.length;r++){const o=ut(t[r].spec.comment,e,n);s.appendChild(o)}return o.appendChild(s),o}function ut(t,e,n){const o=document.createElement("button");o.className="commentDelete",o.title="Delete annotation",o.innerHTML="x",o.addEventListener("click",(()=>e(n.tr.setMeta(lt,{type:"deleteComment",comment:t}))));const s=document.createElement("li");return s.className="commentText",s.innerHTML=t.text,s.appendChild(o),s}const pt=y()("isle:text-editor"),ht="cursor-widget",mt=et.D.length;var ft=new z.Sy({state:{init(){return{decorations:J.EH.empty,version:0}},apply(t,e){const n=t.getMeta(this);let o;if(n&&n.cursors){const s=Q()(n.cursors);o=J.EH.empty;for(let e=0;e<s.length;e++){const r=s[e];if(r===n.clientID)continue;const i=document.createElement("span");i.className="editor-collaborative-cursor";const a=document.createElement("span");a.className="editor-collaborative-cursor-line",a.style=`background-color: ${et.D[e%mt]}`,i.appendChild(a);const l=document.createElement("span");l.innerHTML=r,l.className="editor-collaborative-cursor-text",l.style=`background-color: ${et.D[e%mt]}`,i.appendChild(l);const c=n.cursors[r];let d=c.from,u=c.to;if(pt("Should display cursor at position: "+d),d!==u){if(d>u){const t=u;u=d,d=t}o=o.add(t.doc,[J.p.widget(d,i,{PLACEHOLDER_ID:ht}),J.p.inline(d,u,{style:`background-color: ${et.b[e%mt]};`})])}else o=o.add(t.doc,[J.p.widget(d,i,{PLACEHOLDER_ID:ht})])}return{decorations:o,version:n.version||e.version+1}}return e}},props:{decorations(t){return this.getState(t).decorations}}}),gt=n(5027),bt=n(193450),vt=n(565784),yt=n(208757),wt=n(563135),Et=n(592941),_t=n(302108),St=Object.defineProperty,kt=(t,e,n)=>(((t,e,n)=>{e in t?St(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const xt=y()("isle:collaborative-view"),Ct={mapSelectionBackward:!0};class Mt{constructor(t,e){this.edit=t,this.comm=e}}const Ot=t=>{return o.createElement("div",{className:"prose-statusbar"},t.nUsers&&t.docname?o.createElement("span",{className:"docinfo"},t.t("connected-to"),":",o.createElement("span",{className:"connected",style:{marginLeft:5}},o.createElement("span",{className:"docname"},t.docname,", "),o.createElement("span",{className:"users",style:{marginLeft:5}},(e=t.nUsers)+" user"+(1===e?"":"s")+":",t.userList.map(((t,e)=>o.createElement(tt.Z,{key:`${t}-${e}`,tooltip:t,placement:"top"},o.createElement("span",{className:"prose-statusbar-user-badge",style:{backgroundColor:et.D[e%et.D.length]}}))))))):null,t.nWords?o.createElement("span",null,t.t("words"),": ",t.nWords):null,t.nChars?o.createElement("span",{style:{marginLeft:5}},t.t("characters"),": ",t.nChars):null);var e};class Zt extends o.Component{constructor(t){super(t),kt(this,"replaceEditorState",(()=>{if(console.log("Replace editor state with current default value..."),console.log(this.dispatchState),!this.dispatchState)return setTimeout(this.replaceEditorState,100);const t=this.dispatchState.edit,e=new z.C1(t.doc);console.log(e);const n=Y()(this.props.defaultValue)?Node.fromJSON(st.Z,JSON.parse(this.props.defaultValue)):(0,Et.Z)(this.props.defaultValue);this.dispatch({type:"transaction",transaction:t.tr.replaceWith(e.from,e.to,n)})})),kt(this,"send",((t,{steps:e,comments:n,cursor:o})=>{xt("Send current actions to server...");const s={version:W(t),steps:e?e.steps.map((t=>t.toJSON())):[],cursor:o,clientID:this.props.session.user.name||this.props.session.anonymousIdentifier,comment:n||[]};this.props.session.sendCollaborativeEvents(this.props.id,s)})),kt(this,"onEditorState",(t=>{let e=0,n=0;t.doc.forEach((t=>{t.forEach((t=>{t.text&&(e+=t.text.length,n+=(0,yt.Z)(t.text))}))})),this.nWords=n,this.nChars=e,this.props.onEditorState(t),this.forceUpdate()})),kt(this,"dispatchTransaction",(t=>{this.dispatch({type:"transaction",transaction:t})})),this.doc=Y()(t.defaultValue)?t.defaultValue:(0,Et.Z)(t.defaultValue).toJSON(),this.lastCursor={from:null,to:null},this.state={nUsers:null,userList:[]}}componentDidMount(){const t=this.props.session;this.unsubscribe=t.subscribe(((e,n)=>{e!==_t.At&&e!==_t.E7||this.dispatchState||this.props.session.joinCollaborativeEditing(this.props.id,this.doc),e===_t.qG&&n.id===`${t.namespaceID}-${t.lessonID}-${this.props.id}`?(xt("Joined collaborative editing..."),this.handleStart(n.data)):e===_t.ug&&n.id===`${t.namespaceID}-${t.lessonID}-${this.props.id}`?"polling"===this.dispatchState.comm&&this.handlePollResponse(n.data):e===_t.t0&&n.id===`${t.namespaceID}-${t.lessonID}-${this.props.id}`?(xt("Received response after sending collaborative editing events..."),"send"===this.dispatchState.comm&&this.handleSendResponse(n.data)):e===_t.q$&&n.id===`${t.namespaceID}-${t.lessonID}-${this.props.id}`&&(xt("Received info that other user updated the document "+JSON.stringify(n.data)+"[comm="+this.dispatchState.comm+"]"),"listening"===this.dispatchState.comm&&this.dispatch({type:"polling"}))})),this.dispatchState||this.props.session.joinCollaborativeEditing(this.props.id,this.doc)}componentDidUpdate(t){this.props.defaultValue===t.defaultValue&&this.props.docId===t.docId||this.replaceEditorState()}componentWillUnmount(){this.view&&this.view.destroy(),this.unsubscribe&&this.unsubscribe()}dispatch(t){let e=null;if("loaded"===t.type){const e=z.yy.create({doc:t.doc,schema:st.Z,plugins:nt.Z.concat([H({version:t.version,clientID:this.props.session.user.name||this.props.session.anonymousIdentifier}),lt,ct((t=>this.dispatch({type:"transaction",transaction:t}))),ft]),comments:t.comments});this.dispatchState=new Mt(e,"listening"),this.setState({nUsers:t.users,userList:Q()(t.cursors)})}else if("restart"===t.type)this.dispatchState=new Mt(null,"start"),this.props.session.joinCollaborativeEditing(this.props.id);else if("listening"===t.type)this.dispatchState=new Mt(this.dispatchState.edit,"listening");else if("polling"===t.type)this.dispatchState=new Mt(this.dispatchState.edit,"polling"),this.poll();else if("recover"===t.type)this.dispatchState=new Mt(this.dispatchState.edit,"recover"),this.recover();else if("transaction"===t.type){e=this.dispatchState.edit.apply(t.transaction);let n=(0,K.tp)(e);n&&(e=e.apply(n.setMeta("addToHistory",!1)))}if(e){let n;e.doc.content.size>4e4?("detached"!==this.dispatchState.comm&&xt("Document too big. Detached."),this.dispatchState=new Mt(e,"detached")):("listening"===this.dispatchState.comm||t.requestDone)&&(n=this.sendable(e))?(this.dispatchState=new Mt(e,"send"),this.send(e,n)):t.requestDone?this.dispatchState=new Mt(e,"listening"):this.dispatchState=new Mt(e,this.dispatchState.comm),this.onEditorState(this.dispatchState.edit)}this.dispatchState.edit?this.view?this.view.updateState(this.dispatchState.edit):(xt("Create editor view..."),this.setView(new J.tk(this.editorDiv,{state:this.dispatchState.edit,nodeViews:{footnote:(t,e,n,o)=>new gt.Z(t,e,n,o),image:(t,e,n,o)=>new vt.Z(t,e,n,o),plot:(t,e,n,o)=>new vt.Z(t,e,n,o)},dispatchTransaction:this.dispatchTransaction,handleDOMEvents:{dragenter:t=>{xt("Handle drag enter event..."),(0,bt.yz)(t)},drop:wt.Z}}))):this.setView(null)}recover(){xt("Try to recover from an error..."),"recover"===this.dispatchState.comm&&this.dispatch({type:"polling"})}poll(){const t=lt.getState(this.dispatchState.edit),e=ft.getState(this.dispatchState.edit),n={version:W(this.dispatchState.edit),commentVersion:t.version,cursorVersion:e.version};xt("Ask for collaborative editing events "+JSON.stringify(n)+"[comm="+this.dispatchState.comm+"]"),this.props.session.pollCollaborativeEditingEvents(this.props.id,n)}setView(t){this.view&&this.view.destroy(),this.view=t}handleSendResponse(t){if(xt("Handle send response..."),"invalid version"===t)xt("Went out of sync, trying to restart... "),this.dispatch({type:"restart"});else if("version not current"===t)xt("Version is not current, wait for new data..."),this.dispatch({type:"polling"}),this.poll();else if(t){const e=t.steps.map((t=>q.h8.fromJSON(st.Z,t)));let n=e?B(this.dispatchState.edit,e,function(t,e){let n=[];for(let o=0;o<e;o++)n.push(t);return n}(t.clientID,e.length),Ct):this.dispatchState.edit.tr;n.setMeta(lt,{type:"receive",version:t.commentVersion||0,events:[],sent:t.comment.length}),this.dispatch({type:"transaction",transaction:n,requestDone:!0})}else this.dispatch({type:"recover"})}handlePollResponse(t){if("invalid version"===t||"history no longer available"===t)xt("Too far behind, reverting to server version of document..."),this.dispatch({type:"restart"});else if(t)if(xt(`Received response for version: ${t.version} and commentVersion: ${t.commentVersion}`),t.steps){const e=ft.getState(this.dispatchState.edit).version;let n=B(this.dispatchState.edit,t.steps.map((t=>q.h8.fromJSON(st.Z,t))),t.clientIDs,Ct);n.setMeta(ft,{cursors:t.cursors,version:t.cursorVersion,clientID:this.props.session.user.name||this.props.session.anonymousIdentifier}),this.dispatch({type:"transaction",transaction:n,requestDone:!0}),t.cursorVersion!==e&&this.setState({nUsers:t.users,userList:Q()(t.cursors)})}else this.dispatchTransaction({type:"listening"});else this.dispatch({type:"recover"})}sendable(t){const e=function(t){let e=$.getState(t);return 0==e.unconfirmed.length?null:{version:e.version,steps:e.unconfirmed.map((t=>t.step)),clientID:$.get(t).spec.config.clientID,get origins(){return this._origins||(this._origins=e.unconfirmed.map((t=>t.origin)))}}}(t);let n=t.selection;n=n.toJSON();const o={from:n.head,to:n.anchor},s=lt.getState(t).unsentEvents();return e||s.length||o.from!==this.lastCursor.from||o.to!==this.lastCursor.to?(this.lastCursor=o,{steps:e,comments:s,cursor:o}):null}handleStart(t){if(!t)return xt("Encountered error while starting. Aborting.");xt(`Starting with version: ${t.version} and commentVersion: ${t.commentVersion}`),this.dispatch({type:"loaded",doc:st.Z.nodeFromJSON(t.doc),version:t.version,users:t.users,cursors:t.cursors,comments:{version:t.commentVersion,comments:t.comments}})}render(){return o.createElement(o.Fragment,null,o.createElement(ot.Z,{menu:this.props.menu,state:this.dispatchState?this.dispatchState.edit:null,dispatch:this.dispatchTransaction,view:this.view,fullscreen:this.props.fullscreen,showColorPicker:this.props.showColorPicker,onColorChoice:this.props.onColorChoice}),o.createElement("div",{ref:t=>{this.editorDiv=t,this.props.onMount(this.editorDiv)}}),o.createElement(Ot,{nWords:this.nWords,nChars:this.nChars,nUsers:this.state.nUsers,userList:this.state.userList,docname:this.props.id,t:this.props.t}))}}Zt.propTypes={defaultValue:r().string.isRequired,fullscreen:r().bool.isRequired,menu:r().object.isRequired,showColorPicker:r().bool.isRequired,session:r().object.isRequired,onColorChoice:r().func,onEditorState:r().func,onMount:r().func},Zt.defaultProps={onColorChoice(){},onEditorState(){},onMount(){}};var Dt=(0,d.Zh)("text-editor")(Zt),Pt=n(770561),Nt=n(423184),It=n(658774),jt=n(706e3),At=Object.defineProperty,Rt=Object.defineProperties,Tt=Object.getOwnPropertyDescriptors,Vt=Object.getOwnPropertySymbols,Lt=Object.prototype.hasOwnProperty,zt=Object.prototype.propertyIsEnumerable,Ut=(t,e,n)=>e in t?At(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ft=(t,e)=>{for(var n in e||(e={}))Lt.call(e,n)&&Ut(t,n,e[n]);if(Vt)for(var n of Vt(e))zt.call(e,n)&&Ut(t,n,e[n]);return t},$t=(t,e)=>Rt(t,Tt(e)),Ht=(t,e,n)=>(Ut(t,"symbol"!=typeof e?e+"":e,n),n);class Bt extends o.Component{constructor(t){super(t),Ht(this,"_createEditorView",(t=>{this.editorDiv=t,null!==t&&(this.editorView=new J.tk(t,{state:this.state.editorState,dispatchTransaction:this.dispatchTransaction,editable:()=>!1,nodeViews:{footnote:(t,e,n,o)=>new gt.Z(t,e,n,o),image:(t,e,n,o)=>new vt.Z(t,e,n,o),plot:(t,e,n,o)=>new vt.Z(t,e,n,o),plotContainer:(t,e,n,o)=>new vt.Z(t,e,n,o)}}))})),Ht(this,"addStep",(()=>{if(!this.state.running)return;const t=this.state.editorState,e=t.tr,n=this.state.document.steps[this.state.counter],o=$t(Ft({},this.state.cursors),{[n.clientID]:{from:n.from,to:n.to}});e.setMeta(ft,{cursors:o,version:1,clientID:""});const s=q.h8.fromJSON(st.Z,n),r=s.invert(e.doc);r.clientID=n.clientID,e.maybeStep(s);const i=t.apply(e);this.editorView.updateState(i);const a=this.state.counter+1,l=this.state.invertedSteps.slice();l[this.state.counter]=r;let c=0,d=0;i.doc.forEach((t=>{t.forEach((t=>{t.text&&(c+=t.text.length,d+=(0,yt.Z)(t.text))}))})),this.setState({counter:a,editorState:i,nChars:c,nWords:d,invertedSteps:l,cursors:o},(()=>{a<this.state.document.steps.length&&(this.timeoutID=setTimeout(this.addStep,this.state.interval))}))})),Ht(this,"fastForward",(()=>{if(this.state.running)return this.reset(null,this.fastForward);let t=this.state.editorState;const e=this.state.invertedSteps.slice();for(let s=0;s<this.state.document.steps.length;s++){const n=t.tr,o=this.state.document.steps[s],r=q.h8.fromJSON(st.Z,o),i=r.invert(n.doc);i.clientID=o.clientID,n.maybeStep(r),t=t.apply(n),e[s]=i}this.editorView.updateState(t);let n=0,o=0;t.doc.forEach((t=>{t.forEach((t=>{t.text&&(n+=t.text.length,o+=(0,yt.Z)(t.text))}))})),this.setState({counter:this.state.document.steps.length,editorState:t,nWords:o,nChars:n,invertedSteps:e,running:!1})})),Ht(this,"subtractStep",(()=>{if(!this.state.running)return;const t=this.state.editorState,e=t.tr,n=this.state.counter-1,o=this.state.invertedSteps[n],s=$t(Ft({},this.state.cursors),{[o.clientID]:{from:o.from,to:o.to}});e.setMeta(ft,{cursors:s,version:1,clientID:""}),e.maybeStep(o);const r=t.apply(e);this.editorView.updateState(r);let i=0,a=0;r.doc.forEach((t=>{t.forEach((t=>{t.text&&(i+=t.text.length,a+=(0,yt.Z)(t.text))}))})),this.setState({counter:n,editorState:r,nChars:i,nWords:a},(()=>{n>0&&(this.timeoutID=setTimeout(this.subtractStep,this.state.interval))}))})),Ht(this,"reset",((t,e=C())=>{this.timeoutID&&clearTimeout(this.timeoutID);const n=this.props.defaultValue,o=Y()(n)?Node.fromJSON(st.Z,JSON.parse(n)):(0,Et.Z)(n),s=z.yy.create({doc:o,schema:st.Z,plugins:nt.Z.concat([ft]),cursors:{}});this.editorView.updateState(s),this.setState({editorState:s,counter:0,nChars:0,nWords:0,running:!1},e)})),Ht(this,"playBackward",(()=>{this.setState({running:!0},this.subtractStep)})),Ht(this,"playForward",(()=>{this.setState({running:!0},this.addStep)})),Ht(this,"stop",(()=>{this.setState({running:!1}),this.timeoutID&&clearTimeout(this.timeoutID)})),Ht(this,"handleRestore",(()=>{console.log("Restoring document to state at step "+this.state.counter+"..."),console.log(this.state.editorState.doc),this.props.onRestore(this.state.editorState.doc.content)}));const e=t.defaultValue,n=Y()(e)?Node.fromJSON(st.Z,JSON.parse(e)):(0,Et.Z)(e);this.state={editorState:z.yy.create({doc:n,schema:st.Z,plugins:nt.Z.concat([ft])}),document:null,counter:0,interval:100,running:!1,nWords:0,nChars:0,invertedSteps:[],cursors:{}}}componentDidMount(){return t=this,e=null,n=function*(){const t=this.props.session;if(!t.anonymous){const e=yield t.getTextEditorDocument(this.props.docId);"ok"===e.data.message&&this.setState({document:e.data.document})}},new Promise(((o,s)=>{var r=t=>{try{a(n.next(t))}catch(e){s(e)}},i=t=>{try{a(n.throw(t))}catch(e){s(e)}},a=t=>t.done?o(t.value):Promise.resolve(t.value).then(r,i);a((n=n.apply(t,e)).next())}));var t,e,n}componentWillUnmount(){this.timeoutID&&clearTimeout(this.timeoutID)}render(){const{document:t,counter:e}=this.state,{t:n,session:s}=this.props,r=s.anonymous;let i;return console.log(t),i=r?o.createElement("div",{className:"text-editor-jumbotron"},n("history-only-available-for-users")):o.createElement("div",{ref:this._createEditorView}),o.createElement(o.Fragment,null,o.createElement(tt.Z,{tooltip:n("close")},o.createElement(Pt.Z,{"aria-label":n("close"),variant:"light",onClick:this.props.onClose},o.createElement("i",{className:"fas fa-arrow-left"}))),o.createElement("span",{className:"title text-editor-playback-title"},n("document-history")),o.createElement(Nt.Z,null,o.createElement(tt.Z,{tooltip:n("jump-to-beginning"),show:!r,placement:"bottom"},o.createElement(Pt.Z,{"aria-label":n("jump-to-beginning"),variant:"light",onClick:this.reset,disabled:r},o.createElement("i",{className:"fas fa-fast-backward"}))),o.createElement(tt.Z,{tooltip:n("play-in-reverse"),show:!r&&t&&0!==e&&!this.state.running,placement:"bottom"},o.createElement(Pt.Z,{"aria-label":n("play-in-reverse"),variant:"light",onClick:this.playBackward,disabled:r||!t||0===e||this.state.running},o.createElement("i",{className:"fas fa-play fa-rotate-180"}))),o.createElement(tt.Z,{tooltip:n("stop"),show:!r&&this.state.running,placement:"bottom"},o.createElement(Pt.Z,{"aria-label":n("stop"),variant:"light",onClick:this.stop,disabled:r||!this.state.running},o.createElement("i",{className:"fas fa-pause"}))),o.createElement(tt.Z,{tooltip:n("play"),show:!r&&t&&t.steps.length>e&&!this.state.running,placement:"bottom"},o.createElement(Pt.Z,{"aria-label":n("play"),variant:"light",onClick:this.playForward,disabled:r||!t||t.steps.length<=e||this.state.running},o.createElement("i",{className:"fas fa-play"}))),o.createElement(tt.Z,{tooltip:n("jump-to-end"),show:!r&&t&&t.steps.length>e,placement:"bottom"},o.createElement(Pt.Z,{"aria-label":n("jump-to-end"),variant:"light",onClick:this.fastForward,disabled:r||!t||t.steps.length<=e},o.createElement("i",{className:"fas fa-fast-forward"})))),o.createElement("span",{style:{marginLeft:20,marginRight:10}},n("update-time")),o.createElement(It.Z,{inline:!0,defaultValue:this.state.interval,min:50,max:1e3,onChange:t=>{this.setState({interval:t})},numberInputStyle:{display:"none"}}),o.createElement("span",null,`${this.state.interval}ms`),o.createElement(tt.Z,{tooltip:n("restore-tooltip"),placement:"bottom"},o.createElement(Pt.Z,{variant:"secondary",style:{margin:4,marginLeft:8},onClick:this.handleRestore},n("restore"))),i,o.createElement(jt.Z,{nWords:this.state.nWords,nChars:this.state.nChars,t:n}))}}Bt.propTypes={onClose:r().func.isRequired,onRestore:r().func.isRequired,defaultValue:r().string.isRequired,docId:r().string.isRequired},Bt.defaultProps={};var Wt=Bt;var qt=(t,e)=>`<!doctype html>\n<html lang=en>\n\t<head>\n\t\t<meta charset=utf-8>\n\t\t<title>${t}</title>\n\t\t<link rel="shortcut icon" href="favicon.ico" />\n\t\t<style media="screen" type="text/css">\n\t\t\tbody {\n\t\t\t\tfont-family: 'Open Sans', sans-serif;\n\t\t\t\tfont-size: 12pt;\n\t\t\t\tmargin-left: auto;\n\t\t\t\tmargin-right: auto;\n\t\t\t\tpadding: 10px;\n\t\t\t\twidth: 100%;\n\t\t\t\tmax-width: 1200px;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\n\n\t\t\th1 {\n\t\t\t\tcolor: #2e4468;\n\t\t\t\tfont-size: 26pt;\n\t\t\t\tfont-weight: bold;\n\t\t\t\tletter-spacing: 1px;\n\t\t\t}\n\n\t\t\th2 {\n\t\t\t\tfont-size: 20pt;\n\t\t\t\tcolor: #3c763d;\n\t\t\t\tfont-weight: 600;\n\t\t\t}\n\n\t\t\th3 {\n\t\t\t\tfont-size: 18pt;\n\t\t\t\tcolor: #2e4468;\n\t\t\t\tfont-weight: 600;\n\t\t\t}\n\n\t\t\th4 {\n\t\t\t\tfont-size: 15pt;\n\t\t\t\tcolor: #ca5800;\n\t\t\t\tfont-weight: 600;\n\t\t\t}\n\n\t\t\th5 {\n\t\t\t\tfont-size: 12pt;\n\t\t\t\tfont-weight: 600;\n\t\t\t}\n\n\t\t\ttr {\n\t\t\t\tdisplay: table-row;\n\t\t\t\tvertical-align: inherit;\n\t\t\t\tborder-color: inherit;\n\t\t\t}\n\n\t\t\tth {\n\t\t\t\tcolor: #464a4c;\n\t\t\t\tbackground-color: #eceeef;\n\t\t\t\tpadding: .3rem;\n\t\t\t\tborder-top: 1px solid #eceeef;\n\t\t\t\ttext-align: left;\n\t\t\t\tfont-weight: bold;\n\t\t\t}\n\n\t\t\tth, td {\n\t\t\t\tdisplay: table-cell;\n\t\t\t}\n\n\t\t\ttd {\n\t\t\t\tpadding: .3rem;\n\t\t\t\tvertical-align: top;\n\t\t\t\tborder-top: 1px solid #eceeef;\n\t\t\t}\n\n\t\t\tthead {\n\t\t\t\tdisplay: table-header-group;\n\t\t\t\tvertical-align: middle;\n\t\t\t}\n\n\t\t\ttable {\n\t\t\t\twidth: 100%;\n\t\t\t\tmax-width: 100%;\n\t\t\t\tmargin-bottom: 1rem;\n\t\t\t\tdisplay: table;\n\t\t\t\tborder-spacing: 2px;\n\t\t\t\tborder-color: grey;\n\t\t\t\ttext-align: left;\n\t\t\t}\n\n\t\t\ta {\n\t\t\t\tcolor: #2e4468;\n\t\t\t}\n\n\t\t\tpre {\n\t\t\t\tdisplay: block;\n\t\t\t\tpadding: 9.5px;\n\t\t\t\tmargin: 0 0 10px;\n\t\t\t\tline-height: 1.42857143;\n\t\t\t\tcolor: #333;\n\t\t\t\tword-break: break-all;\n\t\t\t\tword-wrap: break-word;\n\t\t\t\tborder: 1px solid #ccc;\n\t\t\t\tborder-radius: 4px;\n\t\t\t}\n\n\t\t\tcode {\n\t\t\t\twhite-space: pre-wrap;\n\t\t\t}\n\n\t\t\tblockquote {\n\t\t\t\tfont-size: 22px;\n\t\t\t\tpadding: 10px 20px;\n\t\t\t\tmargin: 0px 0px 20px;\n\t\t\t\tborder-left: 5px solid lightgray;\n\t\t\t\tbackground-color: rgb(238, 238, 238);\n\t\t\t}\n\n\t\t\t.img-tooltip {\n\t\t\t\ttop: 24px;\n\t\t\t\tright: 24px;\n\t\t\t\twidth: max-content;\n\t\t\t\tbackground-color: lightgray;\n\t\t\t\tcolor: black;\n\t\t\t\tborder-radius: 5px;\n\t\t\t\ttext-align: left;\n\t\t\t\topacity: 0;\n\t\t\t\tpadding: 15px;\n\t\t\t\tposition: fixed;\n\t\t\t\tfont-size: 22px;\n\t\t\t\t-webkit-transition: opacity 0.5s;\n\t\t\t\t-moz-transition: opacity 0.5s;\n\t\t\t\t-ms-transition: opacity 0.5s;\n\t\t\t\t-o-transition: opacity 0.5s;\n\t\t\t\ttransition: opacity 0.5s;\n\t\t\t\tz-index: 9999;\n\t\t\t}\n\n\t\t\t.img-container {\n\t\t\t\tposition: relative;\n\t\t\t}\n\n\t\t\t.img-container:hover .img-tooltip {\n\t\t\t\topacity: 1;\n\t\t\t}\n\t\t</style>\n\t\t<script>\n\t\t\tMathJax = {\n\t\t\t\tloader: { load: [] }\n\t\t\t\toptions: {}\n\t\t\t\ttex: {\n\t\t\t\t\tinlineMath: [\n\t\t\t\t\t\t['$', '$'],\n\t\t\t\t\t\t[ '\\(', '\\)' ]\n\t\t\t\t\t],\n\t\t\t\t\tdisplayMath: [\n\t\t\t\t\t\t['$$', '$$'],\n\t\t\t\t\t\t['\\[', '\\]']\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t};\n\t\t<\/script>\n\t\t<script src="https://kit.fontawesome.com/3a7c01b4b9.js" crossorigin="anonymous"><\/script>\n\t\t<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"><\/script>\n\t</head>\n\t<body>\n\t${e}\n\t</body>\n</html>`,Jt=n(734622),Kt=n(552212),Gt=n(922730),Yt=n(26266),Xt=n(513014),Qt=n(816092),te=Object.defineProperty,ee=(t,e,n)=>(((t,e,n)=>{e in t?te(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class ne extends o.PureComponent{constructor(){super(...arguments),ee(this,"state",{annotation:""}),ee(this,"_onKeyDown",(t=>{13===t.keyCode&&(t.preventDefault(),this._apply())})),ee(this,"_onTextChange",(t=>{const e=t.target.value;this.setState({annotation:e})})),ee(this,"_cancel",(()=>{this.props.close()})),ee(this,"_apply",(()=>{this.props.close(this.state.annotation)}))}render(){const{annotation:t}=this.state;return o.createElement("div",{className:"annotation-editor"},o.createElement("form",{className:"editor-form",onSubmit:Qt.Z},o.createElement("fieldset",null,o.createElement("legend",null,Gt.a.t("text-editor:annotation-text")),o.createElement(Yt.Z,{autoFocus:!0,onChange:this._onTextChange,onKeyDown:this._onKeyDown,placeholder:Gt.a.t("text-editor:enter-annotation"),spellCheck:!1,as:"textarea",rows:5,value:t||"",style:{marginBottom:20}})),o.createElement("div",{className:"editor-form-buttons"},o.createElement(Xt.Z,{label:Gt.a.t("text-editor:cancel"),onClick:this._cancel}),o.createElement(Xt.Z,{active:!0,disabled:0===t.length,label:Gt.a.t("text-editor:submit"),onClick:this._apply}))))}}var oe=ne,se=n(894778),re=n(562415),ie=Object.defineProperty,ae=(t,e,n)=>(((t,e,n)=>{e in t?ie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class le extends se.Z{constructor(){super(...arguments),ae(this,"_popUp",null),ae(this,"title","add-annotation"),ae(this,"content",V.Z.annotation),ae(this,"enable",(t=>{if(!(t.selection instanceof z.Bs))return!1;const{from:e,to:n}=t.selection;return e<n})),ae(this,"waitForUserInput",((t,e,n,o)=>this._popUp?Promise.resolve(void 0):(e&&e((0,Kt.tk)(t)),new Promise((t=>{this._popUp=(0,re.Z)(oe,{},{modal:!0,onClose:e=>{this._popUp&&(this._popUp=null,t(e))}})}))))),ae(this,"executeWithUserInput",((t,e,n,o)=>{if(e){const{selection:s}=t;let{tr:r}=t;r=n?(0,Kt.be)(n.state):r,r=r.setSelection(s),r=r.setMeta(lt,{type:"newComment",from:s.from,to:s.to,comment:new rt(o,Math.floor(4294967295*Math.random()))}),e(r)}return n&&n.focus(),!0}))}}var ce=le,de=n(450980),ue=n(782963),pe=n.n(ue),he=n(557106),me=n.n(he);const fe=/width: (.+)px/g,ge=/<pre class="img-tooltip">[\s\S]*?<\/pre>/g;function be(t=12,e=!1){const n=t-4;return{"html-h1":{fontSize:n+16,color:"#2e4468",bold:!0,alignment:e?"center":null},"html-h2":{fontSize:n+14,color:"#3c763d",bold:!0,alignment:e?"center":null},"html-h3":{fontSize:n+8,color:"#2e4468",bold:!0,alignment:e?"center":null},"html-h4":{fontSize:n+4,color:"#ca5800",bold:!0,alignment:e?"center":null},"html-img":{alignment:"center"},"html-table":{alignment:"center"}}}var ve=function(t,e,n,o){t=Z()(t,fe,((t,n)=>`width: ${parseFloat(n)*me()(e.pageSize.width/o,1)}px`)),t=Z()(t,ge,"");const s=pe()(t,{defaultStyles:{img:""}}),r=function(t){return 3024===t.pageSize.width&&2160===t.pageSize.height}(e),i={styles:be(n,r),pageSize:e.pageSize,pageOrientation:e.pageOrientation,defaultStyle:{fontSize:n-4},pageMargins:[40,60,40,60]};return i.content=s,i},ye=n(691334),we=n(487890);const Ee=y()("isle:img-to-str");var _e=function(t,e,n,o="png"){Ee(`Generate base64 encoded ${o} string of ${e} x ${n} image...`);const s=document.createElement("canvas"),r=s.getContext("2d");return s.width=e,s.height=n,r.clearRect(0,0,e,n),r.drawImage(t,0,0,e,n),s.toDataURL("image/"+o)},Se=(n(697927),Object.defineProperty),ke=Object.getOwnPropertySymbols,xe=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable,Me=(t,e,n)=>e in t?Se(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Oe=(t,e,n)=>(Me(t,"symbol"!=typeof e?e+"":e,n),n),Ze=(t,e,n)=>new Promise(((o,s)=>{var r=t=>{try{a(n.next(t))}catch(e){s(e)}},i=t=>{try{a(n.throw(t))}catch(e){s(e)}},a=t=>t.done?o(t.value):Promise.resolve(t.value).then(r,i);a((n=n.apply(t,e)).next())}));const De=(0,m.Z)((()=>Promise.all([n.e(15318),n.e(1948)]).then(n.bind(n,718255)))),Pe=(0,m.Z)((()=>Promise.all([n.e(15318),n.e(10337)]).then(n.bind(n,27202)))),Ne=(0,m.Z)((()=>Promise.all([n.e(15318),n.e(29325)]).then(n.bind(n,600566)))),Ie=(0,m.Z)((()=>Promise.all([n.e(40532),n.e(15318),n.e(43159)]).then(n.bind(n,425291)))),je=y()("isle:text-editor"),Ae=/<body[^>]*>((.|[\n\r])*)<\/body>/im,Re=_()("\n",15),Te=a()({html:!0,xhtmlOut:!0,breaks:!0,typographer:!1});let Ve;function Le(t){return Ze(this,null,(function*(){return yield fetch(t).then((t=>t.blob())).then(j.Z)}))}class ze extends o.Component{constructor(t,e){let n;if(super(t),Oe(this,"recordedText",(t=>{t+=" ",document.execCommand("insertText",!1,t)})),Oe(this,"handleFileSelect",(t=>{je("Opening file...");const e=t.target.files,n=new FileReader;n.onload=()=>{je("Successfully read file...");const t=n.result,e=Ae.exec(t)[1];this.setState({value:e,docId:this.state.docId+1})},n.onerror=()=>{je("Encountered an error...")},n.readAsText(e[0])})),Oe(this,"toggleSubmitModal",((t,e=C())=>{this.setState({showSubmitModal:!this.state.showSubmitModal},e)})),Oe(this,"toggleGuides",(()=>{this.setState({showGuides:!this.state.showGuides})})),Oe(this,"toggleResetModal",((t,e=C())=>{this.setState({showResetModal:!this.state.showResetModal},e)})),Oe(this,"togglePDFModal",((t=C())=>{this.setState({showPDFModal:!this.state.showPDFModal},t)})),Oe(this,"toggleHistory",(()=>{this.setState({showHistory:!this.state.showHistory})})),Oe(this,"submitReport",((t=null,e=null)=>Ze(this,null,(function*(){const n=this.context;if(n.anonymous)return n.addNotification({title:this.props.t("sign-in"),message:this.props.t("sign-in-required"),level:"warning",position:"tr"});let o=w.PW.fromSchema(st.Z).serializeFragment(this.editorState.doc.content),s=document.createElement("div");s.appendChild(o);const r=s.getElementsByTagName("img");for(let t=0;t<r.length;t++){const e=r[t];e.crossOrigin="Anonymous",P()(e.src,"data:image/svg+xml")?(je("Convert from SVG to PNG..."),e.src=_e(e,e.naturalWidth,e.naturalHeight)):P()(e.src,"data:")||(e.src=yield Le(e.src))}const i=Z()(s.innerHTML,"<p></p>","<p> </p>"),a=document.title||"provisoric",l=qt(a,i),d=ve(i,{pageSize:{width:612,height:792},pageOrientation:"portrait"},16,this.editorDiv.clientWidth);c().createPdf(d).getBase64((o=>{if(this.props.sendSubmissionEmails){const s={text:this.props.t("report-submitted-message",{name:n.user.name}),subject:this.props.t("report-submitted"),attachments:[{filename:"report.html",content:l,contentType:"text/html"},{filename:"report.pdf",content:o,contentType:"application/pdf",encoding:"base64"}]};n.sendMail(s,n.user.email),t&&(s.text=e,n.sendMail(s,t.email))}const r=new FormData,i=new FormData;let a="report.html";this.props.id&&(a=this.props.id+"_"+a);const c=new File([l],a,{type:"text/html"});r.append("file",c),a="report.pdf",a=this.props.id+"_"+a;const d=(0,I.Z)(o,"application/pdf"),u=new File([d],a,{type:"application/pdf"});i.append("file",u),n.uploadFile({formData:r,showNotification:!1}),n.uploadFile({formData:i,showNotification:!1}),n.addNotification({title:this.props.t("submitted"),message:this.props.t("submitted-msg"),level:"success",position:"tr"}),this.props.logAction(ye.gY,s.innerText)}))})))),Oe(this,"resetEditor",(()=>{let t,e;this.props.logAction(ye.td),this.setState({value:Te.render(this.props.defaultValue),docId:this.state.docId+1});const n=this.props.resetModal;t=n&&n.notificationTitle?n.notificationTitle:"Reset",e=n&&n.notification?n.notification:this.props.t("report-deleted-msg"),this.context.addNotification({title:t,message:e,level:"success",position:"tr"})})),Oe(this,"requestTextDocuments",(()=>{const t=this.context;this.getTextEditorDocuments||(this.getTextEditorDocuments=h()(t.getTextEditorDocuments,1e3)),this.getTextEditorDocuments()})),n||(n=Te.render(t.defaultValue)),this.state={showResetModal:!1,showSubmitModal:!1,showPDFModal:!1,showColorPicker:!1,showGuides:!1,isFullscreen:!1,value:n,originalDefaultValue:t.defaultValue,docId:0,group:null,allGroups:null,selectedUserReport:null,showHistory:!1},this.menu=k()(T.ZP,2),this.menu.marks.push({title:"font-color",content:V.Z.color,enable:t=>(0,de.Z)(t,"textColor"),run:(t,e)=>{this.setState({showColorPicker:!this.state.showColorPicker}),this.onColorChoice=n=>{const{schema:o}=t;let{tr:s}=t;const r=o.marks.textColor,i=n?{color:n.hex}:null;return s=(0,Jt.Z)(t.tr.setSelection(t.selection),o,r,i),s.docChanged||s.storedMarksSet?(e&&e(s),this.setState({showColorPicker:!this.state.showColorPicker}),!0):(this.setState({showColorPicker:!this.state.showColorPicker}),!1)}}}),this.menu.addons=[{title:"save-html",content:V.Z.save,run:(t,n)=>{e.live&&this.props.logAction(ye.xV),t||(t=this.editorState);const o=w.PW.fromSchema(st.Z).serializeFragment(t.doc.content),s=document.createElement("div");s.appendChild(o);const r=document.title||"provisoric",i=qt(r,s.innerHTML),a=new Blob([i],{type:"text/html"});(0,N.Z)(a,`${r}_${this.state.docId}.html`),this.setState({docId:this.state.docId+1})}},{title:"export-pdf",content:V.Z.pdf,run:(t,e)=>(this.togglePDFModal(),this.exportPDF=e=>Ze(this,null,(function*(){this.props.logAction(ye.JO,JSON.stringify(e));const n=document.title||"provisoric";let o;try{const n=w.PW.fromSchema(st.Z).serializeFragment(t.doc.content),s=document.createElement("div");s.appendChild(n);const r=s.getElementsByTagName("img");for(let t=0;t<r.length;t++){const e=r[t];e.crossOrigin="Anonymous",P()(e.src,"data:image/svg+xml")?(je("Convert from SVG to PNG..."),e.src=_e(e,e.naturalWidth,e.naturalHeight)):P()(e.src,"data:")||(e.src=yield Le(e.src))}const i=Z()(s.innerHTML,"<p></p>","<p> </p>");o=ve(i,e,16,this.editorDiv.clientWidth)}catch(s){this.context.addNotification({title:this.props.t("error-serializing-html"),message:`${s.message}. ${this.props.t("check-syntax")}`,level:"error",position:"tr"})}this.togglePDFModal((()=>{try{c().createPdf(o).download(n)}catch(s){this.context.addNotification({title:this.props.t("error-generating-pdf"),message:`${s}. ${this.props.t("check-syntax")}`,level:"error",position:"tr"})}}))})),!1)}],this.props.canLoadHTML&&this.menu.addons.unshift({title:"open-html",run:(t,e)=>{const n=document.createElement("input");return n.type="file",n.accept=".html",n.addEventListener("change",this.handleFileSelect,!1),n.click(),!1},content:V.Z.open}),this.props.allowSubmissions&&this.menu.addons.push({title:"submit",content:V.Z.submit,run:(t,e)=>(this.editorState=t,this.toggleSubmitModal(),!1)}),this.menu.addons=this.menu.addons.concat([{title:"toggle-fullscreen",run:()=>{/fullscreen/.test(this.editorWrapper.className)?this.editorWrapper.className=this.editorWrapper.className.replace(/\s*fullscreen\b/,""):this.editorWrapper.className+=" fullscreen",this.state.isFullscreen?document.body.style.overflow=Ve:(Ve=document.body.style.overflow,document.body.style.overflow="hidden"),this.setState({isFullscreen:!this.state.isFullscreen})},content:V.Z.fullscreen},{title:"",content:o.createElement(f.Z,{mode:"microphone",timeout:this.props.voiceTimeout,width:26,height:26,onFinalText:this.recordedText})},{title:"open-tutorials",run:this.toggleGuides,content:V.Z.guides},new ce]),t.history&&this.menu.addons.push({title:"show-history",content:V.Z.history,run:this.toggleHistory}),t.defaultValue!==Re){let t,e;const n=this.props.resetModal;t=n&&n.tooltip?n.tooltip:"reset-to-default",e=n&&n.icon?n.icon:V.Z.reset,this.menu.addons.push({title:t,run:()=>{this.toggleResetModal()},content:e})}}static getDerivedStateFromProps(t,e){if(t.defaultValue!==e.originalDefaultValue){je("Default value has changed...");return{value:t.defaultValue?Te.render(t.defaultValue):t.defaultValue,originalDefaultValue:t.defaultValue}}return null}componentDidMount(){const t=this.context;this.unsubscribe=t.subscribe(((e,n)=>{if(e===_t.OG||e===_t.SC||e===_t.Fw||e===_t.E7||e===_t.Ys)this.forceUpdate();else if(e===_t.WF){const e=t.allGroups.map((t=>t.name));this.setState({group:t.group?t.group.name:e[0],allGroups:e})}else e===_t.vB&&this.setState({group:null,allGroups:null})}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}generateDocumentId(){if("group"===this.props.mode)return this.state.group+"-"+this.props.id;const t=this.context;return this.state.selectedUserReport?this.props.id+"-"+this.state.selectedUserReport:"individual"===this.props.mode?this.props.id+"-"+(t.user.email||t.anonymousIdentifier):"cohort"===this.props.mode&&t.cohort?this.props.id+"-"+t.cohort:this.props.id}renderView(){const t=this.context,e=(0,M.isPrimitive)(t.server),n=this.generateDocumentId();return this.state.showHistory?o.createElement(Wt,{defaultValue:this.props.defaultValue,onClose:this.toggleHistory,onRestore:t=>{this.setState({showHistory:!this.state.showHistory},(()=>{const e=w.PW.fromSchema(st.Z).serializeFragment(t),n=document.createElement("div");n.appendChild(e),this.setState({value:n.innerHTML,docId:this.state.docId+1})}))},editorState:this.editorState,docId:n,session:t,t:this.props.t,key:n}):e?t.live?o.createElement(Dt,{defaultValue:this.state.value,menu:this.menu,onMount:t=>{this.editorDiv=t},session:t,fullscreen:this.state.isFullscreen,showColorPicker:this.state.showColorPicker,onColorChoice:this.onColorChoice,id:n,key:`${n}-{session.anonymous}`,onEditorState:t=>{this.editorState=t}}):o.createElement(o.Fragment,null,o.createElement(ot.Z,{menu:this.menu,fullscreen:this.props.fullscreen}),o.createElement("div",{className:"editorview-connection-lost"},o.createElement(u.Z,{variant:"danger"},o.createElement(u.Z.Heading,null,"Connection lost"),o.createElement("p",null,this.props.connectionLostMessage)))):o.createElement(L.Z,{defaultValue:this.state.value,menu:this.menu,className:"cancel",onMount:t=>{this.editorDiv=t},t:this.props.t,fullscreen:this.state.isFullscreen,showColorPicker:this.state.showColorPicker,onColorChoice:this.onColorChoice,id:A.Z?null:this.props.id,onEditorState:t=>{this.editorState=t},docId:this.state.docId})}render(){const t=this.context;return"group"!==this.props.mode||this.state.group?o.createElement(o.Fragment,null,o.createElement("div",{id:this.props.id,className:"editorview-wrapper",ref:t=>{this.editorWrapper=t},style:this.props.style},this.renderView(),"group"===this.props.mode?o.createElement(g.Z,{owner:!0,banner:null,showOwnerInPresentationMode:!1},o.createElement(b.Z,{placeholder:this.props.t("select-group"),options:this.state.allGroups,value:this.state.group,onChange:t=>{this.setState({group:t})},style:{marginLeft:"20px",width:"320px",display:"inline-block"}})):null,"individual"===this.props.mode||"cohort"===this.props.mode?o.createElement(g.Z,{owner:!0,banner:null,showOwnerInPresentationMode:!1},o.createElement("div",{onFocus:this.requestTextDocuments,onMouseOver:this.requestTextDocuments},o.createElement(b.Z,{placeholder:this.props.t("select-document-to-display"),options:t.textEditorDocuments.filter((t=>t.startsWith(this.props.id))).map((t=>t.slice(this.props.id.length+1))),value:this.state.selectedUserReport,onChange:t=>{this.setState({selectedUserReport:t})},clearable:!0,style:{marginLeft:"20px",width:"320px",display:"inline-block"}}))):null),this.state.showResetModal?o.createElement(Pe,((t,e)=>{for(var n in e||(e={}))xe.call(e,n)&&Me(t,n,e[n]);if(ke)for(var n of ke(e))Ce.call(e,n)&&Me(t,n,e[n]);return t})({show:this.state.showResetModal,onHide:this.toggleResetModal,onSubmit:this.resetEditor,t:this.props.t},this.props.resetModal)):null,this.state.showSubmitModal?o.createElement(De,{show:this.state.showSubmitModal,onHide:this.toggleSubmitModal,onSubmit:this.submitReport,t:this.props.t}):null,o.createElement(Ne,{show:this.state.showGuides,onHide:this.toggleGuides,target:this.props.id,t:this.props.t}),this.state.showPDFModal?o.createElement(Ie,{show:this.state.showPDFModal,onHide:this.togglePDFModal,exportPDF:this.exportPDF,t:this.props.t}):null):o.createElement("h3",{style:this.props.style},this.props.t("available-when-grouped"))}}ze.propTypes={allowSubmissions:r().bool,canLoadHTML:r().bool,connectionLostMessage:r().string,defaultValue:r().string,history:r().bool,mode:r().oneOf(["group","collaborative","individual","cohort"]),resetModal:r().shape({title:r().string,body:r().string,buttonLabel:r().string,notificationTitle:r().string,notification:r().string,tooltip:r().string}),sendSubmissionEmails:r().bool,voiceTimeout:r().number,style:r().object},ze.defaultProps={allowSubmissions:!0,canLoadHTML:!0,connectionLostMessage:"Please check your internet connection. To prevent data loss, save the HTML version of your report.",defaultValue:Re,history:!0,mode:"individual",sendSubmissionEmails:!1,voiceTimeout:5e3,resetModal:null,style:{}},ze.contextType=R.Z;var Ue=(0,we.D)("EDITOR")((0,d.Zh)("text-editor")(ze))},966123:function(t,e,n){n.d(e,{Z:function(){return N}});var o=n(202784),s=n(213980),r=n.n(s),i=n(690299),a=n.n(i),l=n(498614),c=n(581440),d=n(185610),u=n(153446),p=n(836663),h=n(296781),m=n(155061),f=n(294565),g=n(112114),b=n(812128),v=n(141396),y=n(557106),w=n.n(y),E=n(783158),_=n.n(E);var S=function(t,e,n,o){let s=e;if(t.nodeSize<=2)return null;const r=t=>t.type===o;for(e=w()(2,e),n=_()(n,t.nodeSize-2);s<=n;){const e=t.nodeAt(s);if(!e||!e.marks){s++;continue}const n=e.marks.find(r);if(n)return n;s+=1}return null};const k={1:26,2:20,3:18,4:15,5:12};var x=function(t){const{schema:e,doc:n,selection:o,tr:s}=t,r=e.marks.fontSize,i=e.nodes.heading,a=String(12);if(!r)return a;const{from:l,to:c,empty:d}=o;if(d){const e=(s.storedMarks||t.storedMarks||o.$cursor&&o.$cursor.marks&&o.$cursor.marks()||[]).find((t=>t.type===r));return e?String(e.attrs.pt||a):a}const u=r?S(n,l,c,r):null;if(u)return String(u.attrs.pt);if(!i)return a;const p=(0,v.Tr)(i)(t.selection);if(!p)return a;const h=String(p.node.attrs.level);return k[h]||a},C=n(450980),M=JSON.parse('["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b","#000000"]');const O=a()("isle:text-editor"),Z="#6e6e6e",D=t=>{if(t.disabled)return o.createElement("button",{onClick:t.onClick,style:{active:t.active,color:t.active?"black":Z,opacity:.2},disabled:!0,className:"menu-item","aria-label":t.t(t.title)},t.children);let e=t.t(t.title);return t.hotkey&&(e+=` (${t.hotkey})`),o.createElement(g.Z,{key:`${t.itemKey}-tooltip`,tooltip:e,placement:"bottom"},o.createElement("button",{onClick:t.onClick,style:{active:t.active,color:t.active?"black":Z},className:"menu-item","aria-label":t.t(t.title)},t.children))},P=({menu:t,children:e,state:n,dispatch:s,view:r,fullscreen:i,showColorPicker:a,onColorChoice:l,t:g})=>{const v=t=>e=>{e.preventDefault(),t.run&&(O("Run command",t,e),t.run(n,s,r,e.nativeEvent))},y=(t,e)=>o.createElement(D,{key:e,itemKey:e,type:"button",active:!(!t.active||!n)&&t.active(n),disabled:!r&&"save-html"!==t.title||!(!t.enable||!n)&&!t.enable(n),title:"string"==typeof t.title?g(t.title):"",hotkey:t.hotkey,onClick:v(t),t:g},(0,f.isPrimitive)(t.content)?g(t.content):t.content),w=(t,e)=>!r||t.enable&&n&&!t.enable(n)?o.createElement(m.Z,{key:`dropdown-item-${e}`,disabled:!0},(0,f.isPrimitive)(t.content)?g(t.content):t.content):o.createElement(m.Z,{key:`dropdown-item-${e}`,onClick:v(t)},(0,f.isPrimitive)(t.content)?g(t.content):t.content),E=t=>t?t.map(y):null;return o.createElement("div",{className:"prose-menu-bar cancel"},e,E(t.blocks),t.headers?o.createElement(o.Fragment,null,o.createElement(d.Z,{title:o.createElement("span",{className:"screenreader"},g("headers")),variant:"outline-secondary",size:"sm",style:{display:"inline-block",marginRight:4}},t.headers.map(w)),o.createElement("i",{className:"prose-separator"},"|")):null,E(t.marks),i?E(t.extraMarks):null,o.createElement("div",{style:{display:a?"initial":"none",position:"absolute",top:"50px",left:"100px",zIndex:2}},o.createElement(c.Z,{width:"600px",colors:M,circleSize:16,onChangeComplete:l})),o.createElement("i",{className:"prose-separator"},"|"),t.fontSizes?o.createElement(u.Z,{style:{display:"inline-block",marginLeft:4}},o.createElement(h.Z,{size:"sm",variant:"outline-secondary",disabled:!n||!(0,C.Z)(n,"fontSize")},n?x(n):"12"),o.createElement(p.Z,{style:{minWidth:"24px"}},t.fontSizes.map(((t,e)=>o.createElement(m.Z,{key:`font-buttons-${e}`,style:{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3},onClick:v(t)},t.content))))):null,E(t.wraps),i&&t.alignment?o.createElement(o.Fragment,null,o.createElement("i",{className:"prose-separator"},"|"),E(t.alignment)):null,t.insert?o.createElement(o.Fragment,null,o.createElement("i",{className:"prose-separator"},"|"),o.createElement(d.Z,{title:o.createElement(o.Fragment,null,b.Z.insert,o.createElement("span",{className:"screenreader"},g("insert"))),variant:"outline-secondary",size:"sm",style:{display:"inline-block"},name:"Insert",disabled:!r},t.insert.map(w))):null,t.tableEdits?o.createElement(o.Fragment,null,o.createElement("i",{className:"prose-separator"},"|"),o.createElement(d.Z,{title:o.createElement(o.Fragment,null,b.Z.table,o.createElement("span",{className:"screenreader"},g("table"))),variant:"outline-secondary",size:"sm",style:{display:"inline-block"},name:"Table",disabled:!r},t.tableEdits.map(w))):null,i&&t.history?o.createElement(o.Fragment,null,o.createElement("i",{className:"prose-separator"},"|"),t.history.map(y)):null,t.addons?o.createElement("i",{className:"prose-separator"},"|"):null,E(t.addons))};P.propTypes={dispatch:r().func,view:r().object,menu:r().object.isRequired,state:r().object,onColorChoice:r().func.isRequired,showColorPicker:r().bool.isRequired,fullscreen:r().bool.isRequired,t:r().func.isRequired},P.defaultProps={dispatch:null,view:null,state:null};var N=(0,l.Zh)("text-editor")(P)},592941:function(t,e,n){var o=n(130764),s=n(922032);e.Z=t=>{const e=document.createElement("div");return e.innerHTML=t,o.aw.fromSchema(s.Z).parse(e)}},706e3:function(t,e,n){var o=n(202784);e.Z=t=>o.createElement("div",{className:"prose-statusbar"},o.createElement("span",null,t.t("words"),": ",t.nWords),o.createElement("span",{style:{marginLeft:5}},t.t("characters"),": ",t.nChars))},979409:function(t,e,n){var o=n(202784),s=n(213980),r=n.n(s),i=n(690299),a=n.n(i),l=n(130764),c=n(952780),d=n(627191),u=n(732357),p=n(814361),h=n(151300),m=n.n(h),f=n(690202),g=n(966123),b=n(922032),v=n(5027),y=n(565784),w=n(193450),E=n(706e3),_=n(208757),S=n(563135),k=n(592941),x=Object.defineProperty,C=(t,e,n)=>(((t,e,n)=>{e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const M=a()("isle:text-editor");class O extends o.Component{constructor(t){let e;super(t),C(this,"_createEditorView",(t=>{this.editorDiv=t,null!==t&&(this.editorView=new c.tk(t,{state:this.state.editorState,dispatchTransaction:this.dispatchTransaction,nodeViews:{footnote:(t,e,n,o)=>new v.Z(t,e,n,o),image:(t,e,n,o)=>new y.Z(t,e,n,o),plot:(t,e,n,o)=>new y.Z(t,e,n,o),plotContainer:(t,e,n,o)=>new y.Z(t,e,n,o)},handleDOMEvents:{dragenter:t=>{M("Handle drag enter event..."),(0,w.yz)(t)},drop:S.Z,keydown:this.props.onKeyDown}})),this.props.onMount(this.editorDiv)})),C(this,"onEditorState",(t=>{let e=0,n=0;this.props.showStatusBar&&t.doc.forEach((t=>{t.forEach((t=>{t.text&&(e+=t.text.length,n+=(0,_.Z)(t.text))}))})),this.props.onEditorState(t),this.setState({editorState:t,nWords:n,nChars:e})})),C(this,"dispatchTransaction",(t=>{let e=this.state.editorState.apply(t);null!==this.editorView&&this.editorView.updateState(e);let n=(0,u.tp)(this.state.editorState);n&&(e=e.apply(n.setMeta("addToHistory",!1))),this.onEditorState(e)})),C(this,"saveInBrowser",(()=>{M("Saving document state to local storage..."),this.state.editorState&&localStorage.setItem(this.props.id,JSON.stringify(this.state.editorState.doc.toJSON()))})),t.id&&(e=localStorage.getItem(t.id)),e||(e=t.defaultValue);const n=m()(e)?l.NB.fromJSON(b.Z,JSON.parse(e)):(0,k.Z)(e);this.state={editorState:d.yy.create({doc:n,schema:b.Z,plugins:f.Z})}}componentDidMount(){this.props.autoSave&&this.props.id&&(this.saveInterval=setInterval(this.saveInBrowser,this.props.intervalTime)),window.addEventListener("unload",this.saveInBrowser)}componentDidUpdate(t){if(this.props.defaultValue!==t.defaultValue||this.props.docId!==t.docId){M("Re-creating editor state...");const t=m()(this.props.defaultValue)?l.NB.fromJSON(b.Z,JSON.parse(this.props.defaultValue)):(0,k.Z)(this.props.defaultValue);this.setState({editorState:d.yy.create({doc:t,schema:b.Z,plugins:f.Z})},(()=>{this.editorView.destroy(),this._createEditorView(this.editorDiv)}))}}componentWillUnmount(){this.editorView&&this.editorView.destroy(),this.saveInterval&&clearInterval(this.saveInterval),window.removeEventListener("unload",this.saveInBrowser)}get markdown(){return p.Dm.serialize(this.state.editorState.doc)}focus(){this.editorView&&this.editorView.focus()}render(){return o.createElement(o.Fragment,null,o.createElement(g.Z,{menu:this.props.menu,state:this.state.editorState,dispatch:this.dispatchTransaction,view:this.editorView,fullscreen:this.props.fullscreen,showColorPicker:this.props.showColorPicker,onColorChoice:this.props.onColorChoice}),o.createElement("div",{className:this.props.className,ref:this._createEditorView}),this.props.showStatusBar?o.createElement(E.Z,{nWords:this.state.nWords,nChars:this.state.nChars,t:this.props.t}):null)}}O.propTypes={autoSave:r().bool,intervalTime:r().number,defaultValue:r().string.isRequired,docId:r().number.isRequired,fullscreen:r().bool.isRequired,showColorPicker:r().bool.isRequired,menu:r().object.isRequired,showStatusBar:r().bool,t:r().func,onColorChoice:r().func,onEditorState:r().func,onKeyDown:r().func,onMount:r().func},O.defaultProps={autoSave:!0,intervalTime:1e4,showStatusBar:!0,t(){},onColorChoice(){},onEditorState(){},onKeyDown(){},onMount(){}},e.Z=O},5027:function(t,e,n){var o=n(952780),s=n(627191),r=n(951801),i=n(59195),a=n(526151),l=n(409961),c=n.n(l),d=n(783158),u=n.n(d),p=Object.defineProperty,h=(t,e,n)=>(((t,e,n)=>{e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);e.Z=class{constructor(t,e,n){h(this,"dispatchInner",(t=>{let{state:e,transactions:n}=this.innerView.state.applyTransaction(t);if(this.innerView.updateState(e),!t.getMeta("fromOutside")){let t=this.outerView.state.tr,e=a.KS.offset(this.getPos()+1);for(let o=0;o<n.length;o++){let s=n[o].steps;for(let n=0;n<s.length;n++)t.step(s[n].map(e))}t.docChanged&&this.outerView.dispatch(t)}})),this.node=t,this.outerView=e,this.getPos=n,this.dom=document.createElement("footnote"),this.innerView=null}selectNode(){this.dom.classList.add("ProseMirror-selectednode"),this.innerView||this.open()}deselectNode(){this.dom.classList.remove("ProseMirror-selectednode"),this.innerView&&this.close()}open(){let t=this.dom.appendChild(document.createElement("div"));t.className="footnote-tooltip",this.innerView=new o.tk(t,{state:s.yy.create({doc:this.node,plugins:[(0,i.h)({"Mod-z":()=>(0,r.Yw)(this.outerView.state,this.outerView.dispatch),"Mod-y":()=>(0,r.KX)(this.outerView.state,this.outerView.dispatch)})]}),dispatchTransaction:this.dispatchInner,handleDOMEvents:{mousedown:()=>{this.outerView.hasFocus()&&this.innerView.focus()}}})}close(){this.innerView.destroy(),this.innerView=null,this.dom.textContent=""}update(t){if(!t.sameMarkup(this.node))return!1;if(this.node=t,this.innerView){let e=this.innerView.state,n=t.content.findDiffStart(e.doc.content);if(!c()(n)){let{a:o,b:s}=t.content.findDiffEnd(e.doc.content),r=n-u()(o,s);r>0&&(o+=r,s+=r),this.innerView.dispatch(e.tr.replace(n,s,t.slice(n,o)).setMeta("fromOutside",!0))}}return!0}destroy(){this.innerView&&this.close()}stopEvent(t){return this.innerView&&this.innerView.dom.contains(t.target)}ignoreMutation(){return!0}}},708984:function(t,e){e.Z=function(t,e="",n=512){const o=atob(t),s=[];for(let r=0;r<o.length;r+=n){const t=o.slice(r,r+n),e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);const i=new Uint8Array(e);s.push(i)}return new Blob(s,{type:e})}},627939:function(t,e){e.Z=t=>{const{FileReader:e}=window,n=new e;return n.readAsDataURL(t),new Promise((t=>{n.onloadend=()=>{t(n.result)}}))}},55257:function(t,e){const n=/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i;function o(t){setImmediate((function(){throw t}),0)}function s(t){return n.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}const r=function(t){if(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))return;const e=t.document;function n(){return t.URL||t.webkitURL||t}function r(t){setTimeout((function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()}),4e4)}let i,a=!1;e&&e.createElementNS&&(i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in i);const l=/constructor/i.test(t.HTMLElement)||t.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent),d=t.setImmediate||t.setTimeout;function u(e,u,p){p||(e=s(e));const h=this,m="application/octet-stream"===e.type;let f;function g(){!function(t,e,n){let s=(e=[].concat(e)).length;for(;s--;){const i=t["on"+e[s]];if("function"==typeof i)try{i.call(t,n||t)}catch(r){o(r)}}}(h,"writestart progress write writeend".split(" "))}if(h.readyState=h.INIT,a)return f=n().createObjectURL(e),void d((function(){i.href=f,i.download=u,function(t){const e=new MouseEvent("click");t.dispatchEvent(e)}(i),g(),r(f),h.readyState=h.DONE}),0);!function(){if((c||m&&l)&&t.FileReader){const n=new FileReader;return n.onloadend=function(){let e=c?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,h.readyState=h.DONE,g()},n.readAsDataURL(e),void(h.readyState=h.INIT)}if(f||(f=n().createObjectURL(e)),m)t.location.href=f;else{t.open(f,"_blank")||(t.location.href=f)}h.readyState=h.DONE,g(),r(f)}()}const p=u.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=s(t)),navigator.msSaveOrOpenBlob(t,e)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=null,p.onwritestart=null,p.onprogress=null,p.onwrite=null,p.onabort=null,p.onerror=null,p.onwriteend=null,function(t,e,n){return new u(t,e||t.name||"download",n)})}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);e.Z=r},19789:function(t,e){e.Z=function(t){return new Promise(((e,n)=>{const{FileReader:o}=window;if(o){const s=new o;s.onload=t=>{const n=t.target.result;e({src:n,height:0,width:0,id:""})},s.onerror=()=>{n(new Error("FileReader failed"))},s.readAsDataURL(t)}else n(new Error("FileReader is not available"))}))}},365601:function(t,e){e.Z=function(t){let e=0;return()=>(e+=1,`${t}-${e}`)}},78708:function(t){t.exports=JSON.parse("[8,9,10,11,12,14,18,24,30,36,48,60,72]")}}]);