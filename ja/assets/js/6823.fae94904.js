(self.webpackChunk=self.webpackChunk||[]).push([[6823],{596823:function(e,t,r){const{Transform:o}=r(354851),n=Buffer.from([239,187,191]);class s extends o{constructor(e={}){super({writableObjectMode:!0,...e});const t={};let r;for(let i in e)t[a(i)]=e[i];if(r=this.normalize(t))throw r;switch(t.record_delimiter){case"auto":t.record_delimiter=null;break;case"unix":t.record_delimiter="\n";break;case"mac":t.record_delimiter="\r";break;case"windows":t.record_delimiter="\r\n";break;case"ascii":t.record_delimiter="\x1e";break;case"unicode":t.record_delimiter="\u2028"}this.options=t,this.state={stop:!1},this.info={records:0}}normalize(e){if(void 0===e.bom||null===e.bom||!1===e.bom)e.bom=!1;else if(!0!==e.bom)return new l("CSV_OPTION_BOOLEAN_INVALID_TYPE",["option `bom` is optional and must be a boolean value,",`got ${JSON.stringify(e.bom)}`]);if(void 0===e.delimiter||null===e.delimiter)e.delimiter=",";else if(Buffer.isBuffer(e.delimiter))e.delimiter=e.delimiter.toString();else if("string"!=typeof e.delimiter)return new l("CSV_OPTION_DELIMITER_INVALID_TYPE",["option `delimiter` must be a buffer or a string,",`got ${JSON.stringify(e.delimiter)}`]);if(void 0===e.quote||null===e.quote)e.quote='"';else if(!0===e.quote)e.quote='"';else if(!1===e.quote)e.quote="";else if(Buffer.isBuffer(e.quote))e.quote=e.quote.toString();else if("string"!=typeof e.quote)return new l("CSV_OPTION_QUOTE_INVALID_TYPE",["option `quote` must be a boolean, a buffer or a string,",`got ${JSON.stringify(e.quote)}`]);if(void 0!==e.quoted&&null!==e.quoted||(e.quoted=!1),void 0!==e.quoted_empty&&null!==e.quoted_empty||(e.quoted_empty=void 0),void 0===e.quoted_match||null===e.quoted_match||!1===e.quoted_match?e.quoted_match=null:Array.isArray(e.quoted_match)||(e.quoted_match=[e.quoted_match]),e.quoted_match)for(let t of e.quoted_match){const e=t instanceof RegExp;if(!("string"==typeof t)&&!e)return Error(`Invalid Option: quoted_match must be a string or a regex, got ${JSON.stringify(t)}`)}if(void 0!==e.quoted_string&&null!==e.quoted_string||(e.quoted_string=!1),void 0!==e.eof&&null!==e.eof||(e.eof=!0),void 0===e.escape||null===e.escape)e.escape='"';else if(Buffer.isBuffer(e.escape))e.escape=e.escape.toString();else if("string"!=typeof e.escape)return Error(`Invalid Option: escape must be a buffer or a string, got ${JSON.stringify(e.escape)}`);if(e.escape.length>1)return Error(`Invalid Option: escape must be one character, got ${e.escape.length} characters`);if(void 0!==e.header&&null!==e.header||(e.header=!1),e.columns=this.normalize_columns(e.columns),void 0!==e.quoted&&null!==e.quoted||(e.quoted=!1),void 0!==e.cast&&null!==e.cast||(e.cast={}),void 0!==e.cast.bigint&&null!==e.cast.bigint||(e.cast.bigint=e=>""+e),void 0!==e.cast.boolean&&null!==e.cast.boolean||(e.cast.boolean=e=>e?"1":""),void 0!==e.cast.date&&null!==e.cast.date||(e.cast.date=e=>""+e.getTime()),void 0!==e.cast.number&&null!==e.cast.number||(e.cast.number=e=>""+e),void 0!==e.cast.object&&null!==e.cast.object||(e.cast.object=e=>JSON.stringify(e)),void 0!==e.cast.string&&null!==e.cast.string||(e.cast.string=function(e){return e}),void 0===e.record_delimiter||null===e.record_delimiter)e.record_delimiter="\n";else if(Buffer.isBuffer(e.record_delimiter))e.record_delimiter=e.record_delimiter.toString();else if("string"!=typeof e.record_delimiter)return Error(`Invalid Option: record_delimiter must be a buffer or a string, got ${JSON.stringify(e.record_delimiter)}`)}_transform(e,t,r){if(!0===this.state.stop)return;if(!Array.isArray(e)&&"object"!=typeof e)return this.state.stop=!0,r(Error(`Invalid Record: expect an array or an object, got ${JSON.stringify(e)}`));if(0===this.info.records)if(Array.isArray(e)){if(!0===this.options.header&&!this.options.columns)return this.state.stop=!0,r(Error("Undiscoverable Columns: header option requires column option or object records"))}else void 0!==this.options.columns&&null!==this.options.columns||(this.options.columns=this.normalize_columns(Object.keys(e)));0===this.info.records&&(this.bom(),this.headers());try{this.emit("record",e,this.info.records)}catch(o){return this.state.stop=!0,this.emit("error",o)}let i;if(this.options.eof){if(i=this.stringify(e),void 0===i)return;i+=this.options.record_delimiter}else{if(i=this.stringify(e),void 0===i)return;(this.options.header||this.info.records)&&(i=this.options.record_delimiter+i)}this.info.records++,this.push(i),r()}_flush(e){0===this.info.records&&(this.bom(),this.headers()),e()}stringify(e,t=!1){if("object"!=typeof e)return e;const{columns:r,header:o}=this.options,n=[];if(Array.isArray(e)){r&&e.splice(r.length);for(let r=0;r<e.length;r++){const i=e[r],[o,s]=this.__cast(i,{index:r,column:r,records:this.info.records,header:t});if(o)return void this.emit("error",o);n[r]=[s,i]}}else if(r)for(let i=0;i<r.length;i++){const o=_(e,r[i].key),[s,u]=this.__cast(o,{index:i,column:r[i].key,records:this.info.records,header:t});if(s)return void this.emit("error",s);n[i]=[u,o]}else for(let u of e){const o=e[u],[s,l]=this.__cast(o,{index:i,column:r[i].key,records:this.info.records,header:t});if(s)return void this.emit("error",s);n.push([l,o])}let s="";for(let i=0;i<n.length;i++){let e,t,[r,o]=n[i];if("string"==typeof r)e=this.options;else if(c(r)){if(e=r,r=e.value,delete e.value,"string"!=typeof r&&null!=r)return void this.emit("error",Error(`Invalid Casting Value: returned value must return a string, null or undefined, got ${JSON.stringify(r)}`));if(e={...this.options,...e},t=this.normalize(e))return void this.emit("error",t)}else{if(null!=r)return void this.emit("error",Error(`Invalid Casting Value: returned value must return a string, an object, null or undefined, got ${JSON.stringify(r)}`));e=this.options}const{delimiter:u,escape:l,quote:a,quoted:d,quoted_empty:f,quoted_string:h,quoted_match:m,record_delimiter:p}=e;if(r){if("string"!=typeof r)return this.emit("error",Error(`Formatter must return a string, null or undefined, got ${JSON.stringify(r)}`)),null;const e=u.length&&r.indexOf(u)>=0,t=""!==a&&r.indexOf(a)>=0,i=r.indexOf(l)>=0&&l!==a,n=r.indexOf(p)>=0,c=h&&"string"==typeof o;let f=m&&m.filter((e=>"string"==typeof e?-1!==r.indexOf(e):e.test(r)));f=f&&f.length>0;const g=!0===t||e||n||d||c||f;if(!0===g&&!0===i){const e="\\"===l?new RegExp(l+l,"g"):new RegExp(l,"g");r=r.replace(e,l+l)}if(!0===t){const e=new RegExp(a,"g");r=r.replace(e,l+a)}!0===g&&(r=a+r+a),s+=r}else(!0===f||""===o&&!0===h&&!1!==f)&&(s+=a+a);i!==n.length-1&&(s+=u)}return s}bom(){!0===this.options.bom&&this.push(n)}headers(){if(!1===this.options.header)return;if(void 0===this.options.columns)return;let e=this.options.columns.map((e=>e.header));e=this.options.eof?this.stringify(e,!0)+this.options.record_delimiter:this.stringify(e),this.push(e)}__cast(e,t){const r=typeof e;try{return"string"===r?[void 0,this.options.cast.string(e,t)]:"bigint"===r?[void 0,this.options.cast.bigint(e,t)]:"number"===r?[void 0,this.options.cast.number(e,t)]:"boolean"===r?[void 0,this.options.cast.boolean(e,t)]:e instanceof Date?[void 0,this.options.cast.date(e,t)]:"object"===r&&null!==e?[void 0,this.options.cast.object(e,t)]:[void 0,e,e]}catch(i){return[i]}}normalize_columns(e){if(null!=e){if("object"!=typeof e)throw Error('Invalid option "columns": expect an array or an object');if(Array.isArray(e)){const t=[];for(let r of e)if("string"==typeof r)t.push({key:r,header:r});else{if("object"!=typeof r||void 0===r||Array.isArray(r))throw Error("Invalid column definition: expect a string or an object");if(!r.key)throw Error('Invalid column definition: property "key" is required');void 0===r.header&&(r.header=r.key),t.push(r)}e=t}else{const t=[];for(let r in e)t.push({key:r,header:e[r]});e=t}return e}}}const u=function(){let e,t,r;for(let o in arguments){const i=arguments[o],n=typeof i;if(void 0===e&&Array.isArray(i))e=i;else if(void 0===t&&c(i))t=i;else{if(void 0!==r||"function"!==n)throw new l("CSV_INVALID_ARGUMENT",["Invalid argument:",`got ${JSON.stringify(i)} at index ${o}`]);r=i}}const i=new s(t);if(r){const e=[];i.on("readable",(function(){let t;for(;null!==(t=this.read());)e.push(t)})),i.on("error",(function(e){r(e)})),i.on("end",(function(){r(void 0,e.join(""))}))}if(void 0!==e)if("function"==typeof setImmediate)setImmediate((function(){for(let t of e)i.write(t);i.end()}));else{for(let t of e)i.write(t);i.end()}return i};class l extends Error{constructor(e,t,...r){Array.isArray(t)&&(t=t.join(" ")),super(t),void 0!==Error.captureStackTrace&&Error.captureStackTrace(this,l),this.code=e;for(const i of r)for(const e in i){const t=i[e];this[e]=Buffer.isBuffer(t)?t.toString():null==t?t:JSON.parse(JSON.stringify(t))}}}u.Stringifier=s,u.CsvError=l,e.exports=u;const c=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)},a=function(e){return e.replace(/([A-Z])/g,(function(e,t){return"_"+t.toLowerCase()}))},d=".".charCodeAt(0),f=/\\(\\)?/g,h=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g"),m=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,p=/^\w*$/,g=function(e){const t=typeof e;return"symbol"===t||"object"===t&&e&&"[object Symbol]"===function(e){return Object.prototype.toString.call(e)}(e)},y=function(e,t){return Array.isArray(e)?e:function(e,t){if(Array.isArray(e))return!1;const r=typeof e;return!("number"!==r&&"symbol"!==r&&"boolean"!==r&&e&&!g(e))||p.test(e)||!m.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:function(e){const t=[];return e.charCodeAt(0)===d&&t.push(""),e.replace(h,(function(e,r,i,o){let n=e;i?n=o.replace(f,"$1"):r&&(n=r.trim()),t.push(n)})),t}(e)},b=function(e){if("string"==typeof e||g(e))return e;const t=`${e}`;return"0"==t&&1/e==-INFINITY?"-0":t},_=function(e,t){let r=0;const i=(t=y(t,e)).length;for(;null!=e&&r<i;)e=e[b(t[r++])];return r&&r===i?e:void 0}}}]);