"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1055],{14042:function(e,t,n){n.r(t),n.d(t,{default:function(){return he}});var s=n(202784),i=n(213980),o=n.n(i),r=n(912895),a=n.n(r),l=n(198),c=n(318967),u=n.n(c),h=n(10863),d=n(423184),p=n(770561),m=n(23836),f=n(790817),b=n(690299),g=n.n(b),w=n(240054),y=n.n(w),k=n(588703),S=n.n(k),v=n(833022),E=n.n(v),C=n(623102),Z=n.n(C),q=n(294565),F=n(605977),N=n.n(F),x=n(525678),$=n(8044),z=n(124624),P=n(448151),Q=n(29769),O=n(57054),M=n(328613),j=n(331647),B=n(770149),L=n(123103),I=n(55328),T=n(417332),R=n(691334),H=n(302108),D=n(741082),V=n(879052);var A=function(e){return E()(e)&&e.component},U=n(715318),G=Object.defineProperty,J=(e,t,n)=>(((e,t,n)=>{t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class W extends s.Component{constructor(){super(...arguments),J(this,"clickHide",(()=>{this.props.onHide()})),J(this,"handleClick",(()=>{this.props.onSubmit(),this.props.onHide()}))}render(){return s.createElement(U.Z,{onHide:this.clickHide,show:this.props.show,dialogClassName:"modal-w30"},s.createElement(U.Z.Header,{closeButton:!0},s.createElement(U.Z.Title,{as:"h4"},this.props.t("finish"),"?")),s.createElement(U.Z.Body,null,this.props.t("finish-prompt")),s.createElement(U.Z.Footer,null,s.createElement(p.Z,{variant:"secondary",onClick:this.clickHide},this.props.t("cancel")),s.createElement(p.Z,{variant:"warning",onClick:this.handleClick},this.props.t("confirm"))))}}W.propTypes={onHide:o().func,onSubmit:o().func,show:o().bool.isRequired},W.defaultProps={onHide(){},onSubmit(){}};var X=W,_=(n(697927),Object.defineProperty),K=Object.defineProperties,Y=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable,se=(e,t,n)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ie=(e,t)=>{for(var n in t||(t={}))te.call(t,n)&&se(e,n,t[n]);if(ee)for(var n of ee(t))ne.call(t,n)&&se(e,n,t[n]);return e},oe=(e,t)=>K(e,Y(t)),re=(e,t,n)=>(se(e,"symbol"!=typeof t?t+"":t,n),n);const ae=g()("isle:quiz"),le=(0,T.Z)("quiz"),ce={header:{fontSize:24,bold:!0,margin:[0,0,0,10]},author:{fontSize:16,italics:!0,margin:[0,0,0,10],alignment:"center"},date:{fontSize:16,italics:!0,alignment:"right",margin:[0,15,0,15]},subheader:{fontSize:18,bold:!0,margin:[0,30,0,10]},question:{fontSize:15,margin:[0,10,0,0],italics:!0},boldTitle:{fontSize:14,margin:[0,5,0,5],bold:!0}};class ue extends s.Component{constructor(e,t){ae("Instantiating quiz component..."),super(e),re(this,"toggleFinishModal",(()=>{this.setState({showFinishModal:!this.state.showFinishModal})})),re(this,"handleFinishClick",(()=>{this.setState({counter:this.state.count},(()=>{this.handleNextClick()}))})),re(this,"handleNextClick",(()=>{const e=this.quizBody.getElementsByClassName("submit-button");for(let o=0;o<e.length;o++)e[o].click();ae("Display next question...");const t=this.state.questions[this.state.current],n=this.context;this.state.answered||n.log({id:t.props.id,type:R.gaB,value:!0}),t.props&&t.props.id&&this.state.selectedConfidence&&n.log({id:t.props.id+"_confidence",type:R.qn5,value:this.state.selectedConfidence}),this.props.onSubmit();const s={};let i=this.state.counter;i+=1,i>=this.state.count?(ae("No further questions should be shown..."),s.finished=!0,n.log({id:this.id,type:R.oZL,value:!0}),this.props.onFinished()):(i===this.state.count-1&&(s.last=!0),s.current=this.sample()[0],ae("Selected question at index "+s.current)),s.answered=!1,s.selectedConfidence=null,s.answerSelected=!1,s.counter=i,this.setState(s)})),re(this,"markSelected",(()=>{ae("Mark answer as selected..."),this.setState({answerSelected:!0})})),re(this,"handleSubmission",(e=>{const t=this.state.questions[this.state.current],n=this.state.answers.slice();let s,i;if(t.props){if(S()(t.props.answers)&&void 0!==t.props.solution){const n=t.props.solution;if(S()(n)){i="";for(let e=0;e<n.length;e++)i+=t.props.answers[n[e]].content,i+="; ";s="";for(let n=0;n<e.length;n++)!0===e[n]&&(s+=t.props.answers[n].content,s+="; ")}else s=t.props.answers[e].content,i=t.props.answers[n].content}else if(S()(t.props.elements)){ae("Create answer and solution string for <MatchListQuestion />"),s="",i="";for(let n=0;n<t.props.elements.length;n++){const o=t.props.elements[n];for(let t=0;t<e.length;t++){const n=e[t];if(n.a===o.a){s+=`${n.a}:${n.b}; `;break}}i+=`${o.a}:${o.b}; `}}else if(S()(t.props.options)){s="",i="";for(let n=0;n<t.props.options.length;n++){const o=t.props.options[n],r=e[n];i+=`${o.text}; `,s+=`${r.text}; `}}else s=e,i=t.props.solution,S()(i)&&(s=s.join(", "),i=i.join(", "));n[this.state.current]={question:t.props?t.props.question:null,answer:s,solution:i,counter:this.state.counter}}this.setState({answered:!0,answers:n})})),re(this,"handleConfidenceChange",(e=>{const t=e.target.value;ae("Choosing confidence: "+t);const n=this.state.confidences.slice();n[this.state.current]=t,this.setState({selectedConfidence:t,confidences:n})})),re(this,"toggleInstructorView",(()=>{this.setState({showInstructorView:!this.state.showInstructorView})})),this.id=e.id||le(e);let n=e.questions;e.questions||(n=[]);let s=null;if(n.length>0){const e=N()(0,n.length,1);this.sample=y().factory(e,{size:1,mutate:!0,replace:!1}),s=this.sample()[0]}const i=t.currentUserActions,o=!0===(0,V.Z)(i,this.id,R.oZL);this.state={answers:new Array(n.length),answered:!1,confidences:new Array(n.length),current:s,count:e.count||n.length,counter:0,finished:!e.repeatable&&o,answerSelected:!1,last:!1,selectedConfidence:null,showInstructorView:!1,showFinishModal:!1,questions:[],questionIDs:[],id:this.id}}static getDerivedStateFromProps(e,t){if(e.questions&&e.questions.length!==t.questions.length){const n=e.questions.length,s=new Array(n);for(let i=0;i<n;i++){const n=e.questions[i];n.props&&n.props.id?s[i]=n.props.id:s[i]=`${t.id}-${i}`}return{questions:e.questions,questionIDs:s}}return null}componentDidMount(){const e=this.context;e&&(this.unsubscribe=e.subscribe(((e,t)=>{if(e===H.u){let e=t[this.id];if(!this.props.repeatable&&S()(e)){const t=e.some((e=>e.type===R.oZL));this.setState({finished:t})}}})))}componentDidUpdate(e){if(ae("Component did update..."),this.props.count!==e.count||this.props.questions&&this.props.questions.length!==e.questions.length){ae("Resetting component...");const e=N()(0,this.props.questions.length,1);this.sample=y().factory(e,{size:1,mutate:!0}),this.setState({count:this.props.count||this.prop.questions.length})}}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}downloadResponsesFactory(e){return()=>{const t={content:[{text:this.props.t("answer-for",{id:this.id}),style:"header",alignment:"center"}],styles:ce},n=this.context;Z()(n.user)||t.content.push({text:`${this.props.t("by")} ${n.user.name} (${n.user.email})`,style:"author"});const s=new Date;t.content.push({text:`${s.toLocaleDateString()} - ${s.toLocaleTimeString()}`,style:"date"});for(let i=0;i<e.length;i++){let{question:n,answer:s,solution:o,confidence:r}=e[i];n=(0,q.isPrimitive)(n)?n:u()(n),s=(0,q.isPrimitive)(s)?s:u()(s),o=(0,q.isPrimitive)(o)?o:u()(o),t.content.push({text:n,style:"question"}),t.content.push({text:`${this.props.t("answer")}:`,style:"boldTitle"}),t.content.push({text:s,style:{color:s===o?"#3c763d":"#d9534f",margin:[0,0,0,10]}}),r&&(t.content.push({text:`${this.props.t("your-confidence")}:`,style:"boldTitle"}),t.content.push({text:r})),t.content.push({text:`${this.props.t("correct-answer")}:`,style:"boldTitle"}),t.content.push({text:(0,q.isPrimitive)(o)?o:u()(o)})}a().createPdf(t).download("responses.pdf")}}renderScoreboard(){if(ae("Rendering scoreboard..."),!this.props.provideFeedback)return s.createElement("h3",null,this.props.t("quiz-finished"));let e=this.state.answers.slice();for(let t=0;t<e.length;t++)e[t]&&(e[t].confidence=this.state.confidences[t]);return e.sort(((e,t)=>e.counter>t.counter)),e=e.filter((e=>E()(e))),0===e.length?s.createElement("h3",null,this.props.t("quiz-finished")):s.createElement("div",null,s.createElement("p",null,this.props.duration?this.props.t("time-up"):this.props.t("quiz-finished"),this.props.t("summary-label"),":"),s.createElement("table",{className:"table table-bordered"},s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",null,this.props.t("question")),s.createElement("th",null,this.props.t("your-answer")),s.createElement("th",null,this.props.t("correct-answer")),this.props.confidence?s.createElement("th",null,this.props.t("your-confidence")):null)),s.createElement("tbody",null,e.map(((e,t)=>{let n;n=e.answer===e.solution?"quiz-right-answer":"quiz-wrong-answer";let i=e.question;A(i)&&(i=(0,I.Z)(i));let o=e.answer;A(o)&&(o=(0,I.Z)(o));let r=e.solution;return A(r)&&(r=(0,I.Z)(r)),s.createElement("tr",{className:n,key:t},s.createElement("td",null,i),s.createElement("td",null,o),s.createElement("td",null,r),this.props.confidence?s.createElement("td",null,e.confidence):null)})))),this.props.downloadButton?s.createElement(p.Z,{onClick:this.downloadResponsesFactory(e)},this.props.t("download-pdf")):null)}renderQuestion(e,t){if(!e)return null;const n=e.props||{};switch(A(n.question)&&(ae("Question property is an object, convert to JSX..."),n.question=(0,I.Z)(n.question)),e.component){case"Fragment":case"div":return(0,I.Z)(e);case"FreeTextQuestion":return s.createElement($.Z,oe(ie({disableSubmitNotification:!0,feedback:!1,provideFeedback:!1},n),{onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}));case"MultipleChoiceQuestion":return s.createElement(z.Z,oe(ie({disableSubmitNotification:!0,feedback:!1,provideFeedback:"none"},n),{onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}));case"MatchListQuestion":return s.createElement(P.Z,oe(ie({disableSubmitNotification:!0,feedback:!1,showSolution:!1},n),{onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}));case"NumberQuestion":return s.createElement(Q.Z,oe(ie({disableSubmitNotification:!0,feedback:!1,provideFeedback:!1},n),{onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}));case"OrderQuestion":return s.createElement(O.Z,oe(ie({disableSubmitNotification:!0,feedback:!1,provideFeedback:!1},n),{onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}));case"RangeQuestion":return s.createElement(M.Z,oe(ie({disableSubmitNotification:!0,feedback:!1,provideFeedback:!1},n),{onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}));case"SelectQuestion":return s.createElement(j.Z,oe(ie({disableSubmitNotification:!0,feedback:!1,provideFeedback:!1},n),{onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}));default:{const i=e.type===z.Z&&"none";return s.createElement(e.type,oe(ie(ie({},e.props),n),{disableSubmitNotification:!0,feedback:!1,provideFeedback:i,onChange:this.markSelected,onSubmit:this.handleSubmission,id:t}))}}}renderConfidenceSurvey(){return this.props.confidence?s.createElement(f.Z,{className:"center",style:{width:"75%"}},s.createElement(h.Z,{className:"center"},s.createElement(m.Z.Label,null,this.props.t("confidence-prompt")),s.createElement("br",null),s.createElement(m.Z.Check,{type:"radio",label:this.props.t("guessed"),checked:"Guessed"===this.state.selectedConfidence,value:"Guessed",inline:!0,onClick:this.handleConfidenceChange})," ",s.createElement(m.Z.Check,{type:"radio",label:this.props.t("somewhat-sure"),checked:"Somewhat sure"===this.state.selectedConfidence,value:"Somewhat sure",inline:!0,onClick:this.handleConfidenceChange})," ",s.createElement(m.Z.Check,{type:"radio",label:this.props.t("confident"),checked:"Confident"===this.state.selectedConfidence,value:"Confident",inline:!0,onClick:this.handleConfidenceChange}))):null}renderFooterNodes(e,t){let n;return e.props&&(n=e.props.id),n||(n=`${this.id}-${t}`),s.Children.map(this.props.footerNodes,((e,t)=>s.cloneElement(e,{id:`${e.props.id}-footer-${n}`,key:`${this.state.current}-${t}`})))}render(){ae("Rendering component...");const e=this.context,t=this.state.questions[this.state.current],n=this.state.questionIDs[this.state.current];let i;return i=!this.state.finished&&(this.state.answered||this.state.answerSelected||this.props.skippable||e.currentUserActions[n]),this.state.showInstructorView?s.createElement(f.Z,{className:"quiz"},s.createElement(f.Z.Header,null,s.createElement("span",null,s.createElement("h3",{style:{display:"inline-block"}},this.props.t("instructor-view")),s.createElement(p.Z,{variant:"secondary",style:{float:"right"},onClick:this.toggleInstructorView},this.props.t("close-instructor-view")))),s.createElement(f.Z.Body,null,this.state.questions.map(((e,t)=>{const n=this.state.questionIDs[t];return s.createElement("div",{key:t},s.createElement("h3",null,this.props.t("question")," ",t+1,":"),this.renderQuestion(e,n),this.renderFooterNodes(e,t))}))),s.createElement(p.Z,{className:"quiz-button",variant:"secondary",onClick:this.toggleInstructorView},this.props.t("close-instructor-view"))):s.createElement(s.Fragment,null,this.props.duration?s.createElement(x.Z,{invisible:!0,id:this.id,active:this.props.active,duration:this.props.duration,onTimeUp:()=>{ae("Time is up...");this.context.log({id:this.id,type:R.oZL,value:!0}),this.setState({finished:!0},(()=>{this.props.onFinished()}))}}):null,s.createElement(f.Z,{className:"quiz"},s.createElement(f.Z.Header,null,this.state.finished?s.createElement("h3",null,this.props.t("answer-summary")):s.createElement("h3",null,this.props.t("question")," ",this.state.counter+1,"/",this.state.count)),s.createElement(f.Z.Body,null,s.createElement("div",{ref:e=>{this.quizBody=e}},this.state.finished?this.renderScoreboard():s.createElement("span",{key:this.state.current},this.renderQuestion(t,n)),this.state.finished?null:this.renderConfidenceSurvey(),t?this.renderFooterNodes(t):null,s.createElement(d.Z,{style:{float:"right"}},s.createElement(B.Z,{owner:!0,showOwnerInPresentationMode:!1,banner:null},s.createElement(p.Z,{className:"quiz-button",variant:"secondary",onClick:this.toggleInstructorView,style:{marginRight:10}},this.props.t("open-instructor-view"))),!this.props.showFinishButton&&!this.state.last||this.state.finished?null:s.createElement(p.Z,{style:{marginRight:10},className:"quiz-button",variant:"secondary",onClick:this.state.last?this.handleFinishClick:this.toggleFinishModal},this.props.finishLabel||this.props.t("finish-label")),i&&!this.state.last?s.createElement(p.Z,{className:"quiz-button",variant:"primary",onClick:this.handleNextClick,disabled:this.props.forceConfidence&&!this.state.selectedConfidence&&this.state.answerSelected},this.props.nextLabel||this.props.t("next-question")):null)))),s.createElement(X,{show:this.state.showFinishModal,onSubmit:this.handleFinishClick,onHide:this.toggleFinishModal,t:this.props.t}))}}ue.propTypes={confidence:o().bool,forceConfidence:o().bool,count:o().number,questions:o().array.isRequired,active:o().bool,duration:o().number,skippable:o().bool,footerNodes:o().array,nextLabel:o().string,provideFeedback:o().bool,showFinishButton:o().bool,finishLabel:o().string,downloadButton:o().bool,repeatable:o().bool,onFinished:o().func,onSubmit:o().func},ue.defaultProps={confidence:!1,forceConfidence:!1,count:null,active:!0,duration:null,skippable:!0,footerNodes:[],nextLabel:null,provideFeedback:!0,showFinishButton:!1,finishLabel:null,downloadButton:!0,repeatable:!1,onFinished(){},onSubmit(){}},ue.contextType=L.Z;var he=(0,l.Z)("questions/quiz")((0,D.W)(ue))},879052:function(e,t,n){var s=n(588703),i=n.n(s),o=n(830324),r=n.n(o);t.Z=(e,t,n)=>{if(r()(e)){let s=e[t];if(i()(s)&&(s=s.filter((e=>e.type===n)),s.length>0))return s[0].value}return null}},55328:function(e,t,n){var s=n(202784),i=n(690299),o=n.n(i),r=n(588703),a=n.n(r),l=n(833022),c=n.n(l),u=n(224008),h=n.n(u),d=n(194542),p=n(8044),m=n(124624),f=n(908536),b=n(448151),g=n(29769),w=n(57054),y=n(328613),k=n(331647);const S=o()("isle:convert-json");t.Z=function e(t){S(`Convert JSON ${t.component} object to React element...`);let n=h()(t.children);if(a()(n))for(let s=0;s<n.length;s++){const t=n[s];c()(t)&&(n[s]=e(t))}else c()(n)&&(n=e(n));let i=t.component;switch(i){case"Fragment":i=s.Fragment;break;case"TeX":i=d.Z;break;case"FreeTextQuestion":i=p.Z;break;case"MultipleChoiceMatrix":i=f.Z;break;case"MultipleChoiceQuestion":i=m.Z;break;case"MatchListQuestion":i=b.Z;break;case"NumberQuestion":i=g.Z;break;case"OrderQuestion":i=w.Z;break;case"RangeQuestion":i=y.Z;break;case"SelectQuestion":i=k.Z;break;default:i=t.component}const o=t.props||{};return(0,s.createElement)(i,o,n)}},770561:function(e,t,n){var s=n(72779),i=n.n(s),o=n(202784),r=n(247830),a=n(429658),l=n(552322);const c=o.forwardRef((({as:e,bsPrefix:t,variant:n,size:s,active:o,className:c,...u},h)=>{const d=(0,a.vE)(t,"btn"),[p,{tagName:m}]=(0,r.FT)({tagName:e,...u}),f=m;return(0,l.jsx)(f,{...p,...u,ref:h,className:i()(c,d,o&&"active",n&&`${d}-${n}`,s&&`${d}-${s}`,u.href&&u.disabled&&"disabled")})}));c.displayName="Button",c.defaultProps={variant:"primary",active:!1,disabled:!1},t.Z=c},423184:function(e,t,n){var s=n(72779),i=n.n(s),o=n(202784),r=n(429658),a=n(552322);const l=o.forwardRef((({bsPrefix:e,size:t,vertical:n,className:s,as:o="div",...l},c)=>{const u=(0,r.vE)(e,"btn-group");let h=u;return n&&(h=`${u}-vertical`),(0,a.jsx)(o,{...l,ref:c,className:i()(s,h,t&&`${u}-${t}`)})}));l.displayName="ButtonGroup",l.defaultProps={vertical:!1,role:"group"},t.Z=l},318967:function(e){var t=function(e,t){return e+n(t)},n=function(e){return null===e||"boolean"==typeof e||void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?e:Array.isArray(e)?e.reduce(t,""):function(e){return Object.prototype.hasOwnProperty.call(e,"props")}(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?n(e.props.children):""};n.default=n,e.exports=n}}]);