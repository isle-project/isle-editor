"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[20082],{370420:function(e,t,n){const a=(0,n(217431).Z)((()=>n.e(96131).then(n.bind(n,66720))));t.Z=a},29596:function(e,t,n){n.r(t);var a=n(202784),l=n(213980),s=n.n(l),r=n(690299),u=n.n(r),o=n(498614),i=n(770561),c=n(26266),m=n(10863),d=n(830650),h=n(973777),b=n(287013),p=n.n(b),E=n(409961),q=n.n(E),f=n(112114),g=n(370420),Z=n(377174),v=n(426214),w=n(123103),C=n(691334),H=n(302108),y=n(487890);const z=u()("isle:queue"),Q=e=>{if(0===e.questions.length)return a.createElement("p",null,e.t("no-questions"));const t=e.session;return a.createElement(h.Z,{className:"queue-table",showPageSizeOptions:!1,data:e.questions,resizable:!1,sortable:!1,columns:[{Header:"Pic",id:"pic",accessor:e=>{const{userList:n}=t;for(let t=0;t<n.length;t++)if(n[t].name===e.name)return n[t].picture;return""},Cell:e=>a.createElement("img",{className:"queue-table-pic",alt:"User thumbnail",src:`${t.server}/thumbnail/${e.value}`}),maxWidth:46,minWidth:46,style:{color:"darkslategrey"}},{Header:e.t("name"),id:"nameCol",accessor:"name",width:150,Cell:e=>a.createElement(f.Z,{tooltip:`${e.value} (${e.original.email})`},a.createElement("span",{className:"queue-table-name"},e.value))},{Header:e.t("cohort"),id:"cohortCol",accessor:e=>{const{cohorts:n}=t;for(let t=0;t<n.length;t++)if(p()(n[t].members,e.email))return n[t].title;return""}},{Header:e.t("question"),id:"qCol",accessor:"value",width:350,style:{"white-space":"unset"}},{Header:e.t("chat"),Cell:t=>{const n="Queue_"+t.original.name;return a.createElement(g.Z,{tooltip:e.t("queue-start-chat"),for:n})}},{Header:"",accessor:"remove",Cell:n=>a.createElement(f.Z,{placement:"left",tooltip:e.t("mark-and-remove")},a.createElement(i.Z,{variant:"secondary",size:"sm",onClick:()=>{t.removeQuestionFromQueue(n.original)}},a.createElement("i",{className:"fas fa-check"}))),filterable:!1,width:45}],pageSize:8})},N=e=>{const{id:t,logAction:n}=(0,y.G)("QUEUE",e),{draggable:l,show:s,onHide:r,onNewQuestion:u}=e,h=(0,a.useContext)(w.Z),b=h.questions,{t:p}=(0,o.$G)("internal/toolbar/queue"),[E,f]=(0,a.useState)(""),[N,k]=(0,a.useState)(null),x=()=>{z("Send the signal to enter the queue..."),n(C.K5,E,{},"members");const e={name:h.user.name,email:h.user.email,value:E};h.addQuestionToQueue(e)},L=()=>{const e={name:h.user.name,email:h.user.email,value:E};h.removeQuestionFromQueue(e)},W=e=>{e.target.className&&e.target.className.includes("queue-panel")&&r()};let F;if((0,a.useEffect)((()=>{let e;return h&&(z("We have a session, subscribe the component..."),e=h.subscribe(((e,n)=>{if(e===H.Kd){const e=n;let t=null;for(let n=0;n<e.length;n++)if(e[n].email===h.user.email){t=n;break}k(t)}n&&n.id===t&&n.type===C.K5&&h.isOwner()&&u()}))),()=>{e&&e()}}),[t,u,h]),s){if(h.isOwner())return z("User is an owner..."),F=a.createElement(v.Z,{className:"queue-panel",tabIndex:0,role:"button",header:p("queue"),onHide:r,minimizable:!0,trapFocus:!0},a.createElement(Q,{questions:h.questions,t:p,session:h,for:t})),l&&(F=a.createElement(Z.Z,{bounds:"#Lesson",cancel:".queue-table",onEscape:W,resizable:!0,minWidth:300,minHeight:150},F)),F;const e=()=>{f(""),r()};if(!q()(N)){const t="Queue_"+h.user.name;return F=a.createElement(v.Z,{className:"queue-panel",tabIndex:0,role:"button",header:p("queue"),onHide:e,minimizable:!0,trapFocus:!0},a.createElement("p",null,a.createElement(o.cC,{i18nKey:"queue-status",ns:"Queue"},"Your question: ",a.createElement("i",null,{question:E}),a.createElement("br",null),"You are currently at position ",a.createElement("strong",null,{spot:N})," on the queue.",a.createElement("br",null),"There are ",a.createElement("strong",null,{size:h.questions.length})," individual(s) in the queue.")),a.createElement(g.Z,{for:t,showTooltip:!1}),a.createElement(i.Z,{style:{marginLeft:10},size:"sm",onClick:L},p("remove-myself-from-queue"))),l&&(F=a.createElement(Z.Z,{bounds:"#Lesson",onEscape:W,resizable:!0,minWidth:300,minHeight:150},F)),F}return F=a.createElement(v.Z,{className:"queue-panel",tabIndex:0,role:"button",header:p("queue"),onHide:e,minimizable:!0,trapFocus:!0},a.createElement("p",null,p("queue-prompt")),a.createElement(m.Z,null,a.createElement(d.Z,null,p("question")),a.createElement(c.Z,{type:"text",id:"queue_form",value:E,onChange:e=>{f(e.target.value)},onKeyPress:e=>{13===e.charCode&&E.length>0&&x()},width:500})),a.createElement(i.Z,{disabled:0===E.length,onClick:x},p("submit-question")),a.createElement("span",{style:{marginLeft:8}},p("queue-size",{n:b.length}))),l&&(F=a.createElement(Z.Z,{bounds:"#Lesson",cancel:"#queue_form",onEscape:W,resizable:!0,minWidth:300,minHeight:150},F)),F}return null};N.defaultProps={draggable:!0,show:!0,onHide(){},onNewQuestion(){}},N.propTypes={draggable:s().bool,show:s().bool,onHide:s().func,onNewQuestion:s().func},t.default=N}}]);