"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3634],{667045:function(_,e,t){const s=(0,t(217431).Z)((()=>t.e(10112).then(t.bind(t,497925))));e.Z=s},370420:function(_,e,t){const s=(0,t(217431).Z)((()=>t.e(96131).then(t.bind(t,66720))));e.Z=s},738190:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(202784),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(928316),prop_types__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(213980),prop_types__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_22__),react_i18next__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(198),react_json_tree__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(584118),_stdlib_assert_has_own_property__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(700601),_stdlib_assert_has_own_property__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_stdlib_assert_has_own_property__WEBPACK_IMPORTED_MODULE_2__),_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(588703),_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_3__),_stdlib_assert_is_regexp__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(144393),_stdlib_assert_is_regexp__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_stdlib_assert_is_regexp__WEBPACK_IMPORTED_MODULE_4__),_stdlib_assert_is_object_like__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(93961),_stdlib_assert_is_object_like__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_stdlib_assert_is_object_like__WEBPACK_IMPORTED_MODULE_5__),_stdlib_math_base_special_max__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(557106),_stdlib_math_base_special_max__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_stdlib_math_base_special_max__WEBPACK_IMPORTED_MODULE_6__),_stdlib_string_replace__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(302467),_stdlib_string_replace__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_stdlib_string_replace__WEBPACK_IMPORTED_MODULE_7__),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(770561),react_bootstrap_ButtonToolbar__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(482228),react_bootstrap_Tooltip__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(31071),_isle_project_components_internal_chat_button__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(370420),_isle_project_components_hint_button__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(667045),codemirror__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(223326),codemirror__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(codemirror__WEBPACK_IMPORTED_MODULE_10__),_isle_project_utils_scroll_to__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(107466),_isle_project_utils_uid__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(417332),_isle_project_components_overlay_trigger__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(998325),_isle_project_session_context_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(123103),_console_styles_json__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(136590),_isle_project_constants_actions_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(691334),codemirror_mode_javascript_javascript_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(249055),codemirror_mode_javascript_javascript_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(codemirror_mode_javascript_javascript_js__WEBPACK_IMPORTED_MODULE_15__),__defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(_,e,t)=>e in _?__defProp(_,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):_[e]=t,__spreadValues=(_,e)=>{for(var t in e||(e={}))__hasOwnProp.call(e,t)&&__defNormalProp(_,t,e[t]);if(__getOwnPropSymbols)for(var t of __getOwnPropSymbols(e))__propIsEnum.call(e,t)&&__defNormalProp(_,t,e[t]);return _},__publicField=(_,e,t)=>(__defNormalProp(_,"symbol"!=typeof e?e+"":e,t),t);const RE_CONSOLE=/console\.(error|warn|debug|log|info)/g,uid=(0,_isle_project_utils_uid__WEBPACK_IMPORTED_MODULE_11__.Z)("js-shell"),THEME={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"},showSolutionButton=(_,e,t,s,r)=>{const o=react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Tooltip__WEBPACK_IMPORTED_MODULE_16__.Z,{id:"tooltip"},r("solution-button:solution-tooltip"));return!_||s<1?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_isle_project_components_overlay_trigger__WEBPACK_IMPORTED_MODULE_12__.Z,{placement:"top",positionLeft:100,overlay:o,rootClose:!0},react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{style:{display:"inline-block",marginLeft:"4px"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_17__.Z,{variant:"warning",size:"sm",disabled:!0,style:{pointerEvents:"none"}},r(t?"solution-button:hide-solution":"solution-button:show-solution")))):react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_17__.Z,{variant:"warning",size:"sm",onClick:e},r(t?"solution-button:hide-solution":"solution-button:show-solution"))};function makeLog(_,e){const t=_.type||"default",s=_console_styles_json__WEBPACK_IMPORTED_MODULE_14__[t];return react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",{key:e,style:s},_.msg)}class JSShell extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props,context){if(super(props),__publicField(this,"resetConsole",(()=>{this.setState({log:[]})})),__publicField(this,"handleSolutionClick",(()=>{const _=this.editor.getValue(),e=this.props.solution.replace(/\\n/g,"\n");if(!1===this.state.solutionOpen?(this.editor.setOption("theme","paraiso-light"),this.editor.setOption("readOnly",!0)):(this.editor.setOption("theme","elegant"),this.editor.setOption("readOnly",!1)),_!==e){this.context.log({id:this.id,type:_isle_project_constants_actions_js__WEBPACK_IMPORTED_MODULE_18__.pog,value:_}),this.setState({lastSolution:_,solutionOpen:!this.state.solutionOpen}),this.editor.setValue(e,1)}else this.setState({solutionOpen:!this.state.solutionOpen}),this.editor.setValue(this.state.lastSolution||e,1)})),__publicField(this,"handleEvaluationClick",(()=>{let currentCode=this.editor.getValue();currentCode=_stdlib_string_replace__WEBPACK_IMPORTED_MODULE_7___default()(currentCode,RE_CONSOLE,"print.$1");const session=this.context;session.log({id:this.id,type:_isle_project_constants_actions_js__WEBPACK_IMPORTED_MODULE_18__.IAZ,value:currentCode});try{this.props.check?(currentCode+=";"+this.props.check,eval(currentCode)):eval(currentCode)}catch(err){const _={type:"error",msg:err.message},e=this.state.log;e.push(_),this.setState({log:e})}this.props.onEvaluate(currentCode)})),__publicField(this,"innerConsole",(()=>{__webpack_require__.g.print={error:this.printFactory("error"),warn:this.printFactory("warn"),info:this.printFactory("info"),log:this.printFactory("log"),debug:this.printFactory("debug")}})),__publicField(this,"printFactory",(_=>{const e=this;return function(){const t=[];for(let _=0;_<arguments.length;_++){const e=arguments[_];_stdlib_assert_is_regexp__WEBPACK_IMPORTED_MODULE_4___default()(e)?t.push(react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{key:_,className:"js-shell-console-output"},e.toString())):_stdlib_assert_is_object_like__WEBPACK_IMPORTED_MODULE_5___default()(e)?t.push(react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_json_tree__WEBPACK_IMPORTED_MODULE_19__.L,{key:_,data:e,theme:{extend:THEME,tree:{padding:"0.2em",backgroundColor:"#f3f2f3"}}})):t.push(react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{key:_,className:"js-shell-console-output"},String(e)))}const s={type:_,msg:t},r=e.state.log;r.push(s),e.setState({log:r})}})),__publicField(this,"logHint",(_=>{this.context.log({id:this.id,type:_isle_project_constants_actions_js__WEBPACK_IMPORTED_MODULE_18__._4F,value:_})})),this.state={log:[],exhaustedHints:0===props.hints.length,solutionOpen:!1},this.id=props.id||uid(props),this.props.vars)for(let _ in this.props.vars)_stdlib_assert_has_own_property__WEBPACK_IMPORTED_MODULE_2___default()(this.props.vars,_)&&(__webpack_require__.g[_]=this.props.vars[_])}componentDidMount(){this.editor=codemirror__WEBPACK_IMPORTED_MODULE_10___default()(this.editorDiv,{mode:"javascript",theme:"elegant",lineNumbers:!0,lineWrapping:!0}),this.editor.setValue(this.props.code,-1),this.editor.on("change",this.props.onChange),this.props.disabled&&(this.editor.setOption("readOnly",!0),this.editor.renderer.$cursorLayer.element.style.opacity=0,this.editor.textInput.getElement().disabled=!0),this.innerConsole(),this.props.precompute&&this.handleEvaluationClick()}componentDidUpdate(_){if(this.props.code!==_.code)this.editor.setValue(this.props.code,1),this.props.precompute&&this.handleEvaluationClick();else if(this.props.disabled!==_.disabled)this.props.disabled?this.editor.setOption("readOnly",!0):this.editor.setOption("readOnly",!1);else{const _=react_dom__WEBPACK_IMPORTED_MODULE_1__.findDOMNode(this);let e=_.closest?_.closest(".spectacle-content"):null;if(e){let t=window.getComputedStyle(e).getPropertyValue("transform"),s=/matrix\(([0-9.]*)/.exec(t);if(_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_3___default()(s)&&s.length>1){let e=s[1];_.style.transform=`scale(${1/e})`}}}this.scrollToBottom()}componentWillUnmount(){__webpack_require__.g.print=null}showHints(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_isle_project_components_hint_button__WEBPACK_IMPORTED_MODULE_9__.Z,{hints:this.props.hints,disabled:this.props.disabled,onClick:this.logHint,onFinished:()=>{this.setState({exhaustedHints:!0})}})}scrollToBottom(){(0,_isle_project_utils_scroll_to__WEBPACK_IMPORTED_MODULE_20__.Z)(this.consoleOutput,this.consoleOutput.scrollHeight,1e3)}renderLogs(){const _=this.state.log,e=[];for(let t=0;t<_.length;t++){const s=_[t];e.push(makeLog(s,t))}return e}renderResetButton(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{"aria-label":this.props.t("reset"),className:"js-shell-reset",onClick:this.resetConsole},react__WEBPACK_IMPORTED_MODULE_0__.createElement("i",{className:"fas fa-times"}))}render(){const _=this.props.hints.length,e=react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_ButtonToolbar__WEBPACK_IMPORTED_MODULE_21__.Z,{style:{float:"right",marginTop:"8px"}},_>0?this.showHints():null,this.props.solution&&!this.props.disabled?showSolutionButton(this.state.exhaustedHints,this.handleSolutionClick,this.state.solutionOpen,this.state.nEvaluations,this.props.t):null,this.props.chat?react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{style:{display:"inline-block",marginLeft:"4px"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_isle_project_components_internal_chat_button__WEBPACK_IMPORTED_MODULE_8__.Z,{for:this.id})):null),t=__spreadValues({lineHeight:"1.2em",maxHeight:1.2*_stdlib_math_base_special_max__WEBPACK_IMPORTED_MODULE_6___default()(5,this.props.lines)+"em",height:1.2*this.props.lines+"em"},this.props.style),s=react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"js-shell-edit",style:t,ref:_=>{this.editorDiv=_}});return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{id:this.id},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"js-shell"},s,react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:`js-shell-toolbar ${this.props.className}`},this.props.disabled?react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",null):react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_17__.Z,{variant:"primary",size:"sm",style:{marginTop:"8px",marginBottom:"8px"},onClick:this.handleEvaluationClick},this.props.t("evaluate")),e,react__WEBPACK_IMPORTED_MODULE_0__.createElement("br",null)),this.props.disabled?null:this.renderResetButton(),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{ref:_=>{this.consoleOutput=_},className:"js-shell-console"},this.renderLogs())))}}JSShell.defaultProps={code:"",solution:"",hints:[],precompute:!1,chat:!1,check:null,disabled:!1,lines:5,className:"",style:{},vars:null,onChange(){},onEvaluate(){}},JSShell.propTypes={code:prop_types__WEBPACK_IMPORTED_MODULE_22___default().string,solution:prop_types__WEBPACK_IMPORTED_MODULE_22___default().string,hints:prop_types__WEBPACK_IMPORTED_MODULE_22___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_22___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_22___default().string,prop_types__WEBPACK_IMPORTED_MODULE_22___default().node])),precompute:prop_types__WEBPACK_IMPORTED_MODULE_22___default().bool,chat:prop_types__WEBPACK_IMPORTED_MODULE_22___default().bool,check:prop_types__WEBPACK_IMPORTED_MODULE_22___default().string,disabled:prop_types__WEBPACK_IMPORTED_MODULE_22___default().bool,lines:prop_types__WEBPACK_IMPORTED_MODULE_22___default().number,className:prop_types__WEBPACK_IMPORTED_MODULE_22___default().string,style:prop_types__WEBPACK_IMPORTED_MODULE_22___default().object,onChange:prop_types__WEBPACK_IMPORTED_MODULE_22___default().func,onEvaluate:prop_types__WEBPACK_IMPORTED_MODULE_22___default().func,vars:prop_types__WEBPACK_IMPORTED_MODULE_22___default().object},JSShell.contextType=_isle_project_session_context_js__WEBPACK_IMPORTED_MODULE_13__.Z,__webpack_exports__.default=(0,react_i18next__WEBPACK_IMPORTED_MODULE_23__.Z)(["r","solution-button"])(JSShell)},107466:function(_,e){e.Z=function _(e,t,s){if(s<=0)return;const r=(t-e.scrollTop)/s*10;setTimeout((function(){e.scrollTop=e.scrollTop+r,e.scrollTop!==t&&_(e,t,s-10)}),10)}},136590:function(_){_.exports=JSON.parse('{"log":{"marginLeft":"8px","marginBottom":"0px","fontFamily":"monospace","color":"darkgreen","whiteSpace":"pre-wrap"},"error":{"marginLeft":"8px","marginBottom":"0px","fontFamily":"monospace","color":"red","fontWeight":800,"whiteSpace":"pre-wrap"},"info":{"marginLeft":"8px","marginBottom":"0px","fontFamily":"monospace","color":"darkcyan","whiteSpace":"pre-wrap"},"warn":{"marginLeft":"8px","marginBottom":"0px","fontFamily":"monospace","color":"darkorange","whiteSpace":"pre-wrap"},"default":{"marginLeft":"8px","marginBottom":"0px","fontFamily":"monospace","color":"darkslategrey"}}')}}]);