"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[61],{297219:function(e,t,r){r.r(t);var n=r(497326),i=r(894578),a=r(55196),o=r(202784),s=r(213980),c=r.n(s),l=r(198),u=r(822736),p=r(770561),h=r(588703),m=r.n(h),d=r(708579),f=r(184607),v=r(338664),g=r(412042),y=Object.defineProperty,T=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,E=function(e,t,r){return t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},x=function(e,t){for(var r in t||(t={}))b.call(t,r)&&E(e,r,t[r]);if(T)for(var n,i=(0,a.Z)(T(t));!(n=i()).done;){r=n.value;C.call(t,r)&&E(e,r,t[r])}return e},M=0,w=function(e){var t,r=e.x,n=e.y,i=e.data,a=e.type,o=e.quantitative,s=e.impurityMeasure,c=e.scoreThreshold,l=e.maxTreeDepth,u=e.minItemsCount;t=m()(r)?r:[r];try{return"Classification"===a?new f.DV({response:n,predictors:t,data:i,quantitative:o,criterion:s,scoreThreshold:c,maxTreeDepth:l,minItemsCount:u}):new f.tC({response:n,predictors:t,data:i,quantitative:o,scoreThreshold:c,maxTreeDepth:l,minItemsCount:u})}catch(p){return null}},Z=function(e){function t(t){var r,i,a;r=e.call(this,t)||this,i=(0,n.Z)(r),E(i,"symbol"!=typeof(a="handlePredict")?a+"":a,(function(){r.props.onPredict(r.state.tree,M)})),M+=1;var o=r.props,s=o.x,c=o.y,l=o.data,u=o.type,p=o.quantitative,h=o.impurityMeasure,m=o.scoreThreshold,d=o.maxTreeDepth,f=o.minItemsCount;return r.state=x({tree:w({x:s,y:c,data:l,type:u,quantitative:p,impurityMeasure:h,scoreThreshold:m,maxTreeDepth:d,minItemsCount:f})},t),r}return(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){if(e.y!==t.y||e.x!==t.x||e.type!==t.type||e.impurityMeasure!==t.impurityMeasure||e.data!==t.data||e.quantitative!==t.quantitative||e.scoreThreshold!==t.scoreThreshold||e.maxTreeDepth!==t.maxTreeDepth||e.minItemsCount!==t.minItemsCount){var r=e.x,n=e.y,i=e.data,a=e.type,o=e.quantitative,s=e.impurityMeasure,c=e.scoreThreshold,l=e.maxTreeDepth,u=e.minItemsCount;return x({tree:w({x:r,y:n,data:i,type:a,quantitative:o,impurityMeasure:s,scoreThreshold:c,maxTreeDepth:l,minItemsCount:u})},e)}return null},t.prototype.render=function(){var e=this.state.tree,t=this.props.t;return e?o.createElement("div",{style:{overflowX:"auto",width:"100%"}},o.createElement("span",{className:"title"},t("decision-tree-for",{y:this.props.y,counter:M})),o.createElement(f.fA,{tree:e.root}),this.props.onPredict?o.createElement(d.Z,{tooltip:t("predictions-attached")},o.createElement(p.Z,{variant:"secondary",size:"sm",style:{marginTop:10},onClick:this.handlePredict},this.props.t("use-model-to-predict"))):null):o.createElement(u.Z,{variant:"danger"},t("missing-attributes"))},t}(o.Component);Z.defaultProps={impurityMeasure:"gini",scoreThreshold:.0075,maxTreeDepth:5,minItemsCount:50,onPredict:null},Z.propTypes={data:c().object.isRequired,y:c().oneOfType([c().string,c().instanceOf(g.E)]).isRequired,x:c().oneOfType([c().arrayOf(c().oneOfType([c().string,c().instanceOf(g.E)])),c().string,c().instanceOf(g.E)]).isRequired,type:c().oneOf(["Classification","Regression"]).isRequired,quantitative:c().arrayOf(c().string).isRequired,impurityMeasure:c().oneOf(["gini","entropy"]),scoreThreshold:c().number,maxTreeDepth:c().number,minItemsCount:c().number,onPredict:c().func},t.default=(0,l.Z)("models")((0,v.W)(Z))},184607:function(e,t,r){r.d(t,{DV:function(){return U},OI:function(){return ee},tC:function(){return Y},fA:function(){return te}});var n=r(12860),i=r(240054),a=r.n(i),o=r(287013),s=r.n(o),c=r(700601),l=r.n(c),u=r(798030),p=r.n(u),h=r(686605),m=r.n(h),d=r(605977),f=r.n(d),v=r(894578),g=r(202784),y=r(198),T=r(46255),b=r(309765),C=r(844096),E=r.n(C),x=r(481066),M=r(597909),w=r(497326),Z=r(213980),D=r.n(Z),q=r(770561),I=r(81982),N=r(708579),O=Object.defineProperty,k=function(e,t,r){return function(e,t,r){t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!=typeof t?t+"":t,r),r},P=function(e){function t(){var t;return t=e.call(this)||this,k((0,w.Z)(t),"toggleFullscreen",(function(){t.setState({fullscreen:!t.state.fullscreen})})),t.state={fullscreen:!1},t}return(0,v.Z)(t,e),t.prototype.render=function(){var e=this.props.t;return g.createElement(g.Fragment,null,g.createElement(N.Z,{id:"fullscreen_tooltip",placement:"bottom",tooltip:e("toggle-fullscreen")},g.createElement(q.Z,{variant:"outline-danger",size:"sm",onClick:this.toggleFullscreen,style:{position:"absolute",top:"10px",right:"32px"}},g.createElement("div",{className:"fa fa-window-maximize"}))),g.createElement(I.Z,{show:this.state.fullscreen,onHide:this.toggleFullscreen,dialogClassName:"modal-100w"},g.createElement(I.Z.Header,{closeButton:!0},g.createElement(I.Z.Title,{as:"h1"},e("decision-tree"))),g.createElement(I.Z.Body,{style:{height:.75*window.innerHeight,width:"100%",fontSize:32,overflow:"scroll"}},g.createElement("div",{className:"decision-tree decision-tree-fullscreen"},this.props.tree)),g.createElement(I.Z.Footer,null,g.createElement(q.Z,{onClick:this.toggleFullscreen},e("close")))))},t}(g.Component);P.propTypes={tree:D().node.isRequired};var R=(0,y.Z)("models")(P),S=/^[+-]?[\d.]+e?[+-]?\d*$/;function F(e,t){if(!e)return null;if(e.category){var r=e.category;return((0,b.isPrimitive)(r)||S.test(r))&&(r=Number(r),E()(r)||(r=r.toFixed(6))),g.createElement("ul",null,g.createElement("li",null,g.createElement("span",{className:"decision-tree-leaf"},t("predict"),": ",r," ")))}return g.createElement("ul",null,g.createElement("li",null,g.createElement("span",null,g.createElement("b",null," ",e.attribute," ",e.predicateName," ",e.pivot," ?")),g.createElement("ul",null,g.createElement("li",null,g.createElement("span",null,t("no")," ( ",e.notMatchedCount," ",t("obs"),") "),F(e.notMatch,t)),g.createElement("li",null,g.createElement("span",null,t("yes")," ( ",e.matchedCount," ",t("obs"),") "),F(e.match,t)))))}var z=function(e){function t(t){var r;return(r=e.call(this,t)||this).state={plotValue:null,plotKey:null,fullscreen:!1},r}(0,v.Z)(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this;this.tree&&(this.treeWrapper.scrollLeft=.4*this.tree.clientWidth,(0,T.hi)(this.tree,{backgroundColor:"white",style:{fontSize:22}}).then((function(t){var r='<img src="'+t+'" style="display: block; margin: 0 auto; max-width: 100%; max-height: 100%" />';e.setState({plotKey:"\x3c!--IMAGE_LOG:"+(0,x.Z)(6)+"_"+(0,x.Z)(6)+"--\x3e",plotValue:r})})))},r.render=function(){var e=this,t=this.props.t,r=F(this.props.tree,t);return g.createElement("div",{className:"decision-tree-wrapper",ref:function(t){e.treeWrapper=t}},g.createElement("button",{className:"decision-tree-draggable-bar",draggable:"true",onDragStart:function(t){t.dataTransfer.setData("text/html",e.state.plotValue),t.dataTransfer.setData("text/plain",e.state.plotKey)},onClick:function(){(0,M.Z)(e.state.plotValue)},style:{float:"left"}},t("drag-plot")),g.createElement(R,{variant:"outline-danger",size:"sm",onClick:function(){e.setState({fullscreen:!e.state.fullscreen})},tree:r},g.createElement("div",{className:"fa fa-times"})),g.createElement("div",{className:"decision-tree",ref:function(t){e.tree=t}},r))},t}(g.Component),A=(0,y.Z)("models")(z);var B=function(e,t,r,n,i){for(var a=[],o=[],s=e[r],c=t.length-1;c>=0;c--){var l=t[c];n(s[l],i)?a.push(l):o.push(l)}return{match:a,notMatch:o}};function j(e,t){for(var r={},n=t.length-1;n>=0;n--){r[e[t[n]]]=0}for(var i=t.length-1;i>=0;i--){r[e[t[i]]]+=1}return r}function V(e,t){var r,n=j(e,t),i=0;for(var a in n)n[a]>i&&(i=n[a],r=a);return r}function H(e,t){var r=j(e,t),n=0;for(var i in r)if(l()(r,i)){var a=r[i]/t.length;n+=a*(1-a)}return n}function W(e,t){var r=j(e,t),n=0;for(var i in r)if(l()(r,i)){var a=r[i]/t.length;n+=-a*p()(a)}return n}function K(e,t){var r=t.length,n=0,i=0,a=0,o=0;if(!r)return null;if(r<2)return 0;for(var s=0;s<r;s++){var c=e[t[s]];a+=(n=c-i)*(c-(i+=n/(o+=1)))}return a/(o-1)}function L(e,t){var r=t.length;if(!r)return null;for(var n=0,i=0;i<r;i++){n+=(e[t[i]]-n)/(i+1)}return n}var _={"==":function(e,t){return e==t},">=":function(e,t){return e>=t}};function G(e){var t=this,r=e.data[e.response].length;this.importances={};for(var n=0;n<e.predictors.length;n++)this.importances[e.predictors[n]]=0;this.root=X({data:e.data,response:e.response,predictors:e.predictors,indices:e.indices?e.indices:f()(0,r,1),minItemsCount:e.minItemsCount||50,minBucket:e.minBucket||m()((e.minItemsCount||50)/3),scoreThreshold:e.scoreThreshold||.01,maxTreeDepth:e.maxTreeDepth||20,quantitative:e.quantitative,criterion:"gini"===e.criterion?H:W},this.importances),this.predict=function(r,n){if(void 0===n){for(var i=r[e.predictors[0]].length,a=new Array(i),o=0;o<i;o++)a[o]=J(t.root,r,o);return a}return J(t.root,r,n)},this.type="classification",this.response=e.response}function X(e,t){var r=e.data,i=e.predictors,o=e.indices,c=e.response,l=e.minItemsCount,u=e.scoreThreshold,p=e.maxTreeDepth,h=e.quantitative,m=e.criterion,d=e.minBucket,f=e.nTry,v=o.length;if(0===p||v<=l)return{category:V(r[c],o)};var g=m(r[c],o),y={},T={gain:0};f&&(a()(i,{size:f}),(0,n.Z)("predictors"));for(var b=v-1;b>=0;b--)for(var C=o[b],E=0;E<i.length;E++){var x=i[E],M=r[x][C],w=void 0,Z=x+(w=s()(h,x)?">=":"==")+M;if(!y[Z]){y[Z]=!0;var D=_[w],q=B(r,o,x,D,M),I=m(r[c],q.match),N=m(r[c],q.notMatch),O=0;O+=I*q.match.length,O+=N*q.notMatch.length;var k=g-(O/=v);k>T.gain&&q.match.length>d&&q.notMatch.length>d&&((T=q).predicateName=w,T.predicate=D,T.attribute=x,T.pivot=M,T.gain=k)}}if(!T.gain||T.gain/g<u)return{category:V(r[c],o)};e.maxTreeDepth=p-1,t[T.attribute]+=T.gain,e.indices=T.match;var P=X(e,t);e.indices=T.notMatch;var R=X(e,t);return{attribute:T.attribute,predicate:T.predicate,predicateName:T.predicateName,pivot:T.pivot,match:P,notMatch:R,matchedCount:T.match.length,notMatchedCount:T.notMatch.length}}function $(e){var t=e.data,r=e.predictors,i=e.indices,o=e.response,c=e.minItemsCount,l=e.scoreThreshold,u=e.maxTreeDepth,p=e.quantitative,h=e.minBucket,m=e.nTry,d=i.length;if(0===u||d<=c)return{category:L(t[o],i)};var f=K(t[o],i),v={},g={gain:0};m&&(a()(r,{size:m}),(0,n.Z)("predictors"));for(var y=d-1;y>=0;y--)for(var T=i[y],b=0;b<r.length;b++){var C=r[b],E=t[C][T],x=void 0,M=C+(x=s()(p,C)?">=":"==")+E;if(!v[M]){v[M]=!0;var w=_[x],Z=B(t,i,C,w,E),D=K(t[o],Z.match),q=K(t[o],Z.notMatch),I=0;I+=D*Z.match.length,I+=q*Z.notMatch.length;var N=f-(I/=d);N>g.gain&&Z.match.length>h&&Z.notMatch.length>h&&((g=Z).predicateName=x,g.predicate=w,g.attribute=C,g.pivot=E,g.gain=N)}}if(!g.gain||g.gain/f<l)return{category:L(t[o],i)};e.maxTreeDepth=u-1,e.indices=g.match;var O=$(e);e.indices=g.notMatch;var k=$(e);return{attribute:g.attribute,predicate:g.predicate,predicateName:g.predicateName,pivot:g.pivot,match:O,notMatch:k,matchedCount:g.match.length,notMatchedCount:g.notMatch.length}}function J(e,t,r){for(;;){if(e.category)return e.category;var n=t[e.attribute][r];e=(0,e.predicate)(n,e.pivot)?e.match:e.notMatch}}function Q(e,t,r){for(var n={},i=0;i<e.length;i++){var a=e[i].predict(t,r);n[a]=n[a]?n[a]+1:1}var o,s=-1;for(var c in n)l()(n,c)&&n[c]>s&&(s=n[c],o=c);return o}var U=G,Y=function(e){var t=this,r=e.data[e.response].length;this.root=$({data:e.data,response:e.response,predictors:e.predictors,indices:e.indices?e.indices:f()(0,r,1),minItemsCount:e.minItemsCount||50,minBucket:e.minBucket||m()((e.minItemsCount||50)/3),scoreThreshold:e.scoreThreshold||.01,maxTreeDepth:e.maxTreeDepth||20,quantitative:e.quantitative}),this.predict=function(r,n){if(void 0===n){for(var i=r[e.predictors[0]].length,a=new Array(i),o=0;o<i;o++)a[o]=Number(J(t.root,r,o));return a}return Number(J(t.root,r,n))},this.type="regression",this.response=e.response},ee=function(e){var t=this;this.trees=function(e){for(var t=[],r=e.data[e.response].length,n=f()(0,r,1),i=0;i<e.nTrees;i++)t[i]=a()(n);for(var o=[],s=0;s<e.nTrees;s++){e.indices=t[s];var c=new G(e);o.push(c)}return o}(e),this.importances={};for(var r=0;r<e.predictors.length;r++){var n=e.predictors[r];this.importances[n]=0;for(var i=0;i<this.trees.length;i++)this.importances[n]+=this.trees[i].importances[n];this.importances[n]/=this.trees.length}this.predict=function(r,n){if(void 0===n){for(var i=r[e.predictors[0]].length,a=new Array(i),o=0;o<i;o++)a[o]=Q(t.trees,r,o);return a}return Q(t.trees,r,n)},this.type="classification",this.response=e.response},te=A},597909:function(e,t){t.Z=function(e){var t=document.createElement("div");t.innerHTML=e,t.style.position="fixed",t.style.opacity=0,t.style.pointerEvents="none",document.body.appendChild(t),window.getSelection().removeAllRanges();var r=document.createRange();r.selectNode(t),window.getSelection().addRange(r),document.execCommand("copy"),document.body.removeChild(t)}},783679:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(202784);function i(e){var t=(0,n.useRef)(null);return(0,n.useEffect)((function(){t.current=e})),t.current}},658092:function(e,t,r){r.d(t,{Z:function(){return i}});var n=Function.prototype.bind.call(Function.prototype.call,[].slice);function i(e,t){return n(e.querySelectorAll(t))}}}]);