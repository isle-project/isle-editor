"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4093],{978834:function(t,e,n){n.r(e),n.d(e,{default:function(){return V}});var r=n(894578),i=n(55196),o=n(202784),a=n(213980),s=n.n(a),l=n(198);function u(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r]);return n}const c={distanceFunction:u};function h(t,e,n=c){const r=n.distanceFunction||c.distanceFunction,i=n.similarityFunction||c.similarityFunction;let o=-1;if("function"==typeof i){let n=Number.MIN_VALUE;for(let r=0;r<t.length;r++){const a=i(e,t[r]);a>n&&(n=a,o=r)}}else{if("function"!=typeof r)throw new Error("A similarity or distance function it's required");{let n=Number.MAX_VALUE;for(let i=0;i<t.length;i++){const a=r(e,t[i]);a<n&&(n=a,o=i)}}}return o}function f(t,e,n,r){for(var i=0;i<t.length;i++)n[i]=h(e,t[i],{distanceFunction:r});return n}function d(t,e){const n=65535&(t>>>=0);return((t-n)*(e>>>=0)>>>0)+n*e>>>0}class m{constructor(t=Date.now()){this.state=new Uint32Array(4),this.init(t),this.random=this.getFloat.bind(this)}getUint32(){return this.nextState(),this.state[3]+this.state[2]>>>0}getFloat(){return 5.960464477539063e-8*(this.getUint32()>>>8)}init(t){if(!Number.isInteger(t))throw new TypeError("seed must be an integer");this.state[0]=t,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(let e=1;e<8;e++)this.state[3&e]^=e+d(1812433253,this.state[e-1&3]^this.state[e-1&3]>>>30>>>0)>>>0;this.periodCertification();for(let e=0;e<8;e++)this.nextState()}periodCertification(){0===this.state[0]&&0===this.state[1]&&0===this.state[2]&&0===this.state[3]&&(this.state[0]=88,this.state[1]=83,this.state[2]=65,this.state[3]=68)}nextState(){let t=this.state[0];t^=t<<15,t^=t>>>18,t^=this.state[3]<<11,this.state[0]=this.state[1],this.state[1]=this.state[2],this.state[2]=this.state[3],this.state[3]=t}}function g(t,e,n){const r=e();if(n){let t=0;for(;r>n[t];)t++;return t}return Math.floor(r*t)}var p=function(t,e={},n=Math.random){const{size:r=1,replace:i=!1,probabilities:o}=e;let a,s;if(a="number"==typeof t?function(t){const e=[];for(let n=0;n<t;n++)e.push(n);return e}(t):t.slice(),o){if(!i)throw new Error("choice with probabilities and no replacement is not implemented");if(o.length!==a.length)throw new Error("the length of probabilities option should be equal to the number of choices");s=[o[0]];for(let t=1;t<o.length;t++)s[t]=s[t-1]+o[t];if(Math.abs(1-s[s.length-1])>1e-8)throw new Error(`probabilities should sum to 1, but instead sums to ${s[s.length-1]}`)}if(!1===i&&r>a.length)throw new Error("size option is too large");const l=[];for(let u=0;u<r;u++){const t=g(a.length,n,s);l.push(a[t]),i||a.splice(t,1)}return l};class v{constructor(t=Math.random){if("number"==typeof t){const e=new m(t);this.randomGenerator=e.random}else this.randomGenerator=t}choice(t,e){return p(t,e,this.randomGenerator)}random(){return this.randomGenerator()}randInt(t,e){return void 0===e&&(e=t,t=0),t+Math.floor(this.randomGenerator()*(e-t))}randomSample(t){const e=[];for(let n=0;n<t;n++)e.push(this.random());return e}}var w=n(920756);function b(t,e){const n=new w.Z(t.rows,e.rows);for(let r=0;r<t.rows;r++)for(let i=0;i<e.rows;i++)n.set(r,i,u(t.getRow(r),e.getRow(i)));return n}function y(t){let e=[];for(let n=0;n<t;n++)e.push(n);return e}function E(t){let e=[t[0]];for(let n=1;n<t.length;n++)e[n]=e[n-1]+t[n];return e}const z=Symbol("distance");class A{constructor(t,e,n,r,i){this.clusters=t,this.centroids=e,this.converged=n,this.iterations=r,this[z]=i}nearest(t){const e=new Array(t.length);return f(t,this.centroids.map((function(t){return t.centroid})),e,this[z])}computeInformation(t){for(var e=this.centroids.map((function(t){return{centroid:t,error:0,size:0}})),n=0;n<t.length;n++)e[this.clusters[n]].error+=this[z](t[n],this.centroids[this.clusters[n]]),e[this.clusters[n]].size++;for(var r=0;r<this.centroids.length;r++)e[r].size?e[r].error/=e[r].size:e[r].error=null;return new A(this.clusters,e,this.converged,this.iterations,this[z])}}const k={maxIterations:100,tolerance:1e-6,withIterations:!1,initialization:"kmeans++",distanceFunction:u};function x(t,e,n,r,i,o){var a=function(t,e,n,r){const i=e[0].length;for(var o=new Array(r),a=new Array(r),s=0;s<r;s++){o[s]=new Array(i),a[s]=0;for(var l=0;l<i;l++)o[s][l]=0}for(var u=0;u<e.length;u++){a[n[u]]++;for(var c=0;c<i;c++)o[n[u]][c]+=e[u][c]}for(var h=0;h<r;h++)for(var f=0;f<i;f++)a[h]?o[h][f]/=a[h]:o[h][f]=t[h][f];return o}(t,e,n=f(e,t,n,i.distanceFunction),r),s=function(t,e,n,r){for(var i=0;i<t.length;i++)if(n(t[i],e[i])>r)return!1;return!0}(a,t,i.distanceFunction,i.tolerance);return new A(n,a,s,o,i.distanceFunction)}function I(t,e,n){if(n=Object.assign({},k,n),e<=0||e>t.length||!Number.isInteger(e))throw new Error("K should be a positive integer smaller than the number of points");var r;if(Array.isArray(n.initialization)){if(n.initialization.length!==e)throw new Error("The initial centers should have the same length as K");r=n.initialization}else switch(n.initialization){case"kmeans++":r=function(t,e,n={}){const r=(t=new w.Z(t)).rows,i=new v(n.seed),o=[],a=n.localTrials||2+Math.floor(Math.log(e)),s=i.randInt(r);o.push(t.getRow(s));let l=new w.Z(1,t.rows);for(let d=0;d<t.rows;d++)l.set(0,d,u(t.getRow(d),o[0]));let c=[E(l.getRow(0))];const h=1/c[0][r-1];let f=w.Z.mul(l,h);for(let u=1;u<e;u++){const e=i.choice(r,{replace:!0,size:a,probabilities:f[0]}),n=b(t.selection(e,y(t.columns)),t);let s,h,d;for(let t=0;t<a;t++){const r=w.Z.min(l,[n.getRow(t)]),i=r.sum();(void 0===s||i<h)&&(s=e[t],h=i,d=r)}o[u]=t.getRow(s),l=d,c=[E(l.getRow(0))],f=w.Z.mul(l,1/c[0][r-1])}return o}(t,e,n);break;case"random":r=function(t,e,n){return new v(n).choice(t,{size:e})}(t,e,n.seed);break;case"mostDistant":r=function(t,e,n,r){const i=new v(r);var o=new Array(e);if(o[0]=Math.floor(i.random()*t.length),e>1){for(var a={dist:-1,index:-1},s=0;s<t.length;++s)n[o[0]][s]>a.dist&&(a.dist=n[o[0]][s],a.index=s);if(o[1]=a.index,e>2)for(var l=2;l<e;++l){for(var u={dist:-1,index:-1},c=0;c<t.length;++c){for(var h={dist:Number.MAX_VALUE,index:-1},f=0;f<l;++f)n[f][c]<h.dist&&-1===o.indexOf(c)&&(h={dist:n[f][c],index:c});h.dist!==Number.MAX_VALUE&&h.dist>u.dist&&(u=Object.assign({},h))}o[l]=u.index}}return o.map((e=>t[e]))}(t,e,function(t,e){for(var n=new Array(t.length),r=0;r<t.length;++r)for(var i=r;i<t.length;++i){n[r]||(n[r]=new Array(t.length)),n[i]||(n[i]=new Array(t.length));const o=e(t[r],t[i]);n[r][i]=o,n[i][r]=o}return n}(t,n.distanceFunction),n.seed);break;default:throw new Error(`Unknown initialization method: "${n.initialization}"`)}0===n.maxIterations&&(n.maxIterations=Number.MAX_VALUE);var i=new Array(t.length);if(n.withIterations)return function*(t,e,n,r,i){for(var o,a=!1,s=0;!a&&s<i.maxIterations;)o=x(t,e,n,r,i,++s),yield o.computeInformation(e),a=o.converged,t=o.centroids}(r,t,i,e,n);for(var o,a=!1,s=0;!a&&s<n.maxIterations;)a=(o=x(r,t,i,e,n,++s)).converged,r=o.centroids;return o.computeInformation(t)}var F=n(822736),R=n(700601),M=n.n(R),Z=n(43649),K=n(338664),O=n(479724),N=Object.defineProperty,U=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,C=function(t,e,n){return e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},G=function(t,e){for(var n in e||(e={}))j.call(e,n)&&C(t,n,e[n]);if(U)for(var r,o=(0,i.Z)(U(e));!(r=o()).done;){n=r.value;S.call(e,n)&&C(t,n,e[n])}return t},L=function(t){var e=t.K,n=t.variables,r=t.data,i=t.initialization;if(!(r&&n&&e&&i))return null;var o=[];if(!M()(r,n[0]))return null;for(var a=r[n[0]].length,s=[],l=0;l<a;l++){for(var u=[],c=!1,h=0;h<n.length;h++){if(!M()(r,n[h]))return null;var f=r[n[h]][l];if(!(0,O.Z)(f)){c=!0;break}u.push(f)}c?s.push(l):o.push(u)}try{for(var d=I(o,e,{initialization:i}),m=0;m<s.length;m++)d.clusters.splice(s[m],0,null);return d.clusters=d.clusters.map((function(t){return null===t?null:"Cluster "+(t+1)})),d}catch(g){return null}},P=function(t){function e(e){var n;n=t.call(this,e)||this;var r=e.K,i=e.variables,o=e.data,a=e.initialization,s=L({K:r,variables:i,data:o,initialization:a});return n.state=G({result:s},e),s&&e.onResult(s),n}return(0,r.Z)(e,t),e.getDerivedStateFromProps=function(t,e){if(t.data!==e.data||t.variables!==e.variables||t.K!==e.K||t.initialization!==e.initialization){var n=t.K,r=t.variables,i=t.data,o=t.initialization,a=L({K:n,variables:r,data:i,initialization:o});return t.onResult(a),G({result:a},t)}return null},e.prototype.render=function(){var t=this.state.result,e=this.props,n=e.t,r=e.variables;return t?o.createElement("div",{style:{overflowX:"auto",width:"100%"}},o.createElement("span",{className:"title"},n("kmeans-summary")),o.createElement("p",null,t.converged?n("algorithm-converged",{n:t.iterations}):n("algorithm-not-converged",{n:t.iterations})),function(t,e,n){return o.createElement(Z.Z,{bordered:!0,size:"sm"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,n("cluster")),e.map((function(t,e){return o.createElement("th",{key:e},e+1)})))),o.createElement("tbody",null,t.map((function(t,n){return o.createElement("tr",{key:n},o.createElement("th",null,t),e.map((function(t,e){return o.createElement("td",{key:e},t.centroid[n].toFixed(4))})))}))),o.createElement("tbody",null,o.createElement("tr",null,o.createElement("th",null,n("size")),e.map((function(t,e){return o.createElement("th",{key:e},t.size)})))))}(r,t.centroids,n)):o.createElement(F.Z,{variant:"danger"},n("missing-attributes"))},e}(o.Component);P.defaultProps={K:3,initialization:"kmeans++",onResult:function(){}},P.propTypes={data:s().object.isRequired,variables:s().arrayOf(s().string).isRequired,K:s().number,initialization:s().oneOf(["kmeans++","random","mostDistant"]),onResult:s().func};var V=(0,l.Z)("models")((0,K.W)(P))}}]);