"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2017],{667045:function(e,t,n){const l=(0,n(217431).Z)((()=>n.e(112).then(n.bind(n,497925))));t.Z=l},956260:function(e,t,n){var l=n(202784),a=n(213980),r=n.n(a),i=Object.defineProperty,s=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const f=e=>{const t=e,{children:n}=t,a=((e,t)=>{var n={};for(var l in e)o.call(e,l)&&t.indexOf(l)<0&&(n[l]=e[l]);if(null!=e&&s)for(var l of s(e))t.indexOf(l)<0&&c.call(e,l)&&(n[l]=e[l]);return n})(t,["children"]);return l.createElement("div",((e,t)=>{for(var n in t||(t={}))o.call(t,n)&&u(e,n,t[n]);if(s)for(var n of s(t))c.call(t,n)&&u(e,n,t[n]);return e})({},a),n)};f.defaultProps={className:"",style:{}},f.propTypes={className:r().string,style:r().object},t.Z=f},370420:function(e,t,n){const l=(0,n(217431).Z)((()=>n.e(6131).then(n.bind(n,66720))));t.Z=l},800712:function(e,t,n){const l=(0,n(217431).Z)((()=>Promise.all([n.e(3312),n.e(4507)]).then(n.bind(n,307125))));t.Z=l},849914:function(e,t,n){n.r(t);var l=n(202784),a=n(213980),r=n.n(a),i=n(690299),s=n.n(i),o=n(376699),c=n(790817),u=n(417332),f=n(123103),p=n(810370),m=n(514921),d=n(667045),b=n(370420),h=n(956260),g=n(172888),y=n(800712),v=n(477195),E=n(879052),Z=n(741082),k=n(691334),N=n(302108);const q=(0,u.Z)("file-question"),O=s()("isle:file-upload"),C=e=>{const{t:t}=(0,o.$)("questions/file"),{accept:n,until:a,onChange:r}=e,i=(0,l.useRef)(e.id||q(e)),s=(0,l.useContext)(f.Z),u=(0,l.useRef)(null),[Z,C]=(0,l.useState)(null),[P,w]=(0,l.useState)(null),[D,x]=(0,l.useState)(!1),[j,S]=(0,l.useState)(!1),T=(0,l.useCallback)((()=>{O(`Set submission to last action for question ${i.current} if available...`);const e=s.currentUserActions,t=(0,E.Z)(e,i.current,k.R_);t&&t!==P&&(w(t),S(!0))}),[s,P]),{hints:R}=e,_=R.length,F=(0,l.useCallback)((e=>{O("Logging hint..."),s.log({id:i.current,type:k.cN,value:e})}),[s]);(0,l.useEffect)((()=>{const e=s.subscribe((e=>{e===N.u&&T()}));return()=>{e()}}),[s,T]);const A=(0,l.useCallback)((()=>{const e=new FormData;e.append("file",Z),x(!0),s.uploadFile({formData:e,callback:(e,t)=>{if(e)return O(e),x(!1),C(null),void(u.current.value="");const n=t.filename,l=s.server+"/"+n;s.log({id:i.current,type:k.R_,value:l}),w(l),x(!1),S(!0)},showNotification:!0})}),[Z,s]),L=()=>{const e=u.current.files[0];r(e),C(e)},$=e=>{e.stopPropagation(),e.preventDefault();const t=e.dataTransfer;let n=null;if(t.items&&t.items.length>0){const e=t.items[0];"file"===e.kind&&(n=e.getAsFile())}else t.files&&t.files.length>0&&(n=t.files[0]);n&&(r(n),C(n))};let z;return D||(z=l.createElement(l.Fragment,null,P?l.createElement("div",{className:"center",style:{maxWidth:600}},l.createElement("p",null,t("submitted-file-link"),": ",l.createElement("a",{href:P,target:"_blank",rel:"noopener noreferrer"},P))):null,l.createElement("div",{className:"file-question-dropzone",onDrop:$,onDragOver:v.Z,onDragEnd:v.Z},l.createElement("span",null,t("drop-file"))),l.createElement("p",{className:"center"},t("or")),l.createElement("input",{id:i+"-upload",className:"file-question-input center",type:"file",accept:n,onChange:L,ref:u}))),l.createElement(c.Z,{id:i.current,className:`file-question ${e.className}`,style:e.style},l.createElement(c.Z.Body,{className:"d-grid gap-2",style:{width:e.feedback?"calc(100%-60px)":"100%",display:"inline-block"}},l.createElement("label",null,e.question),l.createElement(p.Z,{running:D,width:256,height:128}),z,e.feedback?l.createElement(g.Z,{vertical:!0,id:i.current+"_feedback",style:{position:"absolute",right:"4px",top:"4px"}}):null,l.createElement(h.Z,{buttonLabel:"Answers",id:i.current,info:k.R_,data:{question:e.question,type:"file"},points:e.points}),l.createElement("div",{className:"file-question-toolbar"},_>0?l.createElement(d.Z,{onClick:F,hints:e.hints,placement:e.hintPlacement}):null,a&&s.startTime>a?l.createElement("span",{className:"title",style:{marginLeft:4}},t("question-closed")):l.createElement(m.Z,{className:"submit-button",variant:"primary",size:"sm",onClick:A,disabled:!Z||D},t(j?"resubmit":"submit")),e.chat?l.createElement(b.Z,{for:i.current}):null),l.createElement(y.Z,{for:i.current,points:e.points})))};C.defaultProps={question:"",hints:[],hintPlacement:"bottom",feedback:!0,chat:!1,accept:"*/*",until:null,points:10,className:"",style:{},onChange(){}},C.propTypes={question:r().oneOfType([r().string,r().node]),hintPlacement:r().string,hints:r().arrayOf(r().oneOfType([r().string,r().node])),feedback:r().bool,chat:r().bool,accept:r().string,until:r().instanceOf(Date),points:r().number,className:r().string,style:r().object,onChange:r().func},t.default=(0,Z.W)(C)},879052:function(e,t,n){var l=n(588703),a=n.n(l),r=n(830324),i=n.n(r);t.Z=(e,t,n)=>{if(i()(e)){let l=e[t];if(a()(l)&&(l=l.filter((e=>e.type===n)),l.length>0))return l[0].value}return null}},477195:function(e,t){t.Z=function(e){e.stopPropagation(),e.preventDefault()}}}]);