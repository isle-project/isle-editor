"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1534],{263648:function(e,r,t){t.r(r),t.d(r,{default:function(){return P}});var o=t(497326),i=t(894578),n=t(202784),c=t(690299),s=t.n(c),a=t(213980),d=t.n(a),l=t(198),u=t(423184),h=t(770561),p=t(380408),g=t(156562),m=t(477704),f=t.n(m),v=t(923723),b=t(267682),S=t(338664),w=JSON.parse('[{"command":"startRecording","trigger":"start","description":"Start recording"},{"command":"stopRecording","trigger":"stop","description":"Stop recording"},{"command":"hide","trigger":"conceal","description":"Hide recorder"},{"command":"show","trigger":"show","description":"Show recorder"}]'),y=Object.defineProperty,C=function(e,r,t){return function(e,r,t){r in e?y(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t}(e,"symbol"!=typeof r?r+"":r,t),t},E=s()("isle:recorder"),R=document.createElement("script");R.src="https://www.webrtc-experiment.com/EBML.js",R.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(R);var k=function(e){var r=t.g.MediaRecorder;return"function"!=typeof r.isTypeSupported||r.isTypeSupported(e)};function Z(e){var r=document.createElement("video");r.muted=!0,r.srcObject=e,r.style.display="none",(document.body||document.documentElement).appendChild(r)}var A=function(e){function r(r){var t;t=e.call(this,r)||this,C((0,o.Z)(t),"hide",(function(){t.setState({hidden:!0})})),C((0,o.Z)(t),"show",(function(){t.setState({hidden:!1})})),C((0,o.Z)(t),"handleSourceChange",(function(e){t.audio&&(t.audio=null),t.camera&&(t.camera=null),t.screen&&(t.screen=null),t.recorder&&(t.recorder.destroy(),t.recorder=null),t.setState({selectedSources:e})})),C((0,o.Z)(t),"storeFile",(function(){t.recorder.save("recoding.webm")})),C((0,o.Z)(t),"clearFile",(function(){t.recorder.clearRecordedData(),t.setState({finished:!1})})),C((0,o.Z)(t),"uploadFile",(function(){var e,r=t.context,o=t.getActiveSources(),i=o.audio,c=o.camera,s=o.screen;e=!i||c||s?t.recorderVideoConfig.mimeType:t.recorderAudioConfig.mimeType;var a=t.props.id,d="recordedFile.webm";a&&(d=a+"_"+d),(0,m.getSeekableBlob)(t.recorder.getBlob(),(function(o){var i=new File([o],d,{type:e}),c=new FormData;c.append("file",i),r.uploadFile({formData:c,callback:function(e,r){if(e)return t.handleError(e.message);var o=t.context,i=r.filename,c=o.server+"/"+i;o.addNotification({title:t.props.t("recording-uploaded"),message:t.props.t("recording-uploaded-message"),level:"success",position:"tl",autoDismiss:0,children:n.createElement("span",null,n.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},t.props.t("open-link")))}),t.setState({uploaded:!0})}})}))})),C((0,o.Z)(t),"handleClick",(function(){t.state.recording?t.stopRecording():t.startRecording()})),C((0,o.Z)(t),"getActiveSources",(function(){for(var e={audio:!1,camera:!1,screen:!1},r=0;r<t.state.selectedSources.length;r++)"audio"===t.state.selectedSources[r]?e.audio=!0:"camera"===t.state.selectedSources[r]?e.camera=!0:"screen"===t.state.selectedSources[r]&&(e.screen=!0);return e}));var i=[];return r.audio&&i.push("audio"),r.screen&&i.push("screen"),r.camera&&i.push("camera"),t.state={recording:r.autostart,finished:!1,uploaded:!1,hidden:!1,selectedSources:i},t}(0,i.Z)(r,e);var c=r.prototype;return c.componentDidMount=function(){this.props.autostart&&this.startRecording()},c.componentWillUnmount=function(){this.props.screen&&this.screen&&this.screen.getVideoTracks().forEach((function(e){e.stop()})),this.props.audio&&this.audio&&this.audio.getAudioTracks().forEach((function(e){e.stop()}))},c.handleError=function(e){this.context.addNotification({title:this.props.t("encountered-error"),message:e,level:"error",position:"tr"}),this.setState({recording:!1,finished:!1})},c.captureScreen=function(e){var r=this;t.g.navigator.mediaDevices.getDisplayMedia({video:{displaySurface:"monitor",logicalSurface:!0,cursor:"always"}}).then(e).catch((function(e){var t=r.props.t("failed-to-capture-screen",{msg:e.message});r.handleError(t)}))},c.captureCamera=function(e,r){var o=this;t.g.navigator.mediaDevices.getUserMedia({audio:r,video:!0}).then(e).catch((function(e){var r=o.props.t("failed-to-capture-camera",{msg:e.message});o.handleError(r)}))},c.captureAudio=function(e){var r=this;t.g.navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(e).catch((function(e){var t=r.props.t("failed-to-capture-microphone",{msg:e.message});r.handleError(t)}))},c.startRecording=function(){var e=this;if(this.setState({recording:!0,finished:!1,uploaded:!1}),E("Start recording..."),this.recorder)try{this.recorder.startRecording()}catch(r){this.setupRecorder((function(r){e.recorder.startRecording()}))}else this.setupRecorder()},c.stopRecording=function(){var e=this;this.setState({recording:!1,finished:!0}),this.recorder.stopRecording((function(){(0,m.getSeekableBlob)(e.recorder.getBlob(),(function(r){e.player.src=URL.createObjectURL(r),e.player.muted=!1}))}))},c.setupRecorder=function(e){var r=this;void 0===e&&(e=function(){}),E("Setting up the recorder...");var t,o,i,n,c,s,a=this.getActiveSources(),d=a.audio,l=a.camera,u=a.screen;if(u||l?this.recorderVideoConfig=(c={bitsPerSecond:this.props.bitsPerSecond,screen:u},s={mimeType:"video/webm",type:"video",bitsPerSecond:c.bitsPerSecond},c.screen||(s.recorderType=m.MediaStreamRecorder),s):d&&(this.recorderAudioConfig=(t={bitsPerSecond:this.props.bitsPerSecond},o=t.bitsPerSecond,i="audio/mpeg",n=m.MediaStreamRecorder,!1===k(i)&&(E(i,"is not supported."),!1===k(i="audio/ogg")&&(E(i,"is not supported."),!1===k(i="audio/webm")&&(E(i,"is not supported."),i="audio/wav",n=m.StereoAudioRecorder))),{mimeType:i,recorderType:n,type:"audio",bitsPerSecond:o,numberOfAudioChannels:1})),l&&!u){if(this.camera)return this.recorder=f()(this.camera,this.recorderVideoConfig),this.recorder.startRecording(),e();this.captureCamera((function(t){t.width=window.screen.width,t.height=window.screen.height,t.fullcanvas=!0,r.camera=t,r.recorder=f()(t,r.recorderVideoConfig),r.recorder.startRecording(),e()}),d)}if(d&&!u&&!l){if(this.audio)return this.recorder=f()(this.audio,this.recorderAudioConfig),this.recorder.startRecording(),e();this.captureAudio((function(t){r.recorder=f()(t,r.recorderAudioConfig),r.recorder.startRecording(),r.audio=t,e()}))}if(u&&!l&&d){if(this.audio&&this.screen)return this.recorder=f()([this.screen,this.audio],this.recorderVideoConfig),this.recorder.startRecording(),e();this.captureScreen((function(t){Z(t),r.captureAudio((function(o){Z(o),t.width=window.screen.width,t.height=window.screen.height,t.fullcanvas=!0,r.screen=t,r.audio=o,r.recorder=f()([t,o],r.recorderVideoConfig),r.recorder.startRecording(),e()}))}))}if(u&&!l&&!d){if(this.screen)return this.recorder=f()(this.screen,this.recorderVideoConfig),this.recorder.startRecording(),e();this.captureScreen((function(t){t.width=window.screen.width,t.height=window.screen.height,t.fullcanvas=!0,r.screen=t,r.recorder=f()(t,r.recorderVideoConfig),r.recorder.startRecording(),e()}))}if(this.screen&&this.camera)return this.recorder=f()([this.camera,this.screen],this.recorderVideoConfig),this.recorder.startRecording(),e();u&&l&&this.captureCamera((function(t){Z(t),r.captureScreen((function(o){Z(o),o.width=window.screen.width,o.height=window.screen.height,o.fullcanvas=!0,r.camera=t,r.screen=o,r.recorder=f()([t,o],r.recorderVideoConfig),r.recorder.startRecording(),e()}))}),d)},c.renderAudioVideo=function(){var e=this,r=this.getActiveSources(),t=r.audio,o=r.camera,i=r.screen;return!t||o||i?i||o?n.createElement("video",{width:"300px",height:"auto",style:{display:this.state.recording?"none":"block"},ref:function(r){e.player=r},controls:!0,autoPlay:!0}):void 0:n.createElement("audio",{style:{display:this.state.recording?"none":"block"},ref:function(r){e.player=r},controls:!0,autoPlay:!0})},c.render=function(){var e=this.state.recording?"red":"rgb(100,100,100)";if(this.state.hidden)return null;var r=this.props.style;return n.createElement("div",{className:"recorder-container unselectable",style:r},n.createElement("div",{className:"recorder-rec",style:{color:e}},this.state.recording?"":"REC"),this.state.selectedSources.length>0?n.createElement("div",{className:"recorder-button-container"},n.createElement("button",{"aria-label":this.props.t("toggle-recording"),className:"recorder-button",onClick:this.handleClick,style:{background:e}})):null,this.state.finished||this.state.recording?null:n.createElement(p.Z,{className:"recorder-buttongroup",size:"sm",type:"checkbox",value:this.state.selectedSources,onChange:this.handleSourceChange},n.createElement(g.Z,{variant:"light",className:"recorder-togglebutton",disabled:!this.props.screen||this.state.recording,value:"screen"},this.props.t("screen")),n.createElement(g.Z,{variant:"light",className:"recorder-togglebutton",disabled:!this.props.camera||this.state.recording,value:"camera"},this.props.t("cam")),n.createElement(g.Z,{variant:"light",className:"recorder-togglebutton",disabled:!this.props.audio||this.state.recording,value:"audio"},this.props.t("audio")),n.createElement(v.Z,{reference:this,id:this.props.voiceID,commands:w})),this.state.finished?this.renderAudioVideo():null,n.createElement("div",{style:{background:"rgba(0, 80,255,0.5)"}},this.state.finished?n.createElement(u.Z,null,n.createElement(h.Z,{size:"sm",onClick:this.clearFile,variant:"warning"},this.props.t("clear-file")),this.props.downloadable?n.createElement(h.Z,{size:"sm",onClick:this.storeFile,variant:"primary"},this.props.t("download-file")):null,this.props.uploadable?n.createElement(h.Z,{size:"sm",onClick:this.uploadFile,disabled:this.state.uploaded,variant:"primary"},this.props.t("upload-file")):null):null))},r}(n.Component);A.propTypes={audio:d().bool,camera:d().bool,screen:d().bool,autostart:d().bool,downloadable:d().bool,uploadable:d().bool,bitsPerSecond:d().number,voiceID:d().string,style:d().object},A.defaultProps={audio:!1,autostart:!1,bitsPerSecond:128e4,camera:!1,downloadable:!1,screen:!1,uploadable:!1,voiceID:null,style:{}},A.contextType=b.Z;var P=(0,l.Z)("recorder")((0,S.W)(A))}}]);