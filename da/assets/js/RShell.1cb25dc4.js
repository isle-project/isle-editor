(self.webpackChunk=self.webpackChunk||[]).push([[11002],{303428:function(t,e,n){"use strict";n.d(e,{$F:function(){return s},PB:function(){return i}});function i(t){return`data-rr-ui-${t}`}function s(t){return`rrUi${t}`}},232848:function(t,e,n){!function(t){"use strict";t.registerHelper("wordChars","r",/[\w.]/),t.defineMode("r",(function(e){function n(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=!0;return e}var i=["NULL","NA","Inf","NaN","NA_integer_","NA_real_","NA_complex_","NA_character_","TRUE","FALSE"],s=["list","quote","bquote","eval","return","call","parse","deparse"],r=["if","else","repeat","while","function","for","in","next","break"],o=["if","else","repeat","while","function","for"];t.registerHelper("hintWords","r",i.concat(s,r));var l,a=n(i),c=n(s),u=n(r),p=n(o),h=/[+\-*\/^<>=!&|~$:]/;function d(t,e){l=null;var n=t.next();if("#"==n)return t.skipToEnd(),"comment";if("0"==n&&t.eat("x"))return t.eatWhile(/[\da-f]/i),"number";if("."==n&&t.eat(/\d/))return t.match(/\d*(?:e[+\-]?\d+)?/),"number";if(/\d/.test(n))return t.match(/\d*(?:\.\d+)?(?:e[+\-]\d+)?L?/),"number";if("'"==n||'"'==n)return e.tokenize=f(n),"string";if("`"==n)return t.match(/[^`]+`/),"variable-3";if("."==n&&t.match(/.(?:[.]|\d+)/))return"keyword";if(/[a-zA-Z\.]/.test(n)){t.eatWhile(/[\w\.]/);var i=t.current();return a.propertyIsEnumerable(i)?"atom":u.propertyIsEnumerable(i)?(p.propertyIsEnumerable(i)&&!t.match(/\s*if(\s+|$)/,!1)&&(l="block"),"keyword"):c.propertyIsEnumerable(i)?"builtin":"variable"}return"%"==n?(t.skipTo("%")&&t.next(),"operator variable-2"):"<"==n&&t.eat("-")||"<"==n&&t.match("<-")||"-"==n&&t.match(/>>?/)?"operator arrow":"="==n&&e.ctx.argList?"arg-is":h.test(n)?"$"==n?"operator dollar":(t.eatWhile(h),"operator"):/[\(\){}\[\];]/.test(n)?(l=n,";"==n?"semi":null):null}function f(t){return function(e,n){if(e.eat("\\")){var i=e.next();return"x"==i?e.match(/^[a-f0-9]{2}/i):("u"==i||"U"==i)&&e.eat("{")&&e.skipTo("}")?e.next():"u"==i?e.match(/^[a-f0-9]{4}/i):"U"==i?e.match(/^[a-f0-9]{8}/i):/[0-7]/.test(i)&&e.match(/^[0-7]{1,2}/),"string-2"}for(var s;null!=(s=e.next());){if(s==t){n.tokenize=d;break}if("\\"==s){e.backUp(1);break}}return"string"}}var m=1,b=2,y=4;function g(t,e,n){t.ctx={type:e,indent:t.indent,flags:0,column:n.column(),prev:t.ctx}}function v(t,e){var n=t.ctx;t.ctx={type:n.type,indent:n.indent,flags:n.flags|e,column:n.column,prev:n.prev}}function E(t){t.indent=t.ctx.indent,t.ctx=t.ctx.prev}return{startState:function(){return{tokenize:d,ctx:{type:"top",indent:-e.indentUnit,flags:b},indent:0,afterIdent:!1}},token:function(t,e){if(t.sol()&&(0==(3&e.ctx.flags)&&(e.ctx.flags|=b),e.ctx.flags&y&&E(e),e.indent=t.indentation()),t.eatSpace())return null;var n=e.tokenize(t,e);return"comment"!=n&&0==(e.ctx.flags&b)&&v(e,m),";"!=l&&"{"!=l&&"}"!=l||"block"!=e.ctx.type||E(e),"{"==l?g(e,"}",t):"("==l?(g(e,")",t),e.afterIdent&&(e.ctx.argList=!0)):"["==l?g(e,"]",t):"block"==l?g(e,"block",t):l==e.ctx.type?E(e):"block"==e.ctx.type&&"comment"!=n&&v(e,y),e.afterIdent="variable"==n||"keyword"==n,n},indent:function(t,n){if(t.tokenize!=d)return 0;var i=n&&n.charAt(0),s=t.ctx,r=i==s.type;return s.flags&y&&(s=s.prev),"block"==s.type?s.indent+("{"==i?0:e.indentUnit):s.flags&m?s.column+(r?0:1):s.indent+(r?0:e.indentUnit)},lineComment:"#"}})),t.defineMIME("text/x-rsrc","r")}(n(223326))},658092:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var i=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(t,e){return i(t.querySelectorAll(e))}},667045:function(t,e,n){"use strict";const i=(0,n(217431).Z)((()=>n.e(10112).then(n.bind(n,497925))));e.Z=i},956260:function(t,e,n){"use strict";var i=n(202784),s=n(213980),r=n.n(s),o=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(t,e,n)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const p=t=>{const e=t,{children:n}=e,s=((t,e)=>{var n={};for(var i in t)a.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&l)for(var i of l(t))e.indexOf(i)<0&&c.call(t,i)&&(n[i]=t[i]);return n})(e,["children"]);return i.createElement("div",((t,e)=>{for(var n in e||(e={}))a.call(e,n)&&u(t,n,e[n]);if(l)for(var n of l(e))c.call(e,n)&&u(t,n,e[n]);return t})({},s),n)};p.defaultProps={className:"",style:{}},p.propTypes={className:r().string,style:r().object},e.Z=p},370420:function(t,e,n){"use strict";const i=(0,n(217431).Z)((()=>n.e(96131).then(n.bind(n,66720))));e.Z=i},386190:function(t,e,n){"use strict";n.r(e);var i=n(202784),s=n(928316),r=n(213980),o=n.n(r),l=n(198),a=n(321182),c=n(956260),u=n(770561),p=n(482228),h=n(715318),d=n(31071),f=n(735368),m=n.n(f),b=n(60913),y=n(370420),g=n(588703),v=n.n(g),E=n(830324),x=n.n(E),k=n(213939),O=n.n(k),Z=n(294565),S=n(557106),C=n.n(S),w=n(690299),P=n.n(w),H=n(223326),I=n.n(H),N=n(417332),U=n(810370),L=n(667045),j=n(998325),z=n(123103),T=n(691334),_=n(302108),A=n(741082),R=(n(232848),Object.defineProperty),W=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,F=(t,e,n)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$=(t,e,n)=>(F(t,"symbol"!=typeof e?e+"":e,n),n);const B=P()("isle:r-shell"),D=(0,N.Z)("r-shell"),q=/(help\([^)]*\)|\?[^\n]*)/;let G=0,J=[];const K=(t,e)=>{if(x()(t)){let n=t[e];if(v()(n)&&(n=n.filter((t=>t.type===T.cWP)),n.length>0))return n[0].value}return null};class Q extends i.Component{constructor(t){super(t),$(this,"handleResetClick",(()=>{this.editor.setValue(this.props.code,1)})),$(this,"logHint",(t=>{this.context.log({id:this.id,type:T.OUC,value:t})})),$(this,"hideHelp",(()=>{this.setState({help:""})})),this.state={id:G,exhaustedHints:0===t.hints.length,result:"",plots:[],running:!1,nEvaluations:0,solutionOpen:!1,help:""},this.id=t.id||D(t),G+=1,J.push(t.code),this.insertPlot=(e,n)=>i.createElement(a.Z,{key:n,src:e,title:t.t("r-plot")}),this.handleSolutionClick=()=>{const t=this.editor.getValue(),e=this.props.solution.replace(/\\n/g,"\n");if(!1===this.state.solutionOpen?(this.editor.setOption("theme","paraiso-light"),this.editor.setOption("readOnly",!0)):(this.editor.setOption("theme","elegant"),this.editor.setOption("readOnly",!1)),t!==e){this.context.log({id:this.id,type:T.WA3,value:t}),this.setState({lastSolution:t,solutionOpen:!this.state.solutionOpen}),this.editor.setValue(e,1)}else this.setState({solutionOpen:!this.state.solutionOpen}),this.editor.setValue(this.state.lastSolution||e,1)},this.handleEvaluationClick=()=>{B("Evaluate R code..."),this.setState({result:"",plots:[],running:!0});let t=this.editor.getValue();if(J[this.state.id]=t,""===t)this.setState({result:"Code to be evaluated is empty",running:!1});else{const e=this.context;let n=t.match(q);n&&e.getRHelpPage(n[0],((t,e,n)=>{t||this.setState({help:n})})),e.log({id:this.id,type:T.cWP,value:t});let i=(0,b.Z)(this.props.libraries,this.props.prependCode,e);if(this.props.addPreceding)for(let t=0;t<this.state.id;t++)i+=J[t],i+="\n";if(t=i+t+"\n",this.props.onEvaluate(t),!e)return this.setState({result:"R code can only be run in a production environment",nEvaluations:this.state.nEvaluations+1,running:!1});e.executeRCode({code:t,onResult:(t,e,n)=>{this.setState({result:n,nEvaluations:this.state.nEvaluations+1}),this.props.onResult(this.state.result)},onPlots:t=>{this.setState({plots:t,running:!1,nEvaluations:this.state.nEvaluations+1})},onError:t=>{this.setState({result:t,running:!1,nEvaluations:this.state.nEvaluations+1})}})}}}componentDidMount(){this.editor=I()(this.editorDiv,{mode:"r",theme:"elegant",lineNumbers:!0,lineWrapping:!0}),this.editor.setValue(this.props.code,-1),this.props.disabled&&this.editor.setOption("readOnly","nocursor"),this.editor.on("change",this.props.onChange),this.props.precompute&&this.handleEvaluationClick();const t=this.context;if(t){this.unsubscribe=t.subscribe(((t,e)=>{if(t===_.u){let t=K(e,this.id);(0,Z.isPrimitive)(t)&&(this.setState({lastSolution:t,solutionOpen:!1}),this.editor.setValue(t,1))}else this.forceUpdate()}));const e=t.currentUserActions,n=K(e,this.id);(0,Z.isPrimitive)(n)&&(this.setState({lastSolution:n,solutionOpen:!1}),this.editor.setValue(n,1))}}componentDidUpdate(t){if(this.props.code!==t.code)J[this.state.id]=this.props.code,this.editor.setValue(this.props.code,1),this.props.precompute&&this.handleEvaluationClick();else if(this.props.disabled!==t.disabled)this.props.disabled?this.editor.setOption("readOnly",!0):this.editor.setOption("readOnly",!1);else{const t=s.findDOMNode(this);let e=t.closest?t.closest(".spectacle-content"):null;if(e){let n=window.getComputedStyle(e).getPropertyValue("transform"),i=/matrix\(([0-9.]*)/.exec(n);if(v()(i)&&i.length>1){let e=i[1];t.style.transform=`scale(${1/e})`}}}this.editor.refresh()}componentWillUnmount(){G=0,J=[],this.unsubscribe&&this.unsubscribe(),this.editor&&O()(this.editor.destroy)&&this.editor.destroy(),this.editor=null}renderHelpModal(){const{t:t}=this.props;return i.createElement(h.Z,{backdrop:!1,show:Boolean(this.state.help),title:t("r-help"),onHide:this.hideHelp,style:{left:"auto",padding:"10px",position:"fixed",top:"10px",right:"30px",zIndex:99999,overflow:"hidden"},enforceFocus:!1},i.createElement(h.Z.Header,{closeButton:!0},i.createElement(h.Z.Title,{id:"contained-modal-title-lg"},t("r-help"))),i.createElement(h.Z.Body,{style:{height:"400",overflow:"auto"}},i.createElement("span",{dangerouslySetInnerHTML:{__html:this.state.help}})),i.createElement(h.Z.Footer,null,i.createElement(u.Z,{onClick:this.hideHelp},t("close"))))}render(){const t=this.props.hints.length,{t:e}=this.props,n=((t,e)=>{for(var n in e||(e={}))V.call(e,n)&&F(t,n,e[n]);if(W)for(var n of W(e))M.call(e,n)&&F(t,n,e[n]);return t})({lineHeight:"1.2em",maxHeight:1.2*C()(5,this.props.lines)+.5+"em",height:1.2*this.props.lines+.5+"em"},this.props.style);return i.createElement("div",{className:"rshell",style:this.props.style},i.createElement("div",{className:"rshell-editor",style:n,ref:t=>{this.editorDiv=t}}),this.props.disabled?i.createElement("span",null):i.createElement(u.Z,{variant:"primary",size:"sm",style:{marginBottom:"8px"},onClick:this.handleEvaluationClick},e("evaluate")),i.createElement(U.Z,{running:this.state.running,width:60,height:30,display:"inline",lines:12,style:{marginBottom:"-12px"}}),this.props.disabled?null:i.createElement(p.Z,{style:{float:"right"}},t>0?i.createElement(L.Z,{disabled:this.props.disabled,hints:this.props.hints,onClick:this.logHint,onFinished:()=>{this.setState({exhaustedHints:!0})}}):null,this.props.solution?((t,e,n,s,r)=>{const o=i.createElement(d.Z,{id:"tooltip"},r("solution-tooltip"));return!t||s<1?i.createElement(j.Z,{placement:"top",positionLeft:100,overlay:o,rootClose:!0},i.createElement("span",{style:{display:"inline-block",marginLeft:"4px"}},i.createElement(u.Z,{variant:"warning",size:"sm",disabled:!0,style:{pointerEvents:"none"}},r(n?"hide-solution":"show-solution")))):i.createElement(u.Z,{variant:"warning",size:"sm",onClick:e},n?"Hide Solution":"Show Solution")})(this.state.exhaustedHints,this.handleSolutionClick,this.state.solutionOpen,this.state.nEvaluations,e):null,this.props.resettable?((t,e)=>{const n=i.createElement(d.Z,{id:"tooltip"},e("reset-tooltip"));return i.createElement(j.Z,{placement:"top",positionLeft:100,overlay:n,rootClose:!0},i.createElement("span",{style:{display:"inline-block",marginLeft:"4px"}},i.createElement(u.Z,{variant:"warning",size:"sm",onClick:t},e("reset"))))})(this.handleResetClick,e):null,this.props.chat?i.createElement("span",{style:{display:"inline-block",marginLeft:"4px"}},i.createElement(y.Z,{for:this.id})):null),i.createElement("div",{id:"output"},(t=>{if(t){let e={__html:m().sanitize(t)};return i.createElement("pre",{id:"output"},i.createElement("span",{dangerouslySetInnerHTML:e}))}return i.createElement("span",null)})(this.state.result),((t,e)=>{const n=[];for(let s=0;s<t.length;s++)n[s]=i.createElement(a.Z,{width:"60%",height:"auto",key:s,src:t[s],title:e("r-plot")});return n})(this.state.plots,e)),i.createElement(c.Z,{id:this.id,info:T.cWP}),this.renderHelpModal())}}Q.propTypes={code:o().string,solution:o().string,hints:o().arrayOf(o().oneOfType([o().string,o().node])),addPreceding:o().bool,libraries:o().array,precompute:o().bool,prependCode:o().oneOfType([o().string,o().array]),chat:o().bool,disabled:o().bool,lines:o().number,resettable:o().bool,style:o().object,onChange:o().func,onEvaluate:o().func,onResult:o().func},Q.defaultProps={code:"",solution:"",hints:[],addPreceding:!1,libraries:[],precompute:!1,prependCode:"",chat:!1,disabled:!1,lines:5,resettable:!1,style:{},onChange(){},onEvaluate(){},onResult(){}},Q.contextType=z.Z,e.default=(0,l.Z)("r")((0,A.W)(Q))},60913:function(t,e,n){"use strict";var i=n(588703),s=n.n(i);e.Z=function(t,e,n){const{rshell:i}=n.config;i&&i.libraries&&(t=t.concat(i.libraries));let r=(t=>t.map((t=>"library("+t+");")).join(" "))(t);return i&&i.global&&(r+=i.global+"\n"),e=s()(e)?e.join("\n"):e,r+=e+="\n",r}}}]);