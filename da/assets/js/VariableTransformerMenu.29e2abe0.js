/*! For license information please see VariableTransformerMenu.29e2abe0.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[3047],{71026:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return bt}});var n,o,r,i,s=a(858255),l=a(574315),c=a(202784),d=(a(213980),a(770561)),u=(a(627476),a(95767),a(694882),a(298351),a(151119)),p=(a(850110),a(898837),a(911755)),v=a.n(p),Z=a(579553),f=a.n(Z),h=a(26266),g=a(830650),m=a(10863),b=a(96904),y=a(822736),C=a(260952),w=a(458264),N=a(312594),x=a(501258),k=a.n(x),P=a(437069),V=a.n(P),S=a(74039),F=a.n(S),G=a(224008),O=a.n(G),H=a(309765),q=a(741709),A=a(927447),L=a(551769),T=a(601822),E=a(292682),R=a(462874),B=a(997354),z=a(316305),D=a.n(z),M=a(927299),K=a(821337),j=a(148820),I=a(945157),W=a(5140),Y=a(271768),J=a(921455),$=a(938036),U=a(612249);function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(Object(a),!0).forEach((function(t){(0,u.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _=v()("isle:data-explorer:variable-transformer"),ee=/shapes\[(\d)\]\.x0/,te={group:null,displayDensity:!0,densityType:"Data-driven",chooseBins:!1,nBins:null},ae={clickOutsideDeactivates:!0};function ne(e,t){return e-t}var oe=function(e){for(var t=[],a=0;a<e.length;a++)t.push({type:"line",x0:e[a],y0:-100,x1:e[a],y1:100,line:{color:"red",width:3}});return t},re=function(e,t){var a=new Array(t.length);t[0]?a[0]=t[0]:a[0]="(-\u221e,".concat(e[0],")");for(var n=1;n<t.length;n++)t[n]?a[n]=t[n]:a[n]="[".concat(e[n-1],",").concat(e[n],")");var o=t.length-1;return t[o]?a[o]=t[o]:a[o]="[".concat(e[e.length-1],",\u221e)"),a},ie=function(e){var t,a,u=(0,c.useState)(""),p=(0,l.Z)(u,2),v=p[0],Z=p[1],x=(0,c.useState)(0),P=(0,l.Z)(x,2),S=P[0],G=P[1],z=(0,c.useState)({variable:null,configHist:null,breakpoints:null,categories:null,customNames:null}),X=(0,l.Z)(z,2),ie=X[0],se=X[1],le=v.length<2,ce=function(){var t=ie.variable,a=ie.categories,n=ie.breakpoints,o=e.data[t],r=(0,$.Z)(o,a,n);e.logAction(W.dU,{name:v,variable:t,breaks:n,categories:a});var i=(0,M.Z)(v,a);e.onGenerate(i,r),e.onHide()},de=function(e){13!==e.charCode||le||ce()},ue=function(e){Z(e.target.value)},pe=function(e){return function(t){_("Change break point...");var a=ie.breakpoints.slice();a[e]=F()(t,-S),a.sort(ne);var n=O()(ie.configHist);n.layout.shapes=oe(a),se(Q(Q({},ie),{},{configHist:n,breakpoints:a,categories:re(a,ie.customNames)}))}},ve=function(e){return function(t){var a=ie.categories.slice();a[e]=t;var n=ie.customNames.slice();n[e]=t;var o=Q(Q({},ie),{},{categories:a,customNames:n});se(o)}},Ze=function(e){return function(){var t=ie.breakpoints,a=ie.categories,n=ie.customNames;t.splice(e,1),a.splice(e,1),n.splice(e,1);var o=Q({},ie.configHist);o.layout.shapes=oe(t),se(Q(Q({},ie),{},{configHist:o,categories:a,customNames:n,breakpoints:t}))}},fe=function(e){var t=V()(e),a=ee.exec(t[0]);if(a){var n=a[1],o=ie.breakpoints.slice();o[n]=F()(e[t[0]],-S),o.sort(ne);var r=O()(ie.configHist);r.layout.shapes=oe(o),se(Q(Q({},ie),{},{configHist:r,breakpoints:o,categories:re(o,ie.customNames)}))}},he=function(t){_("Change variable to bin...");var a=Q({data:e.data,variable:t},te),n=(0,Y.N)(a);n.layout.yaxis={range:[(0,j.Z)(n.data[1].y),(0,I.Z)(n.data[1].y)],fixedrange:!0},n.layout.xaxis={fixedrange:!0};var o=e.data[t];o=o.filter((function(e){return(0,H.isPrimitive)(e)&&!D()(e)}));var r=[F()((0,K.Z)(o),-S)];n.layout.shapes=oe(r);var i=[!1,!1];se({variable:t,configHist:n,breakpoints:r,customNames:i,categories:re(r,i)})},ge=function(){var t=ie.breakpoints.slice(),a=e.data[ie.variable];a=a.filter((function(e){return(0,H.isPrimitive)(e)&&!D()(e)}));var n=k()(.8,1.2)*(0,K.Z)(a);t.push(F()(n,-S)),t.sort(ne);var o=O()(ie.configHist);o.layout.shapes=oe(t);var r=ie.customNames;r.push(!1);var i=Q(Q({},ie),{},{breakpoints:t,configHist:o,categories:re(t,r)});se(i)};return(0,s.Z)(T.Z,{cancel:".card-body",onDragStart:J.Z,style:{zIndex:1006}},void 0,(0,s.Z)(f(),{focusTrapOptions:ae},void 0,(0,s.Z)(R.Z,{onHide:e.onHide,show:e.show,header:e.t("bin-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:ce,disabled:le},void 0,e.t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,(t=ie.configHist,a=(0,s.Z)(A.Z,{legend:e.t("variable-to-bin"),defaultValue:ie.variable,options:e.quantitative,onChange:he,style:{maxWidth:400}}),t?(0,s.Z)(c.Fragment,{},void 0,a,(0,s.Z)(d.Z,{className:"insert-line-button",onClick:ge},void 0,e.t("insert-break-line")),(0,s.Z)("p",{},void 0,e.t("drag-red-bars"),"(",(0,s.Z)(q.Z,{legend:e.t("digits-after-decimal-snap"),min:0,max:9,inline:!0,defaultValue:S,onChange:G}),")"),(0,s.Z)("div",{style:{height:250}},void 0,(0,s.Z)(E.Z,{data:t.data,layout:t.layout,editable:!0,fit:!0,removeButtons:!0,legendButtons:!1,onRelayout:fe})),(0,s.Z)("div",{},void 0,(0,s.Z)(C.Z,{className:"mb-2"},void 0,(0,s.Z)(C.Z.Header,{},void 0,e.t("choose-category-labels"),":"),(0,s.Z)(C.Z.Body,{},void 0,function(){var t=[],a=ie.breakpoints,l=1===a.length;if(t.push((0,s.Z)(w.Z,{},"div-0",(0,s.Z)(N.Z,{md:7},void 0,n||(n=(0,s.Z)(B.Z,{raw:"x < "})),(0,s.Z)(q.Z,{inline:!0,onBlur:pe(0),defaultValue:a[0],step:"any"})),(0,s.Z)(N.Z,{md:4},void 0,(0,s.Z)(L.Z,{legend:"".concat(e.t("label")," 1"),defaultValue:ie.categories[0],onChange:ve(0),style:{width:200}},0)),o||(o=(0,s.Z)(N.Z,{md:1})))),a.length>1)for(var c=0;c<a.length-1;c++){var d=ve(c+1);t.push((0,s.Z)(w.Z,{},"div-".concat(c+1),(0,s.Z)(N.Z,{md:7},void 0,(0,s.Z)(q.Z,{inline:!0,onBlur:pe(c),defaultValue:a[c],step:"any"}),r||(r=(0,s.Z)(B.Z,{raw:"\\le x <"})),(0,s.Z)(q.Z,{inline:!0,onBlur:pe(c+1),defaultValue:a[c+1],step:"any"})),(0,s.Z)(N.Z,{md:4},void 0,(0,s.Z)(L.Z,{legend:"".concat(e.t("label")," ").concat(c+2),defaultValue:ie.categories[c+1],onChange:d,style:{width:200}},1+c)),(0,s.Z)(N.Z,{md:1},void 0,(0,s.Z)(U.Z,{onClick:Ze(c),style:{marginTop:"5px"},disabled:l,tooltipPlacement:"right"}))))}var u=a.length;return t.push((0,s.Z)(w.Z,{},"div-".concat(u),(0,s.Z)(N.Z,{md:7},void 0,i||(i=(0,s.Z)(B.Z,{raw:"x \\ge"})),(0,s.Z)(q.Z,{inline:!0,onChange:pe(u-1),defaultValue:a[u-1],step:"any"})),(0,s.Z)(N.Z,{md:4},void 0,(0,s.Z)(L.Z,{legend:"Label ".concat(u+1),defaultValue:ie.categories[u],onChange:ve(u),style:{width:200}},u)),(0,s.Z)(N.Z,{md:1},void 0,(0,s.Z)(U.Z,{onClick:Ze(u-1),style:{marginTop:"5px"},disabled:l})))),t}()))),(0,s.Z)(m.Z,{style:{width:"fit-content"}},void 0,(0,s.Z)(g.Z,{},void 0,e.t("name-new-variable"),":"),(0,s.Z)(h.Z,{type:"text",placeholder:e.t("select-name"),onChange:ue,onKeyPress:de}),(0,s.Z)(b.Z,{},void 0,e.t("new-variable-appended")))):(0,s.Z)(c.Fragment,{},void 0,a,(0,s.Z)(y.Z,{variant:"info"},void 0,e.t("select-variable-bin")))))))};ie.defaultProps={logAction:function(){},onGenerate:function(){}};var se,le,ce,de=ie,ue=(a(382139),a(264659)),pe=a(904730),ve=a(673989),Ze=a(175663),fe=a(750591),he=a(575630),ge=(a(217732),a(6059),a(319371),a(387612)),me=a(845450),be=a(423184),ye=a(482228),Ce=a(738314),we=a(380408),Ne=a(156562),xe=a(661599),ke=a(304964),Pe=a(150275),Ve=a(605977),Se=a.n(Ve),Fe=a(287013),Ge=a.n(Fe),Oe=a(302467),He=a.n(Oe),qe=a(693171),Ae=a(123950);function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,he.Z)(e);if(t){var o=(0,he.Z)(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return(0,fe.Z)(this,a)}}var Te=/datum\.([^0-9]+)(\d+):datum\.\1(\d+)/,Ee=Se()(0,10,1),Re=/(?:^|\n)([^\n]*)$/,Be=/^[0-9]/,ze={clickOutsideDeactivates:!0},De=c.forwardRef((function(e,t){var a=e.children,n=e.style,o=e.className,r=e["aria-labelledby"],i=(0,c.useState)(""),d=(0,l.Z)(i,2),u=d[0],p=d[1];return c.createElement("div",{ref:t,style:n,className:o,"aria-labelledby":r},(0,s.Z)(h.Z,{className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return p(e.target.value)},value:u}),(0,s.Z)("ul",{className:"list-unstyled"},void 0,c.Children.toArray(a).filter((function(e){return!u||e.props.children.toLowerCase().startsWith(u)}))))})),Me=function(e){(0,Ze.Z)(a,e);var t=Le(a);function a(e){var n;return(0,ue.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,ve.Z)(n),"handleGenerate",(function(){var e,t=n.state,a=t.code,o=t.name;if(Te.test(a)){for(var r=Te.exec(a),i=r[1],s=parseInt(r[2],10),l=parseInt(r[3],10),c="",d=s;d<=l;d++)c+="datum.".concat(i).concat(d),c+=d<l?",":"";a=He()(a,r[0],c)}Ge()(a,"return ")||(a=He()(a,Re,"\nreturn $1"));try{e=(0,qe.Z)(a,n.props.data),n.props.logAction(W.gx,{code:a,name:o}),n.state.asCategorical&&(e=e.map((function(e){return String(e)}))),n.props.onGenerate(o,e)}catch(u){return n.props.session.addNotification({title:"Errored",message:"Encountered the following error: "+u.message,level:"error",position:"tr"})}n.props.onHide()})),(0,u.Z)((0,ve.Z)(n),"handleNameChange",(function(e){n.setState({name:e.target.value})})),(0,u.Z)((0,ve.Z)(n),"handleCodeChange",(function(e){n.setState({code:e})})),(0,u.Z)((0,ve.Z)(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.name.length>=2&&n.handleGenerate()})),(0,u.Z)((0,ve.Z)(n),"insertVarFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a="datum";t+=a+=!Ge()(e," ")&&!Ge()(e,".")&&!Be.test(e)?".".concat(e):"['".concat(e,"']"),t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),(0,u.Z)((0,ve.Z)(n),"insertLiteralFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=e;t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),(0,u.Z)((0,ve.Z)(n),"insertFuncFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=" "+e+"()";t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length-1})}})),n.state={code:e.defaultCode,selection:null,name:"",showGuide:!1,asCategorical:!1},n}return(0,pe.Z)(a,[{key:"render",value:function(){var e=this,t=this.props.t,a=this.props.quantitative.map((function(t,a){return(0,s.Z)(Ce.Z.Item,{onClick:e.insertVarFactory(t),eventKey:a},a,t)}));return(0,s.Z)(T.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,(0,s.Z)(f(),{focusTrapOptions:ze},void 0,(0,s.Z)(R.Z,{show:this.props.show,onHide:this.props.onHide,header:this.props.t("formula-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:this.handleGenerate,disabled:this.state.name.length<2},void 0,this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,(0,s.Z)("div",{className:"formula-transformer-body"},void 0,(0,s.Z)(xe.Z,{headerClassName:"title",header:this.state.showGuide?t("hide-example-guide"):t("show-example-guide"),visible:this.state.showGuide,onClick:function(){return e.setState({showGuide:!e.state.showGuide})}},void 0,(0,s.Z)("p",{},void 0,t("formula-transformer-example-intro")),(0,s.Z)(me.Z,{condensed:!0},void 0,(0,s.Z)("thead",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("th",{},void 0,t("type")),(0,s.Z)("th",{},void 0,t("example")),(0,s.Z)("th",{},void 0,t("description")))),(0,s.Z)("tbody",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("td",{},void 0,t("interaction"),":"),(0,s.Z)("td",{},void 0,(0,s.Z)("code",{},void 0,"datum.",this.props.quantitative[0]," * datum.",this.props.quantitative[1])),(0,s.Z)("td",{},void 0,(0,s.Z)(ge.c,{i18nKey:"example-description-multiply",ns:"DataExplorer"},void 0,"Multiply values of variables ",(0,s.Z)("code",{},void 0,{first:this.props.quantitative[0]})," and ",(0,s.Z)("code",{},void 0,{second:this.props.quantitative[1]})))),(0,s.Z)("tr",{},void 0,(0,s.Z)("td",{},void 0,t("transformation"),":"),(0,s.Z)("td",{},void 0,(0,s.Z)("code",{},void 0,"exp( datum.",this.props.quantitative[0]," )")),(0,s.Z)("td",{},void 0,(0,s.Z)(ge.c,{i18nKey:"example-description-exponential",ns:"DataExplorer"},void 0,"Natural exponential function of variable ",(0,s.Z)("code",{},void 0,{variable:this.props.quantitative[0]})))),(0,s.Z)("tr",{},void 0,(0,s.Z)("td",{},void 0,t("function"),":"),(0,s.Z)("td",{},void 0,(0,s.Z)("code",{},void 0,"9/5 * ",this.props.quantitative[0]," + 32")),(0,s.Z)("td",{},void 0,(0,s.Z)(ge.c,{i18nKey:"example-description-calculation",ns:"DataExplorer"},void 0,"Multiply values of ",(0,s.Z)("code",{},void 0,{variable:this.props.quantitative[0]})," by ",se||(se=(0,s.Z)("code",{},void 0,"9/5"))," and add ",le||(le=(0,s.Z)("code",{},void 0,"32")))))))),ce||(ce=(0,s.Z)("hr",{})),(0,s.Z)("div",{className:"mb-2"},void 0,(0,s.Z)(ye.Z,{style:{marginBottom:5}},void 0,(0,s.Z)(Ce.Z,{className:"mr-2"},void 0,(0,s.Z)(Ce.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,t("quantitative")),(0,s.Z)(Ce.Z.Menu,{variant:"light",as:De,id:"bg-nested-dropdown"},void 0,a)),(0,s.Z)(Ce.Z,{className:"mr-2"},void 0,(0,s.Z)(Ce.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,t("categorical")),(0,s.Z)(Ce.Z.Menu,{variant:"light",as:De,id:"bg-nested-dropdown"},void 0,this.props.categorical.map((function(t,a){return(0,s.Z)(Ce.Z.Item,{onClick:e.insertVarFactory(t),eventKey:a},a,t)})))))),(0,s.Z)(C.Z,{className:"mb-2"},void 0,(0,s.Z)(C.Z.Body,{},void 0,(0,s.Z)(ye.Z,{style:{marginBottom:5}},void 0,(0,s.Z)(be.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("smaller-than")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" < ")},void 0,"<")),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("greater-than")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" > ")},void 0,">")),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("smaller-or-equal")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" <= ")},void 0,"<=")),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("greater-or-equal")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" >= ")},void 0,">="))),(0,s.Z)(be.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("open-parenthesis")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" ( ")},void 0,"(")),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("closing-parenthesis")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" ) ")},void 0,")"))),(0,s.Z)(be.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("addition")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" + ")},void 0,"+")),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("subtraction")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" - ")},void 0,"-")),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("multiplication")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" * ")},void 0,"*")),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("division")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" / ")},void 0,"/"))),(0,s.Z)(be.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("boolean-and")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" && ")},void 0,t("and"))),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("boolean-or")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" || ")},void 0,t("or"))),(0,s.Z)(Pe.Z,{placement:"top",tooltip:t("boolean-not")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" !")},void 0,t("not"))))),(0,s.Z)(ye.Z,{style:{marginBottom:5}},void 0,(0,s.Z)(be.Z,{size:"sm",className:"mr-2"},void 0,Ee.map((function(t,a){return(0,s.Z)(d.Z,{variant:"light",onClick:e.insertLiteralFactory("".concat(t))},a,t)})),(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(".")},void 0,"."))),(0,s.Z)(ye.Z,{},void 0,(0,s.Z)(be.Z,{size:"sm",className:"me-2"},void 0,Ae.map((function(a,n){return(0,s.Z)(Pe.Z,{placement:"bottom",tooltip:t(a+"-tooltip")},n,(0,s.Z)(d.Z,{variant:"light",onClick:e.insertFuncFactory(a),eventKey:n},void 0,a))})))))),(0,s.Z)(C.Z,{className:"mb-2"},void 0,(0,s.Z)(C.Z.Body,{},void 0,c.createElement(ke.Z,{ref:function(t){e.textarea=t},legend:"".concat(t("expression"),":"),placeholder:t("enter-formula"),value:this.state.code,onChange:this.handleCodeChange,onBlur:function(t){var a=t.target.selectionStart;e.setState({selection:a})},rows:3}))),(0,s.Z)(m.Z,{style:{margin:8}},void 0,(0,s.Z)(g.Z,{},void 0,t("name-new-variable"),":"),(0,s.Z)(h.Z,{type:"text",placeholder:t("select-name"),onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),(0,s.Z)(b.Z,{},void 0,t("new-variable-appended"))),(0,s.Z)(we.Z,{name:"options",onChange:function(t){e.setState({asCategorical:t})},type:"radio",size:"small",value:this.state.asCategorical,style:{padding:6}},void 0,(0,s.Z)(Ne.Z,{variant:"outline-secondary",value:!1},void 0,t("treat-as-quantitative")),(0,s.Z)(Ne.Z,{variant:"outline-secondary",value:!0},void 0,t("treat-as-categorical")))))))}}]),a}(c.Component);Me.defaultProps={logAction:function(){},onGenerate:function(){},defaultCode:"",session:{}};var Ke,je=Me,Ie=a(122081),We=a(147777),Ye=a.n(We),Je=a(471205),$e=a.n(Je),Ue=a(888244),Xe=a.n(Ue),Qe=a(785745),_e=a(833562),et=a(280093);function tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,he.Z)(e);if(t){var o=(0,he.Z)(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return(0,fe.Z)(this,a)}}var at=v()("isle:data-explorer:variable-transformer"),nt={clickOutsideDeactivates:!0};function ot(e){return e?He()(e,".","[dot]"):e}function rt(e){for(var t=V()(e),a=!0,n=0;n<t.length;n++)Xe()(e[t[n]])||(a=!1);return a}var it=function(e){(0,Ze.Z)(a,e);var t=tt(a);function a(e){var n;(0,ue.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,ve.Z)(n),"handleFirstVariableChange",(function(e){var t,a={};if(n.state.secondVar){var o=e,r=n.state.secondVar,i=n.props.data[o];t=Ye()(i,$e());for(var s=(0,et.Z)(t,o),l=(0,et.Z)(n.state.secondFreqs,r),c=0;c<s.length;c++)for(var d=0;d<l.length;d++){var u=s[c]+"-"+l[d];a[ot(u)]=u}}else{var p=n.props.data[e];t=Ye()(p,$e());for(var v=(0,et.Z)(t,e),Z=0;Z<v.length;Z++)a[ot(v[Z])]=v[Z]}var f=rt(a);n.setState({firstVar:e,firstFreqs:t,nameMappings:a,onlyNumbers:f})})),(0,u.Z)((0,ve.Z)(n),"handleSecondVariableChange",(function(e){if(!e){for(var t=n.state.firstVar,a=(0,et.Z)(n.state.firstFreqs,t),o={},r=0;r<a.length;r++)o[ot(a[r])]=a[r];return n.setState({secondVar:e,nameMappings:o})}for(var i={},s=n.state.firstVar,l=n.props.data[e],c=Ye()(l,$e()),d=(0,et.Z)(n.state.firstFreqs,s),u=(0,et.Z)(c,e),p=0;p<d.length;p++)for(var v=0;v<u.length;v++){var Z=d[p]+"-"+u[v];i[ot(Z)]=Z}var f=rt(i);n.setState({secondVar:e,secondFreqs:c,nameMappings:i,onlyNumbers:f})})),(0,u.Z)((0,ve.Z)(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.generatedName.length>=2&&n.makeNewVar()})),(0,u.Z)((0,ve.Z)(n),"changeFreqFactory",(function(e){return function(t){var a=O()(n.state.nameMappings);a[ot(e)]=t.target.value;var o=rt(a);n.setState({nameMappings:a,onlyNumbers:o})}})),(0,u.Z)((0,ve.Z)(n),"changeContigencyFactory",(function(e,t){return function(a){var o=O()(n.state.nameMappings);o[ot(t)+"-"+ot(e)]=a.target.value,n.setState({nameMappings:o})}})),(0,u.Z)((0,ve.Z)(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),(0,u.Z)((0,ve.Z)(n),"makeNewVar",(function(){at("Generating new categorical variable...");var e=n.state,t=e.firstVar,a=e.secondVar,o=e.nameMappings,r=e.castNumeric,i=(0,_e.Z)(t,a,o,n.props.data,r);n.props.onGenerate(n.state.generatedName,i),n.props.logAction(W.CS,{name:n.state.generatedName,firstVar:t,secondVar:a,nameMappings:o,castNumeric:r}),n.props.onHide()})),(0,u.Z)((0,ve.Z)(n),"renderFrequencyTable",(function(){var e=n.state.firstVar,t=n.props.data[e],a=Ye()(t,$e()),o=(0,et.Z)(a,e);return(0,s.Z)(Ie.Z,{bordered:!0,style:{margin:8}},void 0,(0,s.Z)("thead",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("th",{},void 0,n.props.t("old"),":"),o.map((function(t,a){return(0,s.Z)("th",{},"".concat(e,"-").concat(a,"-old"),t)})))),(0,s.Z)("tbody",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("th",{},void 0,n.props.t("new"),":"),o.map((function(t,a){return(0,s.Z)("th",{},"".concat(e,"-").concat(a,"-new"),(0,s.Z)("input",{className:"transformer-table-input",type:"text",defaultValue:t,onChange:n.changeFreqFactory(t)}))}))),(0,s.Z)("tr",{style:{borderTop:"1px solid black"}},void 0,(0,s.Z)("th",{},void 0,n.props.t("frequencies"),":"),o.map((function(t,a){var o=n.state.firstFreqs[t];return(0,s.Z)("td",{},"".concat(e,"-").concat(a,"-freq"),o)})))))})),(0,u.Z)((0,ve.Z)(n),"renderContingencyTable",(function(){var e=n.state.secondVar,t=n.state.firstVar,a=n.props.data[e],o=n.props.data[t],r=Ye()(a,$e()),i=Ye()(o,$e()),l=(0,et.Z)(r,e),c=(0,et.Z)(i,t);return(0,s.Z)(Ie.Z,{bordered:!0,style:{margin:8}},void 0,(0,s.Z)("tr",{},void 0,Ke||(Ke=(0,s.Z)("th",{})),c.map((function(e,t){return(0,s.Z)("th",{},"".concat(e,"-").concat(t),e)}))),l.map((function(e,t){return(0,s.Z)("tr",{},"".concat(e,"-").concat(t),(0,s.Z)("th",{},void 0,e),c.map((function(t,a){return(0,s.Z)("td",{},"".concat(e,"-").concat(t,"-").concat(a),(0,s.Z)("input",{className:"transformer-table-input",type:"text",defaultValue:"".concat(t,"-").concat(e),onChange:n.changeContigencyFactory(e,t)}))})))})))}));for(var o=e.categorical[0],r=e.data[o],i=Ye()(r,$e()),l=(0,et.Z)(i,o),c={},d=0;d<l.length;d++)c[ot(l[d])]=l[d];return n.state={generatedName:"",firstVar:o,firstFreqs:i,nameMappings:c,secondVar:null,secondFreqs:null,castNumeric:!1,onlyNumbers:!1},n}return(0,pe.Z)(a,[{key:"renderTable",value:function(){return this.state.firstVar&&this.state.secondVar?this.renderContingencyTable():this.state.firstVar||this.state.secondVar?this.renderFrequencyTable():null}},{key:"render",value:function(){var e=this,t=this.props.t;return(0,s.Z)(T.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,(0,s.Z)(f(),{focusTrapOptions:nt},void 0,(0,s.Z)(R.Z,{onHide:this.props.onHide,show:this.props.show,header:t("categorical-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:this.makeNewVar,disabled:this.state.generatedName.length<2},void 0,t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,(0,s.Z)(w.Z,{},void 0,(0,s.Z)(N.Z,{md:4},void 0,(0,s.Z)(A.Z,{legend:t("first-variable"),defaultValue:this.state.firstVar||"",options:this.props.categorical,onChange:this.handleFirstVariableChange})),(0,s.Z)(N.Z,{md:4},void 0,(0,s.Z)(A.Z,{clearable:!0,legend:t("optional-second-variable"),defaultValue:this.state.secondVar||"",options:this.props.categorical,onChange:this.handleSecondVariableChange}))),(0,s.Z)(w.Z,{style:{overflowX:"auto",width:"100%"}},void 0,this.renderTable()),(0,s.Z)(w.Z,{},void 0,(0,s.Z)(Pe.Z,{tooltip:t("treat-labels-as-numbers-tooltip")},void 0,(0,s.Z)(Qe.Z,{legend:t("treat-labels-as-numbers"),defaultValue:!1,disabled:!this.state.onlyNumbers,onChange:function(){e.setState({castNumeric:!e.state.castNumeric})}}))),(0,s.Z)(w.Z,{},void 0,(0,s.Z)(m.Z,{style:{margin:8}},void 0,(0,s.Z)(g.Z,{},void 0,t("name-new-variable"),":"),(0,s.Z)(h.Z,{type:"text",placeholder:t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),(0,s.Z)(b.Z,{},void 0,t("new-variable-appended")))))))}}]),a}(c.Component);it.defaultProps={logAction:function(){}};var st=it,lt=(a(448977),a(240054)),ct=a.n(lt),dt=a(1570),ut=a.n(dt);function pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,he.Z)(e);if(t){var o=(0,he.Z)(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return(0,fe.Z)(this,a)}}var vt=v()("isle:data-explorer:group-transformer"),Zt={clickOutsideDeactivates:!0},ft=function(e){(0,Ze.Z)(a,e);var t=pt(a);function a(e){var n;return(0,ue.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,ve.Z)(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),(0,u.Z)((0,ve.Z)(n),"handleGroupNumberChange",(function(e){for(var t=new Array(e).fill(1/e),a=new Array(e),o=0;o<a.length;o++)a[o]="".concat(n.props.t("group")," ").concat(o+1);n.setState({groupProbs:t,labels:a,nGroups:e})})),(0,u.Z)((0,ve.Z)(n),"handleKeyPress",(function(e){if(13===e.charCode){for(var t=0,a=0;a<n.state.groupProbs.length;a++)t+=n.state.groupProbs[a];n.state.generatedName.length>2&&ut()(t,1)<=15e-9&&n.makeNewVar()}})),(0,u.Z)((0,ve.Z)(n),"makeNewVar",(function(){vt("Generating new categorical variable...");var e=V()(n.props.data),t=n.props.data[e[0]].length,a=ct()(n.state.labels,{size:t,probs:n.state.groupProbs,replace:!0});n.props.onGenerate(n.state.generatedName,a),n.props.logAction(W.Dp,{name:n.state.generatedName,labels:n.state.labels,groupProbs:n.state.groupProbs}),n.props.onHide()})),n.state={generatedName:"",nGroups:2,groupProbs:[.5,.5],labels:["Group 1","Group 2"]},n}return(0,pe.Z)(a,[{key:"renderTable",value:function(){for(var e=this,t=new Array(this.state.nGroups),a=function(a){t[a]=(0,s.Z)(w.Z,{},a,(0,s.Z)(N.Z,{},void 0,(0,s.Z)(L.Z,{legend:"Label for Group ".concat(a+1),defaultValue:e.state.labels[a],onChange:function(t){var n=e.state.labels.slice();n[a]=t,e.setState({labels:n})}})),(0,s.Z)(N.Z,{},void 0,(0,s.Z)(q.Z,{legend:e.props.t("group-proportion"),onChange:function(t){var n=e.state.groupProbs.slice();n[a]=t,e.setState({groupProbs:n})},defaultValue:e.state.groupProbs[a],step:.01,min:0,max:1,numbersOnly:!1})))},n=0;n<t.length;n++)a(n);return(0,s.Z)(c.Fragment,{},void 0,t,(0,s.Z)("p",{},void 0,this.props.t("proportions-sum-one")))}},{key:"render",value:function(){for(var e=0,t=0;t<this.state.groupProbs.length;t++)e+=this.state.groupProbs[t];var a=this.state.generatedName.length>2&&ut()(e,1)<=15e-9;return(0,s.Z)(T.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,(0,s.Z)(f(),{focusTrapOptions:Zt},void 0,(0,s.Z)(R.Z,{onHide:this.props.onHide,show:this.props.show,header:this.props.t("group-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:this.makeNewVar,disabled:!a},void 0,this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,(0,s.Z)(w.Z,{},void 0,(0,s.Z)(N.Z,{},void 0,(0,s.Z)(q.Z,{legend:this.props.t("number-of-groups"),onChange:this.handleGroupNumberChange,defaultValue:this.state.nGroups,step:1,min:1,max:99}))),this.renderTable(),(0,s.Z)(w.Z,{},void 0,(0,s.Z)(m.Z,{style:{margin:8}},void 0,(0,s.Z)(g.Z,{},void 0,this.props.t("name-new-variable"),":"),(0,s.Z)(h.Z,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),(0,s.Z)(b.Z,{},void 0,this.props.t("new-variable-appended")))))))}}]),a}(c.Component);ft.defaultProps={logAction:function(){}};var ht=ft,gt=(0,a(844601).Z)((function(){return Promise.all([a.e(8941),a.e(8226),a.e(2460),a.e(1225),a.e(2250),a.e(7293)]).then(a.bind(a,368678))})),mt=function(e){var t,a=e.data,n=e.categorical,o=e.quantitative,r=e.t,i=e.session,u=e.defaultCode,p=e.logAction,v=e.onGenerate,Z=(0,c.useState)(null),f=(0,l.Z)(Z,2),h=f[0],g=f[1],m=function(){var t="formula"===h?null:"formula";g(t),e.onActive(t)},b=function(){var t="bin"===h?null:"bin";g(t),e.onActive(t)},y=function(){var t="categorical"===h?null:"categorical";g(t),e.onActive(t)},C=function(){var t="group"===h?null:"group";g(t),e.onActive(t)},w=function(){var t="random"===h?null:"random";g(t),e.onActive(t)};if(a)switch(h){case"bin":t=(0,s.Z)(de,{show:!0,onHide:b,quantitative:o,logAction:p,onGenerate:v,data:a,t:r});break;case"categorical":t=(0,s.Z)(st,{show:!0,onHide:y,categorical:n,logAction:p,onGenerate:v,data:a,t:r});break;case"formula":t=(0,s.Z)(je,{show:!0,onHide:m,categorical:n,quantitative:o,data:a,defaultCode:u,logAction:p,onGenerate:v,session:i,t:r});break;case"group":t=(0,s.Z)(ht,{show:!0,onHide:C,logAction:p,onGenerate:v,data:a,t:r});break;case"random":t=(0,s.Z)(gt,{show:!0,onHide:w,logAction:p,onGenerate:v,data:a,t:r})}return(0,s.Z)(c.Fragment,{},void 0,(0,s.Z)("div",{className:"well",style:{padding:15,margin:15}},void 0,(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:m,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,r("interactions-functions"))),(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:b,disabled:!o||0===o.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,r("bin-quantitative"))),(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:y,disabled:!n||0===n.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,r("rename-or-combine"))),(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:C,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,r("create-groups"))),(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:w,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,r("generate-random-data")))),t)};mt.defaultProps={logAction:function(){},onActive:function(){},onGenerate:function(){},defaultCode:"",session:{}};var bt=mt},921455:function(e,t){"use strict";t.Z=function(e){e.stopPropagation()}},217732:function(e,t,a){"use strict";var n=a(542985),o=a(410875),r=a(542094),i="startsWith",s="".startsWith;n(n.P+n.F*a(708852)(i),"String",{startsWith:function(e){var t=r(this,e,i),a=o(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return s?s.call(t,n,a):t.slice(a,a+n.length)===n}})},888244:function(e,t,a){"use strict";var n=a(667237);e.exports=n},667237:function(e,t,a){"use strict";var n=a(294565).isPrimitive;e.exports=function(e){var t,a,o;if(!n(e))return!1;if(0===(t=e.length))return!1;for(o=0;o<t;o++)if((a=e.charCodeAt(o))<48||a>57)return!1;return!0}},915521:function(e,t,a){"use strict";var n=a(501874),o=a(567359),r=a(268949),i=a(833022),s=a(213939),l=a(700601),c=a(362739),d=a(306830),u=a(149074).factory,p=a(422957),v=a(488088),Z=a(15311),f=a(583764);e.exports=function(){var e,t,a,h,g,m;if(0===arguments.length)t=u();else if(1===arguments.length){if(!i(e=arguments[0]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(l(e,"prng")){if(!s(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else{if(h=Z(g=arguments[0],m=arguments[1]))throw h;if(arguments.length>2){if(!i(e=arguments[2]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(l(e,"prng")){if(!s(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else t=u()}return n(a=void 0===g?V:P,"NAME","uniform"),e&&e.prng?(n(a,"seed",null),n(a,"seedLength",null),r(a,"state",c(null),d),n(a,"stateLength",null),n(a,"byteLength",null),n(a,"toJSON",c(null)),n(a,"PRNG",t)):(o(a,"seed",b),o(a,"seedLength",y),r(a,"state",N,x),o(a,"stateLength",C),o(a,"byteLength",w),n(a,"toJSON",k),n(a,"PRNG",t),t=t.normalized),a;function b(){return t.seed}function y(){return t.seedLength}function C(){return t.stateLength}function w(){return t.byteLength}function N(){return t.state}function x(e){t.state=e}function k(){var e={type:"PRNG"};return e.name=a.NAME,e.state=v(t.state),e.params=void 0===g?[]:[g,m],e}function P(){return f(t,g,m)}function V(e,a){return p(e)||p(a)||e>=a?NaN:f(t,e,a)}}},501258:function(e,t,a){"use strict";var n=a(501874),o=a(387944);n(o,"factory",a(915521)),e.exports=o},387944:function(e,t,a){"use strict";var n=a(915521)();e.exports=n},583764:function(e){"use strict";e.exports=function(e,t,a){var n=e();return a*n+(1-n)*t}},15311:function(e,t,a){"use strict";var n=a(309765).isPrimitive,o=a(316305);e.exports=function(e,t){return!n(e)||o(e)?new TypeError("invalid argument. First argument must be a number primitive and not `NaN`. Value: `"+e+"`."):!n(t)||o(t)?new TypeError("invalid argument. Second argument must be a number primitive and not `NaN`. Value: `"+t+"`."):e>=t?new RangeError("invalid argument. Minimum support `a` must be less than maximum support `b`. Value: `["+e+","+t+"]`."):null}},482228:function(e,t,a){"use strict";var n=a(607560),o=a(998283),r=a(72779),i=a.n(r),s=a(202784),l=a(429658),c=["bsPrefix","className"],d=s.forwardRef((function(e,t){var a=e.bsPrefix,r=e.className,d=(0,o.Z)(e,c),u=(0,l.vE)(a,"btn-toolbar");return s.createElement("div",(0,n.Z)({},d,{ref:t,className:i()(r,u)}))}));d.displayName="ButtonToolbar",d.defaultProps={role:"toolbar"},t.Z=d},845450:function(e,t,a){"use strict";var n=a(607560),o=a(998283),r=a(72779),i=a.n(r),s=a(202784),l=a(429658),c=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],d=s.forwardRef((function(e,t){var a=e.bsPrefix,r=e.className,d=e.striped,u=e.bordered,p=e.borderless,v=e.hover,Z=e.size,f=e.variant,h=e.responsive,g=(0,o.Z)(e,c),m=(0,l.vE)(a,"table"),b=i()(r,m,f&&m+"-"+f,Z&&m+"-"+Z,d&&m+"-striped",u&&m+"-bordered",p&&m+"-borderless",v&&m+"-hover"),y=s.createElement("table",(0,n.Z)({},g,{className:b,ref:t}));if(h){var C=m+"-responsive";return"string"==typeof h&&(C=C+"-"+h),s.createElement("div",{className:C},y)}return y}));t.Z=d}}]);