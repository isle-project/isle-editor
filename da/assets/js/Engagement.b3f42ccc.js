/*! For license information please see Engagement.b3f42ccc.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3965],{25603:function(e,t,n){var a=n(131293);e.exports=a},131293:function(e,t,n){var a=n(950718).isPrimitive,l=n(422957),r=n(570554);e.exports=function(e){var t,n,s,o,i;if(!a(e))throw new TypeError("invalid argument. Must provide a positive integer. Value: `"+e+"`.");return n=new r(e),s=0,i=-1,o=0,function(a){var r;if(0===arguments.length)return 0===o?null:s;if(i=(i+1)%e,l(a))o=e,s=NaN;else if(o<e)s+=(t=a-s)/(o+=1);else if(l(n[i])){for(o=1,s=a,r=0;r<e;r++)if(r!==i){if(l(n[r])){o=e,s=NaN;break}o+=1,t=n[r]-s,s+=t/o}}else!1===l(s)&&(t=a-n[i],s+=t/e);return n[i]=a,s}}},635772:function(e,t,n){var a=n(612334);e.exports=a},612334:function(e,t,n){var a=n(950718).isPrimitive,l=n(422957),r=n(109918),s=n(395465),o=n(570554);e.exports=function(e){var t,n,i,c,m;if(!a(e))throw new TypeError("invalid argument. Must provide a positive integer. Value: `"+e+"`.");return t=new o(e),n=r,i=s,m=-1,c=0,function(a){var r,s;if(0===arguments.length)return 0===c?null:i-n;m=(m+1)%e,0===a&&(a=0);if(l(a))c=e,n=a,i=a;else if(c<e)c+=1,a<n&&(n=a),a>i&&(i=a);else if(t[m]===n&&a>n||t[m]===i&&a<i||l(t[m])){for(n=a,i=a,s=0;s<e;s++)if(s!==m){if(r=t[s],l(r)){n=r,i=r;break}r<n&&(n=r),r>i&&(i=r)}}else a<n?n=a:a>i&&(i=a);return t[m]=a,i-n}}},693660:function(e,t,n){n.d(t,{I0:function(){return a.Z},Y2:function(){return l.Z},lq:function(){return r.Z}});var a=n(351375),l=n(506078),r=n(440835);n(658774),n(430391),n(369701),n(902194)},370420:function(e,t,n){const a=(0,n(217431).Z)((()=>n.e(96131).then(n.bind(n,66720))));t.Z=a},466844:function(e,t,n){n.r(t),n.d(t,{default:function(){return L}});var a=n(202784),l=n(213980),r=n.n(l),s=n(498614),o=n(875084),i=n(770561),c=n(423184),m=n(113545),u=n(770149),d=n(112114),p=n(487890),f=n(691334),E=n(690299),g=n.n(E),b=n(10863),v=n(830650),h=n(312594),w=n(458264),y=n(377174),Z=n(426214),N=n(693660),k=n(430391),C=n(216281),$=n(93765),x=n(855077);const H=g()("isle:survey-generator");var S=({session:e,onHide:t})=>{const[n,l]=(0,a.useState)([]),[r,o]=(0,a.useState)(""),[c,m]=(0,a.useState)("free-text"),[d,E]=(0,a.useState)(!1),[g,S]=(0,a.useState)(!0),[R,P]=(0,a.useState)(!0),{t:T}=(0,s.$G)("internal/toolbar"),{logAction:j,onAction:G}=(0,p.G)("SURVEY_GENERATOR",{id:"survey-generator"});(0,a.useEffect)((()=>{const e=G({[f.tj]:e=>{H("Should start the survey..."),o(e.value.question),m(e.value.type),l(e.value.answers),E(!0)},[f.N7]:e=>{H("Should stop the survey..."),E(!1)}});return()=>{e()}}),[e,G]),(0,a.useEffect)((()=>{let e;e=!(r.length>3&&(n.length>1||"multiple-choice"!==c)),P(e)}),[n,r,c]);const q=(0,a.useCallback)((e=>{const t=e.split("\n");let n=!0;r.length>3&&t.length>1&&(n=!1),l(t),P(n)}),[r]),A=(0,a.useCallback)((()=>{d?j(f.N7,null,{},"members"):j(f.tj,{answers:n,type:c,question:r},{},"members")}),[n,r,j,d,c]);let z;return z=d?a.createElement("div",null,"multiple-choice"===c?a.createElement(C.Z,{question:r,answers:n,id:r,anonymous:g}):null,"number"===c?a.createElement($.Z,{question:r,id:r,anonymous:g}):null,"free-text"===c?a.createElement(x.Z,{question:r,answers:n,id:r,anonymous:g}):null,a.createElement("label",null,g?"":T("survey-not-anonymous")),a.createElement(u.Z,{owner:!0,banner:null},a.createElement(i.Z,{disabled:R,onClick:A,style:{float:"right"}},T("stop-survey")))):a.createElement(u.Z,{owner:!0,banner:a.createElement("h3",null,T("survey-not-started"))},a.createElement(b.Z,null,a.createElement(w.Z,null,a.createElement(h.Z,{md:3},a.createElement(v.Z,{htmlFor:"survey-select-input"},T("type"),":")),a.createElement(h.Z,{md:9},a.createElement(N.lq,{id:"survey-select-input",defaultValue:c,options:["multiple-choice","number","free-text"],onChange:m})))),a.createElement(b.Z,null,a.createElement(k.Z,{legend:T("question"),onChange:o,rows:2})),"multiple-choice"===c?a.createElement(b.Z,null,a.createElement(k.Z,{legend:T("answer-options-new-line-delimited"),onChange:q})):null,a.createElement(N.I0,{tooltip:T("anonymous-survey-tooltip"),tooltipPlacement:"top",legend:T("anonymous-survey"),defaultValue:!0,onChange:S}),a.createElement(i.Z,{disabled:R,onClick:A},T("start-survey"))),a.createElement(y.Z,{dragHandleClassName:"card-header"},a.createElement(Z.Z,{header:T("survey"),minimizable:!0,className:"survey-generator",onHide:e.isOwner()?t:null,hideTooltip:T("finish-survey"),trapFocus:!0},z))},R=n(845450),P=n(973777),T=n(370420);var j=(0,s.Zh)("internal/toolbar")((({session:e,renderValue:t,responses:n,t:l,onHide:r})=>a.createElement(y.Z,{dragHandleClassName:"card-header"},a.createElement(Z.Z,{className:"engagement-meter-panel",header:l("poll-responses"),onHide:r,minimizable:!0,trapFocus:!0,style:{width:400}},a.createElement(P.Z,{className:"engagement-table",showPageSizeOptions:!1,data:n,resizable:!1,sortable:!1,columns:[{Header:"Pic",id:"pic",accessor:t=>{const{userList:n}=e;for(let e=0;e<n.length;e++)if(n[e].name===t.name)return n[e].picture;return""},Cell:t=>a.createElement("img",{className:"engagement-table-pic",alt:"User thumbnail",src:`${e.server}/thumbnail/${t.value}`}),maxWidth:38,minWidth:38,style:{color:"darkslategrey"}},{Header:l("name"),id:"nameCol",accessor:"name",width:180,Cell:e=>a.createElement(d.Z,{tooltip:`${e.value} (${e.original.email})`},a.createElement("span",{className:"engagement-table-name"},e.value))},{Header:l("response"),id:"responseCol",accessor:"value",Cell:t,maxWidth:38,minWidth:38},{Header:l("chat"),Cell:e=>{const t=`Chat with ${e.original.name}`;return a.createElement(T.Z,{tooltip:l("chat-tooltip"),showTooltip:!1,for:t})}}],pageSize:8})))));const G=({session:e,type:t,t:n,onHide:l})=>{const[r,s]=(0,a.useState)(0),[o,c]=(0,a.useState)(0),[m,d]=(0,a.useState)([]),[E,g]=(0,a.useState)(!1),{logAction:b,onAction:v}=(0,p.G)("ENGAGEMENT_BINARY",{id:"engagement-binary"}),h=(0,a.useRef)(null);(0,a.useEffect)((()=>{let l,r,s;switch(t){case"yes:no":l="fas fa-times",r="fas fa-check",s=n("answer-yes-no");break;case"too-slow:too-fast":l="fas fa-backward",r="fas fa-forward",s=n("answer-slow-fast")}e.isOwner()||h.current||(h.current=e.addNotification({title:n("poll"),message:s,level:"info",position:"tc",dismissible:"none",autoDismiss:0,children:a.createElement("div",{style:{marginBottom:"40px",marginTop:"10px"}},a.createElement(i.Z,{variant:"secondary",style:{float:"left"},onClick:()=>{b(f.Dp,-1),e.removeNotification(h.current),e.addNotification({title:n("answer-recorded"),message:n("answer-recorded-message"),level:"success",position:"tc"})}},a.createElement("i",{className:l})),a.createElement(i.Z,{variant:"secondary",style:{float:"right"},onClick:()=>{b(f.Dp,1),e.removeNotification(h.current),e.addNotification({title:n("answer-recorded"),message:n("answer-recorded-message"),level:"success",position:"tc"})}},a.createElement("i",{className:r})))}))}),[b,e,n,t]),(0,a.useEffect)((()=>{const e=v({[f.Dp]:e=>{const t=m.slice();t.push({name:e.name,email:e.email,value:e.value}),1===e.value?(c(o+1),d(t)):-1===e.value&&(s(r+1),d(t))}});return()=>{e()}}),[r,o,v,m]);const w=(0,a.useCallback)((()=>{g(!E)}),[E]);let N,k;switch(t){case"yes:no":N="fas fa-times",k="fas fa-check";break;case"too-slow:too-fast":N="fas fa-backward",k="fas fa-forward"}const C=a.createElement(R.Z,{bordered:!0,size:"sm"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,a.createElement("i",{className:N})),a.createElement("th",null,a.createElement("i",{className:k})))),a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,r),a.createElement("td",null,o))));return a.createElement(a.Fragment,null,a.createElement(y.Z,{dragHandleClassName:"card-header"},a.createElement(u.Z,{owner:!0,showOwnerInPresentationMode:!1,banner:null},a.createElement(Z.Z,{header:n("poll"),hideTooltip:n("finish-poll"),onHide:l,className:"engagement-meter-panel",minimizable:!0,trapFocus:!0},C,a.createElement(i.Z,{variant:"link",onClick:w},a.createElement("small",null,n("toggle-details"))))),a.createElement(u.Z,{user:!0,notOwner:!0,header:n("poll"),banner:null},a.createElement(Z.Z,{header:n("poll"),className:"engagement-meter-panel",minimizable:!0,trapFocus:!0},C))),E?a.createElement(j,{responses:m,session:e,onHide:w,renderValue:e=>-1===e.value?a.createElement("i",{className:N}):a.createElement("i",{className:k})}):null)};G.propTypes={session:r().object.isRequired,onHide:r().func.isRequired};var q=(0,s.Zh)("internal/toolbar")(G),A=n(998856),z=n(25603),F=n.n(z),M=n(635772),O=n.n(M),V=n(74039),D=n.n(V),I=n(341327),U=n.n(I);var W=({t:e,onSubmit:t})=>{const[n,l]=(0,a.useState)(50),[r,s]=(0,a.useState)({x:0,y:0}),o=(0,a.useCallback)(((e,t)=>{const{x:n,y:a}=t;s({x:n,y:a})}),[]),c=(0,a.useCallback)(((e,t)=>{const{x:n,y:a}=t;s({x:n,y:a}),l((n+100)/200*100)}),[]),m=(0,a.useCallback)((()=>{t(n)}),[n,t]);return a.createElement(a.Fragment,null,a.createElement("div",{className:"score-bottom"},a.createElement(U(),{bounds:{left:-100,right:100,top:0,bottom:0},onStop:c,position:r,onDrag:o},a.createElement("div",{className:"score-setter"})),a.createElement(A.Z,{style:{marginTop:23}},a.createElement(A.Z,{animated:!0,variant:"success",now:n}),a.createElement(A.Z,{animated:!0,variant:"danger",now:100-n}))),a.createElement(i.Z,{variant:"secondary",size:"sm",onClick:m,style:{marginTop:10}},e("submit")))};const Y=({session:e,t:t,onHide:n})=>{const[l,r]=(0,a.useState)(null),[s,o]=(0,a.useState)(null),[c,m]=(0,a.useState)([]),[d,E]=(0,a.useState)(!1),{logAction:g,onAction:b}=(0,p.G)("ENGAGEMENT_METER",{id:"engagement-meter"}),v=(0,a.useCallback)((()=>{E(!d)}),[d]),h=(0,a.useRef)(F()(6)),w=(0,a.useRef)(O()(6)),N=(0,a.useRef)(null);return(0,a.useEffect)((()=>{const n=b({[f.Dp]:e=>{const t=h.current(e.value),n=w.current(e.value),a=c.slice();a.push({name:e.name,email:e.email,value:e.value}),r(t),o(n),m(a)}});return e.isOwner()||N.current||(N.current=e.addNotification({title:t("poll"),message:t("meter-prompt"),level:"info",position:"tc",dismissible:"none",autoDismiss:0,children:a.createElement(W,{t:t,onSubmit:n=>{g(f.Dp,n),e.removeNotification(N.current),e.addNotification({title:t("answer-recorded"),message:t("answer-recorded-message"),level:"success",position:"tc"})}})})),()=>{n()}}),[g,c,e,t,b]),a.createElement(a.Fragment,null,a.createElement(y.Z,{dragHandleClassName:"card-header"},a.createElement(u.Z,{owner:!0,showOwnerInPresentationMode:!1,banner:null},a.createElement(Z.Z,{header:t("poll"),hideTooltip:t("finish-poll"),onHide:n,className:"engagement-meter-panel",minimizable:!0,trapFocus:!0},a.createElement("div",{className:"score-bottom"},l?a.createElement(a.Fragment,null,a.createElement(A.Z,{style:{marginTop:23}},a.createElement(A.Z,{animated:!0,variant:"success",now:l}),a.createElement(A.Z,{animated:!0,variant:"danger",now:100-l}))):null),l?a.createElement("p",null,t("mean"),": ",D()(l,-2)," (n: ",c.length,")"):null,s?a.createElement("p",null,t("range"),": ",D()(s,-2)):null,a.createElement(i.Z,{variant:"link",onClick:v},a.createElement("small",null,t("toggle-details")))))),d?a.createElement(j,{responses:c,session:e,onHide:v,renderValue:e=>e.value}):null)};Y.propTypes={session:r().object.isRequired,onHide:r().func.isRequired};var _=(0,s.Zh)("internal/toolbar")(Y);const B=({session:e})=>{const{t:t}=(0,s.$G)("internal/toolbar"),{logAction:n,onAction:l}=(0,p.G)("ENGAGEMENT_SURVEY",{id:"engagement"}),[r,E]=(0,a.useState)(!1),[g,b]=(0,a.useState)(!1),v=(0,a.useRef)(null),h=(0,a.useCallback)((()=>{n(f.tj,"yes:no",{},"members")}),[n]),w=(0,a.useCallback)((()=>{n(f.tj,"too-slow:too-fast",{},"members")}),[n]),y=(0,a.useCallback)((()=>{n(f.tj,"like:dislike",{},"members")}),[n]),Z=(0,a.useCallback)((()=>{n(f.tj,"survey",{},"members")}),[n]);(0,a.useEffect)((()=>{console.log("Engagement component mounted.");const e=l({[f.tj]:e=>{console.log("Engagement poll started."),E(e.value),b(!1)},[f.uR]:e=>{console.log("Engagement poll ended."),E(e.value),b(!1)}});return()=>{console.log("Unsubscribe from action logger for engagement buttons..."),e()}}),[l]);const N=(0,a.useCallback)((()=>{r?n(f.uR,null,{},"members"):b(!g)}),[n,r,g]);let k;switch(r){case"yes:no":case"too-slow:too-fast":k=a.createElement(q,{type:r,session:e,onHide:N});break;case"like:dislike":k=a.createElement(_,{session:e,onHide:N});break;case"survey":k=a.createElement(S,{session:e,onHide:N});break;default:k=null}const C=a.createElement(u.Z,{owner:!0,banner:null},a.createElement(c.Z,{vertical:!0,className:"toolbar-engagement-buttons"},a.createElement(d.Z,{tooltip:`${t("yes-no")} (1)`,placement:"right"},a.createElement(i.Z,{variant:"light",className:"toolbar-button",onClick:h,"aria-label":`${t("yes-no")} ${t("poll")}`},a.createElement("span",{className:"fa fa-lg fa-check toolbar-icon"}))),a.createElement(d.Z,{tooltip:`${t("slow-fast")} (2)`,placement:"right"},a.createElement(i.Z,{variant:"light",className:"toolbar-button",onClick:w,"aria-label":`${t("slow-fast")} ${t("poll")}`},a.createElement("span",{className:"fa fa-lg fa-tachometer-alt toolbar-icon"}))),a.createElement(d.Z,{tooltip:`${t("like-dislike")} (3)`,placement:"right"},a.createElement(i.Z,{variant:"light",className:"toolbar-button",onClick:y,"aria-label":`${t("like-dislike")} ${t("poll")}`},a.createElement("span",{className:"fa fa-lg fa-thumbs-up toolbar-icon"}))),a.createElement(d.Z,{tooltip:`${t("survey")} (4)`,placement:"right"},a.createElement(i.Z,{variant:"light",className:"toolbar-button",onClick:Z,"aria-label":t("survey")},a.createElement("span",{className:"fa fa-lg fa-poll toolbar-icon"})))),a.createElement(m.Z,{actions:{1:h,2:w,3:y,4:Z}}));return a.createElement(a.Fragment,null,a.createElement(u.Z,{owner:!0,inline:!0,showOwnerInPresentationMode:!0,banner:null},a.createElement(d.Z,{tooltip:`${t(r?"finish-poll":"polls")} (P)`,placement:"right"},a.createElement(i.Z,{variant:r?"warning":g?"success":"light",className:"toolbar-button toolbar-engagement",onClick:N,ref:v,"aria-label":t(r?"finish-poll":"open-poll-menu")},a.createElement("span",{className:"fa fa-lg fa-poll-h toolbar-icon"})))),a.createElement(o.Z,{placement:"right",show:g,target:v.current,trigger:"click"},a.createElement("div",null,C)),k,a.createElement(m.Z,{actions:{p:N}}))};B.propTypes={session:r().object.isRequired};var L=B},998856:function(e,t,n){var a=n(72779),l=n.n(a),r=n(202784),s=n(429658),o=n(21027),i=n(552322);function c(e,t,n){const a=(e-t)/(n-t)*100;return Math.round(1e3*a)/1e3}function m({min:e,now:t,max:n,label:a,visuallyHidden:r,striped:s,animated:o,className:m,style:u,variant:d,bsPrefix:p,...f},E){return(0,i.jsx)("div",{ref:E,...f,role:"progressbar",className:l()(m,`${p}-bar`,{[`bg-${d}`]:d,[`${p}-bar-animated`]:o,[`${p}-bar-striped`]:o||s}),style:{width:`${c(t,e,n)}%`,...u},"aria-valuenow":t,"aria-valuemin":e,"aria-valuemax":n,children:r?(0,i.jsx)("span",{className:"visually-hidden",children:a}):a})}const u=r.forwardRef((({isChild:e,...t},n)=>{if(t.bsPrefix=(0,s.vE)(t.bsPrefix,"progress"),e)return m(t,n);const{min:a,now:c,max:u,label:d,visuallyHidden:p,striped:f,animated:E,bsPrefix:g,variant:b,className:v,children:h,...w}=t;return(0,i.jsx)("div",{ref:n,...w,className:l()(v,g),children:h?(0,o.UI)(h,(e=>(0,r.cloneElement)(e,{isChild:!0}))):m({min:a,now:c,max:u,label:d,visuallyHidden:p,striped:f,animated:E,bsPrefix:g,variant:b},n)})}));u.displayName="ProgressBar",u.defaultProps={min:0,max:100,animated:!1,isChild:!1,visuallyHidden:!1,striped:!1},t.Z=u},458264:function(e,t,n){var a=n(72779),l=n.n(a),r=n(202784),s=n(429658),o=n(552322);const i=r.forwardRef((({bsPrefix:e,className:t,as:n="div",...a},r)=>{const i=(0,s.vE)(e,"row"),c=(0,s.pi)(),m=(0,s.zG)(),u=`${i}-cols`,d=[];return c.forEach((e=>{const t=a[e];let n;delete a[e],null!=t&&"object"==typeof t?({cols:n}=t):n=t;const l=e!==m?`-${e}`:"";null!=n&&d.push(`${u}${l}-${n}`)})),(0,o.jsx)(n,{ref:r,...a,className:l()(t,i,...d)})}));i.displayName="Row",t.Z=i},845450:function(e,t,n){var a=n(72779),l=n.n(a),r=n(202784),s=n(429658),o=n(552322);const i=r.forwardRef((({bsPrefix:e,className:t,striped:n,bordered:a,borderless:r,hover:i,size:c,variant:m,responsive:u,...d},p)=>{const f=(0,s.vE)(e,"table"),E=l()(t,f,m&&`${f}-${m}`,c&&`${f}-${c}`,n&&`${f}-${"string"==typeof n?`striped-${n}`:"striped"}`,a&&`${f}-bordered`,r&&`${f}-borderless`,i&&`${f}-hover`),g=(0,o.jsx)("table",{...d,className:E,ref:p});if(u){let e=`${f}-responsive`;return"string"==typeof u&&(e=`${e}-${u}`),(0,o.jsx)("div",{className:e,children:g})}return g}));t.Z=i}}]);