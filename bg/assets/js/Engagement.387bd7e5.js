/*! For license information please see Engagement.387bd7e5.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3965],{25603:function(e,t,s){var n=s(131293);e.exports=n},131293:function(e,t,s){var n=s(950718).isPrimitive,a=s(422957),r=s(570554);e.exports=function(e){var t,s,i,o,l;if(!n(e))throw new TypeError("invalid argument. Must provide a positive integer. Value: `"+e+"`.");return s=new r(e),i=0,l=-1,o=0,function(n){var r;if(0===arguments.length)return 0===o?null:i;if(l=(l+1)%e,a(n))o=e,i=NaN;else if(o<e)i+=(t=n-i)/(o+=1);else if(a(s[l])){for(o=1,i=n,r=0;r<e;r++)if(r!==l){if(a(s[r])){o=e,i=NaN;break}o+=1,t=s[r]-i,i+=t/o}}else!1===a(i)&&(t=n-s[l],i+=t/e);return s[l]=n,i}}},635772:function(e,t,s){var n=s(612334);e.exports=n},612334:function(e,t,s){var n=s(950718).isPrimitive,a=s(422957),r=s(109918),i=s(395465),o=s(570554);e.exports=function(e){var t,s,l,c,m;if(!n(e))throw new TypeError("invalid argument. Must provide a positive integer. Value: `"+e+"`.");return t=new o(e),s=r,l=i,m=-1,c=0,function(n){var r,i;if(0===arguments.length)return 0===c?null:l-s;m=(m+1)%e,0===n&&(n=0);if(a(n))c=e,s=n,l=n;else if(c<e)c+=1,n<s&&(s=n),n>l&&(l=n);else if(t[m]===s&&n>s||t[m]===l&&n<l||a(t[m])){for(s=n,l=n,i=0;i<e;i++)if(i!==m){if(r=t[i],a(r)){s=r,l=r;break}r<s&&(s=r),r>l&&(l=r)}}else n<s?s=n:n>l&&(l=n);return t[m]=n,l-s}}},693660:function(e,t,s){s.d(t,{I0:function(){return n.Z},Y2:function(){return a.Z},lq:function(){return r.Z}});var n=s(351375),a=s(506078),r=s(440835);s(658774),s(430391),s(369701),s(902194)},370420:function(e,t,s){const n=(0,s(217431).Z)((()=>s.e(96131).then(s.bind(s,66720))));t.Z=n},466844:function(e,t,s){s.r(t),s.d(t,{default:function(){return ne}});var n=s(202784),a=s(213980),r=s.n(a),i=s(302108),o=s(691334),l=s(690299),c=s.n(l),m=s(376699),u=s(770561),p=s(10863),d=s(830650),h=s(312594),f=s(458264),g=s(377174),v=s(426214),b=s(770149),E=s(693660),y=s(430391),w=s(216281),Z=s(93765),N=s(855077),x=s(42653);const C=c()("isle:survey-generator"),H="survey-generator";var R=({session:e,onHide:t})=>{const[s,a]=(0,n.useState)([]),[r,l]=(0,n.useState)(""),[c,R]=(0,n.useState)("free-text"),[P,$]=(0,n.useState)(!1),[k,S]=(0,n.useState)(!0),[q,T]=(0,n.useState)(!0),{t:j}=(0,m.$)("internal/toolbar"),D=(0,x.Z)();(0,n.useEffect)((()=>{const t=e.subscribe(((e,t)=>{C("Received member action..."),e===i.Wh&&H===t.id&&(t.type===o.rXu?(C("Should start the survey..."),l(t.value.question),R(t.value.type),a(t.value.answers),$(!0)):t.type===o.Dl9?(C("Should stop the survey..."),$(!1)):D())}));return()=>{t()}}),[D,e]),(0,n.useEffect)((()=>{let e;e=!(r.length>3&&(s.length>1||"multiple-choice"!==c)),T(e)}),[s,r,c]);const z=(0,n.useCallback)((e=>{const t=e.split("\n");let s=!0;r.length>3&&t.length>1&&(s=!1),a(t),T(s)}),[r]),F=(0,n.useCallback)((()=>{P?e.log({id:H,type:o.Dl9,value:null},"members"):e.log({id:H,type:o.rXu,value:{answers:s,type:c,question:r}},"members")}),[s,e,r,P,c]);let J;return J=P?n.createElement("div",null,"multiple-choice"===c?n.createElement(w.Z,{user:!0,question:r,answers:s,id:H+":multiple-choice-survey",anonymous:k}):null,"number"===c?n.createElement(Z.Z,{user:!0,question:r,id:H+":number-survey",anonymous:k}):null,"free-text"===c?n.createElement(N.Z,{user:!0,question:r,answers:s,id:H+":free-text-survey",anonymous:k}):null,n.createElement("label",null,k?"":j("survey-not-anonymous")),n.createElement(b.Z,{owner:!0,banner:null},n.createElement(u.Z,{disabled:q,onClick:F,style:{float:"right"}},j("stop-survey")))):n.createElement(b.Z,{owner:!0,banner:n.createElement("h3",null,j("survey-not-started"))},n.createElement(p.Z,null,n.createElement(f.Z,null,n.createElement(h.Z,{md:3},n.createElement(d.Z,{htmlFor:"survey-select-input"},j("type"),":")),n.createElement(h.Z,{md:9},n.createElement(E.lq,{id:"survey-select-input",defaultValue:c,options:["multiple-choice","number","free-text"],onChange:R})))),n.createElement(p.Z,null,n.createElement(y.Z,{legend:j("question"),onChange:l,rows:2})),"multiple-choice"===c?n.createElement(p.Z,null,n.createElement(y.Z,{legend:j("answer-options-new-line-delimited"),onChange:z})):null,n.createElement(E.I0,{tooltip:j("anonymous-survey-tooltip"),tooltipPlacement:"top",legend:j("anonymous-survey"),defaultValue:!0,onChange:S}),n.createElement(u.Z,{disabled:q,onClick:F},j("start-survey"))),n.createElement(g.Z,{dragHandleClassName:"card-header"},n.createElement(v.Z,{header:j("survey"),minimizable:!0,className:"survey-generator",onHide:e.isOwner()?t:null,hideTooltip:j("finish-survey"),trapFocus:!0},J))},P=s(198),$=s(845450),k=s(973777),S=s(112114),q=s(370420);var T=(0,P.Z)("internal/toolbar")((e=>n.createElement(g.Z,{dragHandleClassName:"card-header"},n.createElement(v.Z,{className:"engagement-meter-panel",header:e.t("poll-responses"),onHide:e.onHide,minimizable:!0,trapFocus:!0,style:{width:400}},n.createElement(k.Z,{className:"engagement-table",showPageSizeOptions:!1,data:e.responses,resizable:!1,sortable:!1,columns:[{Header:"Pic",id:"pic",accessor:t=>{const{userList:s}=e.session;for(let e=0;e<s.length;e++)if(s[e].name===t.name)return s[e].picture;return""},Cell:t=>n.createElement("img",{className:"engagement-table-pic",alt:"User thumbnail",src:`${e.session.server}/thumbnail/${t.value}`}),maxWidth:38,minWidth:38,style:{color:"darkslategrey"}},{Header:e.t("name"),id:"nameCol",accessor:"name",width:180,Cell:e=>n.createElement(S.Z,{tooltip:`${e.value} (${e.original.email})`},n.createElement("span",{className:"engagement-table-name"},e.value))},{Header:e.t("response"),id:"responseCol",accessor:"value",Cell:e.renderValue,maxWidth:38,minWidth:38},{Header:e.t("chat"),Cell:t=>{const s=`Chat with ${t.original.name}`;return n.createElement(q.Z,{tooltip:e.t("chat-tooltip"),showTooltip:!1,for:s})}}],pageSize:8}))))),j=Object.defineProperty,D=(e,t,s)=>(((e,t,s)=>{t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const z="ENGAGEMENT_BINARY";class F extends n.Component{constructor(e){super(e),D(this,"toggleResponses",(()=>{this.setState({showResponses:!this.state.showResponses})})),this.state={nLeft:0,nRight:0,responses:[],showResponses:!1}}componentDidMount(){const e=this.props.session;let t,s,a;switch(e&&(this.unsubscribe=e.subscribe(((e,t)=>{if(e===i.Wh&&t.id===z&&t.type===o.JeJ){const e=this.state.responses.slice();e.push({name:t.name,email:t.email,value:t.value}),1===t.value?this.setState({nRight:this.state.nRight+1,responses:e}):-1===t.value&&this.setState({nLeft:this.state.nLeft+1,responses:e})}}))),this.props.type){case"yes:no":t="fas fa-times",s="fas fa-check",a=this.props.t("answer-yes-no");break;case"too-slow:too-fast":t="fas fa-backward",s="fas fa-forward",a=this.props.t("answer-slow-fast")}if(!e.isOwner()){const r=e.addNotification({title:this.props.t("poll"),message:a,level:"info",position:"tc",dismissible:"none",autoDismiss:0,children:n.createElement("div",{style:{marginBottom:"40px",marginTop:"10px"}},n.createElement(u.Z,{variant:"secondary",style:{float:"left"},onClick:()=>{e.log({id:z,type:o.JeJ,value:-1}),e.removeNotification(r),e.addNotification({title:this.props.t("answer-recorded"),message:this.props.t("answer-recorded-message"),level:"success",position:"tc"})}},n.createElement("i",{className:t})),n.createElement(u.Z,{variant:"secondary",style:{float:"right"},onClick:()=>{e.log({id:z,type:o.JeJ,value:1}),e.removeNotification(r),e.addNotification({title:this.props.t("answer-recorded"),message:this.props.t("answer-recorded-message"),level:"success",position:"tc"})}},n.createElement("i",{className:s})))})}}render(){let e,t;switch(this.props.type){case"yes:no":e="fas fa-times",t="fas fa-check";break;case"too-slow:too-fast":e="fas fa-backward",t="fas fa-forward"}const{t:s}=this.props,a=n.createElement($.Z,{bordered:!0,size:"sm"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,n.createElement("i",{className:e})),n.createElement("th",null,n.createElement("i",{className:t})))),n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",null,this.state.nLeft),n.createElement("td",null,this.state.nRight))));return n.createElement(n.Fragment,null,n.createElement(g.Z,{dragHandleClassName:"card-header"},n.createElement(b.Z,{owner:!0,showOwnerInPresentationMode:!1,banner:null},n.createElement(v.Z,{header:s("poll"),hideTooltip:s("finish-poll"),onHide:this.props.onHide,className:"engagement-meter-panel",minimizable:!0,trapFocus:!0},a,n.createElement(u.Z,{variant:"link",onClick:this.toggleResponses},n.createElement("small",null,s("toggle-details"))))),n.createElement(b.Z,{user:!0,notOwner:!0,header:s("poll"),banner:null},n.createElement(v.Z,{header:s("poll"),className:"engagement-meter-panel",minimizable:!0,trapFocus:!0},a))),this.state.showResponses?n.createElement(T,{responses:this.state.responses,session:this.props.session,onHide:this.toggleResponses,renderValue:s=>-1===s.value?n.createElement("i",{className:e}):n.createElement("i",{className:t})}):null)}}F.propTypes={session:r().object.isRequired,onHide:r().func.isRequired};var J=(0,P.Z)("internal/toolbar")(F),M=s(998856),O=s(25603),W=s.n(O),V=s(635772),A=s.n(V),I=s(74039),L=s.n(I),B=s(341327),G=s.n(B),U=Object.defineProperty,X=(e,t,s)=>(((e,t,s)=>{t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);class Y extends n.Component{constructor(e){super(e),X(this,"onControlledDrag",((e,t)=>{const{x:s,y:n}=t;this.setState({controlledPosition:{x:s,y:n}})})),X(this,"onControlledDragStop",((e,t)=>{const{x:s,y:n}=t;this.setState({controlledPosition:{x:s,y:n},progress:(s+100)/200*100})})),X(this,"handleSubmit",(()=>{this.props.onSubmit(this.state.progress)})),this.state={progress:50,controlledPosition:{x:0,y:0}}}render(){return n.createElement(n.Fragment,null,n.createElement("div",{className:"score-bottom"},n.createElement(G(),{bounds:{left:-100,right:100,top:0,bottom:0},onStop:this.onControlledDragStop,position:this.state.controlledPosition,onDrag:this.onControlledDrag},n.createElement("div",{className:"score-setter"})),n.createElement(M.Z,{style:{marginTop:23}},n.createElement(M.Z,{animated:!0,variant:"success",now:this.state.progress}),n.createElement(M.Z,{animated:!0,variant:"danger",now:100-this.state.progress}))),n.createElement(u.Z,{variant:"secondary",size:"sm",onClick:this.handleSubmit,style:{marginTop:10}},this.props.t("submit")))}}var Q=Y,_=Object.defineProperty,K=(e,t,s)=>(((e,t,s)=>{t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);class ee extends n.Component{constructor(e){super(e),K(this,"toggleResponses",(()=>{this.setState({showResponses:!this.state.showResponses})})),this.state={mean:null,range:null,responses:[],showResponses:!1},this.id=e.id||"engagement-meter",this.meanAcc=W()(6),this.rangeAcc=A()(6)}componentDidMount(){const e=this.props.session;if(e&&(this.unsubscribe=e.subscribe(((e,t)=>{if(e===i.Wh&&t.id===this.id&&t.type===o.JeJ){const e=this.meanAcc(t.value),s=this.rangeAcc(t.value),n=this.state.responses.slice();n.push({name:t.name,email:t.email,value:t.value}),this.setState({mean:e,range:s,responses:n})}}))),!e.isOwner()){const t=e.addNotification({title:this.props.t("poll"),message:this.props.t("meter-prompt"),level:"info",position:"tc",dismissible:"none",autoDismiss:0,children:n.createElement(Q,{t:this.props.t,onSubmit:e=>{const s=this.props.session;s.log({id:this.id,type:o.JeJ,value:e}),s.removeNotification(t),s.addNotification({title:this.props.t("answer-recorded"),message:this.props.t("answer-recorded-message"),level:"success",position:"tc"})}})})}}render(){return n.createElement(n.Fragment,null,n.createElement(g.Z,{dragHandleClassName:"card-header"},n.createElement(b.Z,{owner:!0,showOwnerInPresentationMode:!1,banner:null},n.createElement(v.Z,{header:this.props.t("poll"),hideTooltip:this.props.t("finish-poll"),onHide:this.props.onHide,className:"engagement-meter-panel",minimizable:!0,trapFocus:!0},n.createElement("div",{className:"score-bottom"},this.state.mean?n.createElement(n.Fragment,null,n.createElement(M.Z,{style:{marginTop:23}},n.createElement(M.Z,{animated:!0,variant:"success",now:this.state.mean}),n.createElement(M.Z,{animated:!0,variant:"danger",now:100-this.state.mean}))):null),this.state.mean?n.createElement("p",null,this.props.t("mean"),": ",L()(this.state.mean,-2)," (n: ",this.state.responses.length,")"):null,this.state.range?n.createElement("p",null,this.props.t("range"),": ",L()(this.state.range,-2)):null,n.createElement(u.Z,{variant:"link",onClick:this.toggleResponses},n.createElement("small",null,this.props.t("toggle-details")))))),this.state.showResponses?n.createElement(T,{responses:this.state.responses,session:this.props.session,onHide:this.toggleResponses,renderValue:e=>e.value}):null)}}ee.propTypes={session:r().object.isRequired,onHide:r().func.isRequired};var te=(0,P.Z)("internal/toolbar")(ee);class se extends n.Component{constructor(e){super(e),this.state={inProgress:!1}}componentDidMount(){const e=this.props.session;this.unsubscribe=e.subscribe(((e,t)=>{if(e===i.Wh&&"engagement"===t.id){const e=t.type;e===o.cG1?this.setState({inProgress:t.value}):e===o.oMQ&&this.setState({inProgress:!1})}}))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}render(){switch(this.state.inProgress){case"yes:no":case"too-slow:too-fast":return n.createElement(J,{type:this.state.inProgress,session:this.props.session,onHide:this.props.onHide});case"like:dislike":return n.createElement(te,{session:this.props.session,onHide:this.props.onHide});case"survey":return n.createElement(R,{session:this.props.session,onHide:this.props.onHide});default:return null}}}se.propTypes={session:r().object.isRequired,onHide:r().func.isRequired};var ne=se},998856:function(e,t,s){var n=s(72779),a=s.n(n),r=s(202784),i=s(429658),o=s(21027),l=s(552322);function c(e,t,s){const n=(e-t)/(s-t)*100;return Math.round(1e3*n)/1e3}function m({min:e,now:t,max:s,label:n,visuallyHidden:r,striped:i,animated:o,className:m,style:u,variant:p,bsPrefix:d,...h},f){return(0,l.jsx)("div",{ref:f,...h,role:"progressbar",className:a()(m,`${d}-bar`,{[`bg-${p}`]:p,[`${d}-bar-animated`]:o,[`${d}-bar-striped`]:o||i}),style:{width:`${c(t,e,s)}%`,...u},"aria-valuenow":t,"aria-valuemin":e,"aria-valuemax":s,children:r?(0,l.jsx)("span",{className:"visually-hidden",children:n}):n})}const u=r.forwardRef((({isChild:e,...t},s)=>{if(t.bsPrefix=(0,i.vE)(t.bsPrefix,"progress"),e)return m(t,s);const{min:n,now:c,max:u,label:p,visuallyHidden:d,striped:h,animated:f,bsPrefix:g,variant:v,className:b,children:E,...y}=t;return(0,l.jsx)("div",{ref:s,...y,className:a()(b,g),children:E?(0,o.UI)(E,(e=>(0,r.cloneElement)(e,{isChild:!0}))):m({min:n,now:c,max:u,label:p,visuallyHidden:d,striped:h,animated:f,bsPrefix:g,variant:v},s)})}));u.displayName="ProgressBar",u.defaultProps={min:0,max:100,animated:!1,isChild:!1,visuallyHidden:!1,striped:!1},t.Z=u},458264:function(e,t,s){var n=s(72779),a=s.n(n),r=s(202784),i=s(429658),o=s(552322);const l=r.forwardRef((({bsPrefix:e,className:t,as:s="div",...n},r)=>{const l=(0,i.vE)(e,"row"),c=(0,i.pi)(),m=`${l}-cols`,u=[];return c.forEach((e=>{const t=n[e];let s;delete n[e],null!=t&&"object"==typeof t?({cols:s}=t):s=t;const a="xs"!==e?`-${e}`:"";null!=s&&u.push(`${m}${a}-${s}`)})),(0,o.jsx)(s,{ref:r,...n,className:a()(t,l,...u)})}));l.displayName="Row",t.Z=l},845450:function(e,t,s){var n=s(72779),a=s.n(n),r=s(202784),i=s(429658),o=s(552322);const l=r.forwardRef((({bsPrefix:e,className:t,striped:s,bordered:n,borderless:r,hover:l,size:c,variant:m,responsive:u,...p},d)=>{const h=(0,i.vE)(e,"table"),f=a()(t,h,m&&`${h}-${m}`,c&&`${h}-${c}`,s&&`${h}-striped`,n&&`${h}-bordered`,r&&`${h}-borderless`,l&&`${h}-hover`),g=(0,o.jsx)("table",{...p,className:f,ref:d});if(u){let e=`${h}-responsive`;return"string"==typeof u&&(e=`${e}-${u}`),(0,o.jsx)("div",{className:e,children:g})}return g}));t.Z=l}}]);